# EPISODE 09: –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò –ò –ü–†–ê–í–ê –î–û–°–¢–£–ü–ê
## Season 3: –°–∏—Å—Ç–µ–º–Ω–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ | –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –†–æ—Å—Å–∏—è

> *"Root access –∫–∞–∫ –∑–∞—Ä—è–∂–µ–Ω–Ω—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç. –ù–µ –¥–∞–≤–∞–π –µ–≥–æ –∫–æ–º—É –ø–æ–ø–∞–ª–æ."*
> ‚Äî –ê–Ω–¥—Ä–µ–π –í–æ–ª–∫–æ–≤, –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä –õ–≠–¢–ò

---

## üìç –ö–æ–Ω—Ç–µ–∫—Å—Ç –º–∏—Å—Å–∏–∏

**–õ–æ–∫–∞—Ü–∏—è:** üá∑üá∫ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –†–æ—Å—Å–∏—è
**–ú–µ—Å—Ç–æ:** –õ–≠–¢–ò (–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∏–π —ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç–∏—Ç—É—Ç), –í–∞—Å–∏–ª—å–µ–≤—Å–∫–∏–π –æ—Å—Ç—Ä–æ–≤
**–î–µ–Ω—å –æ–ø–µ—Ä–∞—Ü–∏–∏:** 17-18 –∏–∑ 60
**–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:** 4-5 —á–∞—Å–æ–≤
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ
**–¢–∏–ø:** **Type B ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ** (90% –∫–æ–Ω—Ñ–∏–≥–∏, 10% bash –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏)

**–ü–µ—Ä—Å–æ–Ω–∞–∂–∏:**
- **–ú–∞–∫—Å –°–æ–∫–æ–ª–æ–≤** ‚Äî –≤—ã, —Ä–∞—Å—Ç—ë—Ç–µ –∫–∞–∫ sysadmin
- **–ê–Ω–¥—Ä–µ–π –í–æ–ª–∫–æ–≤** ‚Äî ex-–ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä Unix (–õ–≠–¢–ò), –º–µ–Ω—Ç–æ—Ä
- **–í–∏–∫—Ç–æ—Ä –ü–µ—Ç—Ä–æ–≤** ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ê–ª–µ–∫—Å –°–æ–∫–æ–ª–æ–≤** ‚Äî –≤–∞—à –¥–≤–æ—é—Ä–æ–¥–Ω—ã–π –±—Ä–∞—Ç, ex-FSB, security expert
- **–ê–Ω–Ω–∞ –ö–æ–≤–∞–ª–µ–≤–∞** ‚Äî forensics expert, blue team lead
- **–î–º–∏—Ç—Ä–∏–π –û—Ä–ª–æ–≤** ‚Äî DevOps engineer
- **LILITH** ‚Äî AI-–ø–æ–º–æ—â–Ω–∏–∫ (—è!)

---

## üé¨ –ü—Ä–æ–ª–æ–≥: –ë–µ–ª—ã–µ –Ω–æ—á–∏

### –î–µ–Ω—å 17. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥. 03:27 Moscow time.

**–í–∏–∫—Ç–æ—Ä** (–≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫, —Ç—Ä–µ–≤–æ–≥–∞ –≤ –≥–æ–ª–æ—Å–µ):
*"–ú–∞–∫—Å, —É –Ω–∞—Å –ø—Ä–æ–±–ª–µ–º–∞. –°–µ—Ä—å—ë–∑–Ω–∞—è. –û–¥–∏–Ω –∏–∑ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω."*

**–ê–Ω–Ω–∞** (screen share ‚Äî forensics report):
*"Backdoor. `/usr/sbin/sshd_backup` ‚Äî —Ñ–µ–π–∫–æ–≤—ã–π sshd –ø—Ä–æ—Ü–µ—Å—Å. –ö—Ä—ã–ª–æ–≤ –ø—Ä–æ–Ω–∏–∫ —á–µ—Ä–µ–∑ —É—á—ë—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å sudo –ø—Ä–∞–≤–∞–º–∏. –ü—Ä–æ–≤–µ—Ä—å `/etc/passwd` ‚Äî —Ç–∞–º —É—á—ë—Ç–∫–∞ `devops` —Å UID 0. ROOT ACCESS."*

**–ú–∞–∫—Å:** *"–ö–∞–∫ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ?!"*

**–ê–ª–µ–∫—Å:** *"Permissions. –ö—Ç–æ-—Ç–æ –¥–∞–ª sudo –∫–æ–º—É –Ω–µ —Å–ª–µ–¥—É–µ—Ç. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞. –ï–¥—å –≤ –°–ü–± ‚Äî —Ç–∞–º –µ—Å—Ç—å —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—É—á–∏—Ç —Ç–µ–±—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—é."*

---

### 02:00. –í–∞—Å–∏–ª—å–µ–≤—Å–∫–∏–π –æ—Å—Ç—Ä–æ–≤. –õ–≠–¢–ò.

–ë–µ–ª—ã–µ –Ω–æ—á–∏. –ù–∞ —É–ª–∏—Ü–µ —Å–≤–µ—Ç–ª–æ, —Ö–æ—Ç—è 2 —á–∞—Å–∞ –Ω–æ—á–∏. –ú–∞–∫—Å –∏–¥—ë—Ç –ø–æ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π –ù–µ–≤—ã, –º–∏–º–æ –†–æ—Å—Ç—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–Ω, –∫ —Å—Ç–∞—Ä–æ–º—É –∑–¥–∞–Ω–∏—é –õ–≠–¢–ò. –í—Å—Ç—Ä–µ—á–∞ —Å **–ê–Ω–¥—Ä–µ–µ–º –í–æ–ª–∫–æ–≤—ã–º** –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ Unix.

**–ê–Ω–¥—Ä–µ–π** (—Å–µ–¥—ã–µ –≤–æ–ª–æ—Å—ã, –æ—á–∫–∏, —Ç–≤–∏–¥–æ–≤—ã–π –ø–∏–¥–∂–∞–∫, —á–∞–π –≤ —Å—Ç–µ–∫–ª—è–Ω–Ω–æ–º —Å—Ç–∞–∫–∞–Ω–µ):
*"–ú–∞–∫—Å–∏–º. –í–∏–∫—Ç–æ—Ä —Ä–∞—Å—Å–∫–∞–∑–∞–ª –æ –ø—Ä–æ–±–ª–µ–º–µ. Permissions ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–º–∞–Ω–¥—ã. –≠—Ç–æ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è. Principle of least privilege ‚Äî —Å–ª—ã—à–∞–ª?"*

**–ú–∞–∫—Å:** *"–ù–µ—Ç..."*

**–ê–Ω–¥—Ä–µ–π:**
*"–î–∞–≤–∞–π –ø–æ –ø–æ—Ä—è–¥–∫—É. Root access –∫–∞–∫ –∑–∞—Ä—è–∂–µ–Ω–Ω—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç. –ù–µ –¥–∞–≤–∞–π –µ–≥–æ –∫–æ–º—É –ø–æ–ø–∞–ª–æ. –≠—Ç–æ —è —Å—Ç—É–¥–µ–Ω—Ç–∞–º 20 –ª–µ—Ç –≥–æ–≤–æ—Ä—é. –ù–æ –∫–∞–∂–¥—ã–π –≥–æ–¥ –∫—Ç–æ-—Ç–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –¥–∞—ë—Ç. –ò –∫–∞–∂–¥—ã–π –≥–æ–¥ –≤–∑–ª–∞–º—ã–≤–∞—é—Ç."*

**–í–∏–∫—Ç–æ—Ä** (–∑–≤–æ–Ω–æ–∫):
*"–ú–∞–∫—Å, –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å 5 —á–µ–ª–æ–≤–µ–∫: —è, —Ç—ã, –ê–ª–µ–∫—Å, –ê–Ω–Ω–∞, –î–º–∏—Ç—Ä–∏–π. –ö–∞–∂–¥–æ–º—É –Ω—É–∂–µ–Ω —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞. –ê–ª–µ–∫—Å ‚Äî —Ç–æ–ª—å–∫–æ network –∫–æ–º–∞–Ω–¥—ã. –ê–Ω–Ω–∞ ‚Äî —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤. –î–º–∏—Ç—Ä–∏–π ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏. –ù–∞—Å—Ç—Ä–æ–π —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ."*

**–ê–Ω–¥—Ä–µ–π:**
*"–•–æ—Ä–æ—à–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ. –ù–∞—á–Ω—ë–º —Å –æ—Å–Ω–æ–≤. –ü–æ—Ç–æ–º sudo. –ü–æ—Ç–æ–º ACL. –ö —É—Ç—Ä—É —Å–ø—Ä–∞–≤–∏—à—å—Å—è. –ë–ª–∞–≥–æ —É—Ç—Ä–æ –Ω–∞—Å—Ç—É–ø–∏—Ç –Ω–µ —Å–∫–æ—Ä–æ."* (—É–ª—ã–±–∞–µ—Ç—Å—è ‚Äî –±–µ–ª—ã–µ –Ω–æ—á–∏)

---

## üéØ –¢–≤–æ—è –º–∏—Å—Å–∏—è

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å **–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø** –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

**–¶–µ–ª—å:**
–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≥—Ä—É–ø–ø—ã, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å permissions, sudo –∏ ACL —Ç–∞–∫, —á—Ç–æ–±—ã:
- ‚úÖ –ö–∞–∂–¥—ã–π –∏–º–µ–µ—Ç **—Ç–æ–ª—å–∫–æ —Ç–µ –ø—Ä–∞–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã**
- ‚úÖ –ê–ª–µ–∫—Å –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å network –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ sudo (–Ω–æ –ù–ï –≤—Å—ë)
- ‚úÖ –ê–Ω–Ω–∞ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –ª–æ–≥–∏, –Ω–æ –ù–ï –∏–∑–º–µ–Ω—è—Ç—å
- ‚úÖ Shared –ø–∞–ø–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–π –∫–æ–º–∞–Ω–¥–µ
- ‚úÖ –ö—Ä—ã–ª–æ–≤ –±–æ–ª—å—à–µ –Ω–µ —Å–º–æ–∂–µ—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å misconfigured permissions

**–ò—Ç–æ–≥:** Security audit report –¥–ª—è –í–∏–∫—Ç–æ—Ä–∞.

---

## üìö –°—Ç—Ä—É–∫—Ç—É—Ä–∞ episode (micro-cycles)

```
–¶–∏–∫–ª 1: –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞           (10 –º–∏–Ω)  üéì
–¶–∏–∫–ª 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –≥—Ä—É–ø–ø—ã            (15 –º–∏–Ω)  üë•
–¶–∏–∫–ª 3: Permissions –∏ special bits       (20 –º–∏–Ω)  üîí
–¶–∏–∫–ª 4: Sudo –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è                (20 –º–∏–Ω)  üõ°Ô∏è
–¶–∏–∫–ª 5: ACL (Access Control Lists)       (15 –º–∏–Ω)  üìã
–¶–∏–∫–ª 6: Resource limits + PAM            (20 –º–∏–Ω)  ‚öôÔ∏è
–¶–∏–∫–ª 7: Security audit (SUID/SGID)       (20 –º–∏–Ω)  üîç
–¶–∏–∫–ª 8: –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç                  (10 –º–∏–Ω)  üìä
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò—Ç–æ–≥–æ: ~130 –º–∏–Ω—É—Ç (2 —á–∞—Å–∞ —Ç–µ–æ—Ä–∏–∏ + 2 —á–∞—Å–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏)
```

---

## üîÑ –¶–ò–ö–õ 1: –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (10 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–¥—Ä–µ–π** (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –¥–æ—Å–∫—É —Å –¥–∏–∞–≥—Ä–∞–º–º–æ–π Unix permissions):
*"–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –Ω–∞—á–∞—Ç—å, –æ—Ç–≤–µ—Ç—å: –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞?"*

**–ú–∞–∫—Å:** *"–ß—Ç–æ–±—ã... –∑–∞—â–∏—Ç–∏—Ç—å —Ñ–∞–π–ª—ã?"*

**–ê–Ω–¥—Ä–µ–π:**
*"–ë–ª–∏–∂–µ. –ß—Ç–æ–±—ã **–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å, –∫—Ç–æ —á—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å**. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Unix. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É –ö—Ä—ã–ª–æ–≤–∞ –≥–ª–∞–∑–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞."*

*(–ê–Ω–¥—Ä–µ–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç forensics report –æ—Ç –ê–Ω–Ω—ã)*

```
FORENSICS REPORT:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Backdoor user: devops
UID: 0 (root!)
Created: 2025-10-09 14:23:17
Sudo access: ALL=(ALL:ALL) ALL (–ø–æ–ª–Ω—ã–π!)
Last login: 2025-10-10 03:15:42 from 185.192.45.118 (–ö—Ä—ã–ª–æ–≤)
```

**–ê–Ω–¥—Ä–µ–π:**
*"–í–∏–¥–∏—à—å –ø—Ä–æ–±–ª–µ–º—É? –ö—Ç–æ-—Ç–æ —Å–æ–∑–¥–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å UID 0 ‚Äî —ç—Ç–æ –∫–∞–∫ –¥–∞—Ç—å –ö—Ä—ã–ª–æ–≤—É master key –æ—Ç –∑–¥–∞–Ω–∏—è. –ü–ª—é—Å –ø–æ–ª–Ω—ã–π sudo ‚Äî –æ–Ω –º–æ–≥ –¥–µ–ª–∞—Ç—å –í–°–Å. –í–æ–ø—Ä–æ—Å: –∫–∞–∫ —ç—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å?"*

**–ú–∞–∫—Å:** *"–ù–µ –¥–∞–≤–∞—Ç—å UID 0?"*

**–ê–Ω–¥—Ä–µ–π:**
*"–ü—Ä–∞–≤–∏–ª—å–Ω–æ. –ù–æ —ç—Ç–æ–≥–æ –º–∞–ª–æ. –ù—É–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–∞. –¢—Ä–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è."*

---

### üìö –¢–µ–æ—Ä–∏—è: –¢—Ä–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### üí° –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Linux Permissions = –ù–æ—á–Ω–æ–π –∫–ª—É–±

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —á—Ç–æ Linux ‚Äî —ç—Ç–æ **–Ω–æ—á–Ω–æ–π –∫–ª—É–±** —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–æ–Ω–∞–º–∏.

```
üè¢ –ù–û–ß–ù–û–ô –ö–õ–£–ë "LINUX"
‚îÇ
‚îú‚îÄ üö™ –í—Ö–æ–¥ (root –∑–æ–Ω–∞)
‚îÇ  –í–ª–∞–¥–µ–ª–µ—Ü –∫–ª—É–±–∞ (root) ‚Äî –º–æ–∂–µ—Ç –í–°–Å
‚îÇ
‚îú‚îÄ üéµ VIP –∑–æ–Ω–∞ (sudo –≥—Ä—É–ø–ø–∞)
‚îÇ  VIP –±—Ä–∞—Å–ª–µ—Ç (sudo) ‚Äî –¥–æ—Å—Ç—É–ø –∫ —Å–ø–µ—Ü–∑–æ–Ω–∞–º
‚îÇ
‚îú‚îÄ üçª –û–±—â–∏–π –∑–∞–ª (–æ–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
‚îÇ  –ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–ø—É—Å–∫ ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
‚îÇ
‚îî‚îÄ üö´ –°–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–º–µ—â–µ–Ω–∏—è (system files)
   –¢–æ–ª—å–∫–æ –ø–µ—Ä—Å–æ–Ω–∞–ª (root, service accounts)
```

**–†–æ–ª–∏:**
- **root** = –≤–ª–∞–¥–µ–ª–µ—Ü –∫–ª—É–±–∞ (–º–æ–∂–µ—Ç –≤—Å—ë: –æ—Ç–∫—Ä—ã—Ç—å –ª—é–±—É—é –¥–≤–µ—Ä—å, –≤—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É, –≤—ã–≥–Ω–∞—Ç—å –≥–æ—Å—Ç–µ–π)
- **alex** = –æ—Ö—Ä–∞–Ω–Ω–∏–∫ –Ω–∞ –≤—Ö–æ–¥–µ (–º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∞, –Ω–æ –Ω–µ —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–ª—É–±–æ–º)
- **anna** = –¥–µ—Ç–µ–∫—Ç–∏–≤ (–º–æ–∂–µ—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –∏ –Ω–∞–±–ª—é–¥–∞—Ç—å, –Ω–æ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å)
- **–æ–±—ã—á–Ω—ã–π —é–∑–µ—Ä** = –≥–æ—Å—Ç—å (–º–æ–∂–µ—Ç —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å –≤ –æ–±—â–µ–º –∑–∞–ª–µ, –Ω–æ –Ω–µ –ª–µ–∑—Ç—å –≤ VIP)

**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
- `rwx` = –ø—Ä–æ–ø—É—Å–∫ —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ (read, write, execute)
- `sudo` = temporary VIP –±—Ä–∞—Å–ª–µ—Ç –Ω–∞ –æ–¥–Ω—É –Ω–æ—á—å
- `SUID` = permanent VIP –±—Ä–∞—Å–ª–µ—Ç (–≤—Å–µ–≥–¥–∞ VIP, –¥–∞–∂–µ –µ—Å–ª–∏ –≥–æ—Å—Ç—å)

**–ü—Ä–æ–±–ª–µ–º–∞ –ö—Ä—ã–ª–æ–≤–∞:**
```
–ö—Ä—ã–ª–æ–≤ –ø–æ–ª—É—á–∏–ª PERMANENT VIP –±—Ä–∞—Å–ª–µ—Ç (UID 0)
+ Master key –æ—Ç –≤—Å–µ—Ö –¥–≤–µ—Ä–µ–π (sudo ALL)
= –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–ª—É–±–æ–º
```

---

#### üõ°Ô∏è –ü—Ä–∏–Ω—Ü–∏–ø 1: Principle of Least Privilege

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
*–ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ** –ø—Ä–∞–≤–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã. –ù–µ –±–æ–ª—å—à–µ.*

**–ü—Ä–∏–º–µ—Ä –∏–∑ –∫–ª—É–±–∞:**
```
‚ùå –ü–õ–û–•–û:
–û—Ö—Ä–∞–Ω–Ω–∏–∫ (alex) –ø–æ–ª—É—á–∞–µ—Ç master key –æ—Ç –≤—Å–µ—Ö –¥–≤–µ—Ä–µ–π
‚Üí –ú–æ–∂–µ—Ç –∑–∞–π—Ç–∏ –≤ VIP, –≤ —Å–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–º–µ—â–µ–Ω–∏—è, –≤ –æ—Ñ–∏—Å –≤–ª–∞–¥–µ–ª—å—Ü–∞
‚Üí –ï—Å–ª–∏ –ö—Ä—ã–ª–æ–≤ –ø–æ–¥–∫—É–ø–∏—Ç –æ—Ö—Ä–∞–Ω–Ω–∏–∫–∞ ‚Äî –≤—Å—ë —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–æ

‚úÖ –•–û–†–û–®–û:
–û—Ö—Ä–∞–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –∫–ª—é—á –¢–û–õ–¨–ö–û –æ—Ç –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏ + —Ä–∞—Ü–∏—è
‚Üí –ú–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∞ –∏ –≤—ã–∑–≤–∞—Ç—å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ
‚Üí –ï—Å–ª–∏ –ö—Ä—ã–ª–æ–≤ –ø–æ–¥–∫—É–ø–∏—Ç ‚Äî –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –≤—Ö–æ–¥—É, –Ω–µ –∫ VIP –∑–æ–Ω–∞–º
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –ê–ª–µ–∫—Å—É:**
```bash
# ‚ùå –ü–õ–û–•–û (–ø–æ–ª–Ω—ã–π sudo):
alex ALL=(ALL:ALL) ALL

# ‚úÖ –•–û–†–û–®–û (—Ç–æ–ª—å–∫–æ network –∫–æ–º–∞–Ω–¥—ã):
alex ALL=(root) NOPASSWD: /usr/sbin/ip, /usr/bin/ss, /usr/sbin/tcpdump
```

---

#### üéØ –ü—Ä–∏–Ω—Ü–∏–ø 2: Defense in Depth

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
*–ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞. –ï—Å–ª–∏ –æ–¥–∏–Ω —Å–ª–æ–π –ø—Ä–æ–±–∏—Ç ‚Äî –µ—Å—Ç—å –≤—Ç–æ—Ä–æ–π, —Ç—Ä–µ—Ç–∏–π, —á–µ—Ç–≤—ë—Ä—Ç—ã–π.*

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ó–∞–º–æ–∫ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–µ–Ω–∞–º–∏**
```
üè∞ –°–†–ï–î–ù–ï–í–ï–ö–û–í–´–ô –ó–ê–ú–û–ö

1-—è —Å—Ç–µ–Ω–∞: —Ä–æ–≤ —Å –≤–æ–¥–æ–π (password)
2-—è —Å—Ç–µ–Ω–∞: –≤—ã—Å–æ–∫–∞—è —Å—Ç–µ–Ω–∞ (permissions)
3-—è —Å—Ç–µ–Ω–∞: –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–æ—Ä–æ—Ç–∞ (sudo rules)
4-—è —Å—Ç–µ–Ω–∞: –±–∞—à–Ω—è (ACL)
5-—è —Å—Ç–µ–Ω–∞: —Å–µ–π—Ñ (encryption)

–ê—Ç–∞–∫—É—é—â–∏–π –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–±–∏—Ç—å –í–°–ï —Å–ª–æ–∏!
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ Episode 09:**
```
–°–ª–æ–π 1: Permissions (chmod, chown)
         ‚îî‚îÄ –ê–ª–µ–∫—Å –Ω–µ –≤–ª–∞–¥–µ–ª–µ—Ü /etc/passwd ‚Üí –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å

–°–ª–æ–π 2: Sudo configuration
         ‚îî‚îÄ –ê–ª–µ–∫—Å –º–æ–∂–µ—Ç –¢–û–õ–¨–ö–û network –∫–æ–º–∞–Ω–¥—ã

–°–ª–æ–π 3: ACL (Access Control Lists)
         ‚îî‚îÄ –ê–Ω–Ω–∞ –º–æ–∂–µ—Ç –¢–û–õ–¨–ö–û —á–∏—Ç–∞—Ç—å –ª–æ–≥–∏, –Ω–µ –ø–∏—Å–∞—Ç—å

–°–ª–æ–π 4: Resource limits (limits.conf)
         ‚îî‚îÄ –ó–∞—â–∏—Ç–∞ –æ—Ç fork bomb (DoS –∏–∑–Ω—É—Ç—Ä–∏)

–°–ª–æ–π 5: Audit logs (/var/log/auth.log)
         ‚îî‚îÄ –í—Å–µ sudo –∫–æ–º–∞–Ω–¥—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
```

**Aha! –º–æ–º–µ–Ω—Ç:**
```
–ö—Ä—ã–ª–æ–≤ –ø—Ä–æ–±–∏–ª –°–ª–æ–π 1 (–ø–æ–ª—É—á–∏–ª backdoor –∞–∫–∫–∞—É–Ω—Ç)
–ù–û: –µ—Å–ª–∏ –±—ã –±—ã–ª–∏ –°–ª–æ–∏ 2-5 ‚Üí –æ–Ω –±—ã –∑–∞—Å—Ç—Ä—è–ª!
```

---

#### üîÄ –ü—Ä–∏–Ω—Ü–∏–ø 3: Separation of Duties

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
*–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–µ–ª–æ–≤–µ–∫. –û–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å.*

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –Ø–¥–µ—Ä–Ω–∞—è –∫–Ω–æ–ø–∫–∞**
```
üöÄ –ó–ê–ü–£–°–ö –Ø–î–ï–†–ù–û–ô –†–ê–ö–ï–¢–´

‚ùå –ü–õ–û–•–û:
–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ‚Üí —Ä–∞–∫–µ—Ç–∞ –ª–µ—Ç–∏—Ç
(–û–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –º–∏—Ä)

‚úÖ –•–û–†–û–®–û:
1. –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –¥–∞—ë—Ç –∫–æ–º–∞–Ω–¥—É
2. –ú–∏–Ω–∏—Å—Ç—Ä –æ–±–æ—Ä–æ–Ω—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç
3. –ì–µ–Ω–µ—Ä–∞–ª –≤–≤–æ–¥–∏—Ç –∫–æ–¥ 1
4. –ü–æ–ª–∫–æ–≤–Ω–∏–∫ –≤–≤–æ–¥–∏—Ç –∫–æ–¥ 2
5. –î–í–ê –∫–ª—é—á–∞ –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –û–î–ù–û–í–†–ï–ú–ï–ù–ù–û
‚Üí –¢–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ —Ä–∞–∫–µ—Ç–∞ –ª–µ—Ç–∏—Ç
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–∞–Ω–¥–µ:**
```
–ê–ª–µ–∫—Å (network –∞–¥–º–∏–Ω):
  ‚úÖ –ú–æ–∂–µ—Ç: –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç—å, firewall
  ‚ùå –ù–µ –º–æ–∂–µ—Ç: —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –º–µ–Ω—è—Ç—å sudo

–ê–Ω–Ω–∞ (forensics):
  ‚úÖ –ú–æ–∂–µ—Ç: —á–∏—Ç–∞—Ç—å –≤—Å–µ –ª–æ–≥–∏
  ‚ùå –ù–µ –º–æ–∂–µ—Ç: —É–¥–∞–ª—è—Ç—å –ª–æ–≥–∏, –∏–∑–º–µ–Ω—è—Ç—å —Ñ–∞–π–ª—ã

–î–º–∏—Ç—Ä–∏–π (DevOps):
  ‚úÖ –ú–æ–∂–µ—Ç: —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Ä–≤–∏—Å–∞–º–∏ (restart nginx)
  ‚ùå –ù–µ –º–æ–∂–µ—Ç: –º–µ–Ω—è—Ç—å network –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–í–∏–∫—Ç–æ—Ä (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä):
  ‚úÖ –ú–æ–∂–µ—Ç: —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞–∑–Ω–∞—á–∞—Ç—å —Ä–æ–ª–∏
  ‚ùå –ù–µ –º–æ–∂–µ—Ç: –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ production —Å–µ—Ä–≤–µ—Ä–∞–º (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ sudo)
```

**–ó–∞—á–µ–º:**
- –ï—Å–ª–∏ –ö—Ä—ã–ª–æ–≤ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç –ê–ª–µ–∫—Å–∞ ‚Üí –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ network
- –ï—Å–ª–∏ –ö—Ä—ã–ª–æ–≤ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç –ê–Ω–Ω—É ‚Üí –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç—å, –Ω–µ –ø–∏—Å–∞—Ç—å
- –ï—Å–ª–∏ –ö—Ä—ã–ª–æ–≤ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç –î–º–∏—Ç—Ä–∏—è ‚Üí –º–æ–∂–µ—Ç restart —Å–µ—Ä–≤–∏—Å—ã, –Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏

**Aha! –º–æ–º–µ–Ω—Ç:**
```
–û–¥–Ω–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —É—á—ë—Ç–∫–∞ ‚â† –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ê–Ω–∞–ª–∏–∑ backdoor

**–ó–∞–¥–∞–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –ù–∞–π–¥–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—á—ë—Ç–∫–∏.

```bash
# –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å shell –¥–æ—Å—Ç—É–ø–æ–º
grep -E '/bin/(bash|sh)$' /etc/passwd

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å UID 0 (–∫—Ä–æ–º–µ root)
awk -F: '$3 == 0 && $1 != "root" {print $1}' /etc/passwd

# –ü—Ä–æ–≤–µ—Ä–∫–∞ sudo –ø—Ä–∞–≤
sudo cat /etc/sudoers
sudo ls -la /etc/sudoers.d/
```

**–ß—Ç–æ —Ç—ã –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏:**
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å UID 0 (–∫—Ä–æ–º–µ root) ‚Äî **BACKDOOR!**
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å `ALL=(ALL:ALL) ALL` –≤ sudoers ‚Äî **–ü–û–õ–ù–´–ô –î–û–°–¢–£–ü!**
- ‚ùå –ü—É—Å—Ç–æ–π –ø–∞—Ä–æ–ª—å –∏–ª–∏ weak password ‚Äî **–£–Ø–ó–í–ò–ú–û–°–¢–¨!**

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"–û–±—ä—è—Å–Ω–∏ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏: –ø–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –¥–∞–≤–∞—Ç—å –≤—Å–µ–º sudo?"*

<details>
<summary>üí≠ –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π (30 —Å–µ–∫—É–Ω–¥)</summary>

**–û—Ç–≤–µ—Ç:**

sudo = temporary root access. –ï—Å–ª–∏ –≤—Å–µ –∏–º–µ—é—Ç sudo ‚Üí –≤—Å–µ –º–æ–≥—É—Ç:
- –°–æ–∑–¥–∞–≤–∞—Ç—å backdoor –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£–¥–∞–ª—è—Ç—å critical —Ñ–∞–π–ª—ã
- –ò–∑–º–µ–Ω—è—Ç—å system –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ß–∏—Ç–∞—Ç—å —á—É–∂–∏–µ —Ñ–∞–π–ª—ã
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å rootkits

**Principle of Least Privilege:** –¥–∞–≤–∞–π —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã.

**–ü—Ä–∏–º–µ—Ä:**
–ê–ª–µ–∫—Å—É –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å network ‚Üí –¥–∞–π sudo –¢–û–õ–¨–ö–û –¥–ª—è network –∫–æ–º–∞–Ω–¥ (ip, iptables)
–ù–ï –¥–∞–≤–∞–π sudo –¥–ª—è ALL ‚Üí –æ–Ω –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å backdoor –∏–ª–∏ —É–∫—Ä–∞—Å—Ç—å sensitive data

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞:**
–ù–µ –¥–∞–≤–∞–π –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á –æ—Ç –∑–¥–∞–Ω–∏—è –≤—Å–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º. –î–∞–π –∫–∞–∂–¥–æ–º—É –∫–ª—é—á –æ—Ç –µ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞.

</details>

---

**–ê–Ω–¥—Ä–µ–π:**
*"–•–æ—Ä–æ—à–æ. –¢–µ–ø–µ—Ä—å —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å –ó–ê–ß–ï–ú –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ permissions. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º –ö–ê–ö —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å."*

---

## üîÑ –¶–ò–ö–õ 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –≥—Ä—É–ø–ø—ã (15 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–¥—Ä–µ–π** (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª):
*"–ü–µ—Ä–≤—ã–π —à–∞–≥ ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–æ–º–∞–Ω–¥—ã. –í–∏–∫—Ç–æ—Ä —Å–∫–∞–∑–∞–ª 5 —á–µ–ª–æ–≤–µ–∫: Viktor, Alex, Anna, Dmitry –∏ —Ç—ã."*

**–ú–∞–∫—Å:** *"useradd?"*

**–ê–Ω–¥—Ä–µ–π:**
*"–ü—Ä–∞–≤–∏–ª—å–Ω–æ. –ù–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ useradd. –ù—É–∂–Ω–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è. –ì—Ä—É–ø–ø—ã."*

*(–†–∏—Å—É–µ—Ç –Ω–∞ –¥–æ—Å–∫–µ)*

```
         üè¢ KERNEL SHADOWS OPERATION
                     ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ            ‚îÇ            ‚îÇ
   üî∑ operations  üî∑ security  üî∑ devops
    (–æ–±—â–∞—è)     (–∑–∞—â–∏—Ç–∞)    (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)
        ‚îÇ            ‚îÇ            ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ
Viktor  Dmitry Alex  Anna     Dmitry
```

**–ê–Ω–¥—Ä–µ–π:**
*"–ì—Ä—É–ø–ø—ã ‚Äî —ç—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è. –ù–µ –¥–∞–≤–∞–π permissions –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –ò—Å–ø–æ–ª—å–∑—É–π –≥—Ä—É–ø–ø—ã. –ü—Ä–æ—â–µ —É–ø—Ä–∞–≤–ª—è—Ç—å, –ø—Ä–æ—â–µ –∞—É–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å."*

---

### üìö –¢–µ–æ—Ä–∏—è: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ Linux

#### –§–∞–π–ª—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è

Linux —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö:

**1. `/etc/passwd` ‚Äî database –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
```
username:x:UID:GID:comment:home:shell
```

–ü—Ä–∏–º–µ—Ä:
```
max:x:1000:1000:Max Sokolov:/home/max:/bin/bash
‚îÇ   ‚îÇ  ‚îÇ    ‚îÇ    ‚îÇ            ‚îÇ          ‚îî‚îÄ Shell
‚îÇ   ‚îÇ  ‚îÇ    ‚îÇ    ‚îÇ            ‚îî‚îÄ Home directory
‚îÇ   ‚îÇ  ‚îÇ    ‚îÇ    ‚îî‚îÄ Comment (GECOS)
‚îÇ   ‚îÇ  ‚îÇ    ‚îî‚îÄ Primary GID
‚îÇ   ‚îÇ  ‚îî‚îÄ UID (User ID)
‚îÇ   ‚îî‚îÄ Password (x = –≤ /etc/shadow)
‚îî‚îÄ Username
```

**–í–∞–∂–Ω—ã–µ UID:**
- `0` = root (superuser)
- `1-999` = system users (daemon, www-data, etc.)
- `1000+` = regular users

**2. `/etc/shadow` ‚Äî –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏**
```
username:encrypted_password:last_change:min:max:warn:inactive:expire
```

–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `600` (—Ç–æ–ª—å–∫–æ root –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å!)

**–ü–æ—á–µ–º—É –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª?**
```
/etc/passwd ‚Üí readable by ALL (–Ω—É–∂–Ω–æ –¥–ª—è ls -l, ps, etc.)
/etc/shadow ‚Üí readable ONLY by root (–ø–∞—Ä–æ–ª–∏ –∑–∞—â–∏—â–µ–Ω—ã)
```

**3. `/etc/group` ‚Äî –≥—Ä—É–ø–ø—ã**
```
groupname:x:GID:members
```

–ü—Ä–∏–º–µ—Ä:
```
operations:x:1001:viktor,dmitry
```

---

### üí° –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ì—Ä—É–ø–ø—ã = –û—Ç–¥–µ–ª—ã –∫–æ–º–ø–∞–Ω–∏–∏

```
üè¢ –ö–û–ú–ü–ê–ù–ò–Ø "KERNEL SHADOWS"

‚îå‚îÄ üìã –û—Ç–¥–µ–ª "operations" (–æ–±—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
‚îÇ   ‚îú‚îÄ Viktor (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä)
‚îÇ   ‚îî‚îÄ Dmitry (DevOps)
‚îÇ
‚îú‚îÄ üõ°Ô∏è –û—Ç–¥–µ–ª "security" (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
‚îÇ   ‚îú‚îÄ Alex (network –∞–¥–º–∏–Ω)
‚îÇ   ‚îî‚îÄ Anna (forensics)
‚îÇ
‚îú‚îÄ üîç –û—Ç–¥–µ–ª "forensics" (—Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è)
‚îÇ   ‚îî‚îÄ Anna (—Ç–æ–ª—å–∫–æ –æ–Ω–∞)
‚îÇ
‚îú‚îÄ ‚öôÔ∏è –û—Ç–¥–µ–ª "devops" (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)
‚îÇ   ‚îî‚îÄ Dmitry (—Ç–æ–ª—å–∫–æ –æ–Ω)
‚îÇ
‚îî‚îÄ üåê –û—Ç–¥–µ–ª "netadmin" (—Å–µ—Ç—å)
    ‚îî‚îÄ Alex (—Ç–æ–ª—å–∫–æ –æ–Ω)
```

**–ó–∞—á–µ–º –Ω—É–∂–Ω—ã –≥—Ä—É–ø–ø—ã?**

**‚ùå –ë–ï–ó –≥—Ä—É–ø–ø:**
```bash
# –î–∞—Ç—å Viktor –¥–æ—Å—Ç—É–ø –∫ shared directory
chmod 770 /var/operations/shared
chown viktor /var/operations/shared

# –î–∞—Ç—å Dmitry –¥–æ—Å—Ç—É–ø –∫ shared directory
??? (Viktor —É–∂–µ –≤–ª–∞–¥–µ–ª–µ—Ü, –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å Dmitry?)

# –î–∞—Ç—å Max –¥–æ—Å—Ç—É–ø
??? (–Ω–µ–ª—å–∑—è –∏–º–µ—Ç—å 3 –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤!)
```

**‚úÖ –° –ì–†–£–ü–ü–ê–ú–ò:**
```bash
# –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
groupadd operations

# –î–æ–±–∞–≤–∏—Ç—å Viktor –∏ Dmitry
usermod -aG operations viktor
usermod -aG operations dmitry

# –î–∞—Ç—å –¥–æ—Å—Ç—É–ø –ì–†–£–ü–ü–ï
chown viktor:operations /var/operations/shared
chmod 770 /var/operations/shared

# –¢–µ–ø–µ—Ä—å Viktor –∏ Dmitry –æ–±–∞ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø!
# –î–æ–±–∞–≤–∏—Ç—å Max? usermod -aG operations max ‚Äî –≥–æ—Ç–æ–≤–æ!
```

---

### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (–ë–ï–ó home, –ë–ï–ó shell)
sudo useradd username

# –ü–æ–ª–Ω—ã–π (–° home directory –∏ bash shell)
sudo useradd -m -s /bin/bash username

# –° –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
sudo useradd -m -s /bin/bash -c "Max Sokolov" max
```

**–§–ª–∞–≥–∏:**
- `-m` ‚Äî —Å–æ–∑–¥–∞—Ç—å home directory (`/home/username`)
- `-s /bin/bash` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å shell (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `/bin/sh`)
- `-c "comment"` ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–ø–æ–ª–Ω–æ–µ –∏–º—è)
- `-G group1,group2` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—ã —Å—Ä–∞–∑—É

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–æ–ª—è

```bash
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ (–∑–∞–ø—Ä–æ—Å–∏—Ç –ø–∞—Ä–æ–ª—å)
sudo passwd username

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
sudo chage -d 0 username

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª—è (90 –¥–Ω–µ–π)
sudo chage -M 90 username
```

#### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É (-a = append, –ù–ï –∑–∞—Ç–∏—Ä–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ!)
sudo usermod -aG groupname username

# –ò–∑–º–µ–Ω–∏—Ç—å shell
sudo usermod -s /bin/bash username

# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
sudo usermod -L username

# –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
sudo usermod -U username
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π -a (append) —Å -G!**
```bash
# ‚ùå –ü–õ–û–•–û (–∑–∞—Ç—Ä—ë—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≥—Ä—É–ø–ø—ã!)
sudo usermod -G newgroup username

# ‚úÖ –•–û–†–û–®–û (–¥–æ–±–∞–≤–∏—Ç –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –≥—Ä—É–ø–ø–∞–º)
sudo usermod -aG newgroup username
```

#### –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Å—Ç–∞–≤–∏—Ç—å home)
sudo userdel username

# –£–¥–∞–ª–∏—Ç—å —Å home directory
sudo userdel -r username
```

#### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

```bash
# UID, GID, –≥—Ä—É–ø–ø—ã
id username

# –¢–æ–ª—å–∫–æ –≥—Ä—É–ø–ø—ã
groups username

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
finger username

# –ö—Ç–æ –æ–Ω–ª–∞–π–Ω
who

# –ö—Ç–æ —á—Ç–æ –¥–µ–ª–∞–µ—Ç
w

# –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤
last username
```

---

### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø–∞–º–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
sudo groupadd groupname

# –£–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É
sudo groupdel groupname

# –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É
sudo usermod -aG groupname username

# –£–¥–∞–ª–∏—Ç—å –∏–∑ –≥—Ä—É–ø–ø—ã
sudo gpasswd -d username groupname

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä—É–ø–ø–µ
getent group groupname

# –í—Å–µ –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
groups username
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø

**–ó–∞–¥–∞–Ω–∏–µ 1: –°–æ–∑–¥–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**

```bash
# –°–æ–∑–¥–∞—Ç—å 4 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
sudo useradd -m -s /bin/bash -c "Viktor Petrov" viktor
sudo useradd -m -s /bin/bash -c "Alex Sokolov" alex
sudo useradd -m -s /bin/bash -c "Anna Kovaleva" anna
sudo useradd -m -s /bin/bash -c "Dmitry Orlov" dmitry

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
for user in viktor alex anna dmitry; do
    echo "$user:TempPass123!" | sudo chpasswd
    sudo chage -d 0 "$user"  # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
done
```

**–ó–∞–¥–∞–Ω–∏–µ 2: –°–æ–∑–¥–∞–π –≥—Ä—É–ø–ø—ã**

```bash
# –°–æ–∑–¥–∞—Ç—å 5 –≥—Ä—É–ø–ø
sudo groupadd operations
sudo groupadd security
sudo groupadd forensics
sudo groupadd devops
sudo groupadd netadmin
```

**–ó–∞–¥–∞–Ω–∏–µ 3: –î–æ–±–∞–≤—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø—ã**

```bash
# operations (–æ–±—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
sudo usermod -aG operations viktor
sudo usermod -aG operations dmitry

# security (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
sudo usermod -aG security alex
sudo usermod -aG security anna

# forensics (—Ç–æ–ª—å–∫–æ Anna)
sudo usermod -aG forensics anna

# devops (—Ç–æ–ª—å–∫–æ Dmitry)
sudo usermod -aG devops dmitry

# netadmin (—Ç–æ–ª—å–∫–æ Alex)
sudo usermod -aG netadmin alex
```

**–ó–∞–¥–∞–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä—å —á–ª–µ–Ω—Å—Ç–≤–æ**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
for user in viktor alex anna dmitry; do
    echo "$user: $(groups $user)"
done
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
viktor: viktor operations
alex: alex security netadmin
anna: anna security forensics
dmitry: dmitry operations devops
```

---

**–°–æ–≤–µ—Ç –æ—Ç LILITH:**
*"–ú–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ bash. –ù–æ –ø–æ–º–Ω–∏: bash –¥–ª—è –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò, –Ω–µ –¥–ª—è –ó–ê–ú–ï–ù–´ useradd. –ò—Å–ø–æ–ª—å–∑—É–π –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã!"*

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç** (—Å–º–æ—Ç—Ä–∏ `solution/setup_users.sh`):
```bash
#!/bin/bash
users=("viktor" "alex" "anna" "dmitry")
for user in "${users[@]}"; do
    sudo useradd -m -s /bin/bash "$user"
    echo "$user:TempPass123!" | sudo chpasswd
    sudo chage -d 0 "$user"
done
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–ê–Ω–¥—Ä–µ–π:** *"–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω —Ñ–ª–∞–≥ -a –≤ usermod -aG?"*

<details>
<summary>üí≠ –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**

`-a` = append (–¥–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –≥—Ä—É–ø–ø–∞–º)

**–ë–ï–ó -a:**
```bash
# –£ alex —Å–µ–π—á–∞—Å: alex security netadmin
sudo usermod -G operations alex
# –¢–µ–ø–µ—Ä—å —É alex: alex operations
# security –∏ netadmin –£–î–ê–õ–ï–ù–´!
```

**–° -a:**
```bash
# –£ alex —Å–µ–π—á–∞—Å: alex security netadmin
sudo usermod -aG operations alex
# –¢–µ–ø–µ—Ä—å —É alex: alex security netadmin operations
# –î–æ–±–∞–≤–∏–ª–∞—Å—å operations, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å
```

**Aha! –º–æ–º–µ–Ω—Ç:**
usermod -G –∑–∞—Ç–∏—Ä–∞–µ—Ç –≤—Å–µ –≥—Ä—É–ø–ø—ã –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ.
usermod -aG –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º.

**–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π -a!**

</details>

---

**–ê–Ω–¥—Ä–µ–π:**
*"–û—Ç–ª–∏—á–Ω–æ. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã, –≥—Ä—É–ø–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã. –¢–µ–ø–µ—Ä—å —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ ‚Äî permissions."*

---

## üîÑ –¶–ò–ö–õ 3: Permissions –∏ special bits (20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–¥—Ä–µ–π** (—Å–æ–∑–¥–∞—ë—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª):
```bash
touch test.txt
ls -l test.txt
```

```
-rw-r--r-- 1 andrei andrei 0 Oct 11 02:30 test.txt
```

**–ê–Ω–¥—Ä–µ–π:**
*"–ß—Ç–æ —Ç—ã –≤–∏–¥–∏—à—å?"*

**–ú–∞–∫—Å:** *"–ë—É–∫–≤—ã... rw-r--r--?"*

**–ê–Ω–¥—Ä–µ–π:**
*"–≠—Ç–æ permissions. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞. –ö—Ç–æ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å, –ø–∏—Å–∞—Ç—å, –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ–∞–π–ª. –≠—Ç–æ —è–∑—ã–∫ Unix. –ù–∞—É—á–∏—Å—å —á–∏—Ç–∞—Ç—å –µ–≥–æ."*

---

### üìö –¢–µ–æ—Ä–∏—è: Permissions (–ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞)

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ permissions

```
-rwxr-xr-x
‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îî‚îÄ Others: execute
‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îî‚îÄ‚îÄ Others: write
‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îî‚îÄ‚îÄ‚îÄ Others: read
‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îî‚îÄ‚îÄ‚îÄ‚îÄ Group: execute
‚îÇ‚îÇ‚îÇ‚îÇ‚îÇ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Group: write
‚îÇ‚îÇ‚îÇ‚îÇ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Group: read
‚îÇ‚îÇ‚îÇ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ User (owner): execute
‚îÇ‚îÇ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ User: write
‚îÇ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ User: read
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ File type (- = file, d = directory, l = link)
```

#### –¢—Ä–∏ –≥—Ä—É–ø–ø—ã –¥–æ—Å—Ç—É–ø–∞ (UGO)

```
‚îå‚îÄ User (–≤–ª–∞–¥–µ–ª–µ—Ü —Ñ–∞–π–ª–∞)
‚îÇ  ‚îå‚îÄ Group (–≥—Ä—É–ø–ø–∞ —Ñ–∞–π–ª–∞)
‚îÇ  ‚îÇ  ‚îå‚îÄ Others (–≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ)
‚îÇ  ‚îÇ  ‚îÇ
rwxr-xr-x
```

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ü—Ä–æ–ø—É—Å–∫ –≤ –Ω–æ—á–Ω–æ–π –∫–ª—É–±**

```
User (–≤–ª–∞–¥–µ–ª–µ—Ü):   VIP –ø—Ä–æ–ø—É—Å–∫ ‚Äî –º–æ–∂–µ—Ç –≤—Å—ë (rwx)
Group (–≥—Ä—É–ø–ø–∞):    –ì—Ä—É–ø–ø–æ–≤–æ–π –±–∏–ª–µ—Ç ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (r-x)
Others (–æ—Å—Ç–∞–ª—å–Ω—ã–µ): –û–±—ã—á–Ω—ã–π –±–∏–ª–µ—Ç ‚Äî –±–∞–∑–æ–≤—ã–π –¥–æ—Å—Ç—É–ø (r--)
```

#### –¢–∏–ø—ã –ø—Ä–∞–≤

| –ü—Ä–∞–≤–æ | –°–∏–º–≤–æ–ª | –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Ñ–∞–π–ª–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ |
|-------|--------|-------------------|------------------------|
| **read** | `r` (4) | –ß–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ | –õ–∏—Å—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (`ls`) |
| **write** | `w` (2) | –ò–∑–º–µ–Ω—è—Ç—å —Ñ–∞–π–ª | –°–æ–∑–¥–∞–≤–∞—Ç—å/—É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã –≤–Ω—É—Ç—Ä–∏ |
| **execute** | `x` (1) | –í—ã–ø–æ–ª–Ω—è—Ç—å –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º—É | –í—Ö–æ–¥–∏—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (`cd`) |

**Aha! –º–æ–º–µ–Ω—Ç: execute –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π**
```bash
# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ë–ï–ó execute
mkdir test
chmod 644 test    # rw-r--r-- (–Ω–µ—Ç x)
cd test           # ‚ùå –û—à–∏–±–∫–∞: Permission denied

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –° execute
chmod 755 test    # rwxr-xr-x (–µ—Å—Ç—å x)
cd test           # ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω execute –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö?**
–ß—Ç–æ–±—ã "–≤–æ–π—Ç–∏" –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ñ–∞–π–ª–∞–º–∏ –≤–Ω—É—Ç—Ä–∏.

---

#### –í–æ—Å—å–º–µ—Ä–∏—á–Ω–∞—è –∑–∞–ø–∏—Å—å

Permissions –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å —á–∏—Å–ª–∞–º–∏:
- `r` = 4
- `w` = 2
- `x` = 1

–°—É–º–º–∞ = –ø—Ä–∞–≤–∞:

| –í–æ—Å—å–º–µ—Ä–∏—á–Ω–æ–µ | –°–∏–º–≤–æ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|------------|----------|
| `0` | `---` | –ù–µ—Ç –ø—Ä–∞–≤ |
| `1` | `--x` | –¢–æ–ª—å–∫–æ execute |
| `2` | `-w-` | –¢–æ–ª—å–∫–æ write (–±–µ—Å–ø–æ–ª–µ–∑–Ω–æ –±–µ–∑ read) |
| `3` | `-wx` | write + execute |
| `4` | `r--` | –¢–æ–ª—å–∫–æ read |
| `5` | `r-x` | read + execute (—á–∞—â–µ –≤—Å–µ–≥–æ –¥–ª—è directories) |
| `6` | `rw-` | read + write (—á–∞—â–µ –≤—Å–µ–≥–æ –¥–ª—è files) |
| `7` | `rwx` | –í—Å–µ –ø—Ä–∞–≤–∞ |

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
chmod 755 file
# 7 = rwx (user)
# 5 = r-x (group)
# 5 = r-x (others)
# –ò—Ç–æ–≥–æ: rwxr-xr-x

chmod 644 file
# 6 = rw- (user)
# 4 = r-- (group)
# 4 = r-- (others)
# –ò—Ç–æ–≥–æ: rw-r--r--

chmod 600 file
# 6 = rw- (user)
# 0 = --- (group)
# 0 = --- (others)
# –ò—Ç–æ–≥–æ: rw------- (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü)
```

**–¢–∏–ø–∏—á–Ω—ã–µ permissions:**

| –¢–∏–ø —Ñ–∞–π–ª–∞ | Permissions | –í–æ—Å—å–º–µ—Ä–∏—á–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|-------------|--------------|----------|
| **–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Å–∫—Ä–∏–ø—Ç** | `rwxr-xr-x` | `755` | –í—Å–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª** | `rw-r--r--` | `644` | –í–ª–∞–¥–µ–ª–µ—Ü –∏–∑–º–µ–Ω—è–µ—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —á–∏—Ç–∞—é—Ç |
| **–°–µ–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª** | `rw-------` | `600` | –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü |
| **Shared directory** | `rwxrwxr-x` | `775` | Group –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å |
| **–°–∏—Å—Ç–µ–º–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥** | `rw-r-----` | `640` | Group –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å |

---

### –ö–æ–º–∞–Ω–¥—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è permissions

#### chmod ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞

**–ß–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç:**
```bash
chmod 755 file          # rwxr-xr-x
chmod 644 file          # rw-r--r--
chmod 600 file          # rw-------
```

**–°–∏–º–≤–æ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:**
```bash
# –î–æ–±–∞–≤–∏—Ç—å execute –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
chmod u+x file

# –£–±—Ä–∞—Ç—å write –¥–ª—è –≥—Ä—É–ø–ø—ã
chmod g-w file

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å read –¥–ª—è –≤—Å–µ—Ö
chmod a+r file
# (a = all = user + group + others)

# –£–±—Ä–∞—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∞ –¥–ª—è others
chmod o= file
```

**–†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
```bash
chmod -R 755 directory
```

#### chown ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞

```bash
# –ò–∑–º–µ–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞
sudo chown user file

# –ò–∑–º–µ–Ω–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏ –≥—Ä—É–ø–ø—É
sudo chown user:group file

# –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ
sudo chown -R user:group directory
```

#### chgrp ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å –≥—Ä—É–ø–ø—É

```bash
sudo chgrp group file
sudo chgrp -R group directory
```

---

### üí° Special Bits (—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–∏—Ç—ã)

–ü–æ–º–∏–º–æ rwx, –µ—Å—Ç—å 3 —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –±–∏—Ç–∞:
- SUID (Set User ID) ‚Äî bit 4000
- SGID (Set Group ID) ‚Äî bit 2000
- Sticky Bit ‚Äî bit 1000

#### SUID (Set User ID) ‚Äî bit 4000

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–§–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ **–≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–∞**, –∞ –Ω–µ —Ç–æ–≥–æ –∫—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª.

**–ü—Ä–∏–º–µ—Ä:**
```bash
ls -l /usr/bin/passwd
# -rwsr-xr-x root root ... /usr/bin/passwd
#    ^
#    s = SUID (–≤–º–µ—Å—Ç–æ x)
```

**–ó–∞—á–µ–º:**
`passwd` –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω—è—Ç—å `/etc/shadow` (owner = root, –ø—Ä–∞–≤–∞ 600).
–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –≤ `/etc/shadow`.
–ù–û: –µ—Å–ª–∏ `passwd` –∏–º–µ–µ—Ç SUID ‚Üí –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ root ‚Üí –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å `/etc/shadow`.

```
User –∑–∞–ø—É—Å–∫–∞–µ—Ç:  passwd
–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫:  root (–∏–∑-–∑–∞ SUID)
–ú–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å:  /etc/shadow ‚úÖ
```

**‚ö†Ô∏è –û–ü–ê–°–ù–û–°–¢–¨:**
–ï—Å–ª–∏ SUID —Ñ–∞–π–ª –∏–º–µ–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å ‚Üí privilege escalation –∫ root!

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ SUID:**
```bash
chmod 4755 file     # –∏–ª–∏ chmod u+s file
```

---

#### SGID (Set Group ID) ‚Äî bit 2000

**–î–ª—è —Ñ–∞–π–ª–æ–≤:**
–§–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ **–≥—Ä—É–ø–ø—ã** –≤–ª–∞–¥–µ–ª—å—Ü–∞.

**–î–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (—á–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):**
–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞—Å–ª–µ–¥—É—é—Ç **–≥—Ä—É–ø–ø—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏**, –∞ –Ω–µ primary group —Å–æ–∑–¥–∞—Ç–µ–ª—è.

**–ü—Ä–∏–º–µ—Ä:**
```bash
mkdir shared
chmod 2775 shared      # –∏–ª–∏ chmod g+s shared
ls -ld shared
# drwxrwsr-x ... shared
#       ^
#       s = SGID

# Viktor —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª
sudo -u viktor touch shared/viktor_file.txt
ls -l shared/viktor_file.txt
# -rw-r--r-- viktor SHARED_GROUP viktor_file.txt
#                   ^^^^^^^^^^^^
#                   –ì—Ä—É–ø–ø–∞ –æ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –Ω–µ –æ—Ç viktor!
```

**–ó–∞—á–µ–º:**
–î–ª—è shared directories. –í—Å–µ —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≥—Ä—É–ø–ø—É.

**–ë–ï–ó SGID:**
```bash
# Viktor primary group = viktor
touch file.txt
ls -l file.txt
# -rw-r--r-- viktor viktor file.txt
#                   ^^^^^^
# Dmitry –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å (–Ω–µ –≤ –≥—Ä—É–ø–ø–µ viktor)
```

**–° SGID:**
```bash
# Directory group = operations
# Viktor primary group = viktor
# –ù–û directory –∏–º–µ–µ—Ç SGID
touch file.txt
ls -l file.txt
# -rw-r--r-- viktor operations file.txt
#                   ^^^^^^^^^^
# Dmitry –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å (–æ–Ω –≤ –≥—Ä—É–ø–ø–µ operations)
```

---

#### Sticky Bit ‚Äî bit 1000

**–î–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:**
–§–∞–π–ª—ã –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ:
- –í–ª–∞–¥–µ–ª–µ—Ü —Ñ–∞–π–ª–∞
- –í–ª–∞–¥–µ–ª–µ—Ü –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- root

**–ü—Ä–∏–º–µ—Ä:**
```bash
ls -ld /tmp
# drwxrwxrwt ... /tmp
#         ^
#         t = sticky bit

# Viktor —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª
sudo -u viktor touch /tmp/viktor_file.txt

# Dmitry –ø—ã—Ç–∞–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å
sudo -u dmitry rm /tmp/viktor_file.txt
# ‚ùå –û—à–∏–±–∫–∞: Operation not permitted

# Viktor –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å
sudo -u viktor rm /tmp/viktor_file.txt
# ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```

**–ó–∞—á–µ–º:**
–î–ª—è shared directories —Ç–∏–ø–∞ `/tmp`. –í—Å–µ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã, –Ω–æ —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏.

**–ë–ï–ó Sticky Bit:**
```bash
# Directory: rwxrwxrwx (–≤—Å–µ –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å)
# Dmitry –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª Viktor ‚Üí —Ö–∞–æ—Å!
```

**–° Sticky Bit:**
```bash
# Directory: rwxrwxrwt (sticky bit –≤–∫–ª—é—á—ë–Ω)
# Dmitry –ù–ï –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª Viktor ‚Üí –ø–æ—Ä—è–¥–æ–∫!
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Sticky Bit:**
```bash
chmod 1777 directory    # –∏–ª–∏ chmod +t directory
```

---

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ special bits

–ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 3:

```bash
chmod 3770 directory
# 3 = 1 (sticky) + 2 (SGID)
# 770 = rwxrwx---

ls -ld directory
# drwxrws--T ... directory
#       ^ ^
#       ‚îÇ Sticky bit (T –≤–º–µ—Å—Ç–æ t, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ—Ç x –¥–ª—è others)
#       SGID (s)
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è shared directory –æ–ø–µ—Ä–∞—Ü–∏–∏:**
```bash
mkdir /var/operations/shared
chown viktor:operations /var/operations/shared
chmod 3770 /var/operations/shared

# –¢–µ–ø–µ—Ä—å:
# - Viktor –∏ Dmitry (operations group) –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã
# - –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç –≥—Ä—É–ø–ø—É operations (SGID)
# - –ö–∞–∂–¥—ã–π –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ñ–∞–π–ª—ã (sticky bit)
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–Ω–∏–µ shared directory

**–ó–∞–¥–∞–Ω–∏–µ: –°–æ–∑–¥–∞–π shared directory —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ permissions**

```bash
# –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
sudo mkdir -p /var/operations/shared

# –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏ –≥—Ä—É–ø–ø—É
sudo chown viktor:operations /var/operations/shared

# –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å permissions
# 3770 = Sticky bit (1) + SGID (2) + rwxrwx--- (770)
sudo chmod 3770 /var/operations/shared

# –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
ls -ld /var/operations/shared
# –û–∂–∏–¥–∞–µ—Ç—Å—è: drwxrws--T viktor operations
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –¢–µ—Å—Ç 1: Viktor —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª
sudo -u viktor touch /var/operations/shared/viktor_file.txt
ls -l /var/operations/shared/viktor_file.txt
# –û–∂–∏–¥–∞–µ—Ç—Å—è: -rw-r--r-- viktor operations viktor_file.txt
#            (–≥—Ä—É–ø–ø–∞ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è SGID!)

# –¢–µ—Å—Ç 2: Dmitry —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª
sudo -u dmitry touch /var/operations/shared/dmitry_file.txt
ls -l /var/operations/shared/dmitry_file.txt
# –û–∂–∏–¥–∞–µ—Ç—Å—è: -rw-r--r-- dmitry operations dmitry_file.txt

# –¢–µ—Å—Ç 3: Dmitry –ø—ã—Ç–∞–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª Viktor
sudo -u dmitry rm /var/operations/shared/viktor_file.txt
# –û–∂–∏–¥–∞–µ—Ç—Å—è: rm: cannot remove 'viktor_file.txt': Operation not permitted
#            (sticky bit –∑–∞—â–∏—â–∞–µ—Ç!)

# –¢–µ—Å—Ç 4: Viktor –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Å–≤–æ–π —Ñ–∞–π–ª
sudo -u viktor rm /var/operations/shared/viktor_file.txt
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —É—Å–ø–µ—Ö
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"–û–±—ä—è—Å–Ω–∏: –∑–∞—á–µ–º –Ω—É–∂–µ–Ω Sticky bit –Ω–∞ shared directory?"*

<details>
<summary>üí≠ –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**

**–ü—Ä–æ–±–ª–µ–º–∞ –ë–ï–ó Sticky bit:**
```bash
# Directory: drwxrwx--- (viktor:operations)
# Viktor —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª
sudo -u viktor touch file.txt

# Dmitry (member of operations) –º–æ–∂–µ—Ç:
sudo -u dmitry rm file.txt    # ‚úÖ –£–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª Viktor!

# –ü–æ—á–µ–º—É? Dmitry –∏–º–µ–µ—Ç write –Ω–∞ directory ‚Üí –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã –≤ –Ω–µ–π
```

**–†–µ—à–µ–Ω–∏–µ: Sticky bit**
```bash
# Directory: drwxrws--T (viktor:operations, sticky bit)
# Viktor —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª
sudo -u viktor touch file.txt

# Dmitry (member of operations) –ø—ã—Ç–∞–µ—Ç—Å—è:
sudo -u dmitry rm file.txt    # ‚ùå Operation not permitted

# Sticky bit: –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ:
# - –°–≤–æ–π —Ñ–∞–π–ª
# - –ï—Å–ª–∏ —Ç—ã –≤–ª–∞–¥–µ–ª–µ—Ü directory
# - –ï—Å–ª–∏ —Ç—ã root
```

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞:**
Sticky bit = "–∫–∞–∂–¥—ã–π –º–æ–∂–µ—Ç –ø—Ä–∏–∫–ª–µ–∏—Ç—å —Å–≤–æ–π —Å—Ç–∏–∫–µ—Ä –Ω–∞ –¥–æ—Å–∫—É, –Ω–æ —Å–Ω—è—Ç—å –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–æ—Ç, –∫—Ç–æ –ø—Ä–∏–∫–ª–µ–∏–ª"

**–ë–µ–∑ sticky bit:**
"–õ—é–±–æ–π –º–æ–∂–µ—Ç —Å–Ω—è—Ç—å –ª—é–±–æ–π —Å—Ç–∏–∫–µ—Ä" ‚Üí —Ö–∞–æ—Å!

</details>

---

**–ê–Ω–¥—Ä–µ–π:**
*"–•–æ—Ä–æ—à–æ! –¢–µ–ø–µ—Ä—å —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ ‚Äî sudo configuration. –≠—Ç–æ —Ç–æ, –≥–¥–µ –ö—Ä—ã–ª–æ–≤ –ø—Ä–æ–±—Ä–∞–ª—Å—è."*

---

## üîÑ –¶–ò–ö–õ 4: Sudo –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–¥—Ä–µ–π** (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/etc/sudoers`):
```bash
sudo cat /etc/sudoers
```

**–ê–Ω–¥—Ä–µ–π:**
*"–≠—Ç–æ `/etc/sudoers` ‚Äî –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ Linux. –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å —á—Ç–æ —á–µ—Ä–µ–∑ sudo. –û—à–∏–±–∫–∞ –∑–¥–µ—Å—å = root access –¥–ª—è –∞—Ç–∞–∫—É—é—â–µ–≥–æ."*

*(–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç backdoor –ö—Ä—ã–ª–æ–≤–∞)*

```bash
# –í /etc/sudoers.d/backdoor:
devops ALL=(ALL:ALL) ALL
```

**–ê–Ω–¥—Ä–µ–π:**
*"–í–∏–¥–∏—à—å? ALL=(ALL:ALL) ALL. –≠—Ç–æ –ø–æ–ª–Ω—ã–π root access. –õ—é–±—É—é –∫–æ–º–∞–Ω–¥—É. –û—Ç –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –ö—Ä—ã–ª–æ–≤ –ø–æ–ª—É—á–∏–ª master key."*

**–ú–∞–∫—Å:** *"–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?"*

**–ê–Ω–¥—Ä–µ–π:**
*"Principle of Least Privilege. –î–ª—è –ê–ª–µ–∫—Å–∞ ‚Äî –¢–û–õ–¨–ö–û network –∫–æ–º–∞–Ω–¥—ã. –î–ª—è –ê–Ω–Ω—ã ‚Äî –¢–û–õ–¨–ö–û —á—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤. –î–ª—è –î–º–∏—Ç—Ä–∏—è ‚Äî –¢–û–õ–¨–ö–û —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏. –ü–æ–∫–∞–∂—É."*

---

### üìö –¢–µ–æ—Ä–∏—è: Sudo (Superuser Do)

#### –ß—Ç–æ —Ç–∞–∫–æ–µ sudo?

**sudo** = temporary root access.

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: VIP –±—Ä–∞—Å–ª–µ—Ç –Ω–∞ –æ–¥–Ω—É –Ω–æ—á—å**
```
üé™ –ù–û–ß–ù–û–ô –ö–õ–£–ë

–û–±—ã—á–Ω—ã–π –≤—Ö–æ–¥: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è ‚Üí –≤—Ö–æ–¥ –≤ –æ–±—â–∏–π –∑–∞–ª
Sudo –≤—Ö–æ–¥: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è ‚Üí –í–†–ï–ú–ï–ù–ù–´–ô VIP –±—Ä–∞—Å–ª–µ—Ç ‚Üí –¥–æ—Å—Ç—É–ø –∫ VIP –∑–æ–Ω–∞–º

–ü–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã: VIP –±—Ä–∞—Å–ª–µ—Ç —Å–Ω—è—Ç ‚Üí –æ–±—Ä–∞—Ç–Ω–æ –≤ –æ–±—â–∏–π –∑–∞–ª
```

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω sudo?**
```
‚ùå –ë–ï–ó SUDO:
1. –í–æ–π—Ç–∏ –∫–∞–∫ root: su -
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
3. –ó–∞–±—ã—Ç—å –≤—ã–π—Ç–∏ –∏–∑ root
4. –°–ª—É—á–∞–π–Ω–æ —É–¥–∞–ª–∏—Ç—å —á—Ç–æ-—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ–µ: rm -rf /

‚úÖ –° SUDO:
1. sudo command
2. –ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –æ—Ç root
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç –∫ –æ–±—ã—á–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
4. –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ Audit trail (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –∫—Ç–æ —á—Ç–æ –≤—ã–ø–æ–ª–Ω–∏–ª)
- ‚úÖ –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–∫—Ç–æ –∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–∂–µ—Ç)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ —á–µ–º –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π root
- ‚úÖ Password = –≤–∞—à –ø–∞—Ä–æ–ª—å (–Ω–µ root –ø–∞—Ä–æ–ª—å)

---

### –§–∞–π–ª /etc/sudoers

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: –ù–ï —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –Ω–∞–ø—Ä—è–º—É—é!**

```bash
# ‚ùå –ü–õ–û–•–û:
sudo nano /etc/sudoers

# ‚úÖ –•–û–†–û–®–û:
sudo visudo
```

**–ü–æ—á–µ–º—É visudo?**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ë–ï–ó visudo ‚Üí –æ—à–∏–±–∫–∞ = sudo —Å–ª–æ–º–∞–Ω = –ø–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞!

---

### –§–æ—Ä–º–∞—Ç sudoers

```
username HOST=(RUNAS) COMMANDS
‚îÇ        ‚îÇ    ‚îÇ       ‚îî‚îÄ –ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å
‚îÇ        ‚îÇ    ‚îî‚îÄ –û—Ç –∏–º–µ–Ω–∏ –∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å (–æ–±—ã—á–Ω–æ root)
‚îÇ        ‚îî‚îÄ –ù–∞ –∫–∞–∫–∏—Ö —Ö–æ—Å—Ç–∞—Ö (–æ–±—ã—á–Ω–æ ALL)
‚îî‚îÄ –ö—Ç–æ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
# –ü–æ–ª–Ω—ã–π sudo (–æ–ø–∞—Å–Ω–æ!)
alex ALL=(ALL:ALL) ALL

# –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:
# alex ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å alex
# ALL ‚Äî –Ω–∞ –ª—é–±–æ–º —Ö–æ—Å—Ç–µ
# (ALL:ALL) ‚Äî –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:–≥—Ä—É–ø–ø—ã
# ALL ‚Äî –ª—é–±—ã–µ –∫–æ–º–∞–Ω–¥—ã
```

```bash
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π sudo (–±–µ–∑–æ–ø–∞—Å–Ω–æ!)
alex ALL=(root) /usr/sbin/ip, /usr/bin/ss

# –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:
# alex ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å alex
# ALL ‚Äî –Ω–∞ –ª—é–±–æ–º —Ö–æ—Å—Ç–µ
# (root) ‚Äî –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ—Ç –∏–º–µ–Ω–∏ root
# /usr/sbin/ip, /usr/bin/ss ‚Äî —Ç–æ–ª—å–∫–æ —ç—Ç–∏ –¥–≤–µ –∫–æ–º–∞–Ω–¥—ã
```

```bash
# Sudo –±–µ–∑ –ø–∞—Ä–æ–ª—è
alex ALL=(root) NOPASSWD: /usr/sbin/ip

# NOPASSWD ‚Äî –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å
```

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –î–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —É –Ω–æ—Ç–∞—Ä–∏—É—Å–∞**
```
üìã –î–û–í–ï–†–ï–ù–ù–û–°–¢–¨

–ö—Ç–æ: Alex Sokolov
–ú–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å —á—Ç–æ: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–µ—Ç—å (ip, ss, iptables)
–û—Ç –∏–º–µ–Ω–∏ –∫–æ–≥–æ: Root (—Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
–ù–∞ –∫–∞–∫–æ–π —Å—Ä–æ–∫: –í—Å–µ–≥–¥–∞ (–ø–æ–∫–∞ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
–°–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–∞—Å–ø–æ—Ä—Ç: –î–∞ / –ù–µ—Ç (NOPASSWD)

–ü–æ–¥–ø–∏—Å—å: ____________
         (visudo)
```

---

### Command aliases (–∞–ª–∏–∞—Å—ã –∫–æ–º–∞–Ω–¥)

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–ª–∏–∞—Å—ã:

```bash
# –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–ª–∏–∞—Å
Cmnd_Alias NETCMDS = /usr/sbin/ip, /usr/bin/ss, /usr/sbin/tcpdump

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª–∏–∞—Å
alex ALL=(root) NOPASSWD: NETCMDS
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –õ–µ–≥–∫–æ —á–∏—Ç–∞—Ç—å (NETCMDS vs –¥–ª–∏–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
- ‚úÖ –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω—è—Ç—å (–¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ)
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = –æ–¥–∏–Ω –∞–ª–∏–∞—Å)

---

### –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ sudo

**1. –ò—Å–ø–æ–ª—å–∑—É–π /etc/sudoers.d/ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**

```bash
# –í–º–µ—Å—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è /etc/sudoers:
sudo visudo

# –°–æ–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:
sudo visudo -f /etc/sudoers.d/alex
sudo visudo -f /etc/sudoers.d/anna
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å (–∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª)
- ‚úÖ –õ–µ–≥–∫–æ —É–¥–∞–ª–∏—Ç—å (rm —Ñ–∞–π–ª vs –ø–æ–∏—Å–∫ –≤ /etc/sudoers)
- ‚úÖ –õ–µ–≥–∫–æ –∞—É–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å (ls /etc/sudoers.d/)

**2. –£–∫–∞–∑—ã–≤–∞–π –ø–æ–ª–Ω—ã–µ –ø—É—Ç–∏ –∫–æ–º–∞–Ω–¥**

```bash
# ‚ùå –ü–õ–û–•–û (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ):
alex ALL=(root) ip

# –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å:
# /tmp/ip (—Ñ–µ–π–∫–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞)
# export PATH=/tmp:$PATH
# sudo ip ‚Üí –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è /tmp/ip –æ—Ç root!

# ‚úÖ –•–û–†–û–®–û:
alex ALL=(root) /usr/sbin/ip

# –¢–æ–ª—å–∫–æ –Ω–∞—Å—Ç–æ—è—â–∏–π /usr/sbin/ip –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω
```

**3. –ò—Å–ø–æ–ª—å–∑—É–π NOPASSWD —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é**

```bash
# NOPASSWD —É–¥–æ–±–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
# –ù–û: –µ—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω ‚Üí –∞—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ –∂–µ –ø—Ä–∞–≤–∞ –ë–ï–ó –ø–∞—Ä–æ–ª—è

# –ò—Å–ø–æ–ª—å–∑—É–π NOPASSWD —Ç–æ–ª—å–∫–æ –¥–ª—è:
# - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –∫–æ–º–∞–Ω–¥
# - –ù–µ–æ–ø–∞—Å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞)

# –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –¥–ª—è:
# - –ü–æ–ª–Ω–æ–≥–æ sudo (ALL)
# - –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (rm, dd)
```

**4. –Ø–≤–Ω–æ –∑–∞–ø—Ä–µ—â–∞–π –æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**

```bash
# Defense in depth: —è–≤–Ω—ã–π –∑–∞–ø—Ä–µ—Ç
alex ALL=(root) !/usr/sbin/visudo, \
                !/usr/bin/passwd root, \
                !/bin/rm -rf /
```

**5. –õ–æ–≥–∏—Ä—É–π sudo –¥–µ–π—Å—Ç–≤–∏—è**

```bash
# –õ–æ–≥–∏ sudo –≤ /var/log/auth.log (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
# –ü—Ä–æ–≤–µ—Ä–∫–∞:
sudo grep "sudo.*COMMAND" /var/log/auth.log

# –ò–ª–∏ —á–µ—Ä–µ–∑ journalctl:
sudo journalctl _COMM=sudo --since today
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è sudo –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

**–ó–∞–¥–∞–Ω–∏–µ: –ù–∞—Å—Ç—Ä–æ–π sudo –¥–ª—è –ê–ª–µ–∫—Å–∞, –ê–Ω–Ω—ã, –î–º–∏—Ç—Ä–∏—è**

**–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å sudoers —Ñ–∞–π–ª –¥–ª—è –ê–ª–µ–∫—Å–∞**

```bash
sudo visudo -f /etc/sudoers.d/alex
```

–î–æ–±–∞–≤–∏—Ç—å:
```
# Alex Sokolov ‚Äî Network Administration
# Principle of Least Privilege: ONLY network commands

Cmnd_Alias NETCMDS = /usr/sbin/ip, \
                      /usr/bin/ss, \
                      /usr/bin/netstat, \
                      /usr/sbin/tcpdump, \
                      /usr/sbin/iptables, \
                      /usr/sbin/ufw, \
                      /usr/bin/nmap

alex ALL=(root) NOPASSWD: NETCMDS

# Explicitly deny dangerous commands
alex ALL=(root) !/usr/sbin/visudo, \
                !/usr/bin/passwd root
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+O, Enter, Ctrl+X).

**–®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞**

```bash
sudo chmod 440 /etc/sudoers.d/alex
```

**–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**

```bash
sudo visudo -c -f /etc/sudoers.d/alex
```

–û–∂–∏–¥–∞–µ—Ç—Å—è: `parsed OK`

**–®–∞–≥ 4: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**

```bash
# –¢–µ—Å—Ç 1: Alex –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å network –∫–æ–º–∞–Ω–¥—ã
sudo -u alex sudo ip addr show
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —É—Å–ø–µ—Ö (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç IP –∞–¥—Ä–µ—Å–∞)

# –¢–µ—Å—Ç 2: Alex –ù–ï –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
sudo -u alex sudo useradd test
# –û–∂–∏–¥–∞–µ—Ç—Å—è: "Sorry, user alex is not allowed to execute..."

# –¢–µ—Å—Ç 3: NOPASSWD —Ä–∞–±–æ—Ç–∞–µ—Ç
sudo -u alex sudo -n ss -tulpn
# –§–ª–∞–≥ -n = non-interactive (–Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å)
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —É—Å–ø–µ—Ö (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã)
```

---

**–ó–∞–¥–∞–Ω–∏–µ: –ü–æ–≤—Ç–æ—Ä–∏ –¥–ª—è –ê–Ω–Ω—ã –∏ –î–º–∏—Ç—Ä–∏—è**

**–î–ª—è –ê–Ω–Ω—ã (read-only –ª–æ–≥–∏):**

```bash
sudo visudo -f /etc/sudoers.d/anna
```

```
# Anna Kovaleva ‚Äî Forensics Expert
# Read-only log access

Cmnd_Alias LOGCMDS = /usr/bin/less /var/log/*, \
                      /usr/bin/tail /var/log/*, \
                      /usr/bin/cat /var/log/*, \
                      /usr/bin/grep * /var/log/*

Cmnd_Alias JOURNALCMDS = /usr/bin/journalctl

anna ALL=(root) NOPASSWD: LOGCMDS, JOURNALCMDS

# Deny log modification
anna ALL=(root) !/bin/rm /var/log/*, \
                !/usr/bin/tee /var/log/*
```

**–î–ª—è –î–º–∏—Ç—Ä–∏—è (service management):**

```bash
sudo visudo -f /etc/sudoers.d/dmitry
```

```
# Dmitry Orlov ‚Äî DevOps Engineer
# Service management

Cmnd_Alias SERVICECMDS = /usr/bin/systemctl start *, \
                          /usr/bin/systemctl stop *, \
                          /usr/bin/systemctl restart *, \
                          /usr/bin/systemctl status *

Cmnd_Alias DOCKERCMDS = /usr/bin/docker, \
                         /usr/bin/docker-compose

dmitry ALL=(root) NOPASSWD: SERVICECMDS, JOURNALCMDS, DOCKERCMDS
```

---

**–°–æ–≤–µ—Ç –æ—Ç LILITH:**
*"–ì–æ—Ç–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ –≤ `solution/sudoers.d/`. –ù–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–π —Ä—É–∫–∞–º–∏ ‚Äî –∫–æ–ø–∏—Ä—É–π –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–π."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–ê–Ω–¥—Ä–µ–π:** *"–ü–æ—á–µ–º—É NOPASSWD –æ–ø–∞—Å–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ sudo, –Ω–æ OK –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥?"*

<details>
<summary>üí≠ –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**

**–° NOPASSWD + –ø–æ–ª–Ω—ã–π sudo:**
```bash
user ALL=(ALL) NOPASSWD: ALL

# –ï—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–∫—Ä–∞–¥–µ–Ω SSH –∫–ª—é—á):
$ sudo rm -rf /    # –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –≠–¢–û –ë–ï–ó –ø–∞—Ä–æ–ª—è!
$ sudo useradd backdoor
$ sudo passwd backdoor
# –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ë–ï–ó –∑–Ω–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è
```

**–° NOPASSWD + –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
alex ALL=(root) NOPASSWD: /usr/sbin/ip

# –ï—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω:
$ sudo ip addr show   # –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –¢–û–õ–¨–ö–û —ç—Ç–æ
$ sudo useradd test   # ‚ùå –ù–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ
$ sudo rm -rf /       # ‚ùå –ù–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ

# –£—â–µ—Ä–± –æ–≥—Ä–∞–Ω–∏—á–µ–Ω network –∫–æ–º–∞–Ω–¥–∞–º–∏
```

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞:**
- NOPASSWD + –ø–æ–ª–Ω—ã–π sudo = –¥–∞—Ç—å –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á –æ—Ç –∑–¥–∞–Ω–∏—è **–±–µ–∑ –æ—Ö—Ä–∞–Ω—ã**
- NOPASSWD + –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã = –¥–∞—Ç—å –∫–ª—é—á –æ—Ç –æ–¥–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã **–±–µ–∑ –æ—Ö—Ä–∞–Ω—ã**

**–í—ã–≤–æ–¥:**
NOPASSWD —É–¥–æ–±–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏!

</details>

---

**–ê–Ω–¥—Ä–µ–π:**
*"–û—Ç–ª–∏—á–Ω–æ. Sudo –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –¢–µ–ø–µ—Ä—å –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–µ–º–∞ ‚Äî ACL."*

---

## üîÑ –¶–ò–ö–õ 5: ACL (Access Control Lists) ‚Äî 15 –º–∏–Ω—É—Ç

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–¥—Ä–µ–π:**
*"Permissions (rwx) —Ö–æ—Ä–æ—à–∏, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã. –û–¥–∏–Ω –≤–ª–∞–¥–µ–ª–µ—Ü, –æ–¥–Ω–∞ –≥—Ä—É–ø–ø–∞, –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ. –ß—Ç–æ –µ—Å–ª–∏ –ê–Ω–Ω–µ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º, –Ω–æ –æ–Ω–∞ –Ω–µ –≤ –≥—Ä—É–ø–ø–µ adm?"*

**–ú–∞–∫—Å:** *"–î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É adm?"*

**–ê–Ω–¥—Ä–µ–π:**
*"–ú–æ–∂–Ω–æ. –ù–æ —Ç–æ–≥–¥–∞ –æ–Ω–∞ –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫–æ –í–°–ï–ú —Ñ–∞–π–ª–∞–º –≥—Ä—É–ø–ø—ã adm. –ê –Ω–∞–º –Ω—É–∂–Ω–æ –¢–û–õ–¨–ö–û `/var/log/auth.log`. –î–ª—è —ç—Ç–æ–≥–æ –µ—Å—Ç—å ACL."*

---

### üìö –¢–µ–æ—Ä–∏—è: ACL (Access Control Lists)

#### –ß—Ç–æ —Ç–∞–∫–æ–µ ACL?

**ACL** = –±–æ–ª–µ–µ –≥–∏–±–∫–∏–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞, —á–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ UGO (User, Group, Others).

**–ü—Ä–æ–±–ª–µ–º–∞ —Å UGO:**
```
File: /var/log/auth.log
Owner: root
Group: adm
Permissions: rw-r-----

–ú–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å:
- root (owner)
- –í—Å–µ –≤ –≥—Ä—É–ø–ø–µ adm

–ê–Ω–Ω–∞ –ù–ï –≤ –≥—Ä—É–ø–ø–µ adm ‚Üí –Ω–µ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å
```

**–†–µ—à–µ–Ω–∏–µ: ACL**
```bash
sudo setfacl -m u:anna:r /var/log/auth.log

# –¢–µ–ø–µ—Ä—å –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å:
# - root (owner)
# - –í—Å–µ –≤ –≥—Ä—É–ø–ø–µ adm
# - anna (—á–µ—Ä–µ–∑ ACL) ‚Üê –î–æ–±–∞–≤–∏–ª–∞—Å—å!
```

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: VIP-–±—Ä–∞—Å–ª–µ—Ç—ã –Ω–∞ —Ñ–µ—Å—Ç–∏–≤–∞–ª–µ**
```
üé™ –ú–£–ó–´–ö–ê–õ–¨–ù–´–ô –§–ï–°–¢–ò–í–ê–õ–¨

Traditional permissions (UGO):
- 1 –≤–ª–∞–¥–µ–ª–µ—Ü (–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä) ‚Äî –º–æ–∂–µ—Ç –≤—Å—ë
- 1 –≥—Ä—É–ø–ø–∞ (–ø–µ—Ä—Å–æ–Ω–∞–ª) ‚Äî limited access
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî —Ç–æ–ª—å–∫–æ basic

–ü—Ä–æ–±–ª–µ–º–∞: –•–æ—á—É –¥–∞—Ç—å Anna VIP –¥–æ—Å—Ç—É–ø, –Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å –µ—ë –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º

–†–µ—à–µ–Ω–∏–µ: ACL = –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π VIP-–±—Ä–∞—Å–ª–µ—Ç –¥–ª—è Anna
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä (owner) ‚Äî –º–æ–∂–µ—Ç –≤—Å—ë
- –ü–µ—Ä—Å–æ–Ω–∞–ª (group) ‚Äî limited access
- Anna (ACL) ‚Äî VIP –±—Ä–∞—Å–ª–µ—Ç (custom –ø—Ä–∞–≤–∞)
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî —Ç–æ–ª—å–∫–æ basic
```

---

### –ö–æ–º–∞–Ω–¥—ã ACL

**setfacl ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ACL**

```bash
# –î–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é anna –ø—Ä–∞–≤–æ read
sudo setfacl -m u:anna:r /var/log/auth.log

# –î–∞—Ç—å –≥—Ä—É–ø–ø–µ forensics –ø—Ä–∞–≤–æ read+execute
sudo setfacl -m g:forensics:rx /var/log

# –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
sudo setfacl -R -m u:anna:r /var/log

# Default ACL (–¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
sudo setfacl -d -m u:anna:r /var/log
```

**getfacl ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å ACL**

```bash
getfacl /var/log/auth.log
```

–í—ã–≤–æ–¥:
```
# file: /var/log/auth.log
# owner: root
# group: adm
user::rw-               # Owner (root)
user:anna:r--           # ACL –¥–ª—è anna ‚Üê –ù–æ–≤–æ–µ!
group::r--              # Group (adm)
mask::r--
other::---
```

**–£–¥–∞–ª–∏—Ç—å ACL**

```bash
# –£–¥–∞–ª–∏—Ç—å ACL –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
sudo setfacl -x u:anna /var/log/auth.log

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ ACL
sudo setfacl -b /var/log/auth.log
```

---

### ACL mask

**Mask** = –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–ª—è ACL –∏ group.

```
Effective permissions = Min(ACL rights, mask)
```

–ü—Ä–∏–º–µ—Ä:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ACL
sudo setfacl -m u:anna:rwx /var/log/auth.log

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å
getfacl /var/log/auth.log

# –í—ã–≤–æ–¥:
user:anna:rwx           # ACL –ø—Ä–∞–≤–∞
mask::r--               # Mask –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç!

# –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∞ anna = min(rwx, r--) = r--
# anna –º–æ–∂–µ—Ç –¢–û–õ–¨–ö–û —á–∏—Ç–∞—Ç—å, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ rwx –≤ ACL!
```

**–ò–∑–º–µ–Ω–∏—Ç—å mask:**
```bash
sudo setfacl -m m::rw /var/log/auth.log
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: ACL –¥–ª—è –ê–Ω–Ω—ã

**–ó–∞–¥–∞–Ω–∏–µ: –î–∞—Ç—å –ê–Ω–Ω–µ read-only –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º**

**–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ ACL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ setfacl
which setfacl

# –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
sudo apt-get install -y acl
```

**–®–∞–≥ 2: –î–∞—Ç—å Anna –¥–æ—Å—Ç—É–ø –∫ /var/log**

```bash
# –ê–Ω–Ω–µ –Ω—É–∂–µ–Ω execute –Ω–∞ /var/log —á—Ç–æ–±—ã –≤–æ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
sudo setfacl -m u:anna:rx /var/log
```

**–®–∞–≥ 3: –î–∞—Ç—å read-only –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ª–æ–≥–∏**

```bash
sudo setfacl -m u:anna:r /var/log/auth.log
sudo setfacl -m u:anna:r /var/log/syslog
sudo setfacl -m u:anna:r /var/log/kern.log
```

**–®–∞–≥ 4: Default ACL –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤**

```bash
# –ù–æ–≤—ã–µ –ª–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç ACL –¥–ª—è anna
sudo setfacl -d -m u:anna:r /var/log
```

**–®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞**

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å ACL
getfacl /var/log/auth.log

# –û–∂–∏–¥–∞–µ—Ç—Å—è:
# user:anna:r--

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤ ls -l –µ—Å—Ç—å +
ls -l /var/log/auth.log
# -rw-r-----+ ... /var/log/auth.log
#           ^
#           + –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ ACL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```

**–®–∞–≥ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

```bash
# –¢–µ—Å—Ç 1: Anna –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å
sudo -u anna cat /var/log/auth.log
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —É—Å–ø–µ—Ö (–ª–æ–≥ –≤—ã–≤–æ–¥–∏—Ç—Å—è)

# –¢–µ—Å—Ç 2: Anna –ù–ï –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å
sudo -u anna bash -c 'echo "fake" >> /var/log/auth.log'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: "Permission denied"

# –¢–µ—Å—Ç 3: Anna –ù–ï –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å
sudo -u anna rm /var/log/auth.log
# –û–∂–∏–¥–∞–µ—Ç—Å—è: "Permission denied"
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"–ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ACL –≤–º–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É adm?"*

<details>
<summary>üí≠ –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**

**–° –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ –≥—Ä—É–ø–ø—É adm:**
```bash
sudo usermod -aG adm anna

# Anna –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –í–°–ï–ú —Ñ–∞–π–ª–∞–º –≥—Ä—É–ø–ø—ã adm:
ls -l /var/log/ | grep "adm"
# -rw-r----- root adm auth.log    ‚úÖ –ú–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å
# -rw-r----- root adm syslog       ‚úÖ –ú–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å
# -rw-r----- root adm alternatives.log ‚úÖ –ú–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å
# ... –∏ –µ—â—ë 50+ —Ñ–∞–π–ª–æ–≤

# –ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –Ω–∞—Ä—É—à–µ–Ω!
```

**–° ACL:**
```bash
sudo setfacl -m u:anna:r /var/log/auth.log

# Anna –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –¢–û–õ–¨–ö–û –∫ auth.log:
ls -l /var/log/auth.log
# -rw-r-----+ root adm auth.log   ‚úÖ –ú–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å (—á–µ—Ä–µ–∑ ACL)

ls -l /var/log/syslog
# -rw-r----- root adm syslog       ‚ùå –ù–ï –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å

# Principle of Least Privilege —Å–æ–±–ª—é–¥—ë–Ω!
```

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É = –¥–∞—Ç—å –∫–ª—é—á–∏ –æ—Ç –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç –æ—Ç–¥–µ–ª–∞
- ACL = –¥–∞—Ç—å –∫–ª—é—á –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã

**–í—ã–≤–æ–¥:**
–ò—Å–ø–æ–ª—å–∑—É–π ACL –¥–ª—è –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞!

</details>

---

**–ê–Ω–¥—Ä–µ–π:**
*"–•–æ—Ä–æ—à–æ. Sudo –∏ ACL –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã. –¢–µ–ø–µ—Ä—å –∑–∞—â–∏—Ç–∞ –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∞—Ç–∞–∫ ‚Äî resource limits."*

---

## üîÑ –¶–ò–ö–õ 6: Resource limits + PAM (20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–¥—Ä–µ–π** (–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å—Ç—Ä–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç):
```bash
:(){ :|:& };:
```

**–ú–∞–∫—Å:** *"–ß—Ç–æ —ç—Ç–æ?"*

**–ê–Ω–¥—Ä–µ–π:**
*"Fork bomb. –°–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ. –ë–µ–∑ –ª–∏–º–∏—Ç–æ–≤ ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∏—Å–Ω–µ—Ç –∑–∞ —Å–µ–∫—É–Ω–¥—ã."*

*(–°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ç–æ—Ä–º–æ–∑–∏—Ç—å... –ø–æ—Ç–æ–º –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è)*

**–ê–Ω–¥—Ä–µ–π:**
*"–í–∏–¥–∏—à—å? –°–∏—Å—Ç–µ–º–∞ –µ—â—ë —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü–æ—Ç–æ–º—É —á—Ç–æ —É –º–µ–Ω—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω nproc limit ‚Äî –º–∞–∫—Å–∏–º—É–º 1000 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. Fork bomb –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å."*

**–ú–∞–∫—Å:** *"–ö–∞–∫ —ç—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è?"*

**–ê–Ω–¥—Ä–µ–π:**
*"`/etc/security/limits.conf` + PAM. –ü–æ–∫–∞–∂—É."*

---

### üìö –¢–µ–æ—Ä–∏—è: Resource limits

#### –ó–∞—á–µ–º –Ω—É–∂–Ω—ã limits?

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç "—Å—ä–µ—Å—Ç—å" –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã —Å–∏—Å—Ç–µ–º—ã:
- Fork bomb ‚Üí –º–∏–ª–ª–∏–æ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚Üí —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∏—Å–ª–∞
- –û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ file descriptors ‚Üí –¥—Ä—É–≥–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∏—Å–∫ –æ–≥—Ä–æ–º–Ω—ã–º —Ñ–∞–π–ª–æ–º

**–†–µ—à–µ–Ω–∏–µ:** Limits ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ë–∏–ª–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç**
```
üéµ –ö–û–ù–¶–ï–†–¢ –í –ö–õ–£–ë–ï

–ë–µ–∑ limits:
- –ö–∞–∂–¥—ã–π –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ –¥—Ä—É–∑–µ–π
- –ü–µ—Ä–≤—ã–π –≥–æ—Å—Ç—å –ø—Ä–∏–≤–æ–¥–∏—Ç 1000 —á–µ–ª–æ–≤–µ–∫
- –ö–ª—É–± –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω, –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏
- –•–∞–æ—Å!

–° limits:
- –ö–∞–∂–¥—ã–π –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –º–∞–∫—Å–∏–º—É–º 10 –¥—Ä—É–∑–µ–π (nproc limit)
- –ü–µ—Ä–≤—ã–π –≥–æ—Å—Ç—å –ø—Ä–∏–≤–æ–¥–∏—Ç 10
- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–æ–∂–µ –º–æ–≥—É—Ç –≤–æ–π—Ç–∏
- –ü–æ—Ä—è–¥–æ–∫!
```

---

### –§–∞–π–ª /etc/security/limits.conf

**–§–æ—Ä–º–∞—Ç:**
```
<domain> <type> <item> <value>
```

**domain:**
- `username` ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `@groupname` ‚Äî –≥—Ä—É–ø–ø–∞ (—Å–∏–º–≤–æ–ª @ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!)
- `*` ‚Äî –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

**type:**
- `soft` ‚Äî –º—è–≥–∫–∏–π –ª–∏–º–∏—Ç (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ hard)
- `hard` ‚Äî –∂—ë—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç (–Ω–µ–ª—å–∑—è –ø—Ä–µ–≤—ã—Å–∏—Ç—å)
- `-` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–∞ (soft –∏ hard)

**item:**
- `nproc` ‚Äî –º–∞–∫—Å–∏–º—É–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- `nofile` ‚Äî –º–∞–∫—Å–∏–º—É–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤ (file descriptors)
- `core` ‚Äî —Ä–∞–∑–º–µ—Ä core dump (0 = –æ—Ç–∫–ª—é—á–∏—Ç—å)
- `fsize` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- `cpu` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ CPU –≤—Ä–µ–º—è (–º–∏–Ω—É—Ç—ã)
- `maxlogins` ‚Äî –º–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤

**value:**
- —á–∏—Å–ª–æ ‚Äî –ª–∏–º–∏—Ç
- `unlimited` ‚Äî –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

---

### –ü—Ä–∏–º–µ—Ä—ã limits

```
# –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: –º–∞–∫—Å–∏–º—É–º 2048 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
*    soft    nproc     2048
*    hard    nproc     4096

# –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: –º–∞–∫—Å–∏–º—É–º 4096 –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
*    soft    nofile    4096
*    hard    nofile    65536

# –û—Ç–∫–ª—é—á–∏—Ç—å core dumps (security!)
*    soft    core      0

# Alex: –ø–æ–≤—ã—à–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã (network –∞–¥–º–∏–Ω)
alex soft    nofile    16384
alex hard    nofile    65536
alex soft    nproc     1500

# Anna: –ø–æ–Ω–∏–∂–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã (forensics –Ω–µ –Ω—É–∂–Ω–æ –º–Ω–æ–≥–æ)
anna soft    nproc     500
anna hard    nproc     1000

# Dmitry: –≤—ã—Å–æ–∫–∏–µ –ª–∏–º–∏—Ç—ã (Docker –Ω—É–∂–Ω–æ –º–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)
dmitry soft  nproc     2000
dmitry hard  nproc     4000
dmitry soft  nofile    16384
```

---

### PAM (Pluggable Authentication Modules)

**–ß—Ç–æ —Ç–∞–∫–æ–µ PAM?**
–ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Linux.

**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ PAM:**
- SSH —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —Å–∞–º
- sudo —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —Å–∞–º
- login —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —Å–∞–º
- –•–æ—á–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å 2FA? –ü–∞—Ç—á–∏ –¥–ª—è –ö–ê–ñ–î–û–ì–û —Å–µ—Ä–≤–∏—Å–∞!

**–° PAM:**
- –û–¥–∏–Ω —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–æ–∏–ª PAM ‚Üí —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å: –¥–æ–±–∞–≤–∏–ª –º–æ–¥—É–ª—å ‚Üí –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–æ–ª—É—á–∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –û—Ö—Ä–∞–Ω–∞ –≤ –∑–¥–∞–Ω–∏–∏**
```
üè¢ –ó–î–ê–ù–ò–ï –° –ù–ï–°–ö–û–õ–¨–ö–ò–ú–ò –í–•–û–î–ê–ú–ò

–ë–µ–∑ PAM:
‚îú‚îÄ –í—Ö–æ–¥ 1 ‚Üí –û—Ö—Ä–∞–Ω–Ω–∏–∫ –í–∞—Å—è (—Å–≤–æ–∏ –ø—Ä–∞–≤–∏–ª–∞)
‚îú‚îÄ –í—Ö–æ–¥ 2 ‚Üí –û—Ö—Ä–∞–Ω–Ω–∏–∫ –ü–µ—Ç—è (—Å–≤–æ–∏ –ø—Ä–∞–≤–∏–ª–∞)
‚îî‚îÄ –í—Ö–æ–¥ 3 ‚Üí –û—Ö—Ä–∞–Ω–Ω–∏–∫ –ö–æ–ª—è (—Å–≤–æ–∏ –ø—Ä–∞–≤–∏–ª–∞)

–° PAM:
‚îú‚îÄ –í—Ö–æ–¥ 1 ‚îÄ‚îÄ‚îÄ‚îê
‚îú‚îÄ –í—Ö–æ–¥ 2 ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚ñ∫ üìã –ï–¥–∏–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (PAM)
‚îî‚îÄ –í—Ö–æ–¥ 3 ‚îÄ‚îÄ‚îÄ‚îò
```

---

### PAM –∏ limits.conf

**–ö—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç limits.conf?**
PAM –º–æ–¥—É–ª—å `pam_limits.so`!

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
grep pam_limits.so /etc/pam.d/common-session
```

–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
```
session required pam_limits.so
```

**–ï—Å–ª–∏ –Ω–µ—Ç:**
```bash
echo "session required pam_limits.so" | sudo tee -a /etc/pam.d/common-session
```

**‚ö†Ô∏è –ë–ï–ó pam_limits.so:**
- limits.conf –ò–ì–ù–û–†–ò–†–£–ï–¢–°–Ø!
- Fork bomb –∑–∞—â–∏—Ç–∞ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ limits

**–®–∞–≥ 1: Backup –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞**

```bash
sudo cp /etc/security/limits.conf /etc/security/limits.conf.backup
```

**–®–∞–≥ 2: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞**

```bash
# –ì–æ—Ç–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ –≤ solution/security/limits.conf
sudo cp solution/security/limits.conf /etc/security/limits.conf

# –ü—Ä–∞–≤–∞ 644
sudo chmod 644 /etc/security/limits.conf
```

**–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ PAM**

```bash
grep pam_limits.so /etc/pam.d/common-session

# –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤–∏—Ç—å:
echo "session required pam_limits.so" | sudo tee -a /etc/pam.d/common-session
```

**–®–∞–≥ 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ (–Ω—É–∂–µ–Ω logout/login!)**

–õ–∏–º–∏—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ù–û–í–û–ú –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!

```bash
# –¢–µ—Å—Ç: –≤–æ–π—Ç–∏ –∫–∞–∫ alex
sudo -i -u alex

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã
ulimit -n    # nofile: –æ–∂–∏–¥–∞–µ—Ç—Å—è 16384
ulimit -u    # nproc: –æ–∂–∏–¥–∞–µ—Ç—Å—è 1500

exit
```

**–®–∞–≥ 5: –¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç fork bomb**

**‚ö†Ô∏è –¢–û–õ–¨–ö–û –í –¢–ï–°–¢–û–í–û–ô –°–†–ï–î–ï! –ù–ï –ù–ê PRODUCTION!**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∏–∑–∫–∏–π –ª–∏–º–∏—Ç –¥–ª—è —Ç–µ—Å—Ç–∞
ulimit -u 50

# –ó–∞–ø—É—Å—Ç–∏—Ç—å fork bomb
:(){ :|:& };:

# –û–∂–∏–¥–∞–µ—Ç—Å—è:
# bash: fork: retry: Resource temporarily unavailable
# –°–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ–π!

# –ë–µ–∑ –ª–∏–º–∏—Ç–∞: —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∏—Å–Ω–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"–û–±—ä—è—Å–Ω–∏: –ø–æ—á–µ–º—É core dumps –æ—Ç–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é?"*

<details>
<summary>üí≠ –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**

**–ß—Ç–æ —Ç–∞–∫–æ–µ core dump?**
–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –º–æ–º–µ–Ω—Ç –∫—Ä–∞—Ö–∞.

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω?**
–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ (debugging) ‚Äî –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –±—ã–ª–æ –≤ –ø–∞–º—è—Ç–∏ –∫–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —É–ø–∞–ª–∞.

**–í —á—ë–º –ø—Ä–æ–±–ª–µ–º–∞?**
–ü–∞–º—è—Ç—å –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å sensitive data:

```c
// –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å –ø–∞—Ä–æ–ª–µ–º –≤ –ø–∞–º—è—Ç–∏
char password[] = "SuperSecret123";
// –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–∞–¥–∞–µ—Ç ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è core dump

// –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∏–∑–≤–ª–µ—á—å –ø–∞—Ä–æ–ª—å:
$ strings core | grep -i secret
SuperSecret123    ‚Üê –ü–∞—Ä–æ–ª—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ!
```

**–¢–∞–∫–∂–µ –≤ core dump –º–æ–∂–µ—Ç –±—ã—Ç—å:**
- SSH –∫–ª—é—á–∏
- –¢–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞
- Database passwords
- Encryption keys
- Personal data (PII)

**–†–µ—à–µ–Ω–∏–µ:**
–û—Ç–∫–ª—é—á–∏—Ç—å core dumps –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`ulimit -c 0`).

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–ª—è debug ‚Üí –≤–∫–ª—é—á–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ.

**Aha! –º–æ–º–µ–Ω—Ç:**
Core dumps –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è debugging, –Ω–æ –æ–ø–∞—Å–Ω—ã –¥–ª—è security!

</details>

---

**–ê–Ω–¥—Ä–µ–π:**
*"–û—Ç–ª–∏—á–Ω–æ. –ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ ‚Äî security audit. –ù–∞–π—Ç–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ backdoors."*

---

## üîÑ –¶–ò–ö–õ 7: Security Audit ‚Äî SUID/SGID (20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–¥—Ä–µ–π:**
*"–ö—Ä—ã–ª–æ–≤ –ª—é–±–∏—Ç –æ—Å—Ç–∞–≤–ª—è—Ç—å backdoors. –û–¥–∏–Ω –∏–∑ –ª—é–±–∏–º—ã—Ö —Ç—Ä—é–∫–æ–≤ ‚Äî SUID —Ñ–∞–π–ª. –ü–æ–∫–∞–∂—É."*

*(–°–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç)*

```bash
# /tmp/backdoor.sh
#!/bin/bash
/bin/bash
```

```bash
sudo chown root /tmp/backdoor.sh
sudo chmod 4755 /tmp/backdoor.sh    # SUID bit

# –ó–∞–ø—É—Å–∫:
/tmp/backdoor.sh
whoami
# Output: root    ‚Üê shell –æ—Ç root!
```

**–ú–∞–∫—Å:** *"–ù–æ... —è –∑–∞–ø—É—Å—Ç–∏–ª –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å!"*

**–ê–Ω–¥—Ä–µ–π:**
*"SUID. –§–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (root). –ï—Å–ª–∏ –ö—Ä—ã–ª–æ–≤ –æ—Å—Ç–∞–≤–∏–ª —Ç–∞–∫–æ–π —Ñ–∞–π–ª ‚Äî backdoor –≥–æ—Ç–æ–≤. –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ SUID —Ñ–∞–π–ª—ã –≤ —Å–∏—Å—Ç–µ–º–µ."*

---

### üìö –¢–µ–æ—Ä–∏—è: SUID/SGID Security Risks

#### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: SUID

**SUID** (Set User ID) ‚Äî —Ñ–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ **–≤–ª–∞–¥–µ–ª—å—Ü–∞**, –Ω–µ —Ç–æ–≥–æ –∫—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª.

**–õ–µ–≥–∏—Ç–∏–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
/usr/bin/passwd    # –ù—É–∂–µ–Ω root –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è /etc/shadow
/usr/bin/sudo      # –ù—É–∂–µ–Ω root –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –æ—Ç root
/usr/bin/ping      # –ù—É–∂–µ–Ω root –¥–ª—è raw sockets
```

**–û–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
/tmp/backdoor.sh   # –í–ª–∞–¥–µ–ª–µ—Ü = root, SUID ‚Üí instant root shell
/home/user/shell   # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π backdoor
```

---

#### –ü–æ—á–µ–º—É SUID –æ–ø–∞—Å–µ–Ω?

**–ï—Å–ª–∏ SUID —Ñ–∞–π–ª –∏–º–µ–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å:**
- Buffer overflow ‚Üí execute arbitrary code as root
- Command injection ‚Üí execute commands as root
- Race condition ‚Üí modify file before execution

**–ü—Ä–∏–º–µ—Ä:**
```c
// suid_program.c (–≤–ª–∞–¥–µ–ª–µ—Ü = root, SUID)
#include <stdlib.h>
int main() {
    system("ls");    // ‚ùå –£–Ø–ó–í–ò–ú–û–°–¢–¨: –Ω–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å!
}
```

```bash
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è
gcc suid_program.c -o suid_program
sudo chown root suid_program
sudo chmod 4755 suid_program

# –≠–∫—Å–ø–ª–æ–π—Ç:
cat > /tmp/ls << 'EOF'
#!/bin/bash
/bin/bash    # Backdoor shell
EOF
chmod +x /tmp/ls
export PATH=/tmp:$PATH

# –ó–∞–ø—É—Å–∫ SUID –ø—Ä–æ–≥—Ä–∞–º–º—ã:
./suid_program
# –í—ã–∑—ã–≤–∞–µ—Ç—Å—è /tmp/ls (–Ω–µ /bin/ls) ‚Üí root shell!
```

---

### –ü–æ–∏—Å–∫ SUID/SGID —Ñ–∞–π–ª–æ–≤

**–ù–∞–π—Ç–∏ –≤—Å–µ SUID —Ñ–∞–π–ª—ã:**
```bash
find / -perm -4000 -type f 2>/dev/null
```

**–ù–∞–π—Ç–∏ –≤—Å–µ SGID —Ñ–∞–π–ª—ã:**
```bash
find / -perm -2000 -type f 2>/dev/null
```

**–ù–∞–π—Ç–∏ SUID –∏–ª–∏ SGID:**
```bash
find / \( -perm -4000 -o -perm -2000 \) -type f 2>/dev/null
```

---

### Baseline approach

**–ò–¥–µ—è:** –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ SUID —Ñ–∞–π–ª–æ–≤ "–∫–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å", –ø–æ—Ç–æ–º –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

**–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å baseline**
```bash
find / -perm -4000 -type f 2>/dev/null | sort > /root/suid_baseline.txt
```

**–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ**
```bash
find / -perm -4000 -type f 2>/dev/null | sort | diff /root/suid_baseline.txt -
```

**–ï—Å–ª–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ SUID —Ñ–∞–π–ª—ã:**
```
> /tmp/backdoor.sh    ‚Üê –ù–æ–≤—ã–π SUID —Ñ–∞–π–ª!
```

**‚Üí –†–ê–°–°–õ–ï–î–û–í–ê–¢–¨!**

---

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ SUID —Ñ–∞–π–ª—ã (Ubuntu)

```
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/su
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/mount
/usr/bin/umount
/usr/bin/ping
/usr/bin/pkexec
```

**–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞:**
- `/tmp` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å SUID!
- `/home` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∞–π–ª—ã, –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å SUID!
- –õ—é–±—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (`.sh`, `.py`) —Å SUID ‚Äî –û–ß–ï–ù–¨ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ!

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: SUID/SGID Audit

**–ó–∞–¥–∞–Ω–∏–µ: –ù–∞–π–¥–∏ –≤—Å–µ SUID —Ñ–∞–π–ª—ã –∏ –ø—Ä–æ–≤–µ—Ä—å –Ω–∞ suspicious**

**–®–∞–≥ 1: –ü–æ–∏—Å–∫ SUID —Ñ–∞–π–ª–æ–≤**

```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ SUID —Ñ–∞–π–ª—ã
find / -perm -4000 -type f 2>/dev/null

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª
find / -perm -4000 -type f 2>/dev/null | sort > /tmp/suid_files.txt
```

**–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ**

```bash
# –°–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö SUID —Ñ–∞–π–ª–æ–≤
cat > /tmp/safe_suid.txt << 'EOF'
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/su
/usr/bin/mount
/usr/bin/umount
/usr/bin/ping
EOF

# –ù–∞–π—Ç–∏ —Ñ–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ safe list
comm -23 /tmp/suid_files.txt /tmp/safe_suid.txt
```

**–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞**

```bash
# SUID —Ñ–∞–π–ª—ã –≤ /tmp
find /tmp -perm -4000 -type f 2>/dev/null

# SUID —Ñ–∞–π–ª—ã –≤ /home
find /home -perm -4000 -type f 2>/dev/null

# –ï—Å–ª–∏ –Ω–∞—à—ë–ª ‚Äî ALERT!
```

**–®–∞–≥ 4: –°–æ–∑–¥–∞—Ç—å baseline**

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –±—É–¥—É—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
sudo find / -perm -4000 -type f 2>/dev/null | sort > /root/suid_baseline.txt
```

**–®–∞–≥ 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–¥–æ–±–∞–≤–∏—Ç—å –≤ cron)**

```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
cat > /usr/local/bin/check_suid.sh << 'EOF'
#!/bin/bash
NEW=$(find / -perm -4000 -type f 2>/dev/null | sort)
DIFF=$(diff /root/suid_baseline.txt <(echo "$NEW"))

if [ -n "$DIFF" ]; then
    echo "‚ö†Ô∏è ALERT: SUID files changed!"
    echo "$DIFF"
    # –û—Ç–ø—Ä–∞–≤–∏—Ç—å alert (email, Slack, etc.)
fi
EOF

chmod +x /usr/local/bin/check_suid.sh

# –î–æ–±–∞–≤–∏—Ç—å –≤ cron (–∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å)
echo "0 2 * * * /usr/local/bin/check_suid.sh" | sudo crontab -
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–ê–Ω–¥—Ä–µ–π:** *"–ü–æ—á–µ–º—É shell scripts —Å SUID –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ Linux?"*

<details>
<summary>üí≠ –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**

**Linux –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç SUID –Ω–∞ shell scripts!**

**–ü–æ—á–µ–º—É?**
Security feature. Shell scripts –ª–µ–≥–∫–æ —ç–∫—Å–ø–ª–æ–π—Ç–∏—Ç—å:

```bash
# suid_script.sh (–≤–ª–∞–¥–µ–ª–µ—Ü = root, SUID)
#!/bin/bash
echo "Hello"
```

**–≠–∫—Å–ø–ª–æ–π—Ç (–µ—Å–ª–∏ –±—ã SUID —Ä–∞–±–æ—Ç–∞–ª):**
```bash
# –ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–¥–º–µ–Ω—è–µ—Ç $PATH
export PATH=/tmp:$PATH

# –°–æ–∑–¥–∞—ë—Ç —Ñ–µ–π–∫–æ–≤—ã–π echo
cat > /tmp/echo << 'EOF'
#!/bin/bash
/bin/bash    # root shell!
EOF
chmod +x /tmp/echo

# –ó–∞–ø—É—Å–∫–∞–µ—Ç script
./suid_script.sh
# –í—ã–∑—ã–≤–∞–µ—Ç—Å—è /tmp/echo ‚Üí root shell!
```

**–ó–∞—â–∏—Ç–∞:**
Linux kernel –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç SUID –Ω–∞:
- Shell scripts (#!/bin/bash)
- Interpreted languages (#!/usr/bin/python, #!/usr/bin/perl)

**SUID —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞:**
- Compiled binaries (ELF executables)

**Aha! –º–æ–º–µ–Ω—Ç:**
–ï—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏—à—å shell script —Å SUID ‚Üí –ª–∏–±–æ –∫—Ç–æ-—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç —á—Ç–æ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ª–∏–±–æ —ç—Ç–æ –ø—Ä–∏–º–∞–Ω–∫–∞ (honeypot).

</details>

---

**–ê–Ω–¥—Ä–µ–π:**
*"–û—Ç–ª–∏—á–Ω–æ. Audit –∑–∞–≤–µ—Ä—à—ë–Ω. –¢–µ–ø–µ—Ä—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç –¥–ª—è –í–∏–∫—Ç–æ—Ä–∞."*

---

## üîÑ –¶–ò–ö–õ 8: –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç (10 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–í–∏–∫—Ç–æ—Ä** (–∑–≤–æ–Ω–æ–∫):
*"–ú–∞–∫—Å, –∫–∞–∫ —É—Å–ø–µ—Ö–∏? –ù–∞—Å—Ç—Ä–æ–∏–ª?"*

**–ú–∞–∫—Å:** *"–î–∞. –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã, sudo –æ–≥—Ä–∞–Ω–∏—á–µ–Ω, ACL –Ω–∞—Å—Ç—Ä–æ–µ–Ω, limits –ø—Ä–∏–º–µ–Ω–µ–Ω—ã."*

**–í–∏–∫—Ç–æ—Ä:**
*"–•–æ—Ä–æ—à–æ. –û—Ç–ø—Ä–∞–≤—å –º–Ω–µ –æ—Ç—á—ë—Ç. Security audit report. –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, –∫–∞–∫–∏–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏."*

**–ê–Ω–¥—Ä–µ–π:**
*"–ü–æ–∫–∞–∂—É –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å comprehensive report."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞

**ONE-LINER –æ—Ç—á—ë—Ç** (–∫–∞–∫ –≤ Episode 04):

```bash
{
  echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
  echo "        SECURITY AUDIT REPORT - EPISODE 09"
  echo "             Users & Permissions"
  echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
  echo
  echo "Operation: KERNEL SHADOWS"
  echo "Location: Saint Petersburg, Russia (LETI)"
  echo "Date: $(date)"
  echo "Auditor: Max Sokolov"
  echo "Mentor: Andrei Volkov"
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "1. USERS CREATED"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  for u in viktor alex anna dmitry; do
    if id "$u" &>/dev/null; then
      echo "‚úì $u: $(id $u)"
    fi
  done
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "2. GROUPS & MEMBERSHIP"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  for u in viktor alex anna dmitry; do
    if id "$u" &>/dev/null; then
      echo "$u: $(groups $u | cut -d: -f2)"
    fi
  done
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "3. SUDO CONFIGURATION"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "Alex: Limited to network commands"
  sudo ls -la /etc/sudoers.d/alex 2>/dev/null || echo "Not configured"
  echo "Anna: Limited to log reading"
  sudo ls -la /etc/sudoers.d/anna 2>/dev/null || echo "Not configured"
  echo "Dmitry: Limited to service management"
  sudo ls -la /etc/sudoers.d/dmitry 2>/dev/null || echo "Not configured"
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "4. ACL CONFIGURATION"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "Anna log access:"
  getfacl /var/log/auth.log 2>/dev/null | grep "user:anna" || echo "Not configured"
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "5. SHARED DIRECTORY"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  ls -ld /var/operations/shared 2>/dev/null || echo "Not created"
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "6. RESOURCE LIMITS"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "Alex limits:"
  sudo -i -u alex bash -c 'echo "  nofile: $(ulimit -n), nproc: $(ulimit -u)"'
  echo "Anna limits:"
  sudo -i -u anna bash -c 'echo "  nofile: $(ulimit -n), nproc: $(ulimit -u)"'
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "7. SUID/SGID AUDIT"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  suid_count=$(find / -perm -4000 -type f 2>/dev/null | wc -l)
  sgid_count=$(find / -perm -2000 -type f 2>/dev/null | wc -l)
  echo "SUID files found: $suid_count"
  echo "SGID files found: $sgid_count"
  echo "Baseline saved: /root/suid_baseline.txt"
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "8. SECURITY POSTURE"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "‚úì Principle of Least Privilege: Implemented"
  echo "‚úì Defense in Depth: Multiple security layers"
  echo "‚úì Separation of Duties: Role-based access"
  echo "‚úì Audit Trail: All sudo commands logged"
  echo
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "RECOMMENDATIONS"
  echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
  echo "1. Monitor SUID files weekly (diff baseline)"
  echo "2. Review sudo logs daily (/var/log/auth.log)"
  echo "3. Enforce strong password policy"
  echo "4. Enable auditd for detailed tracking"
  echo "5. Regular security audits (quarterly)"
  echo
  echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
  echo "                    END OF REPORT"
  echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
  echo
  echo "Signed: Max Sokolov, System Administrator"
  echo "        Andrei Volkov, Mentor (LETI)"
  echo
} > security_audit_ep09.txt

# –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç—á—ë—Ç
cat security_audit_ep09.txt
```

---

### –≠–ø–∏–ª–æ–≥: –ë–µ–ª–æ–µ —É—Ç—Ä–æ

**06:00. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥. –†–∞—Å—Å–≤–µ—Ç –Ω–∞–¥ –ù–µ–≤–æ–π.**

**–ê–Ω–¥—Ä–µ–π** (–ø—Ä–æ–≤–æ–∂–∞–µ—Ç –ú–∞–∫—Å–∞ –Ω–∞ –≤–æ–∫–∑–∞–ª):
*"–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞, –ú–∞–∫—Å. Permissions –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ. Principle of Least Privilege. Defense in Depth. Separation of Duties. –¢—ã –ø–æ–Ω—è–ª –æ—Å–Ω–æ–≤—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è."*

**–ú–∞–∫—Å:** *"–°–ø–∞—Å–∏–±–æ, –ê–Ω–¥—Ä–µ–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á. –ú–Ω–æ–≥–æ–µ —Å—Ç–∞–ª–æ –ø–æ–Ω—è—Ç–Ω–æ. –¢–µ–ø–µ—Ä—å –ø–æ–Ω–∏–º–∞—é –∫–∞–∫ –ö—Ä—ã–ª–æ–≤ –ø—Ä–æ–±—Ä–∞–ª—Å—è ‚Äî misconfigured permissions."*

**–ê–Ω–¥—Ä–µ–π:**
*"–ò–º–µ–Ω–Ω–æ. Root access –∫–∞–∫ –∑–∞—Ä—è–∂–µ–Ω–Ω—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç. –¢–µ–ø–µ—Ä—å —Ç—ã –∑–Ω–∞–µ—à—å –∫–∞–∫ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–¥–∞–≤–∞—Ç—å. –ù–æ –ø–æ–º–Ω–∏: –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –Ω–µ –ø—Ä–æ–¥—É–∫—Ç. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω."*

**–í–∏–∫—Ç–æ—Ä** (–∑–≤–æ–Ω–æ–∫):
*"–ú–∞–∫—Å, –æ—Ç—á—ë—Ç –ø–æ–ª—É—á–∏–ª. –û—Ç–ª–∏—á–Ω–æ. –¢–µ–ø–µ—Ä—å —è –º–æ–≥—É —Å–ø–∞—Ç—å —Å–ø–æ–∫–æ–π–Ω–æ. Permissions –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ. Kr—ã–ª–æ–≤ –±–æ–ª—å—à–µ –Ω–µ —Å–º–æ–∂–µ—Ç –ø—Ä–æ–Ω–∏–∫–Ω—É—Ç—å —á–µ—Ä–µ–∑ misconfigured accounts."*

**–ê–ª–µ–∫—Å:**
*"–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞. –ù–æ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Å–ª–æ–π –∑–∞—â–∏—Ç—ã. –î–∞–ª—å—à–µ ‚Äî –ø—Ä–æ—Ü–µ—Å—Å—ã, systemd, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥. –ì–æ—Ç–æ–≤—å—Å—è –∫ Episode 10."*

**LILITH:**
*"–ù–µ–ø–ª–æ—Ö–æ. Root ‚Äî —ç—Ç–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –Ω–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è. –¢—ã –Ω–∞—á–∏–Ω–∞–µ—à—å –ø–æ–Ω–∏–º–∞—Ç—å. –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ ‚Äî systemd. –ì–æ—Ç–æ–≤—å—Å—è."*

---

## üéì –ß—Ç–æ —Ç—ã –æ—Å–≤–æ–∏–ª

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏:
- ‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –≥—Ä—É–ø–ø—ã:** useradd, groupadd, usermod, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º
- ‚úÖ **Permissions:** chmod, chown, –≤–æ—Å—å–º–µ—Ä–∏—á–Ω–∞—è –∑–∞–ø–∏—Å—å, special bits (SUID, SGID, Sticky)
- ‚úÖ **Sudo:** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ /etc/sudoers.d/, Principle of Least Privilege
- ‚úÖ **ACL:** setfacl, getfacl, –≥—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ **Resource limits:** /etc/security/limits.conf, –∑–∞—â–∏—Ç–∞ –æ—Ç fork bomb
- ‚úÖ **PAM:** –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–æ–¥—É–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, pam_limits.so
- ‚úÖ **Security audit:** –ø–æ–∏—Å–∫ SUID/SGID —Ñ–∞–π–ª–æ–≤, baseline monitoring

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- ‚úÖ **Principle of Least Privilege** ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
- ‚úÖ **Defense in Depth** ‚Äî –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ (permissions + sudo + ACL + limits)
- ‚úÖ **Separation of Duties** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ —Ä–æ–ª—è–º
- ‚úÖ **Audit Trail** ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π

### –§–∏–ª–æ—Å–æ—Ñ–∏—è:
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ > –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (visudo, setfacl, PAM)
- ‚úÖ **Bash = –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äî –ù–ï –∑–∞–º–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä—É—Ç–∏–Ω—ã
- ‚úÖ **Security by design** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞, –Ω–µ afterthought

---

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### Man pages (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫ –ø—Ä–æ—á—Ç–µ–Ω–∏—é!):
```bash
man useradd      # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
man chmod        # –ò–∑–º–µ–Ω–µ–Ω–∏–µ permissions
man sudo         # Superuser do
man sudoers      # Sudo –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
man setfacl      # Set ACL
man getfacl      # Get ACL
man limits.conf  # Resource limits
man pam          # PAM overview
```

### Online —Ä–µ—Å—É—Ä—Å—ã:
- [Red Hat: User Management](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/managing-users-and-groups_configuring-basic-system-settings)
- [Ubuntu Server Guide: Security](https://ubuntu.com/server/docs/security-users)
- [Sudo Manual](https://www.sudo.ws/docs/man/sudoers.man/)
- [Arch Wiki: Access Control Lists](https://wiki.archlinux.org/title/Access_Control_Lists)

### –°–≤—è–∑–∞–Ω–Ω—ã–µ episodes:
- **Episode 04:** Package Management ‚Äî —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è "–∏—Å–ø–æ–ª—å–∑—É–π –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã"
- **Episode 10:** Processes & Systemd ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **Episode 12:** Backup & Recovery ‚Äî –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

**Episode 10: Processes & Systemd** –∂–¥—ë—Ç —Ç–µ–±—è!

–¢–µ–º—ã:
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (ps, top, htop, kill)
- Systemd units (.service, .timer)
- –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (journalctl)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã

---

<div align="center">

**"Root ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è. –≠—Ç–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å."**

‚Äî –ê–Ω–¥—Ä–µ–π –í–æ–ª–∫–æ–≤, –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä, –õ–≠–¢–ò

**Episode 09: Type B Complete! üéâ**

**–î–µ–Ω—å 17-18 / 60 –≤—ã–ø–æ–ª–Ω–µ–Ω!**

</div>

