# /etc/security/limits.conf — Ограничения ресурсов
# Episode 09: Пользователи и права доступа
#
# ⚠️ ЗАДАНИЕ: Заполни TODO секции ниже

# ============================================================================
# ФОРМАТ: <domain> <type> <item> <value>
# ============================================================================
# domain: username | @groupname | *
# type: soft | hard | -
# item: nproc (процессы) | nofile (файлы) | core (core dumps)
# value: число | unlimited

# ============================================================================
# TODO 1: Стандартные лимиты для всех пользователей
# ============================================================================

# Установи для ВСЕХ (*):
# - soft nproc: 2048
# - hard nproc: 4096
# - soft nofile: 4096
# - hard nofile: 65536
# - core: 0 (отключить core dumps для безопасности)

# ТВОЙ КОД ЗДЕСЬ:


# ============================================================================
# TODO 2: Лимиты для Алекса (network админ)
# ============================================================================

# Alex нужны повышенные лимиты для tcpdump, nmap:
# - soft nofile: 16384
# - hard nofile: 65536
# - soft nproc: 1500
# - hard nproc: 3000

# ТВОЙ КОД ЗДЕСЬ:


# ============================================================================
# TODO 3: Лимиты для Анны (forensics)
# ============================================================================

# Anna нужны умеренные лимиты (только чтение логов):
# - soft nproc: 500
# - hard nproc: 1000
# - soft nofile: 4096
# - hard nofile: 16384

# ТВОЙ КОД ЗДЕСЬ:


# ============================================================================
# TODO 4: Лимиты для Дмитрия (DevOps)
# ============================================================================

# Dmitry нужны высокие лимиты для Docker:
# - soft nproc: 2000
# - hard nproc: 4000
# - soft nofile: 16384
# - hard nofile: 65536

# ТВОЙ КОД ЗДЕСЬ:


# ============================================================================
# TODO 5: Root БЕЗ ограничений
# ============================================================================

# Root должен иметь unlimited для критических операций:
# - nofile: unlimited (soft и hard)
# - nproc: unlimited (soft и hard)

# ТВОЙ КОД ЗДЕСЬ:


# ============================================================================
# ИНСТРУКЦИИ ПО УСТАНОВКЕ (после заполнения TODO)
# ============================================================================

# 1. Backup оригинального файла:
#    sudo cp /etc/security/limits.conf /etc/security/limits.conf.backup

# 2. Копировать твой конфиг:
#    sudo cp limits.conf /etc/security/limits.conf

# 3. Права 644:
#    sudo chmod 644 /etc/security/limits.conf

# 4. Проверить PAM интеграцию:
#    grep pam_limits.so /etc/pam.d/common-session
#    Должна быть строка: session required pam_limits.so
#    Если нет:
#    echo "session required pam_limits.so" | sudo tee -a /etc/pam.d/common-session

# 5. КРИТИЧНО: Лимиты применяются при НОВОМ входе!
#    Нужен logout/login:
#    sudo -i -u alex
#    ulimit -n    # Проверить nofile
#    ulimit -u    # Проверить nproc
#    exit

# 6. Тест защиты от fork bomb (ТОЛЬКО В ТЕСТОВОЙ СРЕДЕ!):
#    ulimit -u 50
#    :(){ :|:& };:
#    Система должна остаться работоспособной

# ============================================================================
# ПОДСКАЗКИ
# ============================================================================

# Референс: solution/security/limits.conf
# Теория: README.md Цикл 6
# Зачем нужны limits: защита от DoS изнутри (fork bomb, file descriptor exhaustion)

# End of starter file

