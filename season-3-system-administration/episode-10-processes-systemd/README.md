# EPISODE 10: PROCESSES & SYSTEMD
## Season 3: System Administration | –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –†–æ—Å—Å–∏—è

> *"Init scripts ‚Äî —ç—Ç–æ –ø—Ä–æ—à–ª–æ–µ. SystemD ‚Äî —ç—Ç–æ –±—É–¥—É—â–µ–µ. –ò –Ω–∞—Å—Ç–æ—è—â–µ–µ."*
> ‚Äî **–ë–æ—Ä–∏—Å –ö—É–∑–Ω–µ—Ü–æ–≤**, SystemD Architect

---

## üìç –ö–æ–Ω—Ç–µ–∫—Å—Ç –º–∏—Å—Å–∏–∏

**–õ–æ–∫–∞—Ü–∏—è:** üá∑üá∫ **–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –†–æ—Å—Å–∏—è**
**–ú–µ—Å—Ç–æ:** –ö–æ–≤–æ—Ä–∫–∏–Ω–≥ –Ω–∞ –ù–µ–≤—Å–∫–æ–º –ø—Ä–æ—Å–ø–µ–∫—Ç–µ ‚Üí –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –õ–≠–¢–ò
**–î–µ–Ω—å –æ–ø–µ—Ä–∞—Ü–∏–∏:** **19-20** –∏–∑ 60
**–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:** **4-5 —á–∞—Å–æ–≤**
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ (–°—Ä–µ–¥–Ω—è—è)

**–ü–µ—Ä—Å–æ–Ω–∞–∂–∏:**
- **–ú–∞–∫—Å –°–æ–∫–æ–ª–æ–≤** ‚Äî –≤—ã, –∏–∑—É—á–∞–µ—Ç–µ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ë–æ—Ä–∏—Å –ö—É–∑–Ω–µ—Ü–æ–≤** ‚Äî SystemD –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä, ex-Red Hat contributor
- **–ê–Ω–Ω–∞ –ö–æ–≤–∞–ª–µ–≤–∞** ‚Äî forensics expert, –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ backdoor
- **–í–∏–∫—Ç–æ—Ä –ü–µ—Ç—Ä–æ–≤** ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ–ø–µ—Ä–∞—Ü–∏–∏
- **LILITH** ‚Äî AI-–ø–æ–º–æ—â–Ω–∏–∫ (—è!)

---

## üé¨ –°—é–∂–µ—Ç: –û—Ö–æ—Ç–∞ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å—ã-–ø—Ä–∏–∑—Ä–∞–∫–∏

### –î–µ–Ω—å 19. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥. 08:37 Moscow Time.

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ permissions (Episode 09), –ú–∞–∫—Å –ø–æ–ª—É—á–∞–µ—Ç —Å—Ä–æ—á–Ω—ã–π –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ –æ—Ç –ê–Ω–Ω—ã.

**–ê–Ω–Ω–∞ –ö–æ–≤–∞–ª–µ–≤–∞** (–≤–∑–≤–æ–ª–Ω–æ–≤–∞–Ω–Ω–æ):
*"–ú–∞–∫—Å, –º—ã –Ω–∞—à–ª–∏ –µ—â—ë –æ–¥–∏–Ω backdoor! –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –ü–∏—Ç–µ—Ä–µ –∑–∞–ø—É—â–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å `sshd_backup`. PID 6623. –í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –æ–±—ã—á–Ω—ã–π SSH –¥–µ–º–æ–Ω, –Ω–æ —ç—Ç–æ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞. –ö—Ä—ã–ª–æ–≤ –ø—Ä—è—á–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–¥ –∏–º–µ–Ω–∞–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–ª—É–∂–±."*

**–ú–∞–∫—Å:**
*"–ö–∞–∫ –æ–Ω —Ç—É–¥–∞ –ø–æ–ø–∞–ª? –ú—ã –∂–µ –∑–∞–∫—Ä—ã–ª–∏ –≤—Å–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏!"*

**–ê–Ω–Ω–∞:**
*"Backdoor –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –î–û —Ç–æ–≥–æ –∫–∞–∫ –º—ã –≤–∑—è–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å. –ó–∞–ø—É—â–µ–Ω –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å sudo –ø—Ä–∞–≤–∞–º–∏. –¢—ã –¥–æ–ª–∂–µ–Ω –Ω–∞—É—á–∏—Ç—å—Å—è —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–∞—Ö. –ò–Ω–∞—á–µ —Å–ª–µ–¥—É—é—â—É—é –∞—Ç–∞–∫—É –º—ã –Ω–µ –∑–∞–º–µ—Ç–∏–º –≤–æ–≤—Ä–µ–º—è."*

**–í–∏–∫—Ç–æ—Ä –ü–µ—Ç—Ä–æ–≤:**
*"–ú–∞–∫—Å, –≤ –ü–∏—Ç–µ—Ä–µ –µ—Å—Ç—å —á–µ–ª–æ–≤–µ–∫ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å. –ë–æ—Ä–∏—Å –ö—É–∑–Ω–µ—Ü–æ–≤. Ex-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ Red Hat, —Ä–∞–±–æ—Ç–∞–ª –Ω–∞–¥ systemd –≤ 2013-2017. –û–Ω –Ω–∞—É—á–∏—Ç —Ç–µ–±—è —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –í—ã–µ–∑–∂–∞–π –≤ –∫–æ–≤–æ—Ä–∫–∏–Ω–≥ –Ω–∞ –ù–µ–≤—Å–∫–æ–º, 122."*

---

### 10:00. –í—Å—Ç—Ä–µ—á–∞ —Å –ë–æ—Ä–∏—Å–æ–º –ö—É–∑–Ω–µ—Ü–æ–≤—ã–º.

–ú–∞–∫—Å –≤—Ö–æ–¥–∏—Ç –≤ –ø—Ä–æ—Å—Ç–æ—Ä–Ω—ã–π –∫–æ–≤–æ—Ä–∫–∏–Ω–≥. –ó–∞ —Å—Ç–æ–ª–æ–º —É –æ–∫–Ω–∞ —Å–∏–¥–∏—Ç –º—É–∂—á–∏–Ω–∞ ~35 –ª–µ—Ç: –±–æ—Ä–æ–¥–∞, —Ç–æ–ª—Å—Ç–æ–≤–∫–∞ —Å –Ω–∞–¥–ø–∏—Å—å—é **"systemd or die"**, MacBook Pro —Å Fedora Linux.

**–ë–æ—Ä–∏—Å** (—ç–Ω–µ—Ä–≥–∏—á–Ω–æ –ø–æ–∂–∏–º–∞—è —Ä—É–∫—É):
*"–ú–∞–∫—Å! –í–∏–∫—Ç–æ—Ä —Ä–∞—Å—Å–∫–∞–∑–∞–ª –æ –≤–∞—à–µ–π –ø—Ä–æ–±–ª–µ–º–µ. Backdoor –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å–∏–∫–∞. –ù–æ –µ—Å–ª–∏ —Ç—ã –ü–û–ù–ò–ú–ê–ï–®–¨ systemd, —Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –í–°–Å. Init scripts ‚Äî —ç—Ç–æ –ø—Ä–æ—à–ª–æ–µ. Systemd ‚Äî —ç—Ç–æ —Ñ–∞–∫—Ç."*

**–ú–∞–∫—Å:**
*"–Ø —Å–ª—ã—à–∞–ª –º–Ω–æ–≥–æ —Å–ø–æ—Ä–æ–≤ –ø—Ä–æ systemd. –ì–æ–≤–æ—Ä—è—Ç –æ–Ω —Å–ª–∏—à–∫–æ–º –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π..."*

**–ë–æ—Ä–∏—Å** (—É—Å–º–µ—Ö–∞–µ—Ç—Å—è):
*"–°–ø–æ—Ä—ã ‚Äî —ç—Ç–æ —ç–º–æ—Ü–∏–∏ —Å—Ç–∞—Ä–æ–π –≥–≤–∞—Ä–¥–∏–∏. SystemD ‚Äî —ç—Ç–æ —Ñ–∞–∫—Ç. Ubuntu, Fedora, Debian, RHEL ‚Äî –≤—Å–µ –ø–µ—Ä–µ—à–ª–∏. –ó–Ω–∞–µ—à—å –ø–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –†–ê–ë–û–¢–ê–ï–¢. –î–∞, –æ–Ω —Å–ª–æ–∂–Ω–µ–µ —á–µ–º init scripts. –ù–æ –æ–Ω –¥–∞—ë—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ö–ê–ñ–î–´–ú –∞—Å–ø–µ–∫—Ç–æ–º –ø—Ä–æ—Ü–µ—Å—Å–∞: —Ä–µ—Å—É—Ä—Å—ã, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –ª–æ–≥–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏."*

**–ê–Ω–Ω–∞** (–≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫):
*"–ë–æ—Ä–∏—Å –ø—Ä–∞–≤. –Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ journalctl –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –ë–µ–∑ systemd —è –±—ã –Ω–µ —É–≤–∏–¥–µ–ª–∞ 80% –∞—Ç–∞–∫."*

**–ë–æ—Ä–∏—Å:**
*"–î–∞–≤–∞–π –ø–æ –ø–æ—Ä—è–¥–∫—É. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Äî —á—Ç–æ —ç—Ç–æ, –∫–∞–∫ –æ–Ω–∏ –∂–∏–≤—É—Ç –≤ –ø–∞–º—è—Ç–∏. –ü–æ—Ç–æ–º systemd ‚Äî –∫–∞–∫ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Ä–≤–∏—Å–∞–º–∏ production-grade. –ü–æ—Ç–æ–º journalctl ‚Äî –∫–∞–∫ —á–∏—Ç–∞—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –ö –∫–æ–Ω—Ü—É –¥–Ω—è —Ç—ã –±—É–¥–µ—à—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ."*

–ë–æ—Ä–∏—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ—É—Ç–±—É–∫ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª.

**–ë–æ—Ä–∏—Å:**
*"–ü—Ä–æ—Ü–µ—Å—Å ‚Äî —ç—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –£ –∫–∞–∂–¥–æ–≥–æ –µ—Å—Ç—å PID, owner, parent, –¥–µ—Ç–∏. Linux ‚Äî —ç—Ç–æ –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ö–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ ‚Äî systemd (PID 1). –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –≤–µ—Ç–≤–∏."*

---

## üéØ –¢–≤–æ—è –º–∏—Å—Å–∏—è

–ù–∞—É—á–∏—Ç—å—Å—è **—É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏** –Ω–∞ production Linux —Å–µ—Ä–≤–µ—Ä–µ.

**–¶–µ–ª–∏:**
1. ‚úÖ –ü–æ–Ω—è—Ç—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ Linux (PID, PPID, –¥–µ—Ä–µ–≤–æ)
2. ‚úÖ –ù–∞–π—Ç–∏ –∏ —É–±–∏—Ç—å backdoor –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç –ö—Ä—ã–ª–æ–≤–∞
3. ‚úÖ –°–æ–∑–¥–∞—Ç—å production-ready systemd service –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å systemd timer (–∑–∞–º–µ–Ω–∞ cron)
5. ‚úÖ –ù–∞—É—á–∏—Ç—å—Å—è –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ —á–µ—Ä–µ–∑ journalctl
6. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å resource limits –∏ security hardening

**–ò—Ç–æ–≥:**
Production-ready –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–ø—É—Å–∫–æ–º, resource limits, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
episode-10-processes-systemd/
‚îú‚îÄ‚îÄ README.md                  # üìñ –¢–µ–æ—Ä–∏—è + –∑–∞–¥–∞–Ω–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îÇ
‚îú‚îÄ‚îÄ starter/                   # üéØ –ù–ê–ß–ù–ò –ó–î–ï–°–¨!
‚îÇ   ‚îú‚îÄ‚îÄ systemd/               # SystemD units —Å TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shadow-backup.service      # Backup task (Type=oneshot)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shadow-backup.timer        # Scheduler –¥–ª—è backup
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shadow-monitor.service     # Monitoring daemon (Type=simple)
‚îÇ   ‚îî‚îÄ‚îÄ README.md              # üìã Workflow: –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å starter
‚îÇ
‚îú‚îÄ‚îÄ solution/                  # ‚úÖ –†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–Ω–µ –ø–æ–¥–≥–ª—è–¥—ã–≤–∞–π!)
‚îÇ   ‚îú‚îÄ‚îÄ systemd/               # –ì–æ—Ç–æ–≤—ã–µ systemd units
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shadow-backup.service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shadow-backup.timer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shadow-monitor.service
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ README.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è solution
‚îÇ   ‚îú‚îÄ‚îÄ process_manager.sh     # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îî‚îÄ‚îÄ README.md              # –ü–æ–ª–Ω—ã–π workflow —Ä–µ—à–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ artifacts/                 # üóÇÔ∏è –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ
‚îî‚îÄ‚îÄ tests/                     # üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã
    ‚îî‚îÄ‚îÄ test.sh                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–≤–æ–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è
```

### üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å?

1. **–ü—Ä–æ—á–∏—Ç–∞–π —Ç–µ–æ—Ä–∏—é** –≤ —ç—Ç–æ–º README (8 micro-cycles –Ω–∏–∂–µ)
2. **–û—Ç–∫—Ä–æ–π `starter/README.md`** ‚Äî —Ç–∞–º –ø–æ–ª–Ω—ã–π workflow —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
3. **–ó–∞–ø–æ–ª–Ω–∏ TODO** –≤ systemd units (`starter/systemd/`)
4. **–£—Å—Ç–∞–Ω–æ–≤–∏ units** –≤ `/etc/systemd/system/`
5. **–¢–µ—Å—Ç–∏—Ä—É–π** —á–µ—Ä–µ–∑ `systemctl` –∏ `journalctl`
6. **–ó–∞–ø—É—Å—Ç–∏ –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã** `./tests/test.sh`

---

## üéì –§–∏–ª–æ—Å–æ—Ñ–∏—è Episode: Type B ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–π –Ω–∞–ø—Ä—è–º—É—é

**Episode 10 ‚Äî —ç—Ç–æ Type B episode.**

‚ùå **–ù–ï –ø–∏—à–∏ bash wrapper –≤–æ–∫—Ä—É–≥ systemctl!**
‚úÖ **–£—á–∏—Å—å –ø–∏—Å–∞—Ç—å systemd units –Ω–∞–ø—Ä—è–º—É—é!**

**–ü–æ—á–µ–º—É?**
- SystemD units ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤ Linux (Ubuntu, RHEL, Fedora, Debian)
- Production —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç systemd, –Ω–µ custom bash scripts
- Bash –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥, –ù–ï –¥–ª—è –∑–∞–º–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–ë–æ—Ä–∏—Å:**
*"Systemd —É–∂–µ —É–º–µ–µ—Ç –≤—Å—ë: –∑–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, resource limits, –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫. –ù–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–π –µ–≥–æ –≤ bash. –ü—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ."*

---

## üìö –¢–ï–û–†–ò–Ø: 8 MICRO-CYCLES

### –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ü–∏–∫–ª–∞–º:
- **–¶–∏–∫–ª 1:** –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (10 –º–∏–Ω) ‚Üí –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Ü–µ—Å—Å
- **–¶–∏–∫–ª 2:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (15 –º–∏–Ω) ‚Üí ps, top, kill
- **–¶–∏–∫–ª 3:** SystemD Service Units (20 –º–∏–Ω) ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ .service
- **–¶–∏–∫–ª 4:** SystemD Timers (15 –º–∏–Ω) ‚Üí –ó–∞–º–µ–Ω–∞ cron
- **–¶–∏–∫–ª 5:** Resource Limits & Security (20 –º–∏–Ω) ‚Üí CPUQuota, NoNewPrivileges
- **–¶–∏–∫–ª 6:** Journalctl (15 –º–∏–Ω) ‚Üí –õ–æ–≥–∏ –∏ troubleshooting
- **–¶–∏–∫–ª 7:** –ü—Ä–∞–∫—Ç–∏–∫–∞ (20 –º–∏–Ω) ‚Üí –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ starter/ units
- **–¶–∏–∫–ª 8:** –§–∏–Ω–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (10 –º–∏–Ω) ‚Üí Production-ready setup

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~2 —á–∞—Å–∞ —Ç–µ–æ—Ä–∏–∏ + 2-3 —á–∞—Å–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏ = **4-5 —á–∞—Å–æ–≤**

---

## üîÑ –¶–ò–ö–õ 1: –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (10-15 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ë–æ—Ä–∏—Å** (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª):
*"–°–º–æ—Ç—Ä–∏. –°–µ–π—á–∞—Å –Ω–∞ —ç—Ç–æ–º –Ω–æ—É—Ç–±—É–∫–µ —Ä–∞–±–æ—Ç–∞–µ—Ç 287 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ö–∞–∂–¥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å. –ë—Ä–∞—É–∑–µ—Ä ‚Äî –ø—Ä–æ—Ü–µ—Å—Å. –¢–≤–æ–π bash ‚Äî –ø—Ä–æ—Ü–µ—Å—Å. Systemd ‚Äî –ø—Ä–æ—Ü–µ—Å—Å. Linux ‚Äî —ç—Ç–æ –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤."*

```bash
$ pstree -p
systemd(1)‚îÄ‚î¨‚îÄsystemd-journal(342)
           ‚îú‚îÄsshd(1024)‚îÄ‚îÄ‚îÄsshd(6623)‚îÄ‚îÄ‚îÄbash(6624)
           ‚îú‚îÄnginx(1456)‚îÄ‚î¨‚îÄnginx(1457)
           ‚îÇ             ‚îú‚îÄnginx(1458)
           ‚îÇ             ‚îî‚îÄnginx(1459)
           ‚îî‚îÄfirefox(8821)‚îÄ‚î¨‚îÄfirefox(8822)
                           ‚îú‚îÄfirefox(8823)
                           ‚îî‚îÄfirefox(8824)
```

**–ë–æ—Ä–∏—Å:**
*"–í–∏–¥–∏—à—å? Systemd (PID 1) ‚Äî –∫–æ—Ä–µ–Ω—å. –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –µ–≥–æ –¥–µ—Ç–∏, –≤–Ω—É–∫–∏, –ø—Ä–∞–≤–Ω—É–∫–∏. –ï—Å–ª–∏ systemd —É–º—Ä—ë—Ç ‚Äî –≤—Å—è —Å–∏—Å—Ç–µ–º–∞ —É–º—Ä—ë—Ç. –û–Ω ‚Äî –≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å."*

---

### üìö –¢–µ–æ—Ä–∏—è: –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Ü–µ—Å—Å?

#### üè≠ –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ü—Ä–æ—Ü–µ—Å—Å = –†–∞–±–æ—á–∏–π –Ω–∞ —Ñ–∞–±—Ä–∏–∫–µ

–ü—Ä–µ–¥—Å—Ç–∞–≤—å Linux —Å–∏—Å—Ç–µ–º—É –∫–∞–∫ **–≥–∏–≥–∞–Ω—Ç—Å–∫—É—é —Ñ–∞–±—Ä–∏–∫—É**.

```
üè≠ LINUX FACTORY
‚îÇ
‚îú‚îÄ üë∑ –†–∞–±–æ—á–∏–π #1 (PID 1) ‚Äî "Systemd"
‚îÇ  ‚îú‚îÄ üë∑ –†–∞–±–æ—á–∏–π #342 ‚Äî "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç" (–ø–∏—à–µ—Ç –ª–æ–≥–∏)
‚îÇ  ‚îú‚îÄ üë∑ –†–∞–±–æ—á–∏–π #1024 ‚Äî "–û—Ö—Ä–∞–Ω–Ω–∏–∫ SSH" (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥—ã)
‚îÇ  ‚îÇ  ‚îî‚îÄ üë∑ –†–∞–±–æ—á–∏–π #6623 ‚Äî "–ü–æ–º–æ—â–Ω–∏–∫ –æ—Ö—Ä–∞–Ω–Ω–∏–∫–∞"
‚îÇ  ‚îú‚îÄ üë∑ –†–∞–±–æ—á–∏–µ #1456-1459 ‚Äî "Nginx (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)"
‚îÇ  ‚îî‚îÄ üë∑ –†–∞–±–æ—á–∏–µ #8821-8824 ‚Äî "Firefox (–±—Ä–∞—É–∑–µ—Ä)"
```

**–ö–∞–∂–¥—ã–π —Ä–∞–±–æ—á–∏–π:**
- –ò–º–µ–µ—Ç **–±–µ–π–¥–∂ —Å –Ω–æ–º–µ—Ä–æ–º** (PID = Process ID)
- –ó–Ω–∞–µ—Ç **–∫—Ç–æ –µ–≥–æ –Ω–∞–Ω—è–ª** (PPID = Parent Process ID)
- –í—ã–ø–æ–ª–Ω—è–µ—Ç **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É** (–ø—Ä–æ–≥—Ä–∞–º–º–∞)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ä–µ—Å—É—Ä—Å—ã** (CPU, –ø–∞–º—è—Ç—å, —Ñ–∞–π–ª—ã)
- –ú–æ–∂–µ—Ç **—Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–º–æ—â–Ω–∏–∫–æ–≤** (child processes)
- –ú–æ–∂–µ—Ç **—É–º–µ—Ä–µ—Ç—å** (–∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è) –∏–ª–∏ **–±—ã—Ç—å —É–≤–æ–ª–µ–Ω** (kill)

**–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä = –¥–∏—Ä–µ–∫—Ç–æ—Ä —Ñ–∞–±—Ä–∏–∫–∏.**
–¢—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –∫—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç, –∫–æ–≥–æ –Ω–∞–Ω—è—Ç—å, –∫–æ–≥–æ —É–≤–æ–ª–∏—Ç—å.

---

#### üéØ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã

##### 1. **PID (Process ID)**

**–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä** –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

```bash
$ ps aux | head -3
USER       PID  %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1   0.0  0.1 169064 13944 ?        Ss   10:00   0:01 /sbin/systemd
root       342   0.0  0.0  45780  6124 ?        Ss   10:00   0:00 systemd-journal
```

- **PID 1** ‚Äî –≤—Å–µ–≥–¥–∞ systemd (–∏–ª–∏ init)
- **PID 342** ‚Äî systemd-journald (–ª–æ–≥–∏)
- **PID 6623** ‚Äî backdoor –ø—Ä–æ—Ü–µ—Å—Å –ö—Ä—ã–ª–æ–≤–∞ (!)

**–ë–æ—Ä–∏—Å:**
*"–ï—Å–ª–∏ —Ç—ã –∑–Ω–∞–µ—à—å PID ‚Äî —Ç—ã –º–æ–∂–µ—à—å —É–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å. `kill 6623`. –ù–æ —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–¥–æ –µ–≥–æ –Ω–∞–π—Ç–∏."*

---

##### 2. **PPID (Parent Process ID)**

**–ö—Ç–æ —Å–æ–∑–¥–∞–ª —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å?**

```bash
$ ps -o pid,ppid,cmd
  PID  PPID CMD
    1     0 /sbin/systemd
 1024     1 /usr/sbin/sshd
 6623  1024 /tmp/sshd_backup  ‚Üê backdoor! Parent = sshd
 6624  6623 bash
```

**–î–µ—Ä–µ–≤–æ:**
```
systemd (1)
 ‚îî‚îÄ sshd (1024)
     ‚îî‚îÄ sshd_backup (6623)  ‚Üê –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û!
         ‚îî‚îÄ bash (6624)
```

**–ê–Ω–Ω–∞:**
*"–í–∏–¥–∏—à—å? Backdoor (6623) –∑–∞–ø—É—â–µ–Ω –æ—Ç sshd (1024). –ö—Ç–æ-—Ç–æ –∑–∞—à—ë–ª —á–µ—Ä–µ–∑ SSH –∏ –∑–∞–ø—É—Å—Ç–∏–ª –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –≠—Ç–æ –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏."*

---

##### 3. **Process States (—Å–æ—Å—Ç–æ—è–Ω–∏—è)**

–ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö:

| –°–æ—Å—Ç–æ—è–Ω–∏–µ | –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|-----|----------|
| **Running** | `R` | –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–µ–π—á–∞—Å (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç CPU) |
| **Sleeping** | `S` | –ñ–¥—ë—Ç —Å–æ–±—ã—Ç–∏—è (I/O, —Å–∏–≥–Ω–∞–ª) |
| **Stopped** | `T` | –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (Ctrl+Z) |
| **Zombie** | `Z` | –ó–∞–≤–µ—Ä—à–∏–ª—Å—è, –Ω–æ parent –Ω–µ –∑–∞–±—Ä–∞–ª exit code |
| **Dead** | ‚Äî | –ü—Ä–æ—Ü–µ—Å—Å –±–æ–ª—å—à–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |

```bash
$ ps aux | grep -E 'STAT|nginx'
USER       PID  %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root      1456   0.0  0.1 125696  8420 ?        Ss   10:00   0:00 nginx: master
www-data  1457   0.0  0.0 126144  5632 ?        S    10:00   0:00 nginx: worker
```

- **`Ss`** ‚Äî Sleeping (–∂–¥—ë—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π), session leader
- **`S`** ‚Äî Sleeping (worker –∂–¥—ë—Ç –∑–∞–¥–∞—á –æ—Ç master)

**–ë–æ—Ä–∏—Å:**
*"Zombie –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Äî —ç—Ç–æ –º—ë—Ä—Ç–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ '–ø–æ—Ö–æ—Ä–æ–Ω–µ–Ω—ã'. Parent –¥–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å wait(). –ï—Å–ª–∏ zombies –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è ‚Äî —ç—Ç–æ bug –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ."*

---

##### 4. **–î–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**

Linux –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –≤ **–¥–µ—Ä–µ–≤–æ** (tree).

```
     systemd (PID 1)
     /      |      \
   ssh    nginx   cron
   /
 bash
  |
 vim
```

**–ë–æ—Ä–∏—Å:**
*"Systemd ‚Äî —ç—Ç–æ –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞. –ï—Å–ª–∏ —É–±–∏—Ç—å systemd (kill -9 1) ‚Äî —Å–∏—Å—Ç–µ–º–∞ —É–º—Ä—ë—Ç. –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—É—á–∞—Ç SIGTERM –∏ –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è. Kernel –ø–∞–Ω–∏–∫—É–µ—Ç."*

**–ü–æ–ª–µ–∑–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞:**
```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pstree -p

# –î–µ—Ä–µ–≤–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
pstree -p 1024  # –¥–µ—Ä–µ–≤–æ –¥–ª—è sshd
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ò–Ω—Å–ø–µ–∫—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ó–∞–¥–∞–Ω–∏–µ:** –ù–∞–π–¥–∏ backdoor –ø—Ä–æ—Ü–µ—Å—Å `sshd_backup` (–∏–ª–∏ –ª—é–±–æ–π –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å).

#### –®–∞–≥ 1: –ü–æ—Å–º–æ—Ç—Ä–∏ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

```bash
# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux

# –¢–æ–ª—å–∫–æ sshd –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep sshd

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: pgrep
pgrep -a sshd
```

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å?**
- ‚ùå –ü—Ä–æ—Ü–µ—Å—Å —Å –∏–º–µ–Ω–µ–º –ø–æ—Ö–æ–∂–∏–º –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–π (sshd_backup, cron_worker)
- ‚ùå –ü—Ä–æ—Ü–µ—Å—Å –≤ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–º –º–µ—Å—Ç–µ (`/tmp/`, `/home/user/.hidden/`)
- ‚ùå –ü—Ä–æ—Ü–µ—Å—Å –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∞–≤–∞–º–∏ root

---

#### –®–∞–≥ 2: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

```bash
# –ù–∞–π—Ç–∏ PID
suspicious_pid=$(pgrep -f sshd_backup)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É
ls -l /proc/$suspicious_pid/exe

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
cat /proc/$suspicious_pid/cmdline | tr '\0' ' '

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å environment variables
cat /proc/$suspicious_pid/environ | tr '\0' '\n'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã
sudo lsof -p $suspicious_pid
```

**–ë–æ—Ä–∏—Å:**
*"`/proc` ‚Äî —ç—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞. Kernel —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –∫–∞–∫ —Ñ–∞–π–ª—ã. `/proc/PID/` —Å–æ–¥–µ—Ä–∂–∏—Ç –í–°–Å –æ –ø—Ä–æ—Ü–µ—Å—Å–µ."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –ß—Ç–æ —Ç–∞–∫–æ–µ PID 1 –∏ –ø–æ—á–µ–º—É –µ–≥–æ –Ω–µ–ª—å–∑—è —É–±–∏—Ç—å?

<details>
<summary>üí° –î—É–º–∞–π 30 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**
PID 1 ‚Äî —ç—Ç–æ **systemd** (–∏–ª–∏ init), –ø–µ—Ä–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç kernel –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏.

**–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —É–±–∏—Ç—å:**
- –≠—Ç–æ –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Äî –µ–≥–æ –¥–µ—Ç–∏ (–ø—Ä—è–º—ã–µ –∏–ª–∏ –∫–æ—Å–≤–µ–Ω–Ω—ã–µ)
- –ï—Å–ª–∏ PID 1 —É–º—Ä—ë—Ç ‚Üí kernel –ø–∞–Ω–∏–∫—É–µ—Ç ‚Üí —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- Linux kernel –∑–∞—â–∏—â–∞–µ—Ç PID 1 –æ—Ç –æ–±—ã—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤

**–ë–æ—Ä–∏—Å:** *"Systemd ‚Äî —ç—Ç–æ —Å–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º—ã. –ï—Å–ª–∏ —Å–µ—Ä–¥—Ü–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è ‚Äî —Å–º–µ—Ä—Ç—å."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–æ–º –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `R` –∏ `S`?

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary>

**–û—Ç–≤–µ—Ç:**
- **`R` (Running):** –ü—Ä–æ—Ü–µ—Å—Å –°–ï–ô–ß–ê–° –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CPU, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- **`S` (Sleeping):** –ü—Ä–æ—Ü–µ—Å—Å –ñ–î–Å–¢ —Å–æ–±—ã—Ç–∏—è (I/O, —Å–∏–≥–Ω–∞–ª, timeout)

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞:**
- `R` = —Ä–∞–±–æ—á–∏–π –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –∫–æ–Ω–≤–µ–π–µ—Ä–µ
- `S` = —Ä–∞–±–æ—á–∏–π –∂–¥—ë—Ç –∫–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç —Å–ª–µ–¥—É—é—â–∞—è –¥–µ—Ç–∞–ª—å

**–ü—Ä–∏–º–µ—Ä:**
- –í–µ–±-—Å–µ—Ä–≤–µ—Ä nginx: —Å–æ—Å—Ç–æ—è–Ω–∏–µ `S` (–∂–¥—ë—Ç HTTP –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è gcc: —Å–æ—Å—Ç–æ—è–Ω–∏–µ `R` (–∞–∫—Ç–∏–≤–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –∫–æ–¥)

**–ë–æ—Ä–∏—Å:** *"–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ 99% –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ S. –¢–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ R."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ß—Ç–æ —Ç–∞–∫–æ–µ zombie –ø—Ä–æ—Ü–µ—Å—Å?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**Zombie (Z) –ø—Ä–æ—Ü–µ—Å—Å:**
- –ü—Ä–æ—Ü–µ—Å—Å **–∑–∞–≤–µ—Ä—à–∏–ª—Å—è**, –Ω–æ –µ–≥–æ parent –µ—â—ë **–Ω–µ –∑–∞–±—Ä–∞–ª exit code**
- –ó–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –Ω–æ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CPU/–ø–∞–º—è—Ç—å
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ `<defunct>` –≤ `ps`

**–ö–∞–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è:**
```
1. Child –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è (exit)
2. Kernel —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç exit code
3. Child –∂–¥—ë—Ç –ø–æ–∫–∞ parent –≤—ã–∑–æ–≤–µ—Ç wait()
4. –ü–æ–∫–∞ parent –Ω–µ –≤—ã–∑–≤–∞–ª wait() ‚Äî child = zombie
```

**–ö–∞–∫ —É–±–∏—Ç—å zombie:**
‚ùå `kill -9 zombie_pid` ‚Äî –ù–ï –†–ê–ë–û–¢–ê–ï–¢ (–ø—Ä–æ—Ü–µ—Å—Å —É–∂–µ –º—ë—Ä—Ç–≤!)
‚úÖ –£–±–∏—Ç—å parent –ø—Ä–æ—Ü–µ—Å—Å ‚Üí systemd "—É—Å—ã–Ω–æ–≤–∏—Ç" zombie ‚Üí zombie –∏—Å—á–µ–∑–Ω–µ—Ç

**–ë–æ—Ä–∏—Å:** *"Zombies –Ω–µ –æ–ø–∞—Å–Ω—ã, –Ω–æ –µ—Å–ª–∏ –∏—Ö —Å–æ—Ç–Ω–∏ ‚Äî —ç—Ç–æ bug –≤ parent –ø—Ä–æ–≥—Ä–∞–º–º–µ. –û–Ω–∞ –∑–∞–±—ã–≤–∞–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å wait()."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 1

- [ ] –ü–æ–Ω—è–ª —á—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Ü–µ—Å—Å (–ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤ –ø–∞–º—è—Ç–∏)
- [ ] –ó–Ω–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ PID, PPID
- [ ] –ü–æ–Ω–∏–º–∞—é –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (systemd = –∫–æ—Ä–µ–Ω—å)
- [ ] –£–º–µ—é –Ω–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ `ps`, `pgrep`
- [ ] –ú–æ–≥—É –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —á–µ—Ä–µ–∑ `/proc/PID/`

**LILITH:**
*"–ü—Ä–æ—Ü–µ—Å—Å ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–º–∞–Ω–¥–∞. –≠—Ç–æ –∂–∏–≤–æ–π –æ–±—ä–µ–∫—Ç –≤ –ø–∞–º—è—Ç–∏. –£ –Ω–µ–≥–æ –µ—Å—Ç—å identity (PID), —Ä–æ–¥–∏—Ç–µ–ª–∏ (PPID), —Ä–µ—Å—É—Ä—Å—ã, —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ù–∞—É—á–∏—Å—å —á–∏—Ç–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –∫–∞–∫ –∫–Ω–∏–≥—É."*

---

## üîÑ –¶–ò–ö–õ 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (15-20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ë–æ—Ä–∏—Å** (–ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç):
*"–û–∫–µ–π, —Ç—ã –Ω–∞—à—ë–ª backdoor –ø—Ä–æ—Ü–µ—Å—Å. PID 6623. –ß—Ç–æ –¥–∞–ª—å—à–µ? –£–±–∏—Ç—å? –ù–µ —Ç–∞–∫ –±—ã—Å—Ç—Ä–æ. –í Linux –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å ‚Äî signals (—Å–∏–≥–Ω–∞–ª—ã)."*

**–ú–∞–∫—Å:**
*"Signals? –≠—Ç–æ –∫–∞–∫ `kill -9`?"*

**–ë–æ—Ä–∏—Å:**
*"Kill -9 ‚Äî —ç—Ç–æ SIGKILL. –ì—Ä—É–±–∞—è —Å–∏–ª–∞. '–í—ã—Å—Ç—Ä–µ–ª –≤ –≥–æ–ª–æ–≤—É'. –ü—Ä–æ—Ü–µ—Å—Å –ù–ï –º–æ–∂–µ—Ç –µ–≥–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å. –ù–æ –µ—Å—Ç—å –≤–µ–∂–ª–∏–≤—ã–π —Å–ø–æ—Å–æ–± ‚Äî SIGTERM. '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≤–µ—Ä—à–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ'. –ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∑–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª—ã, –ø–æ—á–∏—Å—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã."*

**–ê–Ω–Ω–∞:**
*"–í production –í–°–ï–ì–î–ê —Å–Ω–∞—á–∞–ª–∞ SIGTERM. –ü–æ—Ç–æ–º, –µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç ‚Äî SIGKILL. –ì—Ä—É–±–æ–µ —É–±–∏–π—Å—Ç–≤–æ –º–æ–∂–µ—Ç –ø–æ–≤—Ä–µ–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ."*

---

### üìö –¢–µ–æ—Ä–∏—è: Signals (—Å–∏–≥–Ω–∞–ª—ã)

#### üì® –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Signals = –°–æ–æ–±—â–µ–Ω–∏—è —Ä–∞–±–æ—á–∏–º

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —á—Ç–æ —Ç—ã ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä —Ñ–∞–±—Ä–∏–∫–∏. –¢—ã –Ω–µ –º–æ–∂–µ—à—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—á–µ–≥–æ. –ù–æ —Ç—ã –º–æ–∂–µ—à—å **–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–º—É —Å–æ–æ–±—â–µ–Ω–∏–µ**:

```
üì® –°–æ–æ–±—â–µ–Ω–∏—è (Signals):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–∫–æ–Ω—á–∏ —Ä–∞–±–æ—Ç—É"       ‚îÇ ‚Üê SIGTERM (15)
‚îÇ "–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ —Å–≤–æ—ë —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ"   ‚îÇ ‚Üê SIGHUP (1)
‚îÇ "–ù–ï–ú–ï–î–õ–ï–ù–ù–û –û–°–¢–ê–ù–û–í–ò–°–¨!"           ‚îÇ ‚Üê SIGKILL (9)
‚îÇ "–ü–∞—É–∑–∞, –ø–æ–¥–æ–∂–¥–∏ –∫–æ–º–∞–Ω–¥—ã"           ‚îÇ ‚Üê SIGSTOP (19)
‚îÇ "–ü—Ä–æ–¥–æ–ª–∂–∞–π —Ä–∞–±–æ—Ç—É"                 ‚îÇ ‚Üê SIGCONT (18)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–†–∞–±–æ—á–∏–π (–ø—Ä–æ—Ü–µ—Å—Å) –º–æ–∂–µ—Ç:
- ‚úÖ **–ü—Ä–∏–Ω—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å (–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å signal)
- ‚úÖ **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å** (–µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª –Ω–µ SIGKILL)
- ‚ùå **–ù–ï –º–æ–∂–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å** SIGKILL –∏ SIGSTOP (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ)

---

#### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã

| –°–∏–≥–Ω–∞–ª | –ù–æ–º–µ—Ä | –î–µ–π—Å—Ç–≤–∏–µ | –ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å? |
|--------|-------|----------|---------------------|
| **SIGTERM** | 15 | –í–µ–∂–ª–∏–≤–∞—è –ø—Ä–æ—Å—å–±–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è | ‚úÖ –î–∞ |
| **SIGKILL** | 9 | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–±–∏–π—Å—Ç–≤–æ | ‚ùå –ù–µ—Ç |
| **SIGHUP** | 1 | Reload –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | ‚úÖ –î–∞ |
| **SIGINT** | 2 | Interrupt (Ctrl+C) | ‚úÖ –î–∞ |
| **SIGSTOP** | 19 | –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å | ‚ùå –ù–µ—Ç |
| **SIGCONT** | 18 | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ—Å–ª–µ SIGSTOP | ‚Äî |
| **SIGUSR1/2** | 10/12 | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–∏–≥–Ω–∞–ª—ã | ‚úÖ –î–∞ |

---

#### üì° –ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª

##### –ö–æ–º–∞–Ω–¥–∞ `kill`

```bash
# SIGTERM (default, –≤–µ–∂–ª–∏–≤–æ)
kill 6623

# –¢–æ –∂–µ —Å–∞–º–æ–µ —è–≤–Ω–æ
kill -15 6623
kill -TERM 6623

# SIGKILL (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ)
kill -9 6623
kill -KILL 6623

# SIGHUP (reload –∫–æ–Ω—Ñ–∏–≥–∞)
kill -1 6623
kill -HUP 6623
```

**–ë–æ—Ä–∏—Å:**
*"`kill` ‚Äî –ø–ª–æ—Ö–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ. –û–Ω–æ –Ω–µ '—É–±–∏–≤–∞–µ—Ç', –æ–Ω–æ '–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª'. kill -HUP –Ω–µ —É–±–∏–≤–∞–µ—Ç, –∞ –ø—Ä–æ—Å–∏—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥."*

---

##### –ö–æ–º–∞–Ω–¥–∞ `killall` –∏ `pkill`

```bash
# –£–±–∏—Ç—å –í–°–ï –ø—Ä–æ—Ü–µ—Å—Å—ã —Å –∏–º–µ–Ω–µ–º "sshd_backup"
killall sshd_backup

# –¢–æ –∂–µ —á–µ—Ä–µ–∑ pkill (regex)
pkill -f sshd_backup

# –£–±–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è "attacker"
pkill -u attacker

# SIGTERM –¥–ª—è –≤—Å–µ—Ö nginx workers
killall -15 nginx
```

**‚ö†Ô∏è –û–°–¢–û–†–û–ñ–ù–û:**
`killall nginx` —É–±—å—ë—Ç –í–°–ï nginx –ø—Ä–æ—Ü–µ—Å—Å—ã (master + workers)!

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–±–∏–π—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

#### üìú –ê–ª–≥–æ—Ä–∏—Ç–º graceful shutdown

**–ü—Ä–∞–≤–∏–ª–æ:**
1Ô∏è‚É£ –°–Ω–∞—á–∞–ª–∞ SIGTERM (–≤–µ–∂–ª–∏–≤–æ)
2Ô∏è‚É£ –ü–æ–¥–æ–∂–¥–∏ 5-10 —Å–µ–∫—É–Ω–¥
3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—å –∂–∏–≤ –ª–∏ –µ—â—ë
4Ô∏è‚É£ –ï—Å–ª–∏ –∂–∏–≤ ‚Äî SIGKILL (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ)

```bash
#!/bin/bash

# –ù–∞–π—Ç–∏ PID backdoor –ø—Ä–æ—Ü–µ—Å—Å–∞
pid=$(pgrep -f sshd_backup)

if [[ -z "$pid" ]]; then
    echo "Process not found"
    exit 1
fi

echo "Found backdoor: PID $pid"
ps -p "$pid" -o pid,user,cmd

# –®–∞–≥ 1: SIGTERM (–≤–µ–∂–ª–∏–≤–æ)
echo "Sending SIGTERM..."
kill -15 "$pid"

# –®–∞–≥ 2: –ü–æ–¥–æ–∂–¥–∏ 5 —Å–µ–∫—É–Ω–¥
sleep 5

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞
if ps -p "$pid" > /dev/null 2>&1; then
    echo "‚ö†Ô∏è  Process still alive. Sending SIGKILL..."
    kill -9 "$pid"
    sleep 1
fi

# –®–∞–≥ 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
if ps -p "$pid" > /dev/null 2>&1; then
    echo "‚ùå Failed to kill process"
    exit 1
else
    echo "‚úì Process killed successfully"
fi
```

**–ê–Ω–Ω–∞:**
*"–í production —Ç–∞–∫ –¥–µ–ª–∞—é—Ç –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤. SIGTERM –¥–∞—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å—É –≤—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. SIGKILL ‚Äî —ç—Ç–æ –∞–≤–∞—Ä–∏–π–Ω–∞—è –∫–Ω–æ–ø–∫–∞."*

---

### üìä –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

#### 1. `ps` ‚Äî Process Status

```bash
# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (BSD style)
ps aux

# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (UNIX style)
ps -ef

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
ps -p 6623

# Custom —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞
ps -eo pid,ppid,user,%cpu,%mem,cmd

# –ü—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
ps -u www-data
```

**–ö–æ–ª–æ–Ω–∫–∏:**
- **PID** ‚Äî Process ID
- **%CPU** ‚Äî % –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CPU
- **%MEM** ‚Äî % –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
- **VSZ** ‚Äî Virtual memory Size (KB)
- **RSS** ‚Äî Resident Set Size (—Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å, KB)
- **STAT** ‚Äî –°–æ—Å—Ç–æ—è–Ω–∏–µ (R, S, Z, etc.)
- **START** ‚Äî –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞
- **TIME** ‚Äî CPU –≤—Ä–µ–º—è (—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å)
- **COMMAND** ‚Äî –ö–æ–º–∞–Ω–¥–∞

---

#### 2. `top` / `htop` ‚Äî Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
top

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ CPU: P
# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ Memory: M
# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å: k (–≤–≤–µ—Å—Ç–∏ PID)
# –í—ã—Ö–æ–¥: q
```

**–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è: `htop`**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
sudo apt install htop

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
htop

# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
# - –¶–≤–µ—Ç–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
# - –î–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (F5)
# - –ü–æ–∏—Å–∫ (F3)
# - –§–∏–ª—å—Ç—Ä (F4)
# - Kill —á–µ—Ä–µ–∑ –º–µ–Ω—é (F9)
```

**–ë–æ—Ä–∏—Å:**
*"htop ‚Äî —ç—Ç–æ top –Ω–∞ —Å—Ç–µ—Ä–æ–∏–¥–∞—Ö. –£—Å—Ç–∞–Ω–æ–≤–∏ –µ–≥–æ –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–∞—Ö. Troubleshooting —Å—Ç–∞–Ω–µ—Ç –≤ 10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ."*

---

#### 3. `pgrep` / `pkill` ‚Äî Find/Kill by name

```bash
# –ù–∞–π—Ç–∏ PID –ø–æ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
pgrep nginx
# –í—ã–≤–æ–¥: 1456

# –° –¥–µ—Ç–∞–ª—è–º–∏ (cmd)
pgrep -a nginx
# –í—ã–≤–æ–¥: 1456 nginx: master process

# –ü–æ regex
pgrep -f "sshd.*backup"

# –£–±–∏—Ç—å –ø–æ –∏–º–µ–Ω–∏
pkill nginx

# –£–±–∏—Ç—å –ø–æ regex
pkill -f "python.*malicious"

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
pkill -u attacker
```

---

#### 4. `pstree` ‚Äî –î–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

```bash
# ASCII –¥–µ—Ä–µ–≤–æ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pstree

# –° PID
pstree -p

# –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
pstree -p 1456

# –° –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
pstree -a
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
systemd(1)‚îÄ‚î¨‚îÄsystemd-journal(342)
           ‚îú‚îÄsshd(1024)‚îÄ‚îÄ‚îÄbash(6624)‚îÄ‚îÄ‚îÄvim(6625)
           ‚îî‚îÄnginx(1456)‚îÄ‚î¨‚îÄnginx(1457)
                         ‚îú‚îÄnginx(1458)
                         ‚îî‚îÄnginx(1459)
```

---

#### 5. `/proc` filesystem ‚Äî –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –§–° –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

```bash
# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
ls /proc/
# 1/  342/  1024/  6623/  ...

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ 6623
ls /proc/6623/
# cmdline  environ  exe  fd/  maps  status  ...

# –ü—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É
ls -l /proc/6623/exe

# –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
cat /proc/6623/cmdline | tr '\0' ' '

# Environment variables
cat /proc/6623/environ | tr '\0' '\n'

# –û—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã
ls -l /proc/6623/fd/

# –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
cat /proc/6623/status
```

**–ë–æ—Ä–∏—Å:**
*"`/proc` ‚Äî —ç—Ç–æ –æ–∫–Ω–æ –≤ kernel. –í—Å—ë —á—Ç–æ kernel –∑–Ω–∞–µ—Ç –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ —Ñ–∞–π–ª—ã. –•–æ—á–µ—à—å –∑–Ω–∞—Ç—å —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å? –ó–∞–≥–ª—è–Ω–∏ –≤ `/proc/PID/`."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É SIGTERM –∏ SIGKILL?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

| SIGTERM (15) | SIGKILL (9) |
|--------------|-------------|
| –í–µ–∂–ª–∏–≤–∞—è –ø—Ä–æ—Å—å–±–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–±–∏–π—Å—Ç–≤–æ |
| –ü—Ä–æ—Ü–µ—Å—Å –ú–û–ñ–ï–¢ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å (cleanup) | –ü—Ä–æ—Ü–µ—Å—Å –ù–ï –ú–û–ñ–ï–¢ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å |
| –ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å | –ù–ï–õ–¨–ó–Ø –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å |
| Graceful shutdown | Immediate termination |

**–ê–Ω–∞–ª–æ–≥–∏—è:**
- SIGTERM = "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–∫–æ–Ω—á–∏ —Ä–∞–±–æ—Ç—É –∏ —É–π–¥–∏"
- SIGKILL = "–í—ã—Ö–æ–¥ ‚Üí —Å–µ–π—á–∞—Å!" (–æ—Ö—Ä–∞–Ω–Ω–∏–∫ –≤—ã—Ç–∞–ª–∫–∏–≤–∞–µ—Ç)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ Production: –≤—Å–µ–≥–¥–∞ —Å–Ω–∞—á–∞–ª–∞ SIGTERM, –ø–æ—Ç–æ–º SIGKILL
- ‚úÖ Debugging: SIGTERM —á—Ç–æ–±—ã –ø—Ä–æ—Ü–µ—Å—Å –º–æ–≥ –∑–∞–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏
- ‚ùå SIGKILL —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–∏—Å –∏ –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç

**–ë–æ—Ä–∏—Å:** *"SIGTERM = –∫—É–ª—å—Ç—É—Ä–∞. SIGKILL = –≤–∞—Ä–≤–∞—Ä—Å—Ç–≤–æ. –ë—É–¥—å –∫—É–ª—å—Ç—É—Ä–Ω—ã–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ü–æ—á–µ–º—É `kill -9 1` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?

<details>
<summary>üí° –ü–æ–¥—É–º–∞–π –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º</summary>

**–û—Ç–≤–µ—Ç:**
PID 1 (systemd/init) –∑–∞—â–∏—â—ë–Ω kernel –æ—Ç –≤—Å–µ—Ö —Å–∏–≥–Ω–∞–ª–æ–≤, –≤–∫–ª—é—á–∞—è SIGKILL.

**–ü–æ—á–µ–º—É:**
- PID 1 ‚Äî —ç—Ç–æ –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ï—Å–ª–∏ PID 1 —É–º—Ä—ë—Ç ‚Üí kernel –ø–∞–Ω–∏–∫—É–µ—Ç ‚Üí —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- Kernel –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç ANY —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è PID 1

**–ß—Ç–æ –±—É–¥–µ—Ç –µ—Å–ª–∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:**
```bash
$ sudo kill -9 1
# –ö–æ–º–∞–Ω–¥–∞ "—É—Å–ø–µ—à–Ω–∞", –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
# Systemd –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

$ ps -p 1
  PID TTY          TIME CMD
    1 ?        00:00:01 systemd
```

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å systemd:**
```bash
# –í—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo systemctl poweroff

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
sudo systemctl reboot
```

**–ë–æ—Ä–∏—Å:** *"Kernel –∑–∞—â–∏—â–∞–µ—Ç PID 1 –∫–∞–∫ –º–∞—Ç—å –∑–∞—â–∏—â–∞–µ—Ç —Ä–µ–±—ë–Ω–∫–∞. –ù–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –µ–≥–æ —É–±–∏—Ç—å."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ `pkill -u attacker`?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**
–£–±–∏–≤–∞–µ—Ç (SIGTERM) –í–°–ï –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `attacker`.

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. `pkill` –∏—â–µ—Ç –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≥–¥–µ `user == attacker`
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç SIGTERM –∫–∞–∂–¥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É
3. –ü—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `attacker` –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä:**
```bash
# –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∑–∞–ø—É—Å—Ç–∏–ª 3 –ø—Ä–æ—Ü–µ—Å—Å–∞
$ ps -u attacker
  PID TTY      TIME CMD
 6623 ?        0:00 sshd_backup
 6624 ?        0:00 bash
 6625 ?        0:00 nc -l 4444

# –£–±–∏—Ç—å –≤—Å—ë
$ sudo pkill -u attacker

# –ü—Ä–æ–≤–µ—Ä–∫–∞
$ ps -u attacker
# (–ø—É—Å—Ç–æ)
```

**‚ö†Ô∏è –û–°–¢–û–†–û–ñ–ù–û:**
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —É–±—å—ë—Ç –í–°–ï –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (SSH —Å–µ—Å—Å–∏–∏, cron jobs, etc.)!

**–ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ:**
```bash
# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ —Å–º–æ–∂–µ—Ç –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è)
sudo usermod -L attacker

# –ó–∞—Ç–µ–º —É–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
sudo pkill -u attacker
```

**–ê–Ω–Ω–∞:** *"–ü–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤–∑–ª–æ–º–∞ —è –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞—é: 1) pkill -u attacker, 2) usermod -L attacker, 3) passwd -l attacker. –¢—Ä–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 2

- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ signals (—Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º)
- [ ] –ó–Ω–∞—é —Ä–∞–∑–Ω–∏—Ü—É SIGTERM vs SIGKILL
- [ ] –£–º–µ—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–±–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (graceful shutdown)
- [ ] –ó–Ω–∞–∫–æ–º —Å `ps`, `top`, `htop`, `pgrep`, `pkill`
- [ ] –ú–æ–≥—É –∏–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ `/proc/PID/`

**LILITH:**
*"Kill ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ '—É–±–∏—Ç—å'. –≠—Ç–æ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∞. SIGTERM = –≤–µ–∂–ª–∏–≤–∞—è –ø—Ä–æ—Å—å–±–∞. SIGKILL = –ø—Ä–∏–∫–∞–∑. –í production –≤—Å–µ–≥–¥–∞ –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å —Å–Ω–∞—á–∞–ª–∞."*

---

## üîÑ –¶–ò–ö–õ 3: SystemD Service Units (20-25 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ë–æ—Ä–∏—Å** (–∑–∞–∫—Ä—ã–≤–∞–µ—Ç `htop`):
*"–û–∫–µ–π, —Ç—ã –Ω–∞—à—ë–ª backdoor –∏ —É–±–∏–ª –µ–≥–æ. –ù–æ —á—Ç–æ –¥–∞–ª—å—à–µ? –ö—Ä—ã–ª–æ–≤ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ —Å–Ω–æ–≤–∞ –µ—Å–ª–∏ –Ω–∞–π–¥—ë—Ç –≤–µ–∫—Ç–æ—Ä. –ù—É–∂–µ–Ω –ü–û–°–¢–û–Ø–ù–ù–´–ô –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥. –°–µ—Ä–≤–∏—Å –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å 24/7."*

**–ú–∞–∫—Å:**
*"Bash —Å–∫—Ä–∏–ø—Ç –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ?"*

**–ë–æ—Ä–∏—Å** (–∫–∞—á–∞–µ—Ç –≥–æ–ª–æ–≤–æ–π):
*"–ù–µ—Ç. Production-grade —Ä–µ—à–µ–Ω–∏–µ ‚Äî —ç—Ç–æ systemd service. –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∫—Ä–∞—à–∞—Ö, resource limits, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ journalctl, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å security features. –í—Å—ë —á—Ç–æ –Ω—É–∂–Ω–æ."*

**–í–∏–∫—Ç–æ—Ä** (–≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫):
*"–ë–æ—Ä–∏—Å –ø—Ä–∞–≤. –ù–∞—à–∏ —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç systemd. –ú–∞–∫—Å, –Ω–∞—É—á–∏—Å—å –ø–∏—Å–∞—Ç—å service units. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏."*

---

### üìö –¢–µ–æ—Ä–∏—è: SystemD Service Units

#### üèóÔ∏è –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Service Unit = –ö–æ–Ω—Ç—Ä–∞–∫—Ç —Å —Ä–∞–±–æ—á–∏–º

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —á—Ç–æ —Ç—ã –Ω–∞–Ω–∏–º–∞–µ—à—å —Ä–∞–±–æ—á–µ–≥–æ (–ø—Ä–æ—Ü–µ—Å—Å) –Ω–∞ —Ñ–∞–±—Ä–∏–∫—É. –¢—ã –ø–∏—à–µ—à—å **–∫–æ–Ω—Ç—Ä–∞–∫—Ç** (service unit):

```
üìÑ –¢–†–£–î–û–í–û–ô –î–û–ì–û–í–û–† (Service Unit)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

[–°–µ–∫—Ü–∏—è 1: –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]
- –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏: "Shadow Monitor"
- –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã: "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã –Ω–∞ backdoors"
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://...
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –Ω–∞—á–∏–Ω–∞—Ç—å —Ä–∞–±–æ—Ç—É –ü–û–°–õ–ï –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ç–∏

[–°–µ–∫—Ü–∏—è 2: –£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã]
- –¢–∏–ø —Ä–∞–±–æ—Ç—ã: –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è (–Ω–µ —Ä–∞–∑–æ–≤–∞—è)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: shadow-monitor (–ù–ï root!)
- –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: /var/operations/shadow-monitor
- –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞: /usr/local/bin/shadow-monitor.sh
- –õ–∏–º–∏—Ç CPU: –º–∞–∫—Å–∏–º—É–º 25%
- –õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏: –º–∞–∫—Å–∏–º—É–º 128MB
- –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞: –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –µ—Å–ª–∏ —É–ø–∞–ª

[–°–µ–∫—Ü–∏—è 3: –£—Å–ª–æ–≤–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏]
- –ó–∞–ø—É—Å–∫–∞—Ç—å: –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- –¶–µ–ª—å: multi-user.target (–º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
```

SystemD —á–∏—Ç–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–±–æ—á–∏–º (–ø—Ä–æ—Ü–µ—Å—Å–æ–º) —Å–æ–≥–ª–∞—Å–Ω–æ —É—Å–ª–æ–≤–∏—è–º.

---

#### üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Service Unit

Service unit ‚Äî —ç—Ç–æ **INI-—Ñ–∞–π–ª** –≤ `/etc/systemd/system/servicename.service`.

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä:**

```ini
[Unit]
Description=Shadow Monitor Service

[Service]
ExecStart=/usr/local/bin/shadow-monitor.sh

[Install]
WantedBy=multi-user.target
```

–≠—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å–µ—Ä–≤–∏—Å!

---

#### üìã –¢—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏

##### 1. **[Unit]** ‚Äî –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```ini
[Unit]
Description=KERNEL SHADOWS System Monitor
Documentation=https://github.com/kernel-shadows/episode-10

# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞)
After=network-online.target
Wants=network-online.target
Requires=systemd-journald.service
```

**–ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ü–∏–∏:**
- **`Description`** ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ `systemctl status`)
- **`After=`** ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å –ü–û–°–õ–ï —ç—Ç–∏—Ö units
- **`Before=`** ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å –ü–ï–†–ï–î —ç—Ç–∏–º–∏ units
- **`Wants=`** ‚Äî —Ö–æ—á–µ—Ç —á—Ç–æ–±—ã —ç—Ç–æ—Ç unit –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (–Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- **`Requires=`** ‚Äî –¢–†–ï–ë–£–ï–¢ —á—Ç–æ–±—ã —ç—Ç–æ—Ç unit –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (–∏–Ω–∞—á–µ fail)
- **`Conflicts=`** ‚Äî –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å —ç—Ç–∏–º unit

**–ë–æ—Ä–∏—Å:**
*"–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞. After=network ‚Üí —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ü–û–°–õ–ï —Å–µ—Ç–∏. –õ–æ–≥–∏—á–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–æ—Ç–æ—Ä—ã–π —à–ª—ë—Ç –∞–ª–µ—Ä—Ç—ã –ø–æ —Å–µ—Ç–∏."*

---

##### 2. **[Service]** ‚Äî –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å

```ini
[Service]
Type=simple
User=shadow-monitor
WorkingDirectory=/var/operations/shadow-monitor
ExecStart=/usr/local/bin/shadow-monitor.sh

# Restart policy
Restart=on-failure
RestartSec=10s

# Resource limits
CPUQuota=25%
MemoryLimit=128M

# Security
NoNewPrivileges=true
PrivateTmp=true
```

**–ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ü–∏–∏:**
- **`Type=`** ‚Äî —Ç–∏–ø —Å–µ—Ä–≤–∏—Å–∞ (simple, forking, oneshot, etc.)
- **`User=`**, **`Group=`** ‚Äî –æ—Ç –∫–∞–∫–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–ø—É—Å–∫–∞—Ç—å
- **`ExecStart=`** ‚Äî –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞
- **`ExecStartPre=`** ‚Äî –∫–æ–º–∞–Ω–¥—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º (–ø—Ä–æ–≤–µ—Ä–∫–∏)
- **`ExecStartPost=`** ‚Äî –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
- **`ExecStop=`** ‚Äî –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (default: SIGTERM)
- **`Restart=`** ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- **`RestartSec=`** ‚Äî –ø–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º
- **`WorkingDirectory=`** ‚Äî —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

---

##### 3. **[Install]** ‚Äî –ö–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å

```ini
[Install]
WantedBy=multi-user.target
```

**–ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ü–∏–∏:**
- **`WantedBy=`** ‚Äî –≤ –∫–∞–∫–æ–º target –≤–∫–ª—é—á–∞—Ç—å —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å
- **`RequiredBy=`** ‚Äî –∫–∞–∫–æ–π target –¢–†–ï–ë–£–ï–¢ —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å

**Targets (—É–ø—Ä–æ—â—ë–Ω–Ω–æ):**
- **`multi-user.target`** ‚Äî –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º (–±–µ–∑ GUI)
- **`graphical.target`** ‚Äî –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º (—Å GUI)
- **`timers.target`** ‚Äî –¥–ª—è timer units

**–ë–æ—Ä–∏—Å:**
*"[Install] –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç—ã –¥–µ–ª–∞–µ—à—å `systemctl enable`. Enable —Å–æ–∑–¥–∞—ë—Ç symlink –≤ `/etc/systemd/system/multi-user.target.wants/`. –¢–∞–∫ systemd –∑–Ω–∞–µ—Ç —á—Ç–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ."*

---

#### üé® –¢–∏–ø—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (Type=)

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----|----------|--------|
| **simple** | –î–æ–ª–≥–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (default) | –í–µ–±-—Å–µ—Ä–≤–µ—Ä, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |
| **forking** | –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ª–∞–µ—Ç fork –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è | Nginx, Apache (—Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å) |
| **oneshot** | –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è | Backup, setup scripts |
| **notify** | –ü—Ä–æ—Ü–µ—Å—Å —É–≤–µ–¥–æ–º–ª—è–µ—Ç systemd –∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤ | –°–ª–æ–∂–Ω—ã–µ –¥–µ–º–æ–Ω—ã (PostgreSQL) |
| **idle** | –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –≤—Å–µ jobs –∑–∞–≤–µ—Ä—à–µ–Ω—ã | –ù–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ |

**–î–ª—è 90% —Å–ª—É—á–∞–µ–≤:**
- **`simple`** ‚Äî –¥–ª—è –¥–æ–ª–≥–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤
- **`oneshot`** ‚Äî –¥–ª—è –∑–∞–¥–∞—á –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–Ω–∏–µ service unit

#### –ó–∞–¥–∞—á–∞: –°–æ–∑–¥–∞—Ç—å `shadow-monitor.service`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ó–∞–ø—É—Å–∫ –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `shadow-monitor`
- –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- Resource limits (CPU 25%, Memory 128MB)
- –õ–æ–≥–∏ –≤ journalctl

**–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

```bash
# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (no login shell)
sudo useradd -r -s /bin/false shadow-monitor

# –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
sudo mkdir -p /var/operations/shadow-monitor
sudo chown shadow-monitor:shadow-monitor /var/operations/shadow-monitor
```

---

**–®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**

```bash
sudo nano /usr/local/bin/shadow-monitor.sh
```

```bash
#!/bin/bash
# Shadow Monitor - Episode 10

LOG_TAG="shadow-monitor"

log_message() {
    logger -t "$LOG_TAG" "$1"
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1"
}

check_suspicious_processes() {
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ backdoor –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    suspicious=$(ps aux | grep -E 'sshd_backup|backdoor' | grep -v grep)

    if [[ -n "$suspicious" ]]; then
        log_message "‚ö†Ô∏è  ALERT: Suspicious process detected!"
        log_message "$suspicious"
    fi
}

log_message "Shadow Monitor started"

while true; do
    check_suspicious_processes
    sleep 30  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
done
```

```bash
# –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
sudo chmod +x /usr/local/bin/shadow-monitor.sh
```

---

**–®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å service unit**

SystemD units —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ `/etc/systemd/system/`.

```bash
sudo nano /etc/systemd/system/shadow-monitor.service
```

```ini
[Unit]
Description=KERNEL SHADOWS System Monitor
Documentation=https://github.com/kernel-shadows/episode-10
After=network-online.target
Wants=network-online.target
Requires=systemd-journald.service

[Service]
Type=simple
User=shadow-monitor
Group=shadow-monitor
WorkingDirectory=/var/operations/shadow-monitor

ExecStart=/usr/local/bin/shadow-monitor.sh

# Pre-checks
ExecStartPre=/usr/bin/test -f /usr/local/bin/shadow-monitor.sh
ExecStartPre=/usr/bin/test -x /usr/local/bin/shadow-monitor.sh

# Restart policy
Restart=on-failure
RestartSec=10s
StartLimitBurst=5
StartLimitIntervalSec=60s

# Resource limits
CPUQuota=25%
MemoryLimit=128M
TasksMax=50

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectHome=true
ProtectSystem=strict

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=shadow-monitor

[Install]
WantedBy=multi-user.target
```

---

**–®–∞–≥ 4: –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞**

```bash
# Reload systemd (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π!)
sudo systemctl daemon-reload

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
sudo systemd-analyze verify shadow-monitor.service

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl start shadow-monitor.service

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status shadow-monitor.service

# –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
sudo systemctl enable shadow-monitor.service

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ enabled
sudo systemctl is-enabled shadow-monitor.service
```

---

**–®–∞–≥ 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

```bash
# Real-time –ª–æ–≥–∏
sudo journalctl -u shadow-monitor.service -f

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
sudo journalctl -u shadow-monitor.service -n 50

# –° –º–æ–º–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
sudo journalctl -u shadow-monitor.service -b

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
sudo journalctl -u shadow-monitor.service -p err
```

---

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

```bash
# –ù–∞–π—Ç–∏ PID —Å–µ—Ä–≤–∏—Å–∞
PID=$(systemctl show shadow-monitor.service -p MainPID --value)

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (—Å–∏–º—É–ª—è—Ü–∏—è –∫—Ä–∞—à–∞)
sudo kill -9 "$PID"

# –ü–æ–¥–æ–∂–¥–∞—Ç—å 10 —Å–µ–∫—É–Ω–¥ (RestartSec=10s)
sleep 10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status shadow-monitor.service

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# Active: active (running)
# Main PID: [–Ω–æ–≤—ã–π PID]
# Restarts: 1
```

**–ë–æ—Ä–∏—Å:**
*"–í–∏–¥–∏—à—å? –°–µ—Ä–≤–∏—Å —É–ø–∞–ª, systemd –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª. Restart=on-failure —Ä–∞–±–æ—Ç–∞–µ—Ç. –≠—Ç–æ –∏ –µ—Å—Ç—å production-ready setup."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Type=simple –∏ Type=oneshot?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

| Type=simple | Type=oneshot |
|-------------|--------------|
| –î–æ–ª–≥–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å | –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è |
| –ù–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å–∞–º | –ó–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ |
| –ü—Ä–∏–º–µ—Ä—ã: nginx, monitoring | –ü—Ä–∏–º–µ—Ä—ã: backup, setup scripts |

**–ü—Ä–∏–º–µ—Ä—ã:**

**simple:**
```bash
#!/bin/bash
while true; do
    check_system
    sleep 60
done
```

**oneshot:**
```bash
#!/bin/bash
create_backup
cleanup_old_backups
exit 0
```

**–ë–æ—Ä–∏—Å:** *"Simple = daemon. Oneshot = task. –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è ‚Äî oneshot. –ï—Å–ª–∏ –∫—Ä—É—Ç–∏—Ç—Å—è –≤ —Ü–∏–∫–ª–µ ‚Äî simple."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ó–∞—á–µ–º –Ω—É–∂–µ–Ω `systemctl daemon-reload`?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**
SystemD –∫—ç—à–∏—Ä—É–µ—Ç unit files –≤ –ø–∞–º—è—Ç–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç daemon-reload:**
1. –ü–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ unit files –∏–∑ `/etc/systemd/system/`
2. –û–±–Ω–æ–≤–ª—è–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—ç—à systemd
3. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–æ–≤—ã–µ units, –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ units)

**–ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω:**
- ‚úÖ –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ unit —Ñ–∞–π–ª–∞
- ‚úÖ –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ unit —Ñ–∞–π–ª–∞
- ‚úÖ –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è unit —Ñ–∞–π–ª–∞

**–ß—Ç–æ –±—É–¥–µ—Ç –µ—Å–ª–∏ –∑–∞–±—ã—Ç—å:**
```bash
$ sudo systemctl start shadow-monitor.service
Failed to start shadow-monitor.service: Unit shadow-monitor.service not found.

$ sudo systemctl daemon-reload
$ sudo systemctl start shadow-monitor.service
‚úì Started shadow-monitor.service
```

**–ë–æ—Ä–∏—Å:** *"–ó–∞–±—ã–ª daemon-reload? SystemD –Ω–µ –≤–∏–¥–∏—Ç —Ç–≤–æ–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –≠—Ç–æ —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –Ω–æ–≤–∏—á–∫–æ–≤."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ü–æ—á–µ–º—É User=shadow-monitor, –∞ –Ω–µ root?

<details>
<summary>üí° Principle of Least Privilege</summary>

**–û—Ç–≤–µ—Ç:**
**Principle of Least Privilege:** –¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ –ù–ï–û–ë–•–û–î–ò–ú–´.

**–ü–æ—á–µ–º—É –ù–ï root:**
- ‚ùå –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ù–ï —Ç—Ä–µ–±—É–µ—Ç root –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
- ‚ùå –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω ‚Üí –∞—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∏—Ç root
- ‚ùå Root –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –ø–æ–≤—Ä–µ–¥–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤ –∫–æ–¥–µ

**–ö–æ–≥–¥–∞ root –Ω–µ–æ–±—Ö–æ–¥–∏–º:**
- ‚úÖ Backup –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

**Best practice:**
```ini
# ‚ùå –ü–ª–æ—Ö–æ
User=root

# ‚úÖ –•–æ—Ä–æ—à–æ
User=shadow-monitor  # –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

# ‚úÖ –ï—â—ë –ª—É—á—à–µ
User=shadow-monitor
NoNewPrivileges=true  # –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
ProtectSystem=strict  # read-only —Å–∏—Å—Ç–µ–º–∞
ProtectHome=true      # –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ /home
```

**–ê–Ω–Ω–∞:** *"–ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç root ‚Äî —ç—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∞—Ç–∞–∫—É—é—â–µ–≥–æ. –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ root."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 3

- [ ] –ü–æ–Ω–∏–º–∞—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É service unit ([Unit], [Service], [Install])
- [ ] –ó–Ω–∞—é —Ä–∞–∑–Ω–∏—Ü—É Type=simple vs Type=oneshot
- [ ] –ú–æ–≥—É —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞
- [ ] –£–º–µ—é –Ω–∞–ø–∏—Å–∞—Ç—å service unit —Ñ–∞–π–ª
- [ ] –ó–Ω–∞—é –∫–æ–º–∞–Ω–¥—ã: daemon-reload, start, stop, enable, disable, status
- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º Principle of Least Privilege

**LILITH:**
*"Service unit ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ '–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç'. –≠—Ç–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç: —á—Ç–æ –¥–µ–ª–∞—Ç—å, –∫–∞–∫ –¥–µ–ª–∞—Ç—å, –∫–æ–≥–¥–∞ –¥–µ–ª–∞—Ç—å, —Å –∫–∞–∫–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏, —Å –∫–∞–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é. Production-grade thinking."*

---

## üîÑ –¶–ò–ö–õ 4: SystemD Timers ‚Äî –ó–∞–º–µ–Ω–∞ Cron (15-20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ë–æ—Ä–∏—Å:**
*"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7. –û—Ç–ª–∏—á–Ω–æ. –¢–µ–ø–µ—Ä—å backup. –ù–∞–º –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å backup –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2 –Ω–æ—á–∏. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî cron. –ù–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º systemd timers."*

**–ú–∞–∫—Å:**
*"–ü–æ—á–µ–º—É –Ω–µ cron? –û–Ω –∂–µ –ø—Ä–æ—â–µ..."*

**–ë–æ—Ä–∏—Å:**
*"Cron –ø—Ä–æ—Å—Ç, –¥–∞. –ù–æ systemd timers –¥–∞—é—Ç –±–æ–ª—å—à–µ: dependency management, logging –≤ journalctl, resource limits, persistent (–µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ ‚Äî timer –∑–∞–ø—É—Å—Ç–∏—Ç –∑–∞–¥–∞—á—É –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏). –í—Å—ë —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è production."*

---

### üìö –¢–µ–æ—Ä–∏—è: SystemD Timers

#### ‚è∞ –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Timer = –ë—É–¥–∏–ª—å–Ω–∏–∫ –¥–ª—è —Ä–∞–±–æ—á–µ–≥–æ

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Ñ–∞–±—Ä–∏–∫—É —Å **–Ω–æ—á–Ω—ã–º —Å—Ç–æ—Ä–æ–∂–µ–º** (timer):

```
üè≠ FACTORY AT NIGHT
‚îÇ
‚îú‚îÄ üïê 02:00 ‚Äî –ë—É–¥–∏–ª—å–Ω–∏–∫ –∑–≤–µ–Ω–∏—Ç
‚îÇ  ‚îî‚îÄ üìû –ó–≤–æ–Ω–æ–∫ —Ä–∞–±–æ—á–µ–º—É: "–ü–æ—Ä–∞ –¥–µ–ª–∞—Ç—å backup!"
‚îÇ      ‚îî‚îÄ üë∑ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è, –¥–µ–ª–∞–µ—Ç backup, —É—Ö–æ–¥–∏—Ç —Å–ø–∞—Ç—å
‚îÇ
‚îú‚îÄ üïê 03:00 ‚Äî (–Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç)
‚îú‚îÄ üïê 04:00 ‚Äî (–Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç)
...
‚îî‚îÄ üïê 02:00 (—Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å) ‚Äî –ë—É–¥–∏–ª—å–Ω–∏–∫ —Å–Ω–æ–≤–∞ –∑–≤–µ–Ω–∏—Ç
```

**Cron:**
- –ë—É–¥–∏–ª—å–Ω–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- –ï—Å–ª–∏ –≤—Ä–µ–º—è —Å–æ–≤–ø–∞–ª–æ ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç –∑–∞–¥–∞—á—É
- –ù–µ –∑–Ω–∞–µ—Ç —á—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω

**SystemD Timer:**
- –ë—É–¥–∏–ª—å–Ω–∏–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º—É
- –ó–Ω–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∑–∞–ø—É—Å–∫–∞—Ç—å –ü–û–°–õ–ï —Å–µ—Ç–∏)
- Persistent=true ‚Üí –∑–∞–ø—É—Å—Ç–∏—Ç –∑–∞–¥–∞—á—É –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω
- –õ–æ–≥–∏ –≤ journalctl (–≤–∏–¥–Ω–æ –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å, —É—Å–ø–µ—à–Ω–æ –ª–∏)

---

#### üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Timer + Service

SystemD timer —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **–î–í–£–• —Ñ–∞–π–ª–æ–≤**:

1. **`.service`** ‚Äî **–ß–¢–û** –¥–µ–ª–∞—Ç—å (backup task)
2. **`.timer`** ‚Äî **–ö–û–ì–î–ê** –¥–µ–ª–∞—Ç—å (—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ)

```
shadow-backup.service  ‚Üê –ß–¢–û: —Å–æ–∑–¥–∞—Ç—å backup
shadow-backup.timer    ‚Üê –ö–û–ì–î–ê: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00
```

**–ë–æ—Ä–∏—Å:**
*"Separation of concerns. Service –∑–Ω–∞–µ—Ç –ö–ê–ö –¥–µ–ª–∞—Ç—å backup. Timer –∑–Ω–∞–µ—Ç –ö–û–ì–î–ê –∑–∞–ø—É—Å–∫–∞—Ç—å service. –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞."*

---

#### üìã –ü—Ä–∏–º–µ—Ä: Backup Timer

**–§–∞–π–ª 1: `shadow-backup.service`** (–ß–¢–û –¥–µ–ª–∞—Ç—å)

```ini
[Unit]
Description=KERNEL SHADOWS Automated Backup
After=network-online.target
Wants=network-online.target

[Service]
Type=oneshot
User=root
WorkingDirectory=/var/operations

ExecStart=/usr/local/bin/shadow-backup.sh

# Pre-checks
ExecStartPre=/usr/bin/test -d /var/operations
ExecStartPre=/usr/bin/test -x /usr/local/bin/shadow-backup.sh

# Post-backup logging
ExecStartPost=/usr/bin/logger -t shadow-backup "Backup completed successfully"

# Timeouts
TimeoutStartSec=1800s

# Resource limits
CPUQuota=50%
MemoryLimit=512M

# Security
PrivateTmp=true

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=shadow-backup

[Install]
# –ù–ï –Ω—É–∂–Ω–∞ [Install] —Å–µ–∫—Ü–∏—è!
# Service –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ timer, –Ω–µ –Ω–∞–ø—Ä—è–º—É—é
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** Type=oneshot –¥–ª—è –∑–∞–¥–∞—á –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è!

---

**–§–∞–π–ª 2: `shadow-backup.timer`** (–ö–û–ì–î–ê –¥–µ–ª–∞—Ç—å)

```ini
[Unit]
Description=KERNEL SHADOWS Backup Timer (Daily at 2 AM)
Documentation=https://github.com/kernel-shadows/episode-10
After=time-sync.target
Requires=time-sync.target

[Timer]
# –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00
OnCalendar=*-*-* 02:00:00

# Randomize start time by ¬±15 minutes
# (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –µ—Å–ª–∏ —É –≤–∞—Å 100+ —Å–µ—Ä–≤–µ—Ä–æ–≤)
RandomizedDelaySec=15min

# –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ ‚Üí –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏
Persistent=true

# –ö–∞–∫–æ–π service –∑–∞–ø—É—Å–∫–∞—Ç—å
Unit=shadow-backup.service

[Install]
WantedBy=timers.target
```

---

#### üé® OnCalendar —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

SystemD –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **calendar expressions** –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.

**–ë–∞–∑–æ–≤—ã–µ:**
```ini
OnCalendar=minutely    # –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
OnCalendar=hourly      # –∫–∞–∂–¥—ã–π —á–∞—Å –≤ :00
OnCalendar=daily       # –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:00
OnCalendar=weekly      # –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 00:00
OnCalendar=monthly     # –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞ –≤ 00:00
OnCalendar=yearly      # 1 —è–Ω–≤–∞—Ä—è –≤ 00:00
```

**–ö–∞—Å—Ç–æ–º–Ω—ã–µ:**
```ini
OnCalendar=*-*-* 02:00:00           # –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00
OnCalendar=Mon *-*-* 09:00:00       # –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 09:00
OnCalendar=Mon-Fri *-*-* 09:00      # –±—É–¥–Ω–∏ –≤ 09:00
OnCalendar=Sat,Sun *-*-* 12:00      # –≤—ã—Ö–æ–¥–Ω—ã–µ –≤ 12:00
OnCalendar=*-*-01 03:00             # –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞ –≤ 03:00
OnCalendar=*-*-* 00/6:00            # –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (00:00, 06:00, 12:00, 18:00)
OnCalendar=*-*-* *:00/15            # –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
systemd-analyze calendar "Mon *-*-* 02:00"
# –í—ã–≤–æ–¥:
#   Original form: Mon *-*-* 02:00
#   Normalized form: Mon *-*-* 02:00:00
#   Next elapse: Mon 2025-10-13 02:00:00 UTC
#   (in UTC): Mon 2025-10-13 02:00:00 UTC
```

**–ë–æ—Ä–∏—Å:**
*"–ù–µ —É–≤–µ—Ä–µ–Ω –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ? `systemd-analyze calendar "—Ç–≤–æ—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ"`. –ü–æ–∫–∞–∂–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫ –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–Ω–∏–µ Timer

#### –ó–∞–¥–∞—á–∞: Backup –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00

**–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å backup script**

```bash
sudo nano /usr/local/bin/shadow-backup.sh
```

```bash
#!/bin/bash
# Shadow Backup - Episode 10

BACKUP_DIR="/var/backups/shadow"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
LOG_TAG="shadow-backup"

# Create backup directory
sudo mkdir -p "$BACKUP_DIR"

log_message() {
    logger -t "$LOG_TAG" "$1"
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1"
}

log_message "Starting backup: $TIMESTAMP"

# Backup important configs
tar czf "$BACKUP_DIR/config_$TIMESTAMP.tar.gz" \
    /etc/systemd/system/*.service \
    /etc/sudoers.d/ \
    /var/operations/ \
    2>/dev/null

# Keep only last 30 backups (30 days)
cd "$BACKUP_DIR" && ls -t config_*.tar.gz | tail -n +31 | xargs -r rm

log_message "Backup completed: $BACKUP_DIR/config_$TIMESTAMP.tar.gz"
```

```bash
sudo chmod +x /usr/local/bin/shadow-backup.sh
```

---

**–®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å service unit**

```bash
sudo nano /etc/systemd/system/shadow-backup.service
```

(–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ)

---

**–®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å timer unit**

```bash
sudo nano /etc/systemd/system/shadow-backup.timer
```

(–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ)

---

**–®–∞–≥ 4: –ê–∫—Ç–∏–≤–∞—Ü–∏—è timer**

```bash
# Reload systemd
sudo systemctl daemon-reload

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
sudo systemd-analyze verify shadow-backup.service
sudo systemd-analyze verify shadow-backup.timer

# Enable timer (–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)
sudo systemctl enable shadow-backup.timer

# Start timer —Å–µ–π—á–∞—Å
sudo systemctl start shadow-backup.timer

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status shadow-backup.timer
```

---

**–®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫**

```bash
# –í—Å–µ timers
sudo systemctl list-timers

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π timer
sudo systemctl list-timers shadow-backup.timer

# –í—ã–≤–æ–¥:
# NEXT                         LEFT          LAST  PASSED  UNIT
# 2025-10-12 02:00:00 UTC  5h 23min left  n/a   n/a     shadow-backup.timer
```

---

**–®–∞–≥ 6: –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (—Ç–µ—Å—Ç)**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å backup –≤—Ä—É—á–Ω—É—é (–Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å 02:00)
sudo systemctl start shadow-backup.service

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status shadow-backup.service

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# Active: inactive (dead)  ‚Üê –ù–û–†–ú–ê–õ–¨–ù–û –¥–ª—è oneshot!
# Status: "Backup completed successfully"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u shadow-backup.service
```

**–ë–æ—Ä–∏—Å:**
*"oneshot service –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. inactive (dead) ‚Äî —ç—Ç–æ OK. –°–º–æ—Ç—Ä–∏ –Ω–∞ Status: 'success' –∏ –ª–æ–≥–∏."*

---

### üÜö Cron vs SystemD Timers

| Cron | SystemD Timers |
|------|----------------|
| ‚úÖ –ü—Ä–æ—Å—Ç–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: `0 2 * * * /script.sh` | ‚ö†Ô∏è –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π (2 —Ñ–∞–π–ª–∞: .service + .timer) |
| ‚ùå –ù–µ—Ç dependency management | ‚úÖ After=, Requires= (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏) |
| ‚ùå –õ–æ–≥–∏ –≤ email –∏–ª–∏ `/var/log/cron` | ‚úÖ –õ–æ–≥–∏ –≤ journalctl (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ) |
| ‚ùå –ù–µ—Ç resource limits | ‚úÖ CPUQuota, MemoryLimit |
| ‚ùå –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω ‚Äî –ø—Ä–æ–ø—É—â–µ–Ω | ‚úÖ Persistent=true ‚Üí catch missed runs |
| ‚ùå –ù–µ—Ç randomization (–≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ) | ‚úÖ RandomizedDelaySec (load distribution) |
| ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω –≤–µ–∑–¥–µ | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ systemd —Å–∏—Å—Ç–µ–º—ã (Ubuntu, RHEL, Fedora, Debian) |

**–ë–æ—Ä–∏—Å:**
*"–î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á –Ω–∞ –ª–∏—á–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ ‚Äî cron OK. –î–ª—è production —Å 100+ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ ‚Äî systemd timers. Better control, better logging, better integration."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –¥–≤–∞ —Ñ–∞–π–ª–∞ (.service –∏ .timer)?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**
**Separation of concerns** (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏).

- **`.service`** –∑–Ω–∞–µ—Ç **–ß–¢–û** –¥–µ–ª–∞—Ç—å (backup logic)
- **`.timer`** –∑–Ω–∞–µ—Ç **–ö–û–ì–î–ê** –¥–µ–ª–∞—Ç—å (schedule)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
1. ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å service –≤—Ä—É—á–Ω—É—é: `systemctl start shadow-backup.service`
2. ‚úÖ –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ —Ç—Ä–æ–≥–∞—è backup logic
3. ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω service —Å —Ä–∞–∑–Ω—ã–º–∏ timers

**–ü—Ä–∏–º–µ—Ä:**
```
shadow-backup.service          ‚Üê backup logic
shadow-backup-daily.timer      ‚Üê –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 02:00
shadow-backup-hourly.timer     ‚Üê –∫–∞–∂–¥—ã–π —á–∞—Å (–¥–ª—è critical data)
```

–û–±–∞ timers –∑–∞–ø—É—Å–∫–∞—é—Ç –æ–¥–∏–Ω service!

**–ë–æ—Ä–∏—Å:** *"–≠—Ç–æ UNIX philosophy: do one thing well. Service –¥–µ–ª–∞–µ—Ç backup. Timer –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é. –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Persistent=true?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**
**Persistent=true** –æ–∑–Ω–∞—á–∞–µ—Ç "catch missed runs".

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. Timer –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ 02:00 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
2. –°–µ—Ä–≤–µ—Ä –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω —Å 01:00 –¥–æ 08:00
3. Timer –ø—Ä–æ–ø—É—Å—Ç–∏–ª –∑–∞–ø—É—Å–∫ –≤ 02:00

**–ë–µ–∑ Persistent:**
```
02:00 ‚Äî –ø—Ä–æ–ø—É—â–µ–Ω (—Å–µ—Ä–≤–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω)
08:00 ‚Äî —Å–µ—Ä–≤–µ—Ä –≤–∫–ª—é—á–∏–ª—Å—è
     ‚Äî backup –ù–ï –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
     ‚Äî —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –∑–∞–≤—Ç—Ä–∞ –≤ 02:00
```

**–° Persistent=true:**
```
02:00 ‚Äî –ø—Ä–æ–ø—É—â–µ–Ω (—Å–µ—Ä–≤–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω)
08:00 ‚Äî —Å–µ—Ä–≤–µ—Ä –≤–∫–ª—é—á–∏–ª—Å—è
08:00 ‚Äî systemd –≤–∏–¥–∏—Ç "–ø—Ä–æ–ø—É—â–µ–Ω –∑–∞–ø—É—Å–∫" ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç backup —Å–µ–π—á–∞—Å!
     ‚Äî backup –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (late, –Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ Backup (–≤–∞–∂–Ω–æ —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω)
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –û—Ç—á—ë—Ç—ã "–∑–∞ –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å" (–µ—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω ‚Äî –Ω–µ –Ω—É–∂–µ–Ω)

**–ë–æ—Ä–∏—Å:** *"Persistent=true –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á. –õ—É—á—à–µ late —á–µ–º never."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ó–∞—á–µ–º RandomizedDelaySec=15min?

<details>
<summary>üí° Load Distribution</summary>

**–û—Ç–≤–µ—Ç:**
**RandomizedDelaySec** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫ –∑–∞–¥–∞—á –≤–æ –≤—Ä–µ–º–µ–Ω–∏.

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü—Ä–µ–¥—Å—Ç–∞–≤—å 100 —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å backup –≤ 02:00:
```
02:00:00 ‚Äî –í–°–ï 100 —Å–µ—Ä–≤–µ—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞—é—Ç backup –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
          ‚Üí –ø–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ backup storage
          ‚Üí —Å–µ—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–∞
          ‚Üí backup –º–µ–¥–ª–µ–Ω–Ω—ã–π
```

**–†–µ—à–µ–Ω–∏–µ: RandomizedDelaySec=15min**
```
02:00:00 ‚Äî —Å–µ—Ä–≤–µ—Ä 1 –∑–∞–ø—É—Å—Ç–∏–ª backup
02:03:12 ‚Äî —Å–µ—Ä–≤–µ—Ä 2 –∑–∞–ø—É—Å—Ç–∏–ª backup
02:07:45 ‚Äî —Å–µ—Ä–≤–µ—Ä 3 –∑–∞–ø—É—Å—Ç–∏–ª backup
...
02:14:23 ‚Äî —Å–µ—Ä–≤–µ—Ä 100 –∑–∞–ø—É—Å—Ç–∏–ª backup
```

Backup —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω —Å 02:00 –¥–æ 02:15 ‚Üí –Ω–µ—Ç –ø–∏–∫–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏!

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ Backup –Ω–∞ –º–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–æ–≤
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
- ‚úÖ Cron jobs –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω—å—à–µ –±–∏–ª–∏ –ø–æ –æ–¥–Ω–æ–º—É API

**–ë–æ—Ä–∏—Å:** *"RandomizedDelaySec ‚Äî —ç—Ç–æ '–≤–µ–∂–ª–∏–≤–æ—Å—Ç—å'. –ù–µ –Ω–∞–≥—Ä—É–∂–∞–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∏–∫–æ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 4

- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º –¥–≤–∞ —Ñ–∞–π–ª–∞ (.service + .timer)
- [ ] –ó–Ω–∞—é —Å–∏–Ω—Ç–∞–∫—Å–∏—Å OnCalendar
- [ ] –£–º–µ—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `systemd-analyze calendar`
- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º Persistent=true
- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º RandomizedDelaySec
- [ ] –£–º–µ—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫ (`systemctl list-timers`)

**LILITH:**
*"Timer ‚Äî —ç—Ç–æ cron –Ω–∞ —Å—Ç–µ—Ä–æ–∏–¥–∞—Ö. –î–∞, —Å–ª–æ–∂–Ω–µ–µ. –ù–æ production —Å–µ—Ä–≤–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç —ç—Ç–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. Dependency management, logging, persistence ‚Äî —ç—Ç–æ –Ω–µ —Ä–æ—Å–∫–æ—à—å, —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å."*

---

## üîÑ –¶–ò–ö–õ 5: Resource Limits & Security Hardening (20-25 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–í–∏–∫—Ç–æ—Ä** (–≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫, —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å):
*"–ú–∞–∫—Å, —Ö–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ backup. –ù–æ —É –Ω–∞—Å –ø—Ä–æ–±–ª–µ–º–∞. –û–¥–∏–Ω –∏–∑ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–µ —É–ø–∞–ª –≤—á–µ—Ä–∞ –Ω–æ—á—å—é. –ü—Ä–∏—á–∏–Ω–∞ ‚Äî fork bomb."*

**–ú–∞–∫—Å:**
*"Fork bomb?"*

**–ê–Ω–Ω–∞:**
*"–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è DoS –∞—Ç–∞–∫–∞. –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏–∏ —Å–µ–±—è –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ. –ö–∞–∂–¥–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞—ë—Ç –µ—â—ë –∫–æ–ø–∏–∏. –ß–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ ‚Äî —Ç—ã—Å—è—á–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–∞, –ø–∞–¥–∞–µ—Ç."*

```bash
# Fork bomb (–ù–ï –ó–ê–ü–£–°–ö–ê–ô!)
:(){ :|:& };:

# –ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:
# –§—É–Ω–∫—Ü–∏—è : –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∞–º–∞ —Å–µ–±—è –¥–≤–∞–∂–¥—ã
# & = –≤ background
# ‚Üí —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
# 1 ‚Üí 2 ‚Üí 4 ‚Üí 8 ‚Üí 16 ‚Üí 32 ‚Üí 64 ‚Üí 128 ‚Üí 256 ‚Üí ...
# –ó–∞ 30 —Å–µ–∫—É–Ω–¥: 10,000+ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚Üí —Å–∏—Å—Ç–µ–º–∞ –º–µ—Ä—Ç–≤–∞
```

**–ë–æ—Ä–∏—Å:**
*"–ó–∞—â–∏—Ç–∞ ‚Äî resource limits. SystemD –º–æ–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å CPU, –ø–∞–º—è—Ç—å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –î–∞–∂–µ –µ—Å–ª–∏ fork bomb –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è ‚Äî systemd —É–±—å—ë—Ç –µ–≥–æ –¥–æ —Ç–æ–≥–æ –∫–∞–∫ –æ–Ω –ø–æ–ª–æ–∂–∏—Ç —Å–∏—Å—Ç–µ–º—É."*

---

### üìö –¢–µ–æ—Ä–∏—è: Resource Limits

#### üè≠ –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Resource Limits = –ü—Ä–æ—Ñ—Å–æ—é–∑–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Ñ–∞–±—Ä–∏–∫—É –ë–ï–ó –ø—Ä–∞–≤–∏–ª:

```
‚ùå –ë–ï–ó –õ–ò–ú–ò–¢–û–í:
üë∑ –†–∞–±–æ—á–∏–π: "–ú–Ω–µ –Ω—É–∂–Ω–æ 100% CPU!"
üíª CPU: "–û–ö!" ‚Üí –¥—Ä—É–≥–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ç–æ—Ä–º–æ–∑—è—Ç

üë∑ –†–∞–±–æ—á–∏–π: "–ú–Ω–µ –Ω—É–∂–Ω–æ 8GB RAM!"
üíæ RAM: "–û–ö!" ‚Üí —Å–∏—Å—Ç–µ–º–∞ —Å–≤–æ–ø–∏—Ç—Å—è –Ω–∞ –¥–∏—Å–∫, –≤—Å—ë –º–µ–¥–ª–µ–Ω–Ω–æ–µ

üë∑ –†–∞–±–æ—á–∏–π: "–ú–Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å 10,000 –ø–æ–º–æ—â–Ω–∏–∫–æ–≤!"
üè≠ –§–∞–±—Ä–∏–∫–∞: "–û–ö!" ‚Üí fork bomb, —Å–∏—Å—Ç–µ–º–∞ –ø–∞–¥–∞–µ—Ç
```

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Ñ–∞–±—Ä–∏–∫—É –° –ø—Ä–∞–≤–∏–ª–∞–º–∏ (resource limits):

```
‚úÖ –° –õ–ò–ú–ò–¢–ê–ú–ò:
üë∑ –†–∞–±–æ—á–∏–π: "–ú–Ω–µ –Ω—É–∂–Ω–æ 100% CPU!"
üìã –ü—Ä–æ—Ñ—Å–æ—é–∑: "–ú–∞–∫—Å–∏–º—É–º 25% –¥–ª—è —Ç–µ–±—è, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö"

üë∑ –†–∞–±–æ—á–∏–π: "–ú–Ω–µ –Ω—É–∂–Ω–æ 8GB RAM!"
üìã –ü—Ä–æ—Ñ—Å–æ—é–∑: "–ú–∞–∫—Å–∏–º—É–º 128MB, –µ—Å–ª–∏ –ø—Ä–µ–≤—ã—Å–∏—à—å ‚Äî —É–≤–æ–ª–µ–Ω"

üë∑ –†–∞–±–æ—á–∏–π: "–ú–Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å 10,000 –ø–æ–º–æ—â–Ω–∏–∫–æ–≤!"
üìã –ü—Ä–æ—Ñ—Å–æ—é–∑: "–ú–∞–∫—Å–∏–º—É–º 50 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –±–æ–ª—å—à–µ –Ω–µ–ª—å–∑—è"
```

**–î–∏—Ä–µ–∫—Ç–æ—Ä (—Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)** —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ (resource limits).
**–ü—Ä–æ—Ñ—Å–æ—é–∑ (systemd)** —Å–ª–µ–¥–∏—Ç —á—Ç–æ–±—ã –Ω–∏–∫—Ç–æ –Ω–µ –Ω–∞—Ä—É—à–∞–ª.

---

#### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ Resource Limits

SystemD –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ª–∏–º–∏—Ç–æ–≤ –≤ —Å–µ–∫—Ü–∏–∏ **[Service]**:

##### 1. **CPU Limits**

```ini
# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU
CPUQuota=25%            # –ú–∞–∫—Å–∏–º—É–º 25% –æ–¥–Ω–æ–≥–æ —è–¥—Ä–∞
CPUQuota=200%           # –ú–∞–∫—Å–∏–º—É–º 2 –ø–æ–ª–Ω—ã—Ö —è–¥—Ä–∞ (–Ω–∞ –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã—Ö CPU)

# CPU scheduling priority
Nice=19                 # –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (-20 = highest, 19 = lowest)
CPUSchedulingPolicy=batch  # Batch scheduling (–¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á)
```

**–ü—Ä–∏–º–µ—Ä:**
```ini
# Backup –Ω–µ –¥–æ–ª–∂–µ–Ω —Ç–æ—Ä–º–æ–∑–∏—Ç—å production —Å–µ—Ä–≤–∏—Å—ã
CPUQuota=50%
Nice=10
```

---

##### 2. **Memory Limits**

```ini
# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–∞–º—è—Ç—å
MemoryLimit=128M        # –ú—è–≥–∫–∏–π –ª–∏–º–∏—Ç (–º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—Å–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ)
MemoryMax=128M          # –ñ—ë—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç (–µ—Å–ª–∏ –ø—Ä–µ–≤—ã—Å–∏—Ç ‚Üí kill)

# Swap limits
MemorySwapMax=0         # –ó–∞–ø—Ä–µ—Ç–∏—Ç—å swap (—Ç–æ–ª—å–∫–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏:**
- **MemoryLimit:** systemd –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø–∞–º—è—Ç—å (cache, buffers)
- **MemoryMax:** systemd —É–±–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å (OOM kill)

**–ë–æ—Ä–∏—Å:**
*"MemoryMax ‚Äî —ç—Ç–æ safety net. –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å —É—Ç–µ–∫–∞–µ—Ç –ø–∞–º—è—Ç—å ‚Äî systemd —É–±—å—ë—Ç –µ–≥–æ –î–û —Ç–æ–≥–æ –∫–∞–∫ –æ–Ω —Å—ä–µ—Å—Ç –≤—Å—é RAM —Å–∏—Å—Ç–µ–º—ã."*

---

##### 3. **Process/Thread Limits**

```ini
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤/–ø–æ—Ç–æ–∫–æ–≤
TasksMax=50             # –ú–∞–∫—Å–∏–º—É–º 50 –∑–∞–¥–∞—á (–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ + –ø–æ—Ç–æ–∫–æ–≤)

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ ulimit
LimitNPROC=100          # –ú–∞–∫—Å–∏–º—É–º 100 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç fork bomb:**
```ini
# –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å 51-–π –ø—Ä–æ—Ü–µ—Å—Å ‚Üí fail
TasksMax=50
```

**–ê–Ω–Ω–∞:**
*"TasksMax=50 —Å–ø–∞—Å–∞–µ—Ç –æ—Ç fork bomb. –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–∞–∫—Å–∏–º—É–º 50 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –Ω–µ —Ç—ã—Å—è—á–∏."*

---

##### 4. **File Descriptor Limits**

```ini
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
LimitNOFILE=1024        # –ú—è–≥–∫–∏–π –ª–∏–º–∏—Ç
LimitNOFILE=4096        # –ñ—ë—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç (—á–µ—Ä–µ–∑ infinity)
```

**–ö–æ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å:**
- –í–µ–±-—Å–µ—Ä–≤–µ—Ä—ã (–º–Ω–æ–≥–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)
- –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–º–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤)

---

##### 5. **Disk I/O Limits**

```ini
# I/O scheduling priority
IOSchedulingClass=2     # 0=none, 1=realtime, 2=best-effort, 3=idle
IOSchedulingPriority=7  # 0=highest, 7=lowest

# I/O bandwidth limits (cgroup v2)
IOReadBandwidthMax=/var 10M    # –ú–∞–∫—Å–∏–º—É–º 10MB/s —á—Ç–µ–Ω–∏–µ –∏–∑ /var
IOWriteBandwidthMax=/var 5M    # –ú–∞–∫—Å–∏–º—É–º 5MB/s –∑–∞–ø–∏—Å—å –≤ /var
```

**–ü—Ä–∏–º–µ—Ä:**
```ini
# Backup –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–º–µ–¥–ª—è—Ç—å production I/O
IOSchedulingClass=3     # idle (—Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–≤–æ–±–æ–¥–Ω–∞)
IOSchedulingPriority=7  # lowest priority
```

---

##### 6. **Timeout Limits**

```ini
# Timeouts
TimeoutStartSec=90s     # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞
TimeoutStopSec=30s      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
RuntimeMaxSec=3600s     # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (1 —á–∞—Å)
```

**–ü—Ä–∏–º–µ—Ä:**
```ini
# Backup –¥–æ–ª–∂–µ–Ω –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –∑–∞ 30 –º–∏–Ω—É—Ç
TimeoutStartSec=1800s

# –ï—Å–ª–∏ backup –∑–∞–≤–∏—Å–Ω–µ—Ç ‚Üí systemd —É–±—å—ë—Ç —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç
```

---

### üîí Security Hardening

SystemD –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Å—è—Ç–∫–∏ –æ–ø—Ü–∏–π –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –∏ –∑–∞—â–∏—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤.

#### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ Security Features

##### 1. **Privilege Restrictions**

```ini
# –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
NoNewPrivileges=true    # –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∞–≤ (suid/sudo)

# –ó–∞–ø—Ä–µ—Ç–∏—Ç—å ambient capabilities
AmbientCapabilities=    # –ü—É—Å—Ç–æ–µ = –Ω–µ—Ç capabilities
```

**–ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç:**
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ suid –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
- ‚ùå –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ sudo –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞
- ‚ùå –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö capabilities

**–ê–Ω–Ω–∞:**
*"NoNewPrivileges=true ‚Äî –ø–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã. –î–∞–∂–µ –µ—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–∏—Å ‚Äî –æ–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏."*

---

##### 2. **Filesystem Isolation**

```ini
# Read-only —Å–∏—Å—Ç–µ–º–∞
ProtectSystem=strict    # / –∏ /usr read-only (—Å–µ—Ä–≤–∏—Å –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å–∏—Å—Ç–µ–º—É)
ProtectSystem=full      # /usr –∏ /boot read-only
ProtectSystem=true      # —Ç–æ–ª—å–∫–æ /usr read-only

# –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–æ–º–∞—à–Ω–∏–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º
ProtectHome=true        # /home, /root, /run/user –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

# –ü—Ä–∏–≤–∞—Ç–Ω—ã–π /tmp
PrivateTmp=true         # –°–µ—Ä–≤–∏—Å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π /tmp

# –†–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–ø–∏—Å—å —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ReadWritePaths=/var/operations/shadow-monitor
```

**–ü—Ä–∏–º–µ—Ä:**
```ini
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω—è—Ç—å —Å–∏—Å—Ç–µ–º—É
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/operations/shadow-monitor
```

---

##### 3. **Kernel Protection**

```ini
# –ó–∞—â–∏—Ç–∞ kernel
ProtectKernelModules=true     # –ù–µ–ª—å–∑—è –∑–∞–≥—Ä—É–∂–∞—Ç—å kernel –º–æ–¥—É–ª–∏
ProtectKernelTunables=true    # –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å /sys, /proc/sys
ProtectKernelLogs=true        # –ù–µ–ª—å–∑—è —á–∏—Ç–∞—Ç—å kernel –ª–æ–≥–∏ (dmesg)
ProtectControlGroups=true     # –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å cgroups
```

---

##### 4. **Process Visibility**

```ini
# –°–∫—Ä—ã—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
ProtectProc=invisible   # –°–µ—Ä–≤–∏—Å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ /proc
ProcSubset=pid          # –í–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ /proc/PID/, –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ
```

---

##### 5. **Network Restrictions**

```ini
# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ç–∏
PrivateNetwork=true            # –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π network namespace (–Ω–µ—Ç —Å–µ—Ç–∏)
RestrictAddressFamilies=AF_INET AF_INET6  # –¢–æ–ª—å–∫–æ IPv4/IPv6 (–Ω–µ—Ç AF_UNIX, AF_NETLINK)

# IP —Ñ–∏–ª—å—Ç—Ä—ã
IPAddressAllow=10.0.0.0/8      # –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Ç—å
IPAddressDeny=any              # –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Hardened Service

**–ó–∞–¥–∞—á–∞:** –£–ª—É—á—à–∏—Ç—å `shadow-monitor.service` —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç–æ–π.

```ini
[Unit]
Description=KERNEL SHADOWS System Monitor (Hardened)
Documentation=https://github.com/kernel-shadows/episode-10
After=network-online.target
Wants=network-online.target
Requires=systemd-journald.service

[Service]
Type=simple
User=shadow-monitor
Group=shadow-monitor
WorkingDirectory=/var/operations/shadow-monitor

ExecStart=/usr/local/bin/shadow-monitor.sh

# Pre-checks
ExecStartPre=/usr/bin/test -f /usr/local/bin/shadow-monitor.sh
ExecStartPre=/usr/bin/test -x /usr/local/bin/shadow-monitor.sh

# ============================================================================
# Restart Policy
# ============================================================================
Restart=on-failure
RestartSec=10s
StartLimitBurst=5
StartLimitIntervalSec=60s

# ============================================================================
# Resource Limits
# ============================================================================
# CPU: –ú–∞–∫—Å–∏–º—É–º 25% (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–∏—Å—Ç–µ–º—É)
CPUQuota=25%
Nice=10

# Memory: –ú–∞–∫—Å–∏–º—É–º 128MB
MemoryMax=128M

# Tasks: –ú–∞–∫—Å–∏–º—É–º 50 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤/–ø–æ—Ç–æ–∫–æ–≤ (–∑–∞—â–∏—Ç–∞ –æ—Ç fork bomb)
TasksMax=50

# File descriptors: –ú–∞–∫—Å–∏–º—É–º 1024 –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
LimitNOFILE=1024

# I/O: –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
IOSchedulingClass=2
IOSchedulingPriority=7

# Timeout: –ú–∞–∫—Å–∏–º—É–º 1 —á–∞—Å —Ä–∞–±–æ—Ç—ã (–∑–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫)
RuntimeMaxSec=3600s

# ============================================================================
# Security Hardening
# ============================================================================
# Privilege restrictions
NoNewPrivileges=true

# Filesystem isolation
ProtectSystem=strict
ProtectHome=true
PrivateTmp=true
ReadWritePaths=/var/operations/shadow-monitor

# Kernel protection
ProtectKernelModules=true
ProtectKernelTunables=true
ProtectKernelLogs=true
ProtectControlGroups=true

# Process visibility
ProtectProc=invisible
ProcSubset=pid

# Network restrictions (–µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–∞ —Å–µ—Ç—å)
# PrivateNetwork=true

# Restrict system calls (advanced)
SystemCallFilter=@system-service
SystemCallFilter=~@privileged @resources
SystemCallErrorNumber=EPERM

# ============================================================================
# Logging
# ============================================================================
StandardOutput=journal
StandardError=journal
SyslogIdentifier=shadow-monitor

[Install]
WantedBy=multi-user.target
```

**–ë–æ—Ä–∏—Å:**
*"–≠—Ç–æ production-grade security. –ï—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å ‚Äî –æ–Ω –≤ sandbox. –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–µ, –Ω–µ—Ç –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π, –Ω–µ—Ç fork bomb, –Ω–µ—Ç —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–≤—ã—Å–∏—Ç MemoryMax=128M?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**
SystemD —É–±—å—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å (OOM kill).

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
1. –ü—Ä–æ—Ü–µ—Å—Å –ø—ã—Ç–∞–µ—Ç—Å—è –∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å > 128MB
2. Kernel –≤–∏–¥–∏—Ç —á—Ç–æ –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω
3. Kernel –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç SIGKILL –ø—Ä–æ—Ü–µ—Å—Å—É
4. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è

**–í –ª–æ–≥–∞—Ö:**
```
journalctl -u shadow-monitor.service
# memory.max exceeded, OOM killer invoked
# Process 12345 killed (signal 9)
```

**SystemD –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫:**
```ini
Restart=on-failure  # –ï—Å–ª–∏ –±—ã–ª MemoryMax OOM ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
```

**–ó–∞—á–µ–º:**
–ó–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º—ã. –õ—É—á—à–µ —É–±–∏—Ç—å –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å —á–µ–º –¥–∞—Ç—å –µ–º—É —Å—ä–µ—Å—Ç—å –≤—Å—é –ø–∞–º—è—Ç—å –∏ –ø–æ–ª–æ–∂–∏—Ç—å —Å–∏—Å—Ç–µ–º—É.

**–ë–æ—Ä–∏—Å:** *"MemoryMax ‚Äî —ç—Ç–æ circuit breaker. –ñ–µ—Ä—Ç–≤—É–µ–º –æ–¥–Ω–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º —Ä–∞–¥–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ó–∞—á–µ–º NoNewPrivileges=true?

<details>
<summary>üí° Privilege Escalation Protection</summary>

**–û—Ç–≤–µ—Ç:**
–ó–∞–ø—Ä–µ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—É –ø–æ–ª—É—á–∞—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π —á–µ–º —É –Ω–µ–≥–æ –µ—Å—Ç—å.

**–ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç:**

**1. SUID –±–∏–Ω–∞—Ä–Ω–∏–∫–∏:**
```bash
# –ë–µ–∑ NoNewPrivileges:
$ /usr/bin/passwd  # SUID root ‚Üí –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∞–µ—Ç root
# –†–ê–ë–û–¢–ê–ï–¢

# –° NoNewPrivileges=true:
$ /usr/bin/passwd
# FAIL: Operation not permitted
```

**2. Sudo –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞:**
```bash
# –í —Å–∫—Ä–∏–ø—Ç–µ —Å–µ—Ä–≤–∏—Å–∞:
sudo systemctl restart nginx

# –° NoNewPrivileges=true:
# sudo: effective uid is not 0, is sudo installed setuid root?
# FAIL
```

**3. Capabilities:**
```bash
# –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å CAP_NET_ADMIN
setcap cap_net_admin+ep /usr/local/bin/script

# –° NoNewPrivileges=true:
# FAIL: cannot elevate capabilities
```

**–ó–∞—á–µ–º:**
–ï—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–∏—Å ‚Üí –æ–Ω –∑–∞—Å—Ç—Ä—è–Ω–µ—Ç —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ `shadow-monitor` (–Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å). –ù–µ —Å–º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –¥–æ root.

**–ê–Ω–Ω–∞:** *"NoNewPrivileges=true ‚Äî —ç—Ç–æ safety belt. –î–∞–∂–µ –µ—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π –Ω–∞–π–¥—ë—Ç 0-day –≤ suid –±–∏–Ω–∞—Ä–Ω–∏–∫–µ ‚Äî –æ–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –∏–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç fork bomb –≤ systemd?

<details>
<summary>üí° TasksMax</summary>

**–û—Ç–≤–µ—Ç:**
–ò—Å–ø–æ–ª—å–∑—É–π **TasksMax** –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤/–ø–æ—Ç–æ–∫–æ–≤.

**–ü—Ä–∏–º–µ—Ä:**
```ini
[Service]
TasksMax=50
```

**Fork bomb:**
```bash
# –ó–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
:(){ :|:& };:

# –°–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ:
# 1 ‚Üí 2 ‚Üí 4 ‚Üí 8 ‚Üí 16 ‚Üí 32 ‚Üí 64 ‚Üí ...
```

**–° TasksMax=50:**
```
–ü—Ä–æ—Ü–µ—Å—Å 1 —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å 2 ‚úì
–ü—Ä–æ—Ü–µ—Å—Å 2 —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å 3 –∏ 4 ‚úì
...
–ü—Ä–æ—Ü–µ—Å—Å 50 —Å–æ–∑–¥–∞–Ω ‚úì
–ü—Ä–æ—Ü–µ—Å—Å –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å 51 ‚ùå
Kernel: "TasksMax exceeded" ‚Üí FAIL

Systemd: "Service failed" ‚Üí Restart=on-failure ‚Üí kill –≤—Å–µ 50 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
```

**–î—Ä—É–≥–∏–µ –∑–∞—â–∏—Ç—ã:**
```ini
# –í /etc/security/limits.conf (–∏–∑ Episode 09!)
shadow-monitor  hard  nproc  100

# –í systemd
LimitNPROC=100
TasksMax=50
```

**–ë–æ—Ä–∏—Å:** *"TasksMax ‚Äî —ç—Ç–æ airbag –¥–ª—è fork bomb. –û–≥—Ä–∞–Ω–∏—á—å –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ —Ä–∞–∑—É–º–Ω–æ–µ —á–∏—Å–ª–æ (50, 100). –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –Ω–µ –Ω—É–∂–Ω–æ 10,000 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 5

- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º resource limits (–∑–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º—ã)
- [ ] –ó–Ω–∞—é –æ—Å–Ω–æ–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã (CPU, Memory, Tasks, Files)
- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ –¥–µ–ª–∞–µ—Ç NoNewPrivileges=true
- [ ] –ü–æ–Ω–∏–º–∞—é –∫–∞–∫ TasksMax –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç fork bomb
- [ ] –ó–Ω–∞—é security features (ProtectSystem, ProtectHome, PrivateTmp)
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å hardened service unit

**LILITH:**
*"Resource limits ‚Äî —ç—Ç–æ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã. –≠—Ç–æ –∑–∞—â–∏—Ç–∞. –û–¥–∏–Ω –ø–ª–æ—Ö–æ–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –¥–æ–ª–∂–µ–Ω —É–±–∏—Ç—å –≤—Å—é —Å–∏—Å—Ç–µ–º—É. Production thinking."*

---

## üîÑ –¶–ò–ö–õ 6: Journalctl ‚Äî –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ (15-20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–Ω–∞** (–≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫, –≤–µ—á–µ—Ä):
*"–ú–∞–∫—Å, —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç, security hardening –Ω–∞ –º–µ—Å—Ç–µ. –û—Ç–ª–∏—á–Ω–æ. –ù–æ —Ç–µ–ø–µ—Ä—å –≤–æ–ø—Ä–æ—Å: –ö–ê–ö —Ç—ã —É–∑–Ω–∞–µ—à—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç? –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å —É–ø–∞–¥—ë—Ç –≤ 3 –Ω–æ—á–∏ ‚Äî –∫–∞–∫ —Ç—ã –æ–± —ç—Ç–æ–º —É–∑–Ω–∞–µ—à—å?"*

**–ú–∞–∫—Å:**
*"–õ–æ–≥–∏ –≤ `/var/log/` ?"*

**–ê–Ω–Ω–∞:**
*"–≠—Ç–æ —Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±. SystemD –∏—Å–ø–æ–ª—å–∑—É–µ—Ç journald ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–∏—à—É—Ç –≤ journald. –í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ, —Ñ–∏–ª—å—Ç—Ä—É–µ–º–æ, searchable."*

**–ë–æ—Ä–∏—Å:**
*"journalctl ‚Äî —ç—Ç–æ —Ç–≤–æ–∏ –≥–ª–∞–∑–∞ –∏ —É—à–∏. –ë–µ–∑ –ª–æ–≥–æ–≤ —Ç—ã —Å–ª–µ–ø–æ–π. –ù–∞—É—á–∏—Å—å —á–∏—Ç–∞—Ç—å journalctl –∫–∞–∫ –≥–∞–∑–µ—Ç—É."*

---

### üìö –¢–µ–æ—Ä–∏—è: SystemD Journal

#### üì∞ –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Journalctl = –ì–∞–∑–µ—Ç–∞ —Ñ–∞–±—Ä–∏–∫–∏

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —á—Ç–æ –Ω–∞ —Ñ–∞–±—Ä–∏–∫–µ (Linux —Å–∏—Å—Ç–µ–º–∞) –µ—Å—Ç—å **–≥–ª–∞–≤–Ω–∞—è –≥–∞–∑–µ—Ç–∞** (journal):

```
üì∞ FACTORY DAILY NEWS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

[10:00] üë∑ –†–∞–±–æ—á–∏–π #1456 (nginx): "Started successfully"
[10:01] üë∑ –†–∞–±–æ—á–∏–π #6623 (shadow-monitor): "Monitoring active"
[10:02] ‚ö†Ô∏è  –†–∞–±–æ—á–∏–π #6623: "ALERT: Suspicious process detected!"
[10:03] üë∑ –†–∞–±–æ—á–∏–π #1789 (shadow-backup): "Backup started"
[10:05] ‚úì  –†–∞–±–æ—á–∏–π #1789: "Backup completed: 1.2GB"
[10:06] ‚ùå –†–∞–±–æ—á–∏–π #8821 (firefox): "Crashed (segfault)"
[10:06] üîÑ –†–∞–±–æ—á–∏–π #8821: "Restarted (attempt 1/5)"
...
```

**–ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ ‚Üí –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª.**

**–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç (journald)** —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ –æ—Ç –≤—Å–µ—Ö —Ä–∞–±–æ—á–∏—Ö (—Å–µ—Ä–≤–∏—Å–æ–≤).
**–ß–∏—Ç–∞—Ç–µ–ª—å (—Ç—ã)** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `journalctl` —á—Ç–æ–±—ã —á–∏—Ç–∞—Ç—å –≥–∞–∑–µ—Ç—É.

---

#### üéØ –ß—Ç–æ —Ç–∞–∫–æ–µ SystemD Journal?

**SystemD Journal (journald)** ‚Äî —ç—Ç–æ:
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –•—Ä–∞–Ω–∏—Ç –ª–æ–≥–∏ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (`/var/log/journal/`)
- –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ searchable
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å systemd (–∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç —Ç—É–¥–∞)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ vs `/var/log/*`:**

| –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (/var/log/*) | SystemD Journal |
|-----------------------------|-----------------|
| –õ–æ–≥–∏ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ñ–∞–π–ª–∞–º | –í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ |
| –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã (grep) | –ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–∏–Ω–¥–µ–∫—Å—ã) |
| –†–æ—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ logrotate | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è |
| –ù–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö | –ë–æ–≥–∞—Ç—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (priority, unit, pid, etc.) |
| –ù—É–∂–µ–Ω tail -f –¥–ª—è realtime | `journalctl -f` –≤—Å—Ç—Ä–æ–µ–Ω–æ |

**–ë–æ—Ä–∏—Å:**
*"Journald ‚Äî —ç—Ç–æ Google –¥–ª—è –ª–æ–≥–æ–≤. –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ, –±—ã—Å—Ç—Ä–æ, —Ñ–∏–ª—å—Ç—Ä—É–µ–º–æ. `/var/log/` ‚Äî —ç—Ç–æ –±—É–º–∞–∂–Ω–∞—è –∫–∞—Ä—Ç–æ—Ç–µ–∫–∞."*

---

### üíª –ö–æ–º–∞–Ω–¥–∞ journalctl

#### üéØ –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –í—Å–µ –ª–æ–≥–∏ (—Å –Ω–∞—á–∞–ª–∞ –≤—Ä–µ–º—ë–Ω)
journalctl

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
journalctl -n 50

# Real-time (follow)
journalctl -f

# –° –º–æ–º–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
journalctl -b

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
journalctl -u shadow-monitor.service

# –õ–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
journalctl --since "1 hour ago"

# –õ–æ–≥–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
journalctl --since today

# –õ–æ–≥–∏ –∑–∞ –≤—á–µ—Ä–∞
journalctl --since yesterday --until today
```

---

#### üé® –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

##### 1. **–ü–æ —Å–µ—Ä–≤–∏—Å—É (unit)**

```bash
# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
journalctl -u nginx.service

# –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤
journalctl -u nginx.service -u shadow-monitor.service

# Real-time –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞
journalctl -u shadow-monitor.service -f
```

---

##### 2. **–ü–æ –≤—Ä–µ–º–µ–Ω–∏**

```bash
# –° –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
journalctl --since "2025-10-11 10:00:00"

# –ú–µ–∂–¥—É –¥–≤—É–º—è –¥–∞—Ç–∞–º–∏
journalctl --since "2025-10-11" --until "2025-10-12"

# –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
journalctl --since "2 hours ago"
journalctl --since "30 minutes ago"
journalctl --since today
journalctl --since yesterday
```

---

##### 3. **–ü–æ priority (—É—Ä–æ–≤–µ–Ω—å –≤–∞–∂–Ω–æ—Å—Ç–∏)**

```bash
# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
journalctl -p err

# –û—à–∏–±–∫–∏ –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ
journalctl -p err..crit

# Warning –∏ –≤—ã—à–µ
journalctl -p warning
```

**Priority levels:**
```
0: emerg   (Emergency, —Å–∏—Å—Ç–µ–º–∞ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞)
1: alert   (Alert, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ–±—É—é—Ç—Å—è)
2: crit    (Critical)
3: err     (Error)
4: warning (Warning)
5: notice  (Notice, –Ω–æ—Ä–º–∞–ª—å–Ω–æ –Ω–æ –≤–∞–∂–Ω–æ)
6: info    (Information)
7: debug   (Debug, –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞)
```

---

##### 4. **–ü–æ –ø—Ä–æ—Ü–µ—Å—Å—É (PID)**

```bash
# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ PID
journalctl _PID=6623

# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
journalctl _UID=1000
```

---

##### 5. **–ü–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É (SyslogIdentifier)**

```bash
# –õ–æ–≥–∏ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º
journalctl -t shadow-monitor
journalctl -t shadow-backup

# –í service unit:
SyslogIdentifier=shadow-monitor
```

---

#### üé® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞

```bash
# –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
journalctl -o short

# –° –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏
journalctl -o verbose

# JSON —Ñ–æ—Ä–º–∞—Ç
journalctl -o json

# JSON pretty-print
journalctl -o json-pretty

# –¢–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–±–µ–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö)
journalctl -o cat
```

---

#### üé® –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

##### 1. **Troubleshooting —É–ø–∞–≤—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞**

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–∏—Å–∞
journalctl -u shadow-monitor.service -n 50

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
journalctl -u shadow-monitor.service -p err

# –° –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫—Ä–∞—à–∞
journalctl -u shadow-monitor.service --since "10 minutes ago"
```

---

##### 2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**

```bash
# Follow –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞
journalctl -u shadow-monitor.service -f

# Follow —Ç–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫
journalctl -p err -f

# Follow –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
journalctl -u nginx.service -u shadow-monitor.service -f
```

---

##### 3. **–ê–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã**

```bash
# –õ–æ–≥–∏ —Ç–µ–∫—É—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏
journalctl -b

# –õ–æ–≥–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏
journalctl -b -1

# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∑–æ–∫
journalctl --list-boots

# –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
systemd-analyze blame
```

---

##### 4. **–ü–æ–∏—Å–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤**

```bash
# Grep –≤ –ª–æ–≥–∞—Ö
journalctl -u shadow-monitor.service | grep "ALERT"

# –ü–æ–∏—Å–∫ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
journalctl -u shadow-monitor.service | grep -E "ERROR|CRITICAL"

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
journalctl -u shadow-monitor.service -p err | wc -l
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Debugging —á–µ—Ä–µ–∑ journalctl

#### –°—Ü–µ–Ω–∞—Ä–∏–π: –°–µ—Ä–≤–∏—Å –ø–∞–¥–∞–µ—Ç, –Ω—É–∂–Ω–æ –≤—ã—è—Å–Ω–∏—Ç—å –ø–æ—á–µ–º—É

**–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å**

```bash
sudo systemctl status shadow-monitor.service

# –í—ã–≤–æ–¥:
# ‚óè shadow-monitor.service - KERNEL SHADOWS System Monitor
#      Loaded: loaded (/etc/systemd/system/shadow-monitor.service)
#      Active: failed (Result: signal) since Sat 2025-10-11 14:32:15 UTC
#     Process: 6623 ExecStart=/usr/local/bin/shadow-monitor.sh (code=killed, signal=KILL)
#    Main PID: 6623 (code=killed, signal=KILL)
```

–í–∏–¥–∏–º: **signal=KILL** (–±—ã–ª —É–±–∏—Ç).

---

**–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏**

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
sudo journalctl -u shadow-monitor.service -n 100

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
sudo journalctl -u shadow-monitor.service -p err
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

**1. MemoryMax exceeded (OOM kill):**
```
Oct 11 14:32:15 server systemd[1]: shadow-monitor.service: A process of this unit has been killed by the OOM killer.
Oct 11 14:32:15 server systemd[1]: shadow-monitor.service: Main process exited, code=killed, status=9/KILL
```

**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å MemoryMax –∏–ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å memory leak –≤ —Å–∫—Ä–∏–ø—Ç–µ.

---

**2. –ü—Ä–µ–≤—ã—à–µ–Ω TasksMax:**
```
Oct 11 14:32:15 server systemd[1]: shadow-monitor.service: Failed to create new process: Resource limit of processes (50) reached
```

**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å TasksMax –∏–ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å fork bomb –≤ —Å–∫—Ä–∏–ø—Ç–µ.

---

**3. –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π:**
```
Oct 11 14:32:15 server shadow-monitor[6623]: Error: File /var/operations/data not found
Oct 11 14:32:15 server systemd[1]: shadow-monitor.service: Main process exited, code=exited, status=1/FAILURE
```

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É –≤ —Å–∫—Ä–∏–ø—Ç–µ.

---

**–®–∞–≥ 3: Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl restart shadow-monitor.service

# Follow –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo journalctl -u shadow-monitor.service -f

# –°–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `journalctl -b` –∏ `journalctl`?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**

| `journalctl` | `journalctl -b` |
|--------------|-----------------|
| –í—Å–µ –ª–æ–≥–∏ (—Å –Ω–∞—á–∞–ª–∞ –≤—Ä–µ–º—ë–Ω) | –õ–æ–≥–∏ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ |
| –ú–æ–∂–µ—Ç –±—ã—Ç—å –û–ß–ï–ù–¨ –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö | –¢–æ–ª—å–∫–æ –ª–æ–≥–∏ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ reboot |

**–ü—Ä–∏–º–µ—Ä:**
```bash
# –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç 30 –¥–Ω–µ–π
journalctl
# –í—ã–≤–æ–¥: –ª–æ–≥–∏ –∑–∞ 30 –¥–Ω–µ–π (–≥–∏–≥–∞–±–∞–π—Ç—ã –¥–∞–Ω–Ω—ã—Ö)

journalctl -b
# –í—ã–≤–æ–¥: –ª–æ–≥–∏ —Ç–æ–ª—å–∫–æ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ reboot (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- `journalctl` ‚Äî –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏—Å—Ç–æ—Ä–∏–∏ (—á—Ç–æ –±—ã–ª–æ –≤—á–µ—Ä–∞, –Ω–µ–¥–µ–ª—é –Ω–∞–∑–∞–¥)
- `journalctl -b` ‚Äî –¥–ª—è troubleshooting —Ç–µ–∫—É—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ (–ø–æ—á–µ–º—É —Å–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è —Å–µ–≥–æ–¥–Ω—è)

**–ë–æ—Ä–∏—Å:** *"`-b` ‚Äî —ç—Ç–æ '—Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –≥–∞–∑–µ—Ç–∞'. –ë–µ–∑ `-b` ‚Äî —ç—Ç–æ '–∞—Ä—Ö–∏–≤ –∑–∞ –≤—Å–µ –≥–æ–¥—ã'."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ö–∞–∫ –Ω–∞–π—Ç–∏ –≤—Å–µ –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–∏—Å–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å?

<details>
<summary>üí° –ö–æ–º–∞–Ω–¥–∞</summary>

**–û—Ç–≤–µ—Ç:**
```bash
journalctl -u shadow-monitor.service -p err --since "1 hour ago"
```

**–†–∞–∑–±–æ—Ä:**
- `-u shadow-monitor.service` ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
- `-p err` ‚Äî priority = error (—Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏)
- `--since "1 hour ago"` ‚Äî –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –æ—à–∏–±–æ–∫
journalctl -u shadow-monitor.service -p err -n 50

# –û—à–∏–±–∫–∏ —Å 10:00 –¥–æ —Å–µ–π—á–∞—Å
journalctl -u shadow-monitor.service -p err --since "10:00"

# –û—à–∏–±–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
journalctl -u shadow-monitor.service -p err --since today
```

**–ê–Ω–Ω–∞:** *"–≠—Ç–æ –ø–µ—Ä–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–∏ troubleshooting. –û—à–∏–±–∫–∏ ‚Üí –ø—Ä–∏—á–∏–Ω–∞ ‚Üí —Ä–µ—à–µ–Ω–∏–µ."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç "code=killed, signal=KILL" –≤ systemctl status?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**
–ü—Ä–æ—Ü–µ—Å—Å –±—ã–ª **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É–±–∏—Ç** (SIGKILL).

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

**1. MemoryMax exceeded (OOM kill):**
```bash
journalctl -u service.service | grep OOM
# shadow-monitor.service: A process has been killed by the OOM killer
```

**2. –ü—Ä–µ–≤—ã—à–µ–Ω timeout:**
```bash
# –í service unit:
TimeoutStartSec=30s

# –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –∑–∞ 30 —Å–µ–∫—É–Ω–¥ ‚Üí systemd —É–±–∏–≤–∞–µ—Ç (SIGKILL)
```

**3. –†—É—á–Ω–æ–µ —É–±–∏–π—Å—Ç–≤–æ:**
```bash
sudo kill -9 6623  # SIGKILL
```

**4. SystemD restart –∏–∑-–∑–∞ RuntimeMaxSec:**
```ini
RuntimeMaxSec=3600s  # –ú–∞–∫—Å–∏–º—É–º 1 —á–∞—Å —Ä–∞–±–æ—Ç—ã
# –ß–µ—Ä–µ–∑ —á–∞—Å systemd —É–±–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç
```

**–ö–∞–∫ —É–∑–Ω–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
journalctl -u service.service -n 50

# –ò—Å–∫–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:
# - OOM killer
# - timeout
# - RuntimeMaxSec
# - memory.max exceeded
```

**–ë–æ—Ä–∏—Å:** *"signal=KILL –≤—Å–µ–≥–¥–∞ involuntary (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ). –ü—Ä–æ—Ü–µ—Å—Å –ù–ï —Ö–æ—Ç–µ–ª —É–º–∏—Ä–∞—Ç—å, –µ–≥–æ —É–±–∏–ª–∏."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 6

- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ systemd journal
- [ ] –ó–Ω–∞—é –±–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã journalctl (-u, -f, -b, -n, -p)
- [ ] –£–º–µ—é —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ (–ø–æ –≤—Ä–µ–º–µ–Ω–∏, priority, unit)
- [ ] –ú–æ–≥—É troubleshoot —É–ø–∞–≤—à–∏–π —Å–µ—Ä–≤–∏—Å —á–µ—Ä–µ–∑ journalctl
- [ ] –ü–æ–Ω–∏–º–∞—é priority levels (emerg, alert, crit, err, warning, info, debug)

**LILITH:**
*"Journalctl ‚Äî —ç—Ç–æ —á—ë—Ä–Ω—ã–π —è—â–∏–∫ —Å–∏—Å—Ç–µ–º—ã. –ü–æ—Å–ª–µ –∫—Ä–∞—à–∞ ‚Äî –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º —Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏. –ë–µ–∑ –ª–æ–≥–æ–≤ troubleshooting = –≥–∞–¥–∞–Ω–∏–µ –Ω–∞ –∫–æ—Ñ–µ–π–Ω–æ–π –≥—É—â–µ."*

---

## üîÑ –¶–ò–ö–õ 7: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ (20-25 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**–ë–æ—Ä–∏—Å** (–∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª):
*"–¢–µ–æ—Ä–∏—è –∑–∞–∫–æ–Ω—á–µ–Ω–∞. –¢–µ–ø–µ—Ä—å –ø—Ä–∞–∫—Ç–∏–∫–∞. –£ —Ç–µ–±—è –µ—Å—Ç—å `starter/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∏—Ö, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å units, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å."*

**–ú–∞–∫—Å:**
*"–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?"*

**–ë–æ—Ä–∏—Å:**
*"–°–æ–∑–¥–∞—Ç—å production-ready –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å —Ç—Ä–µ–º—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:"*

```
1. shadow-monitor.service    ‚Äî –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Type=simple)
2. shadow-backup.service      ‚Äî Backup –∑–∞–¥–∞—á–∞ (Type=oneshot)
3. shadow-backup.timer        ‚Äî –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è backup (daily 02:00)
```

*"–í—Å–µ units —Å resource limits, security hardening, logging –≤ journalctl."*

---

### üéØ –ó–∞–¥–∞–Ω–∏–µ

#### **–ß–∞—Å—Ç—å 1: –ó–∞–ø–æ–ª–Ω–∏—Ç—å TODO –≤ starter/systemd/**

–û—Ç–∫—Ä–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `starter/`:

```bash
cd /home/fazzz/kernel-shadows/season-3-system-administration/episode-10-processes-systemd/starter/systemd/
ls -la
# shadow-backup.service
# shadow-backup.timer
# shadow-monitor.service
```

**–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∏—Ö.**

**–ü—Ä–∏–º–µ—Ä TODO:**
```ini
# TODO 1: –î–æ–±–∞–≤—å Description –¥–ª—è —Å–ª—É–∂–±—ã
# –ü–æ–¥—Å–∫–∞–∑–∫–∞: Description=KERNEL SHADOWS Automated Backup
Description=???
```

**–¢–≤–æ–π –æ—Ç–≤–µ—Ç:**
```ini
Description=KERNEL SHADOWS Automated Backup
```

---

**üìã Workflow (–ø–æ–¥—Ä–æ–±–Ω–æ –≤ `starter/README.md`):**

1. **–û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª** `shadow-backup.service`
2. **–ù–∞–π–¥–∏ TODO** (16 —à—Ç—É–∫)
3. **–ó–∞–ø–æ–ª–Ω–∏** –∫–∞–∂–¥—ã–π TODO –∏—Å–ø–æ–ª—å–∑—É—è –ø–æ–¥—Å–∫–∞–∑–∫–∏
4. **–°–æ—Ö—Ä–∞–Ω–∏** —Ñ–∞–π–ª
5. **–ü–æ–≤—Ç–æ—Ä–∏** –¥–ª—è `shadow-backup.timer` –∏ `shadow-monitor.service`

---

#### **–ß–∞—Å—Ç—å 2: –°–æ–∑–¥–∞—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã**

SystemD units –∑–∞–ø—É—Å–∫–∞—é—Ç bash —Å–∫—Ä–∏–ø—Ç—ã. –°–æ–∑–¥–∞–π –∏—Ö:

**A. `/usr/local/bin/shadow-backup.sh`**

```bash
#!/bin/bash
# –ü—Ä–æ—Å—Ç–æ–π backup script

BACKUP_DIR="/var/backups/shadow"
TIMESTAMP=$(date +"%Y%m%d_%H%M%S")

# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p "$BACKUP_DIR"

# Backup /var/operations
tar -czf "$BACKUP_DIR/backup_$TIMESTAMP.tar.gz" /var/operations 2>/dev/null

echo "Backup completed: backup_$TIMESTAMP.tar.gz"
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
sudo nano /usr/local/bin/shadow-backup.sh
# (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤—ã—à–µ)

sudo chmod +x /usr/local/bin/shadow-backup.sh
```

---

**B. `/usr/local/bin/shadow-monitor.sh`**

```bash
#!/bin/bash
# –ü—Ä–æ—Å—Ç–æ–π monitoring script

while true; do
    echo "[$(date)] Monitoring active. Checking for suspicious processes..."

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ backdoor –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    if ps aux | grep -E 'sshd_backup|backdoor' | grep -v grep > /dev/null; then
        echo "[ALERT] Suspicious process detected!"
    fi

    sleep 30
done
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
sudo nano /usr/local/bin/shadow-monitor.sh
# (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤—ã—à–µ)

sudo chmod +x /usr/local/bin/shadow-monitor.sh
```

---

#### **–ß–∞—Å—Ç—å 3: –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

```bash
# –ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è monitor
sudo useradd -r -s /bin/false shadow-monitor

# –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
sudo mkdir -p /var/operations/shadow-monitor
sudo chown shadow-monitor:shadow-monitor /var/operations/shadow-monitor
```

---

#### **–ß–∞—Å—Ç—å 4: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å units –≤ —Å–∏—Å—Ç–µ–º—É**

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å units –∏–∑ starter/ –≤ /etc/systemd/system/
sudo cp starter/systemd/shadow-backup.service /etc/systemd/system/
sudo cp starter/systemd/shadow-backup.timer /etc/systemd/system/
sudo cp starter/systemd/shadow-monitor.service /etc/systemd/system/

# Permissions
sudo chmod 644 /etc/systemd/system/shadow-*.service
sudo chmod 644 /etc/systemd/system/shadow-*.timer

# Reload systemd (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
sudo systemctl daemon-reload
```

---

#### **–ß–∞—Å—Ç—å 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ units –Ω–∞ –æ—à–∏–±–∫–∏
sudo systemd-analyze verify shadow-backup.service
sudo systemd-analyze verify shadow-backup.timer
sudo systemd-analyze verify shadow-monitor.service

# –ï—Å–ª–∏ –æ—à–∏–±–∫–∏ ‚Äî –∏—Å–ø—Ä–∞–≤—å –≤ starter/, —Å–∫–æ–ø–∏—Ä—É–π –∑–∞–Ω–æ–≤–æ, daemon-reload
```

---

#### **–ß–∞—Å—Ç—å 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

**A. Backup service (oneshot)**

```bash
# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
sudo systemctl start shadow-backup.service

# –°—Ç–∞—Ç—É—Å (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å inactive (dead) ‚Äî —ç—Ç–æ OK –¥–ª—è oneshot!)
sudo systemctl status shadow-backup.service

# –õ–æ–≥–∏
sudo journalctl -u shadow-backup.service

# –ü—Ä–æ–≤–µ—Ä–∫–∞ backup —Ñ–∞–π–ª–∞
ls -lh /var/backups/shadow/
```

---

**B. Monitor service (simple)**

```bash
# –ó–∞–ø—É—Å–∫
sudo systemctl start shadow-monitor.service

# –°—Ç–∞—Ç—É—Å (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å active (running))
sudo systemctl status shadow-monitor.service

# Real-time –ª–æ–≥–∏
sudo journalctl -u shadow-monitor.service -f

# (Ctrl+C –¥–ª—è –≤—ã—Ö–æ–¥–∞)
```

---

**C. Backup timer**

```bash
# Enable + Start
sudo systemctl enable shadow-backup.timer
sudo systemctl start shadow-backup.timer

# –°—Ç–∞—Ç—É—Å
sudo systemctl status shadow-backup.timer

# –ö–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫
sudo systemctl list-timers shadow-backup.timer

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
# NEXT: 2025-10-12 02:00:00 UTC
```

---

**D. –¢–µ—Å—Ç –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ monitor**

```bash
# –ù–∞–π—Ç–∏ PID
PID=$(systemctl show shadow-monitor.service -p MainPID --value)

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (—Å–∏–º—É–ª—è—Ü–∏—è –∫—Ä–∞—à–∞)
sudo kill -9 "$PID"

# –ü–æ–¥–æ–∂–¥–∞—Ç—å 10 —Å–µ–∫—É–Ω–¥ (RestartSec=10s)
sleep 10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª—Å—è
sudo systemctl status shadow-monitor.service
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: active (running), Restarts: 1
```

---

**E. –¢–µ—Å—Ç resource limits**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã
systemctl show shadow-monitor.service | grep -E 'CPU|Memory|Tasks'

# –í—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
# CPUQuotaPerSecUSec=250000 (25%)
# MemoryMax=134217728 (128MB)
# TasksMax=50
```

---

#### **–ß–∞—Å—Ç—å 7: Enable –Ω–∞ boot**

```bash
# –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ monitoring service
sudo systemctl enable shadow-monitor.service

# –ü—Ä–æ–≤–µ—Ä–∫–∞
sudo systemctl is-enabled shadow-monitor.service
# –í—ã–≤–æ–¥: enabled

# Backup timer —É–∂–µ enabled (—Å–¥–µ–ª–∞–ª–∏ –≤ Part 6C)
```

---

### ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç

- [ ] –ó–∞–ø–æ–ª–Ω–∏–ª TODO –≤ `shadow-backup.service` (16 TODO)
- [ ] –ó–∞–ø–æ–ª–Ω–∏–ª TODO –≤ `shadow-backup.timer` (8 TODO)
- [ ] –ó–∞–ø–æ–ª–Ω–∏–ª TODO –≤ `shadow-monitor.service` (30 TODO)
- [ ] –°–æ–∑–¥–∞–ª `/usr/local/bin/shadow-backup.sh` –∏ —Å–¥–µ–ª–∞–ª –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
- [ ] –°–æ–∑–¥–∞–ª `/usr/local/bin/shadow-monitor.sh` –∏ —Å–¥–µ–ª–∞–ª –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
- [ ] –°–æ–∑–¥–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `shadow-monitor`
- [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞–ª units –≤ `/etc/systemd/system/`
- [ ] –í—ã–ø–æ–ª–Ω–∏–ª `systemctl daemon-reload`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —á–µ—Ä–µ–∑ `systemd-analyze verify`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª backup (—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª monitor (–∑–∞–ø—É—Å–∫, —Å—Ç–∞—Ç—É—Å, –ª–æ–≥–∏)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª timer (enable, start, list-timers)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ (kill ‚Üí restart)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª resource limits
- [ ] Enabled services –Ω–∞ boot

**LILITH:**
*"–≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ '–∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É'. –≠—Ç–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ö–ê–ñ–î–û–ô –æ–ø—Ü–∏–∏: –∑–∞—á–µ–º –æ–Ω–∞, —á—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç, –∫–∞–∫–æ–π —Ä–∏—Å–∫ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç. Production-grade thinking."*

---

## üîÑ –¶–ò–ö–õ 8: –§–∏–Ω–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á—ë—Ç (10-15 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

**–î–µ–Ω—å 20. –í–µ—á–µ—Ä.**

–ë–æ—Ä–∏—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –ú–∞–∫—Å–∞.

```bash
$ sudo systemctl list-units --type=service --state=running | grep shadow
shadow-monitor.service     loaded active running   KERNEL SHADOWS System Monitor

$ sudo systemctl list-timers | grep shadow
Sat 2025-10-12 02:00:00 UTC  5h 32min left     n/a      n/a       shadow-backup.timer

$ sudo journalctl -u shadow-monitor.service -n 5
Oct 11 20:28:15 server shadow-monitor[12456]: [2025-10-11 20:28:15] Monitoring active
Oct 11 20:28:45 server shadow-monitor[12456]: [2025-10-11 20:28:45] Monitoring active
...
```

**–ë–æ—Ä–∏—Å** (–∫–∏–≤–∞–µ—Ç):
*"–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7. Backup –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω –Ω–∞ 02:00 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. Resource limits –Ω–∞ –º–µ—Å—Ç–µ. Security hardening –≤–∫–ª—é—á–µ–Ω. –õ–æ–≥–∏ —á–∏—Å—Ç—ã–µ."*

**–í–∏–∫—Ç–æ—Ä** (–≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫):
*"–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –ú–∞–∫—Å. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ –∑–∞–≤–µ—Ä—à—ë–Ω. –ë–æ—Ä–∏—Å, —Å–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—É—á–µ–Ω–∏–µ. –ú–∞–∫—Å, —Å–ª–µ–¥—É—é—â–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî –¢–∞–ª–ª–∏–Ω, –≠—Å—Ç–æ–Ω–∏—è. Episode 11: Disk Management & LVM."*

**–ê–Ω–Ω–∞:**
*"–ú–∞–∫—Å, –ø–æ—Å–ª–µ–¥–Ω–µ–µ. –°–æ–∑–¥–∞–π —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç: –≤—Å–µ running —Å–µ—Ä–≤–∏—Å—ã, –≤—Å–µ active timers, —Å—Ç–∞—Ç—É—Å security features. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π —á—Ç–æ —Ç—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª. –≠—Ç–æ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞."*

---

### üìã –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç (ONE-LINER COMPREHENSIVE)

```bash
#!/bin/bash

echo "=== KERNEL SHADOWS EPISODE 10: Final Report ==="
echo "Generated: $(date)"
echo

echo "=== Active Services ==="
systemctl list-units --type=service --state=running | grep shadow

echo
echo "=== Active Timers ==="
systemctl list-timers --all | grep shadow

echo
echo "=== Service Status ==="
sudo systemctl status shadow-monitor.service --no-pager
echo
sudo systemctl status shadow-backup.timer --no-pager

echo
echo "=== Resource Limits (shadow-monitor) ==="
systemctl show shadow-monitor.service | grep -E 'CPU|Memory|Tasks'

echo
echo "=== Security Features (shadow-monitor) ==="
systemctl show shadow-monitor.service | grep -E 'NoNewPrivileges|ProtectSystem|ProtectHome|PrivateTmp'

echo
echo "=== Recent Logs (last 24 hours) ==="
echo "--- shadow-monitor ---"
sudo journalctl -u shadow-monitor.service --since "24 hours ago" -p warning --no-pager | tail -20
echo
echo "--- shadow-backup ---"
sudo journalctl -u shadow-backup.service --since "24 hours ago" --no-pager | tail -10

echo
echo "=== Backup Files ==="
ls -lh /var/backups/shadow/ | tail -10

echo
echo "=== Final Check ==="
echo "‚úì Monitor service: $(systemctl is-active shadow-monitor.service)"
echo "‚úì Monitor enabled: $(systemctl is-enabled shadow-monitor.service)"
echo "‚úì Backup timer: $(systemctl is-active shadow-backup.timer)"
echo "‚úì Backup timer enabled: $(systemctl is-enabled shadow-backup.timer)"

echo
echo "=== Report Complete ==="
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫:**
```bash
nano /var/operations/shadow-final-report.sh
chmod +x /var/operations/shadow-final-report.sh
./var/operations/shadow-final-report.sh > episode10-final-report.txt
```

---

### ü§î –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø–æ—Å–ª–µ reboot?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–û—Ç–≤–µ—Ç:**

**1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ enabled:**
```bash
sudo systemctl is-enabled shadow-monitor.service
# –í—ã–≤–æ–¥: enabled
```

**2. –ü—Ä–æ–≤–µ—Ä—å WantedBy –≤ unit —Ñ–∞–π–ª–µ:**
```ini
[Install]
WantedBy=multi-user.target
```

**3. –ü—Ä–æ–≤–µ—Ä—å symlink:**
```bash
ls -l /etc/systemd/system/multi-user.target.wants/shadow-monitor.service
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å symlink –Ω–∞ /etc/systemd/system/shadow-monitor.service
```

**4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ (—Ç–µ—Å—Ç):**
```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
sudo reboot

# –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
sudo systemctl status shadow-monitor.service
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: active (running) since ... (< 5 –º–∏–Ω—É—Ç)
```

**–ë–æ—Ä–∏—Å:** *"`systemctl enable` —Å–æ–∑–¥–∞—ë—Ç symlink –≤ target.wants/. SystemD –≤–∏–¥–∏—Ç symlink ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ target."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç Episode 10: Complete!

- [ ] –ü–æ–Ω—è–ª —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (PID, PPID, –¥–µ—Ä–µ–≤–æ)
- [ ] –£–º–µ—é —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (ps, top, kill, signals)
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å systemd service units
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å systemd timers (–∑–∞–º–µ–Ω–∞ cron)
- [ ] –ü–æ–Ω–∏–º–∞—é resource limits (CPU, Memory, Tasks)
- [ ] –ü–æ–Ω–∏–º–∞—é security hardening (NoNewPrivileges, ProtectSystem, etc.)
- [ ] –£–º–µ—é —á–∏—Ç–∞—Ç—å –ª–æ–≥–∏ —á–µ—Ä–µ–∑ journalctl
- [ ] –°–æ–∑–¥–∞–ª production-ready –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å auto-restart
- [ ] –°–æ–∑–¥–∞–ª backup timer —Å Persistent=true
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

---

## üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã Episode 10

### üí° –ì–ª–∞–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã:

1. **–ü—Ä–æ—Ü–µ—Å—Å = –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤ –ø–∞–º—è—Ç–∏**
   - PID, PPID, —Å–æ—Å—Ç–æ—è–Ω–∏–µ, owner, —Ä–µ—Å—É—Ä—Å—ã
   - –î–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: systemd (PID 1) = –∫–æ—Ä–µ–Ω—å

2. **Signals = –°–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º**
   - SIGTERM (15) = –≤–µ–∂–ª–∏–≤–æ, SIGKILL (9) = –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
   - Graceful shutdown: SIGTERM ‚Üí wait ‚Üí SIGKILL

3. **SystemD Service = Production-ready —Å–µ—Ä–≤–∏—Å**
   - [Unit] = –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, [Service] = –∫–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å, [Install] = –∫–æ–≥–¥–∞
   - Type=simple (daemon) vs Type=oneshot (task)

4. **SystemD Timer = Cron –Ω–∞ —Å—Ç–µ—Ä–æ–∏–¥–∞—Ö**
   - .service (–ß–¢–û) + .timer (–ö–û–ì–î–ê)
   - OnCalendar, Persistent=true, RandomizedDelaySec

5. **Resource Limits = –ó–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º—ã**
   - CPUQuota, MemoryMax, TasksMax
   - –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –º–æ–∂–µ—Ç —É–±–∏—Ç—å –≤—Å—é —Å–∏—Å—Ç–µ–º—É

6. **Security Hardening = Defense in Depth**
   - NoNewPrivileges, ProtectSystem, ProtectHome
   - Principle of Least Privilege

7. **Journalctl = –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏**
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ unit, time, priority

---

### üöÄ Production Best Practices:

‚úÖ **DO:**
- –ò—Å–ø–æ–ª—å–∑—É–π –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ root)
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π —Ä–µ—Å—É—Ä—Å—ã (CPU, Memory, Tasks)
- –í–∫–ª—é—á–∞–π security features
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ (Restart=on-failure)
- –õ–æ–≥–∏—Ä—É–π –≤ journalctl
- –ò—Å–ø–æ–ª—å–∑—É–π timers –≤–º–µ—Å—Ç–æ cron
- –¢–µ—Å—Ç–∏—Ä—É–π units —á–µ—Ä–µ–∑ `systemd-analyze verify`
- –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π `systemctl daemon-reload` –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

‚ùå **DON'T:**
- –ù–ï –∑–∞–ø—É—Å–∫–∞–π —Å–µ—Ä–≤–∏—Å—ã –æ—Ç root –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ù–ï –ø–∏—à–∏ bash wrapper –≤–æ–∫—Ä—É–≥ systemctl
- –ù–ï –∑–∞–±—ã–≤–∞–π daemon-reload
- –ù–ï –∏–≥–Ω–æ—Ä–∏—Ä—É–π resource limits
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π SIGKILL –±–µ–∑ SIGTERM —Å–Ω–∞—á–∞–ª–∞

---

### üìö –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:

```bash
# Process Management
ps aux                           # –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pgrep -a –ø—Ä–æ—Ü–µ—Å—Å                 # –ù–∞–π—Ç–∏ PID –ø–æ –∏–º–µ–Ω–∏
kill -15 PID                     # SIGTERM (graceful)
kill -9 PID                      # SIGKILL (force)
pstree -p                        # –î–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

# SystemD Service
sudo systemctl start service     # –ó–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl stop service      # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
sudo systemctl restart service   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl status service    # –°—Ç–∞—Ç—É—Å
sudo systemctl enable service    # –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl daemon-reload     # –ü–µ—Ä–µ—á–∏—Ç–∞—Ç—å units

# SystemD Timer
sudo systemctl list-timers       # –í—Å–µ timers
systemd-analyze calendar "..."   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ

# Journalctl
journalctl -u service.service    # –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞
journalctl -f                    # Real-time
journalctl -p err                # –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
journalctl -b                    # –° –º–æ–º–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏
journalctl --since "1 hour ago"  # –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å

# Analysis
systemd-analyze verify service   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
systemd-analyze blame            # –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
systemctl show service           # –í—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞
systemd-cgtop                    # Real-time —Ä–µ—Å—É—Ä—Å—ã
```

---

### üé¨ –ß—Ç–æ –¥–∞–ª—å—à–µ?

**Episode 11: Disk Management & LVM**
*–õ–æ–∫–∞—Ü–∏—è: –¢–∞–ª–ª–∏–Ω, –≠—Å—Ç–æ–Ω–∏—è*
*–¢–µ–º–∞: –†–∞–∑–¥–µ–ª—ã –¥–∏—Å–∫–∞, —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã, LVM, RAID*

**–ë–æ—Ä–∏—Å** (–Ω–∞ –ø—Ä–æ—â–∞–Ω–∏–µ):
*"–ú–∞–∫—Å, —Ç—ã –æ—Å–≤–æ–∏–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –¢–µ–ø–µ—Ä—å —Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –ß–¢–û —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å ‚Äî disk management: –∫–æ–Ω—Ç—Ä–æ–ª—å –ì–î–ï —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ."*

---

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### Man Pages

```bash
man systemd.service     # Service units
man systemd.timer       # Timer units
man systemd.exec        # Execution options
man systemd.resource-control  # Resource limits
man journalctl          # –õ–æ–≥–∏
man systemctl           # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```

### Online Documentation

- [ArchWiki: systemd](https://wiki.archlinux.org/title/systemd)
- [Red Hat: SystemD Units](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/assembly_working-with-systemd-unit-files_configuring-basic-system-settings)
- [freedesktop.org: SystemD](https://www.freedesktop.org/software/systemd/man/)

---

## üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã

```bash
cd /home/fazzz/kernel-shadows/season-3-system-administration/episode-10-processes-systemd
./tests/test.sh
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç:**
- ‚úÖ Units —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ `/etc/systemd/system/`
- ‚úÖ Scripts —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã
- ‚úÖ Services –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ Timer –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ journalctl
- ‚úÖ Resource limits —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ Security features –≤–∫–ª—é—á–µ–Ω—ã

---

**"SystemD ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ init system. –≠—Ç–æ complete service management framework.
Process lifecycle, resource control, security isolation, logging ‚Äî –≤—Å—ë –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ."**

‚Äî **–ë–æ—Ä–∏—Å –ö—É–∑–Ω–µ—Ü–æ–≤**, SystemD Architect, ex-Red Hat

**Saint Petersburg, Russia ‚Üí Tallinn, Estonia** üá∑üá∫ ‚û°Ô∏è üá™üá™

---

*Episode 10: Complete! üéâ*
*Next: Episode 11 - Disk Management & LVM*
