# EPISODE 11: DISK MANAGEMENT & LVM
## Season 3: System Administration | Tallinn, Estonia üá™üá™

> *"e-Estonia —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–æ–≤–µ—Ä–∏–∏ –∫ –¥–∞–Ω–Ω—ã–º. –ï—Å–ª–∏ –¥–∏—Å–∫ —É–º–∏—Ä–∞–µ—Ç ‚Äî –¥–æ–≤–µ—Ä–∏–µ —É–º–∏—Ä–∞–µ—Ç."*
> ‚Äî **Kristjan Tamm**, e-Government Infrastructure Architect

---

## üìç –ö–æ–Ω—Ç–µ–∫—Å—Ç –º–∏—Å—Å–∏–∏

**–õ–æ–∫–∞—Ü–∏—è:** üá™üá™ **Tallinn, Estonia**
**–ú–µ—Å—Ç–æ:** e-Residency Center, –°—Ç–∞—Ä—ã–π –≥–æ—Ä–æ–¥ –¢–∞–ª–ª–∏–Ω–∞
**–î–µ–Ω—å –æ–ø–µ—Ä–∞—Ü–∏–∏:** **21-22** –∏–∑ 60
**–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:** **4-5 —á–∞—Å–æ–≤**
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (–í—ã—Å–æ–∫–∞—è)

**–ü–µ—Ä—Å–æ–Ω–∞–∂–∏:**
- **–ú–∞–∫—Å –°–æ–∫–æ–ª–æ–≤** ‚Äî –≤—ã, –∏–∑—É—á–∞–µ—Ç–µ disk management
- **Kristjan Tamm** ‚Äî e-Government infrastructure architect, —ç–∫—Å–ø–µ—Ä—Ç –ø–æ LVM
- **Liisa Kask** ‚Äî backup & recovery specialist
- **–í–∏–∫—Ç–æ—Ä –ü–µ—Ç—Ä–æ–≤** ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ–ø–µ—Ä–∞—Ü–∏–∏
- **LILITH** ‚Äî AI-–ø–æ–º–æ—â–Ω–∏–∫ (—è!)

---

## üé¨ –°—é–∂–µ—Ç: –ì–æ–Ω–∫–∞ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º

### –î–µ–Ω—å 21. –ü–µ—Ä–µ–µ–∑–¥: –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ ‚Üí Tallinn.

–ú–∞–∫—Å —Å–∞–¥–∏—Ç—Å—è –Ω–∞ –∞–≤—Ç–æ–±—É—Å –∏–∑ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ –≤ –¢–∞–ª–ª–∏–Ω (8 —á–∞—Å–æ–≤ –≤ –ø—É—Ç–∏ —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—É). –ë–æ—Ä–∏—Å –ø—Ä–æ–≤–æ–∂–∞–µ—Ç –Ω–∞ –∞–≤—Ç–æ–≤–æ–∫–∑–∞–ª–µ:

**–ë–æ—Ä–∏—Å –ö—É–∑–Ω–µ—Ü–æ–≤:**
*"–ú–∞–∫—Å, —Ç—ã –æ—Å–≤–æ–∏–ª systemd. –ü—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º. –ù–æ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö. –î–∞–Ω–Ω—ã–µ –∂–∏–≤—É—Ç –Ω–∞ –¥–∏—Å–∫–∞—Ö. –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ disk management ‚Äî —Ç—ã —Ç–µ—Ä—è–µ—à—å –≤—Å—ë."*

**–ú–∞–∫—Å:**
*"LVM? RAID? –°–ª—ã—à–∞–ª —ç—Ç–∏ —Ç–µ—Ä–º–∏–Ω—ã, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª —Å –Ω–∏–º–∏."*

**–ë–æ—Ä–∏—Å:**
*"Kristjan –Ω–∞—É—á–∏—Ç. –í –¢–∞–ª–ª–∏–Ω–µ ‚Äî e-Estonia. –í—Å—è —Å—Ç—Ä–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–Ω–ª–∞–π–Ω. –ü–∞—Å–ø–æ—Ä—Ç–∞, –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ, –±–∏–∑–Ω–µ—Å ‚Äî –≤—Å—ë –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö. –ï—Å–ª–∏ –¥–∏—Å–∫ —É–º–∏—Ä–∞–µ—Ç ‚Äî —Å—Ç—Ä–∞–Ω–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è. –û–Ω–∏ –∑–Ω–∞—é—Ç disk management –∫–∞–∫ –Ω–∏–∫—Ç–æ."*

–ú–∞–∫—Å —Å–∞–¥–∏—Ç—Å—è –≤ –∞–≤—Ç–æ–±—É—Å. 8 —á–∞—Å–æ–≤ —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—É, –º–∏–º–æ —Å–æ—Å–Ω–æ–≤–æ–≥–æ –ª–µ—Å–∞, —á–µ—Ä–µ–∑ –ù–∞—Ä–≤—É. –î—É–º–∞–µ—Ç –æ —Ç–æ–º, —á—Ç–æ –±—É–¥–µ—Ç –¥–∞–ª—å—à–µ.

---

### 11:00. Tallinn. –°—Ç–∞—Ä—ã–π –≥–æ—Ä–æ–¥.

–ú–∞–∫—Å –ø—Ä–∏–±—ã–≤–∞–µ—Ç –≤ –¢–∞–ª–ª–∏–Ω. –°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—ã–π –≥–æ—Ä–æ–¥ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π IT-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π. –ì–æ—Ç–∏—á–µ—Å–∫–∏–µ –±–∞—à–Ω–∏ –∏ fiber optic –∫–∞–±–µ–ª–∏. –í—Å—Ç—Ä–µ—á–∞ —É e-Residency Center –Ω–∞ Vabaduse v√§ljak.

**Kristjan Tamm** (–≤—Å—Ç—Ä–µ—á–∞–µ—Ç –ú–∞–∫—Å–∞ —É –≤—Ö–æ–¥–∞, ~40 –ª–µ—Ç, hoodie "e-Estonia", laptop –ø–æ–¥ –º—ã—à–∫–æ–π):
*"Max! Welcome to Tallinn! Viktor told me about your operation. You've learned processes, permissions, networking. Now ‚Äî storage. In Estonia, we say: 'Data is the new oil'. But oil is useless if the tank leaks."*

**–ú–∞–∫—Å:**
*"Boris said you're the best in disk management."*

**Kristjan:**
*"e-Estonia runs on trust. Citizens trust government because data is always available. Always secure. How? Redundancy. LVM for flexibility. RAID for reliability. Backups for recovery. I'll show you."*

–û–Ω–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ —Å–µ—Ä–≤–µ—Ä–Ω—É—é e-Residency. –î–µ—Å—è—Ç–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤, –º–∏–≥–∞—é—â–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–∏—Å–∫–æ–≤, monitoring dashboard –Ω–∞ —Å—Ç–µ–Ω–µ.

**Kristjan:**
*"Here we store digital identities of 100,000+ e-residents from 170+ countries. Disk failure? Not an option. Downtime? Not acceptable. Let me introduce you to Liisa."*

**Liisa Kask** (backup engineer, ~30 –ª–µ—Ç, headphones –Ω–∞ —à–µ–µ, laptop —Å monitoring dashboard –æ—Ç–∫—Ä—ã—Ç):
*"Max? Viktor said you're good with scripts. Perfect. We need someone who understands automation. Disk management without automation ‚Äî —ç—Ç–æ chaos."*

---

### 12:00. Emergency: Disk Failure Alert!

–í–Ω–µ–∑–∞–ø–Ω–æ ‚Äî **ALARM** –Ω–∞ monitoring dashboard Liisa. –ö—Ä–∞—Å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã. Slack channel –≤–∑—Ä—ã–≤–∞–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏.

**Liisa** (—Ä–µ–∑–∫–æ –≤—Å—Ç–∞—ë—Ç, —Å–Ω–∏–º–∞–µ—Ç headphones):
*"Disk failure on production server! `/dev/sdb` ‚Äî one of our data drives. SMART reports critical errors. Reallocated sectors: 247. We have maybe 2-3 hours before complete failure."*

**Kristjan** (—Å–ø–æ–∫–æ–π–Ω–æ, –Ω–æ –±—ã—Å—Ç—Ä–æ):
*"Max, you're about to learn disk management the hard way. Real incident. Production. Under pressure. We need to:*

1. *Check disk health (SMART status)*
2. *Migrate data to new disk (before failure)*
3. *Set up LVM properly (for future flexibility)*
4. *Configure monitoring (never miss failure again)*
5. *Test recovery procedures"*

**–ú–∞–∫—Å:**
*"I've never done this before..."*

**Kristjan:**
*"Perfect time to learn. In production. Just like real sysadmin work. Don't worry ‚Äî we have backups."*

–ü–∞—É–∑–∞.

*"Probably."*

**Liisa** (—É–ª—ã–±–∞–µ—Ç—Å—è):
*"Kristjan loves 'learning by fire'. But seriously, I'll guide you. Disk management is critical. Mistakes here ‚Äî and you lose everything. Ready?"*

**–ú–∞–∫—Å:** *"Let's do it."*

---

## üéØ –¢–≤–æ—è –º–∏—Å—Å–∏—è

–ù–∞—É—á–∏—Ç—å—Å—è **—É–ø—Ä–∞–≤–ª—è—Ç—å –¥–∏—Å–∫–∞–º–∏, LVM, RAID** –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏.

**–¶–µ–ª–∏:**
1. ‚úÖ –ü–æ–Ω—è—Ç—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–∏—Å–∫–∏ –≤ Linux (block devices, partitions)
2. ‚úÖ –ù–∞—É—á–∏—Ç—å—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å health (SMART monitoring)
3. ‚úÖ –û—Å–≤–æ–∏—Ç—å LVM (Physical Volumes, Volume Groups, Logical Volumes)
4. ‚úÖ –ü—Ä–æ–≤–µ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —Å failing disk
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `/etc/fstab` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
6. ‚úÖ –°–æ–∑–¥–∞—Ç—å systemd service –¥–ª—è disk monitoring
7. ‚úÖ –ü–æ–Ω—è—Ç—å RAID –∫–æ–Ω—Ü–µ–ø—Ç—ã (redundancy)

**–ò—Ç–æ–≥:**
Production-ready disk management —Å LVM flexibility, redundancy –∏ automated monitoring.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
episode-11-disk-management-lvm/
‚îú‚îÄ‚îÄ README.md                  # üìñ –¢–µ–æ—Ä–∏—è + –∑–∞–¥–∞–Ω–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îÇ
‚îú‚îÄ‚îÄ starter.sh                 # üéØ Bash template —Å TODO
‚îÇ                                 - LVM automation
‚îÇ                                 - Data migration
‚îÇ                                 - Monitoring setup
‚îÇ
‚îú‚îÄ‚îÄ solution/                  # ‚úÖ –†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ disk_manager.sh         # Production-ready LVM script
‚îÇ   ‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fstab.example       # /etc/fstab –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ disk-monitor.service # systemd monitoring service
‚îÇ   ‚îî‚îÄ‚îÄ README.md              # –ü–æ–ª–Ω—ã–π workflow —Ä–µ—à–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ artifacts/                 # üóÇÔ∏è –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ
‚îî‚îÄ‚îÄ tests/                     # üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã
    ‚îî‚îÄ‚îÄ test.sh                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è
```

### üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å?

1. **–ü—Ä–æ—á–∏—Ç–∞–π —Ç–µ–æ—Ä–∏—é** –≤ —ç—Ç–æ–º README (8 micro-cycles –Ω–∏–∂–µ)
2. **–û—Ç–∫—Ä–æ–π `starter.sh`** ‚Äî –∑–∞–ø–æ–ª–Ω–∏ TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
3. **–ò–∑—É—á–∏ LVM –∫–æ–º–∞–Ω–¥—ã** ‚Äî –ø—Ä–∞–∫—Ç–∏–∫–∞ –≤ –∫–∞–∂–¥–æ–º —Ü–∏–∫–ª–µ
4. **–ù–∞—Å—Ç—Ä–æ–π `/etc/fstab`** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. **–°–æ–∑–¥–∞–π monitoring** ‚Äî systemd service –¥–ª—è disk alerts
6. **–ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã** `./tests/test.sh`

---

## üéì –§–∏–ª–æ—Å–æ—Ñ–∏—è Episode: Type A ‚Äî Bash Automation OK

**Episode 11 ‚Äî —ç—Ç–æ Type A episode.**

‚úÖ **Bash automation –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è –¥–ª—è:**
- LVM setup (pvcreate, vgcreate, lvcreate –≤ —Ü–∏–∫–ª–µ)
- Data migration (rsync —Å progress bar)
- Health checks automation

**–ù–û:**
- 70% –≤—Ä–µ–º–µ–Ω–∏: –∏–∑—É—á–µ–Ω–∏–µ LVM –∫–æ–º–∞–Ω–¥, –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤
- 20% –≤—Ä–µ–º–µ–Ω–∏: `/etc/fstab`, systemd –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- 10% –≤—Ä–µ–º–µ–Ω–∏: bash –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

**Kristjan:**
*"LVM ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. Bash ‚Äî —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞. –°–Ω–∞—á–∞–ª–∞ –Ω–∞—É—á–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LVM –≤—Ä—É—á–Ω—É—é. –ü–æ—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π."*

---

## üìö –¢–ï–û–†–ò–Ø: 8 MICRO-CYCLES

### –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ü–∏–∫–ª–∞–º:
- **–¶–∏–∫–ª 1:** –§–∏–ª–æ—Å–æ—Ñ–∏—è –¥–∏—Å–∫–æ–≤ (10-15 –º–∏–Ω) ‚Üí Block devices, partitions
- **–¶–∏–∫–ª 2:** SMART Monitoring (15 –º–∏–Ω) ‚Üí Disk health, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ failures
- **–¶–∏–∫–ª 3:** LVM: Physical Volumes (20 –º–∏–Ω) ‚Üí PV, pvcreate, pvdisplay
- **–¶–∏–∫–ª 4:** LVM: Volume Groups & Logical Volumes (25 –º–∏–Ω) ‚Üí VG, LV, resize
- **–¶–∏–∫–ª 5:** Filesystems & /etc/fstab (20 –º–∏–Ω) ‚Üí ext4, xfs, auto-mount
- **–¶–∏–∫–ª 6:** Data Migration (15 –º–∏–Ω) ‚Üí rsync, dd, –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–¶–∏–∫–ª 7:** RAID Concepts (15 –º–∏–Ω) ‚Üí Redundancy, RAID 0/1/5/10
- **–¶–∏–∫–ª 8:** Production Monitoring (15-20 –º–∏–Ω) ‚Üí systemd service, alerts

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~2 —á–∞—Å–∞ —Ç–µ–æ—Ä–∏–∏ + 2-3 —á–∞—Å–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏ = **4-5 —á–∞—Å–æ–≤**

---

## üîÑ –¶–ò–ö–õ 1: –§–∏–ª–æ—Å–æ—Ñ–∏—è –¥–∏—Å–∫–æ–≤ –≤ Linux (10-15 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**Kristjan** (–ø–æ–¥–≤–æ–¥–∏—Ç –ú–∞–∫—Å–∞ –∫ monitoring dashboard):
*"–°–º–æ—Ç—Ä–∏. –°–µ–π—á–∞—Å –≤ —ç—Ç–æ–π —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç 180 –¥–∏—Å–∫–æ–≤. HDD –∏ SSD. –ö–∞–∂–¥—ã–π –¥–∏—Å–∫ ‚Äî —ç—Ç–æ block device. Kernel –≤–∏–¥–∏—Ç –∏—Ö –∫–∞–∫ —Ñ–∞–π–ª—ã –≤ `/dev/`."*

```bash
$ ls /dev/sd*
/dev/sda  /dev/sda1  /dev/sda2
/dev/sdb  /dev/sdb1
/dev/sdc
```

**Kristjan:**
*"–ö–∞–∂–¥—ã–π `/dev/sdX` ‚Äî —ç—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫. `/dev/sdX1`, `/dev/sdX2` ‚Äî —ç—Ç–æ partitions (—Ä–∞–∑–¥–µ–ª—ã). Linux —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∏—Å–∫–∞–º–∏ —á–µ—Ä–µ–∑ —ç—Ç–∏ —Ñ–∞–π–ª—ã."*

**–ú–∞–∫—Å:**
*"–ö–∞–∫ –æ–±—ã—á–Ω—ã–µ —Ñ–∞–π–ª—ã?"*

**Kristjan:**
*"–î–∞. –í Linux –≤—Å—ë ‚Äî —Ñ–∞–π–ª. –î–∏—Å–∫ ‚Äî —ç—Ç–æ special file. –ú–æ–∂–µ—à—å —á–∏—Ç–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å –∫–∞–∫ –≤ –æ–±—ã—á–Ω—ã–π —Ñ–∞–π–ª. –ù–æ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ ‚Äî –ø—Ä—è–º–∞—è –∑–∞–ø–∏—Å—å –≤ `/dev/sda` –º–æ–∂–µ—Ç —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –≤—Å—é —Å–∏—Å—Ç–µ–º—É."*

---

### üìö –¢–µ–æ—Ä–∏—è: Block Devices –≤ Linux

#### üè¢ –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Disk = –°–∫–ª–∞–¥ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è

–ü—Ä–µ–¥—Å—Ç–∞–≤—å Linux —Å–∏—Å—Ç–µ–º—É –∫–∞–∫ **–æ–≥—Ä–æ–º–Ω—ã–π –æ—Ñ–∏—Å**:

```
üè¢ LINUX OFFICE
‚îÇ
‚îú‚îÄ üíæ –°–∫–ª–∞–¥ #1 (/dev/sda) ‚Äî HDD 2TB
‚îÇ  ‚îú‚îÄ üì¶ –°–µ–∫—Ü–∏—è 1 (/dev/sda1) ‚Äî OS (100GB)
‚îÇ  ‚îú‚îÄ üì¶ –°–µ–∫—Ü–∏—è 2 (/dev/sda2) ‚Äî Swap (16GB)
‚îÇ  ‚îî‚îÄ üì¶ –°–µ–∫—Ü–∏—è 3 (/dev/sda3) ‚Äî /home (1.8TB)
‚îÇ
‚îú‚îÄ üíæ –°–∫–ª–∞–¥ #2 (/dev/sdb) ‚Äî SSD 500GB [‚ö†Ô∏è FAILING!]
‚îÇ  ‚îî‚îÄ üì¶ –°–µ–∫—Ü–∏—è 1 (/dev/sdb1) ‚Äî Databases (500GB)
‚îÇ
‚îî‚îÄ üíæ –°–∫–ª–∞–¥ #3 (/dev/sdc) ‚Äî SSD 500GB [–ù–û–í–´–ô]
   ‚îî‚îÄ (–ø—É—Å—Ç–æ, –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)
```

**–ö–∞–∂–¥—ã–π —Å–∫–ª–∞–¥ (disk):**
- –ò–º–µ–µ—Ç **–∞–¥—Ä–µ—Å** (`/dev/sda`, `/dev/sdb`)
- –†–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ **—Å–µ–∫—Ü–∏–∏** (partitions)
- –ö–∞–∂–¥–∞—è —Å–µ–∫—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç **–¥–∞–Ω–Ω—ã–µ** (filesystem)

**–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** (—Ç—ã) —É–ø—Ä–∞–≤–ª—è–µ—à—å —Å–∫–ª–∞–¥–∞–º–∏:
- –ü—Ä–æ–≤–µ—Ä—è–µ—à—å **health** (SMART)
- –°–æ–∑–¥–∞—ë—à—å **–Ω–æ–≤—ã–µ —Å–µ–∫—Ü–∏–∏** (partitioning)
- **–ü–µ—Ä–µ–Ω–æ—Å–∏—à—å –¥–∞–Ω–Ω—ã–µ** –º–µ–∂–¥—É —Å–∫–ª–∞–¥–∞–º–∏ (migration)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –¥–æ—Å—Ç–∞–≤–∫—É** (fstab mounting)

---

#### üéØ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã

##### 1. **Block Device**

**Block device** ‚Äî —ç—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–æ—Ç–æ—Ä–æ–µ —á–∏—Ç–∞–µ—Ç/–ø–∏—à–µ—Ç –¥–∞–Ω–Ω—ã–µ **–±–ª–æ–∫–∞–º–∏** (–æ–±—ã—á–Ω–æ 512 bytes –∏–ª–∏ 4KB).

```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö block devices
lsblk

# –í—ã–≤–æ–¥:
# NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
# sda      8:0    0   2TB  0 disk
# ‚îú‚îÄsda1   8:1    0  100G  0 part /
# ‚îú‚îÄsda2   8:2    0   16G  0 part [SWAP]
# ‚îî‚îÄsda3   8:3    0  1.8T  0 part /home
# sdb      8:16   0  500G  0 disk
# ‚îî‚îÄsdb1   8:17   0  500G  0 part /var/lib/mysql
```

**–ö–æ–ª–æ–Ω–∫–∏:**
- **NAME:** –ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **MAJ:MIN:** Major/Minor numbers (kernel identifiers)
- **SIZE:** –†–∞–∑–º–µ—Ä
- **TYPE:** disk (—Ü–µ–ª—ã–π –¥–∏—Å–∫) –∏–ª–∏ part (partition)
- **MOUNTPOINT:** –ì–¥–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ (–µ—Å–ª–∏ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ)

---

##### 2. **Naming Convention**

Linux –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –∏–º–µ–Ω–∞ –¥–ª—è –¥–∏—Å–∫–æ–≤:

| –¢–∏–ø –¥–∏—Å–∫–∞ | Naming | –ü—Ä–∏–º–µ—Ä |
|-----------|--------|--------|
| **SATA/SAS HDD/SSD** | `/dev/sdX` | `/dev/sda`, `/dev/sdb` |
| **NVMe SSD** | `/dev/nvmeXnY` | `/dev/nvme0n1` |
| **Virtual (KVM/Xen)** | `/dev/vdX` | `/dev/vda` |
| **Old IDE** | `/dev/hdX` | `/dev/hda` (deprecated) |

**Partitions:**
- `/dev/sda` ‚Üí —Ü–µ–ª—ã–π –¥–∏—Å–∫
- `/dev/sda1` ‚Üí –ø–µ—Ä–≤–∞—è partition
- `/dev/sda2` ‚Üí –≤—Ç–æ—Ä–∞—è partition

**Kristjan:**
*"`/dev/sda` ‚Äî —ç—Ç–æ –≤–µ—Å—å —Å–∫–ª–∞–¥. `/dev/sda1` ‚Äî —ç—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Å–µ–∫—Ü–∏—è –≤ —Å–∫–ª–∞–¥–µ. –ù–µ–ª—å–∑—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å —Å–∫–ª–∞–¥ –µ—Å–ª–∏ –≤ –Ω—ë–º –µ—Å—Ç—å —Å–µ–∫—Ü–∏–∏."*

---

##### 3. **Partitions (—Ä–∞–∑–¥–µ–ª—ã)**

**Partition** ‚Äî —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∏—Å–∫–∞ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —á–∞—Å—Ç–∏.

**–ó–∞—á–µ–º –Ω—É–∂–Ω—ã partitions?**
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ OS –∏ –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ OS —Å–ª–æ–º–∞–µ—Ç—Å—è ‚Üí –¥–∞–Ω–Ω—ã–µ —Ü–µ–ª—ã)
- ‚úÖ –†–∞–∑–Ω—ã–µ filesystems –Ω–∞ –æ–¥–Ω–æ–º –¥–∏—Å–∫–µ (ext4 –¥–ª—è /, xfs –¥–ª—è /data)
- ‚úÖ Dual boot (Linux + Windows –Ω–∞ –æ–¥–Ω–æ–º –¥–∏—Å–∫–µ)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª –¥–ª—è /tmp —Å noexec)

**–°—Ö–µ–º–∞ partitioning (—Ç–∏–ø–∏—á–Ω–∞—è):**

```
/dev/sda (2TB HDD)
‚îÇ
‚îú‚îÄ /dev/sda1 ‚Äî 512MB  ‚Äî EFI System Partition (boot)
‚îú‚îÄ /dev/sda2 ‚Äî 100GB  ‚Äî / (root filesystem)
‚îú‚îÄ /dev/sda3 ‚Äî 16GB   ‚Äî swap (virtual memory)
‚îî‚îÄ /dev/sda4 ‚Äî 1.8TB  ‚Äî /home (user data)
```

---

##### 4. **Partition Tables**

**Partition table** —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ partitions –Ω–∞ –¥–∏—Å–∫–µ.

**–î–≤–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞:**

| MBR (—Å—Ç–∞—Ä—ã–π) | GPT (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π) |
|--------------|-------------------|
| Max 4 primary partitions | Max 128 partitions |
| Max 2TB disk size | Max 8 ZB (zettabytes) |
| Legacy BIOS | UEFI + BIOS |
| –ù–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ | –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –≤ –∫–æ–Ω—Ü–µ –¥–∏—Å–∫–∞ |

**Kristjan:**
*"–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π GPT –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∏—Å–∫–æ–≤. MBR ‚Äî —ç—Ç–æ legacy. GPT –Ω–∞–¥—ë–∂–Ω–µ–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–ª—å—à–∏–µ –¥–∏—Å–∫–∏."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ò–Ω—Å–ø–µ–∫—Ü–∏—è –¥–∏—Å–∫–æ–≤

#### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è disk inspection

```bash
# 1. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö block devices (–¥–µ—Ä–µ–≤–æ)
lsblk

# 2. –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ partitions
sudo fdisk -l

# 3. –¢–æ–ª—å–∫–æ –¥–∏—Å–∫–∏ (–±–µ–∑ partitions)
lsblk -d -o NAME,SIZE,MODEL,SERIAL

# 4. –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –¥–∏—Å–∫–µ
sudo fdisk -l /dev/sda

# 5. Partition table type (MBR –∏–ª–∏ GPT)
sudo parted /dev/sda print | grep "Partition Table"

# 6. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ filesystems
df -h

# 7. –í—Å–µ block devices —Å UUID
lsblk -o NAME,SIZE,FSTYPE,UUID,MOUNTPOINT
```

---

#### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ `lsblk`

```
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda      8:0    0   2TB  0 disk
‚îú‚îÄsda1   8:1    0   512M 0 part /boot/efi
‚îú‚îÄsda2   8:2    0   100G 0 part /
‚îú‚îÄsda3   8:3    0    16G 0 part [SWAP]
‚îî‚îÄsda4   8:4    0   1.8T 0 part /home

sdb      8:16   0   500G 0 disk
‚îî‚îÄsdb1   8:17   0   500G 0 part /var/lib/mysql

sdc      8:32   0   500G 0 disk
(–ø—É—Å—Ç–æ ‚Äî –Ω–æ–≤—ã–π –¥–∏—Å–∫)
```

**–ß—Ç–æ –≤–∏–¥–∏–º:**
- **sda** ‚Äî 2TB –¥–∏—Å–∫ —Å 4 partitions (OS + swap + home)
- **sdb** ‚Äî 500GB –¥–∏—Å–∫ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (FAILING!)
- **sdc** ‚Äî 500GB –Ω–æ–≤—ã–π –¥–∏—Å–∫ (–ø—É—Å—Ç–æ–π, –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏)

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `/dev/sda` –∏ `/dev/sda1`?

<details>
<summary>üí° –î—É–º–∞–π 30 —Å–µ–∫—É–Ω–¥</summary>

**–û—Ç–≤–µ—Ç:**
- **`/dev/sda`** ‚Äî —ç—Ç–æ **–≤–µ—Å—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫** (block device)
- **`/dev/sda1`** ‚Äî —ç—Ç–æ **–ø–µ—Ä–≤–∞—è partition** –Ω–∞ —ç—Ç–æ–º –¥–∏—Å–∫–µ

**–ê–Ω–∞–ª–æ–≥–∏—è:**
- `/dev/sda` = —Ü–µ–ª—ã–π —Å–∫–ª–∞–¥ (–≤–µ—Å—å –¥–∏—Å–∫)
- `/dev/sda1` = —Å–µ–∫—Ü–∏—è #1 –≤ —Å–∫–ª–∞–¥–µ (partition #1)

**–í–∞–∂–Ω–æ:**
–ù–µ–ª—å–∑—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –¥–∏—Å–∫ (`/dev/sda`) –µ—Å–ª–∏ –Ω–∞ –Ω—ë–º –µ—Å—Ç—å partitions. –ú–æ–Ω—Ç–∏—Ä—É–µ—à—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é partition (`/dev/sda1`).

**Kristjan:** *"Partition ‚Äî —ç—Ç–æ logical division. –§–∏–∑–∏—á–µ—Å–∫–∏ —ç—Ç–æ –æ–¥–∏–Ω –¥–∏—Å–∫, –ª–æ–≥–∏—á–µ—Å–∫–∏ ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ó–∞—á–µ–º –Ω—É–∂–Ω—ã partitions? –ü–æ—á–µ–º—É –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ—Å—å –¥–∏—Å–∫ –∫–∞–∫ –æ–¥–∏–Ω —Ä–∞–∑–¥–µ–ª?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–ó–∞—á–µ–º partitions:**

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ OS –∏ –¥–∞–Ω–Ω—ã—Ö
   - –ï—Å–ª–∏ `/home` –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –Ω–∞ 100% ‚Üí OS –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å (–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º `/`)

2. **–†–∞–∑–Ω—ã–µ filesystems:**
   - `/` –Ω–∞ ext4 (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π)
   - `/data` –Ω–∞ xfs (high performance)

3. **Backup/Recovery:**
   - –ú–æ–∂–Ω–æ –±—ç–∫–∞–ø–∏—Ç—å —Ç–æ–ª—å–∫–æ `/home`, –Ω–µ —Ç—Ä–æ–≥–∞—è OS

4. **Mount options:**
   - `/tmp` —Å `noexec` (–∑–∞–ø—Ä–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
   - `/home` —Å `nodev` (–∑–∞–ø—Ä–µ—Ç device files)

5. **Dual boot:**
   - Linux + Windows –Ω–∞ –æ–¥–Ω–æ–º –¥–∏—Å–∫–µ

**–ö–æ–≥–¥–∞ –ù–ï –Ω—É–∂–Ω—ã partitions:**
- –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å LVM (—Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ—é –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—é)
- Virtual machines (–¥–∏—Å–∫–∏ —É–∂–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ)

**Liisa:** *"–í production –º—ã –í–°–ï–ì–î–ê –¥–µ–ª–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–µ partitions –¥–ª—è /, /var, /tmp, /home. –≠—Ç–æ best practice."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ß—Ç–æ —Ç–∞–∫–æ–µ block device?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**Block device** ‚Äî —ç—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–æ—Ç–æ—Ä–æ–µ —á–∏—Ç–∞–µ—Ç/–ø–∏—à–µ—Ç –¥–∞–Ω–Ω—ã–µ **–±–ª–æ–∫–∞–º–∏** (chunks), –∞ –Ω–µ –ø–æ –æ–¥–Ω–æ–º—É –±–∞–π—Ç—É.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –î–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è/–ø–∏—à—É—Ç—Å—è –±–ª–æ–∫–∞–º–∏ (–æ–±—ã—á–Ω–æ 512 bytes, 4KB, –∏–ª–∏ 8KB)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **random access** (–º–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å –ª—é–±–æ–π –±–ª–æ–∫ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç)
- –ò–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä

**–ü—Ä–∏–º–µ—Ä—ã block devices:**
- HDD (–∂—ë—Å—Ç–∫–∏–µ –¥–∏—Å–∫–∏)
- SSD (—Ç–≤–µ—Ä–¥–æ—Ç–µ–ª—å–Ω—ã–µ –¥–∏—Å–∫–∏)
- USB flash drives
- CD/DVD drives

**–ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å: Character device**
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø (serial)
- –ü—Ä–∏–º–µ—Ä—ã: `/dev/tty` (terminal), `/dev/null`

**–í Linux:**
```bash
# Block devices –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ 'b' –≤ ls -l
$ ls -l /dev/sda
brw-rw---- 1 root disk 8, 0 Oct 11 10:00 /dev/sda
^
‚îî‚îÄ 'b' = block device
```

**Kristjan:** *"Block device = —Å–∫–ª–∞–¥ —Å –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —è—á–µ–π–∫–∞–º–∏. –ú–æ–∂–µ—à—å –ø–æ–ª—É—á–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ª—é–±–æ–π —è—á–µ–π–∫–∏ –Ω–∞–ø—Ä—è–º—É—é, –∑–Ω–∞—è –µ—ë –Ω–æ–º–µ—Ä."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 1

- [ ] –ü–æ–Ω—è–ª —á—Ç–æ —Ç–∞–∫–æ–µ block device (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)
- [ ] –ó–Ω–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É disk –∏ partition
- [ ] –ü–æ–Ω–∏–º–∞—é naming convention (`/dev/sdX`, `/dev/nvmeXnY`)
- [ ] –ó–Ω–∞—é –∑–∞—á–µ–º –Ω—É–∂–Ω—ã partitions (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —Ä–∞–∑–Ω—ã–µ fs, backup)
- [ ] –£–º–µ—é –∏–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫–∏ (`lsblk`, `fdisk -l`)
- [ ] –ü–æ–Ω–∏–º–∞—é —Ä–∞–∑–Ω–∏—Ü—É MBR vs GPT (GPT –ª—É—á—à–µ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∏—Å–∫–æ–≤)

**LILITH:**
*"Disk ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ storage. –≠—Ç–æ foundation –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã. –ë–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤ ‚Äî —Ç—ã —Å—Ç—Ä–æ–∏—à—å –Ω–∞ –ø–µ—Å–∫–µ."*

---

## üîÑ –¶–ò–ö–õ 2: SMART Monitoring ‚Äî –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ failures (15-20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**Liisa** (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ú–∞–∫—Å—É monitoring dashboard):
*"Look at this. `/dev/sdb` ‚Äî SMART status critical. Reallocated sectors: 247. Spin retry count: 8. –≠—Ç–æ —É–º–∏—Ä–∞—é—â–∏–π –¥–∏—Å–∫."*

```
SMART Attributes for /dev/sdb:
ID# ATTRIBUTE_NAME          VALUE  WORST  RAW_VALUE
  5 Reallocated_Sector_Ct   100    100    247        ‚ö†Ô∏è CRITICAL
  7 Seek_Error_Rate         85     60     15842341   ‚ö†Ô∏è WARNING
197 Current_Pending_Sector  100    100    3          ‚ö†Ô∏è WARNING
198 Offline_Uncorrectable   100    100    1          ‚ö†Ô∏è WARNING
```

**–ú–∞–∫—Å:**
*"–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?"*

**Liisa:**
*"Reallocated sectors ‚Äî —ç—Ç–æ –ø–ª–æ—Ö–∏–µ —Å–µ–∫—Ç–æ—Ä–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–∏—Å–∫ –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª –≤ —Ä–µ–∑–µ—Ä–≤. 247 ‚Äî —ç—Ç–æ –º–Ω–æ–≥–æ. –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π bad sector ‚Äî —ç—Ç–æ —à–∞–≥ –∫ –ø–æ–ª–Ω–æ–º—É failure."*

**Kristjan:**
*"SMART (Self-Monitoring, Analysis and Reporting Technology) ‚Äî —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–∏—Å–∫–∞. –î–∏—Å–∫ —Å–∞–º –∑–Ω–∞–µ—Ç –∫–æ–≥–¥–∞ –æ–Ω —É–º–∏—Ä–∞–µ—Ç. –ù–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî —Å–ª—É—à–∞—Ç—å –µ–≥–æ."*

---

### üìö –¢–µ–æ—Ä–∏—è: SMART Monitoring

#### üè• –ú–µ—Ç–∞—Ñ–æ—Ä–∞: SMART = –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –æ—Å–º–æ—Ç—Ä –¥–∏—Å–∫–∞

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –¥–∏—Å–∫ –∫–∞–∫ **—á–µ–ª–æ–≤–µ–∫–∞**, –∞ SMART –∫–∞–∫ **–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –æ—Å–º–æ—Ç—Ä**:

```
üè• DISK HEALTH CHECK
‚îÇ
‚îú‚îÄ üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ‚Äî 35¬∞C (–Ω–æ—Ä–º–∞: <45¬∞C) ‚úÖ
‚îú‚îÄ üíì Spin-up time ‚Äî 4500ms (–Ω–æ—Ä–º–∞: <5000ms) ‚úÖ
‚îú‚îÄ ü©∏ Reallocated sectors ‚Äî 247 (–Ω–æ—Ä–º–∞: 0) ‚ö†Ô∏è CRITICAL
‚îú‚îÄ üß† Seek error rate ‚Äî 15M (–Ω–æ—Ä–º–∞: <1M) ‚ö†Ô∏è WARNING
‚îî‚îÄ ‚è±Ô∏è Power-on hours ‚Äî 35,840h (~4 years) ‚ÑπÔ∏è
```

**–î–æ–∫—Ç–æ—Ä (SMART)** –≥–æ–≤–æ—Ä–∏—Ç:
- ‚úÖ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –Ω–æ—Ä–º–µ
- ‚úÖ Spin-up –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π
- ‚ö†Ô∏è **247 reallocated sectors ‚Äî –û–ü–ê–°–ù–û!**
- ‚ö†Ô∏è **High seek errors ‚Äî –¥–∏—Å–∫ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç**
- ‚ÑπÔ∏è –î–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç 4 –≥–æ–¥–∞ ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç

**–î–∏–∞–≥–Ω–æ–∑:** –î–∏—Å–∫ —É–º–∏—Ä–∞–µ—Ç. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –°–†–û–ß–ù–û.

---

#### üéØ –ö–ª—é—á–µ–≤—ã–µ SMART Attributes

##### Critical Attributes (–µ—Å–ª–∏ —Ä–∞—Å—Ç—É—Ç ‚Üí –¥–∏—Å–∫ —É–º–∏—Ä–∞–µ—Ç):

| ID | Attribute | –ß—Ç–æ –∑–Ω–∞—á–∏—Ç | –ù–æ—Ä–º–∞ | –û–ø–∞—Å–Ω–æ |
|----|-----------|------------|-------|--------|
| **5** | Reallocated_Sector_Ct | –ü–ª–æ—Ö–∏–µ —Å–µ–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω—ã | 0 | >50 |
| **197** | Current_Pending_Sector | –ñ–¥—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ (–≤–æ–∑–º–æ–∂–Ω–æ –ø–ª–æ—Ö–∏–µ) | 0 | >5 |
| **198** | Offline_Uncorrectable | –ù–µ–ø–æ–ø—Ä–∞–≤–∏–º—ã–µ –æ—à–∏–±–∫–∏ | 0 | >0 |
| **187** | Reported_Uncorrect | –û—à–∏–±–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É–¥–∞–ª–æ—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å | 0 | >0 |
| **188** | Command_Timeout | –ö–æ–º–∞–Ω–¥—ã –∫–æ—Ç–æ—Ä—ã–µ timeout | 0 | >10 |

##### Warning Attributes (—Å–ª–µ–¥–∏—Ç—å):

| ID | Attribute | –ß—Ç–æ –∑–Ω–∞—á–∏—Ç | –ù–æ—Ä–º–∞ |
|----|-----------|------------|-------|
| **7** | Seek_Error_Rate | –û—à–∏–±–∫–∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ–ª–æ–≤–∫–∏ | Varies (vendor-specific) |
| **190** | Airflow_Temperature_Cel | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ | <45¬∞C |
| **194** | Temperature_Celsius | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ | <45¬∞C |
| **9** | Power_On_Hours | –°–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç | ‚Äî |

**Kristjan:**
*"Reallocated sectors ‚Äî —ç—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å. –ï—Å–ª–∏ –≤–∏–¥–∏—à—å >50 ‚Äî –≥–æ—Ç–æ–≤—å—Å—è –∫ –º–∏–≥—Ä–∞—Ü–∏–∏. –ï—Å–ª–∏ >200 ‚Äî –Ω–∞—á–∏–Ω–∞–π –º–∏–≥—Ä–∞—Ü–∏—é –°–ï–ô–ß–ê–°."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: SMART Monitoring

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ smartmontools

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install smartmontools

# Check service status
sudo systemctl status smartd
```

---

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# 1. Quick health check
sudo smartctl -H /dev/sda

# –í—ã–≤–æ–¥:
# === START OF READ SMART DATA SECTION ===
# SMART overall-health self-assessment test result: PASSED
# –∏–ª–∏ FAILED ‚ö†Ô∏è

# 2. All SMART data
sudo smartctl -a /dev/sda

# 3. –¢–æ–ª—å–∫–æ critical attributes
sudo smartctl -A /dev/sda | grep -E "Reallocated|Pending|Uncorrectable"

# 4. Test –∑–∞–ø—É—Å–∫ (–∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Å—Ç, ~2 –º–∏–Ω)
sudo smartctl -t short /dev/sda

# 5. Test –∑–∞–ø—É—Å–∫ (–¥–ª–∏–Ω–Ω—ã–π —Ç–µ—Å—Ç, ~—á–∞—Å—ã)
sudo smartctl -t long /dev/sda

# 6. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞
sudo smartctl -l selftest /dev/sda

# 7. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å–∫–µ
sudo smartctl -i /dev/sda
```

---

#### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ `smartctl -a /dev/sdb` (failing disk)

```
=== START OF INFORMATION SECTION ===
Model Family:     Seagate Barracuda 7200.14
Device Model:     ST500DM002-1BD142
Serial Number:    W3T7GKSP
Firmware Version: KC45
User Capacity:    500GB
Sector Size:      512 bytes logical/physical
Device is:        In smartctl database
ATA Version is:   ATA8-ACS
SMART support is: Available
SMART support is: Enabled

=== START OF READ SMART DATA SECTION ===
SMART overall-health self-assessment test result: FAILED!
Drive failure expected in less than 24 hours. SAVE ALL DATA. ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è

SMART Attributes Data Structure revision number: 10
ID# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      RAW_VALUE
  1 Raw_Read_Error_Rate     0x000f   117   099   006    Pre-fail  135899696
  3 Spin_Up_Time            0x0003   094   093   000    Pre-fail  0
  4 Start_Stop_Count        0x0032   100   100   020    Old_age   512
  5 Reallocated_Sector_Ct   0x0033   100   100   036    Pre-fail  247        ‚ö†Ô∏è
  7 Seek_Error_Rate         0x000f   085   060   030    Pre-fail  15842341   ‚ö†Ô∏è
  9 Power_On_Hours          0x0032   074   074   000    Old_age   35840
 10 Spin_Retry_Count        0x0013   100   100   097    Pre-fail  8          ‚ö†Ô∏è
 12 Power_Cycle_Count       0x0032   100   100   020    Old_age   487
184 End-to-End_Error        0x0032   100   100   099    Old_age   0
187 Reported_Uncorrect      0x0032   095   095   000    Old_age   5          ‚ö†Ô∏è
188 Command_Timeout         0x0032   100   099   000    Old_age   2
189 High_Fly_Writes         0x003a   100   100   000    Old_age   0
190 Airflow_Temperature_Cel 0x0022   062   053   045    Old_age   38 (Min/Max 25/47)
194 Temperature_Celsius     0x0022   038   047   000    Old_age   38 (0 15 0 0 0)
195 Hardware_ECC_Recovered  0x001a   024   011   000    Old_age   135899696
197 Current_Pending_Sector  0x0012   100   100   000    Old_age   3          ‚ö†Ô∏è
198 Offline_Uncorrectable   0x0010   100   100   000    Old_age   1          ‚ö†Ô∏è
199 UDMA_CRC_Error_Count    0x003e   200   200   000    Old_age   0
240 Head_Flying_Hours       0x0000   100   253   000    Old_age   35836
241 Total_LBAs_Written      0x0000   100   253   000    Old_age   48529472354
242 Total_LBAs_Read         0x0000   100   253   000    Old_age   52486438772
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚ö†Ô∏è **FAILED health check** ‚Äî –¥–∏—Å–∫ —É–º–∏—Ä–∞–µ—Ç!
- ‚ö†Ô∏è **247 reallocated sectors** ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ!
- ‚ö†Ô∏è **8 spin retry** ‚Äî –º–µ—Ö–∞–Ω–∏–∫–∞ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç
- ‚ö†Ô∏è **3 pending sectors** ‚Äî –∂–¥—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ÑπÔ∏è 35,840 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã (~4 –≥–æ–¥–∞)

**–î–µ–π—Å—Ç–≤–∏—è:**
1. ‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ –ó–∞–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π –¥–∏—Å–∫ (—É–∂–µ –µ—Å—Ç—å `/dev/sdc`)
3. ‚úÖ Backup (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–¥–µ–ª–∞–Ω)
4. ‚úÖ –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ ‚Äî —É—Ç–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `/dev/sdb`

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç Reallocated_Sector_Ct = 247?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**Reallocated Sector Count** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **bad sectors** (–ø–ª–æ—Ö–∏—Ö —Å–µ–∫—Ç–æ—Ä–æ–≤) –∫–æ—Ç–æ—Ä—ã–µ –¥–∏—Å–∫ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏–ª –≤ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –æ–±–ª–∞—Å—Ç—å.

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –î–∏—Å–∫ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ–∫—Ç–æ—Ä
2. –°–µ–∫—Ç–æ—Ä –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è/–Ω–µ –ø–∏—à–µ—Ç—Å—è (hardware failure)
3. –î–∏—Å–∫ –ø–æ–º–µ—á–∞–µ—Ç —Å–µ–∫—Ç–æ—Ä –∫–∞–∫ "bad"
4. –î–∏—Å–∫ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ **spare area** (—Ä–µ–∑–µ—Ä–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å)
5. –°—á—ë—Ç—á–∏–∫ Reallocated_Sector_Ct —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è

**247 reallocated sectors = –ö–†–ò–¢–ò–ß–ù–û!**
- –ù–æ—Ä–º–∞: 0 (zero bad sectors)
- –î–æ–ø—É—Å—Ç–∏–º–æ: 1-10 (–º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞ –≥–æ–¥—ã)
- –û–ø–∞—Å–Ω–æ: >50 (–¥–∏—Å–∫ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç)
- –ö—Ä–∏—Ç–∏—á–Ω–æ: >200 (–¥–∏—Å–∫ —É–º–∏—Ä–∞–µ—Ç, –º–∏–≥—Ä–∞—Ü–∏—è –°–†–û–ß–ù–û!)

**–ü–æ—á–µ–º—É –æ–ø–∞—Å–Ω–æ:**
- –†–µ–∑–µ—Ä–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞** (–æ–±—ã—á–Ω–æ ~2-5% –¥–∏—Å–∫–∞)
- –ö–æ–≥–¥–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∫–æ–Ω—á–∞–µ—Ç—Å—è ‚Üí –Ω–æ–≤—ã–µ bad sectors = **permanent data loss**
- –†–æ—Å—Ç bad sectors —á–∞—Å—Ç–æ **—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π** (10 ‚Üí 50 ‚Üí 200 –∑–∞ –Ω–µ–¥–µ–ª–∏)

**Liisa:** *"–ï—Å–ª–∏ –≤–∏–¥–∏—à—å 200+ reallocated sectors ‚Äî —É —Ç–µ–±—è —á–∞—Å—ã, –Ω–µ –¥–Ω–∏. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Äî –ø–µ—Ä–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ú–æ–∂–Ω–æ –ª–∏ –ø–æ—á–∏–Ω–∏—Ç—å –¥–∏—Å–∫ —Å bad sectors?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –ù–ï–¢.**

Bad sectors ‚Äî —ç—Ç–æ **hardware failure**. –§–∏–∑–∏—á–µ—Å–∫–æ–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –º–∞–≥–Ω–∏—Ç–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (HDD) –∏–ª–∏ flash —è—á–µ–µ–∫ (SSD).

**–ß—Ç–æ –ú–û–ñ–ù–û —Å–¥–µ–ª–∞—Ç—å:**
1. **Reallocation (–¥–∏—Å–∫ –¥–µ–ª–∞–µ—Ç —Å–∞–º):**
   - –î–∏—Å–∫ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∞–µ—Ç bad sector –≤ spare area
   - –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è (–µ—Å–ª–∏ spare area –Ω–µ –∫–æ–Ω—á–∏–ª–∞—Å—å)

2. **Secure erase + reformat:**
   - –ò–Ω–æ–≥–¥–∞ –ø–æ–º–æ–≥–∞–µ—Ç "–æ—Å–≤–µ–∂–∏—Ç—å" –¥–∏—Å–∫
   - ‚ö†Ô∏è –£–¥–∞–ª—è–µ—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ!
   - –ù–µ —É–±–∏—Ä–∞–µ—Ç hardware damage, —Ç–æ–ª—å–∫–æ "–º–∞—Å–∫–∏—Ä—É–µ—Ç"

3. **Bad block list:**
   - –ú–æ–∂–Ω–æ –ø–æ–º–µ—Ç–∏—Ç—å bad sectors –≤—Ä—É—á–Ω—É—é (badblocks utility)
   - Filesystem –±—É–¥–µ—Ç –∏—Ö –∏–∑–±–µ–≥–∞—Ç—å
   - –ù–ï —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É, —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ–∫—Ä—É–≥ –Ω–µ—ë

**–ß—Ç–æ –ù–ï –ú–û–ñ–ù–û:**
- ‚ùå "–ü–æ—á–∏–Ω–∏—Ç—å" —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π damage
- ‚ùå –í–µ—Ä–Ω—É—Ç—å reallocated sectors –≤ working area
- ‚ùå –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–ª—å–Ω–µ–π—à—É—é –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é

**Best practice:**
```
Bad sectors –ø–æ—è–≤–∏–ª–∏—Å—å ‚Üí backup –¥–∞–Ω–Ω—ã—Ö ‚Üí –º–∏–≥—Ä–∞—Ü–∏—è ‚Üí —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è –¥–∏—Å–∫–∞
```

**Kristjan:** *"–î–∏—Å–∫ —Å bad sectors ‚Äî —ç—Ç–æ time bomb. –ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ—Å—è—Ü—ã, –º–æ–∂–µ—Ç —É–º–µ—Ä–µ—Ç—å –∑–∞–≤—Ç—Ä–∞. –ù–µ —Ä–∏—Å–∫—É–π production –¥–∞–Ω–Ω—ã–º–∏."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ö–∞–∫ —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å SMART?

<details>
<summary>üí° Best Practices</summary>

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø):**

```bash
# smartd daemon (—á–∞—Å—Ç—å smartmontools)
# –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∏—Å–∫–∏ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
# –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: /etc/smartd.conf
DEVICESCAN -a -o on -S on -s (S/../.././02|L/../../6/03) -m admin@example.com

# –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:
# -a: –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –≤—Å–µ SMART attributes
# -o on: enable automatic offline tests
# -S on: enable attribute autosave
# -s (S/../.././02): short test –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00
# -s (L/../../6/03): long test –∫–∞–∂–¥—É—é —Å—É–±–±–æ—Ç—É –≤ 03:00
# -m: email –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤
```

**Manual checks:**
- ‚úÖ **–†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é:** `sudo smartctl -H /dev/sdX` (quick health)
- ‚úÖ **–†–∞–∑ –≤ –º–µ—Å—è—Ü:** `sudo smartctl -A /dev/sdX` (attributes review)
- ‚úÖ **–†–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª:** `sudo smartctl -t long /dev/sdX` (full test)

**Production –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- ‚úÖ Prometheus + smartctl_exporter
- ‚úÖ Nagios/Zabbix —Å SMART checks
- ‚úÖ Cloud monitoring (AWS CloudWatch Disk Health)

**Liisa:** *"–í production –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º SMART –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç. –ê–ª–µ—Ä—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ Slack –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. Downtime –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 2

- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ SMART (Self-Monitoring –¥–∏—Å–∫–∞)
- [ ] –ó–Ω–∞—é critical attributes (Reallocated, Pending, Uncorrectable)
- [ ] –£–º–µ—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å health (`smartctl -H /dev/sdX`)
- [ ] –£–º–µ—é –ø—Ä–æ—á–∏—Ç–∞—Ç—å SMART –¥–∞–Ω–Ω—ã–µ (`smartctl -a /dev/sdX`)
- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ bad sectors –Ω–µ–ª—å–∑—è "–ø–æ—á–∏–Ω–∏—Ç—å"
- [ ] –ó–Ω–∞—é –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è (>50 reallocated sectors)

**LILITH:**
*"SMART ‚Äî —ç—Ç–æ early warning system. –î–∏—Å–∫ –≥–æ–≤–æ—Ä–∏—Ç '—è —É–º–∏—Ä–∞—é' –∑–∞ –Ω–µ–¥–µ–ª–∏ –¥–æ —Å–º–µ—Ä—Ç–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî —Å–ª—É—à–∞—Ç—å."*

---

## üîÑ –¶–ò–ö–õ 3: LVM ‚Äî Physical Volumes (20-25 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**Kristjan** (–ø–æ–¥–≤–æ–¥–∏—Ç –ú–∞–∫—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É):
*"–£ –Ω–∞—Å –µ—Å—Ç—å –Ω–æ–≤—ã–π –¥–∏—Å–∫ `/dev/sdc` ‚Äî 500GB SSD. –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –í production –º—ã –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–µ partitioning. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º LVM."*

**–ú–∞–∫—Å:**
*"LVM? –ß—Ç–æ —ç—Ç–æ?"*

**Kristjan:**
*"Logical Volume Manager. –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –Ω–∞–¥ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –¥–∏—Å–∫–∞–º–∏. –ü—Ä–µ–¥—Å—Ç–∞–≤—å: partitions ‚Äî —ç—Ç–æ fixed-size –∫–æ—Ä–æ–±–∫–∏. LVM ‚Äî —ç—Ç–æ warehouse —Å flexible —Å—Ç–µ–ª–ª–∞–∂–∞–º–∏. –ú–æ–∂–µ—à—å resize, –ø–µ—Ä–µ–º–µ—â–∞—Ç—å, snapshot ‚Äî –≤—Å—ë –Ω–∞–ª–µ—Ç—É."*

**Liisa:**
*"–í e-Estonia –≤—Å–µ production —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç LVM. Flexible storage ‚Äî —ç—Ç–æ must-have."*

---

### üìö –¢–µ–æ—Ä–∏—è: LVM ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

#### üè≠ –ú–µ—Ç–∞—Ñ–æ—Ä–∞: LVM = Flexible Warehouse

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Å–∫–ª–∞–¥ (storage):

**–ë–µ–∑ LVM (—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ partitions):**
```
üè¢ TRADITIONAL WAREHOUSE (Fixed Layout)
‚îÇ
‚îú‚îÄ üì¶ –°–µ–∫—Ü–∏—è A ‚Äî 100GB (fixed size, –Ω–µ–ª—å–∑—è —Ä–∞—Å—à–∏—Ä–∏—Ç—å)
‚îú‚îÄ üì¶ –°–µ–∫—Ü–∏—è B ‚Äî 200GB (fixed size)
‚îî‚îÄ üì¶ –°–µ–∫—Ü–∏—è C ‚Äî 200GB (fixed size)
    ‚îî‚îÄ 50GB –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, 150GB –ø—É—Å—Ç–æ
        ‚ùå –ù–µ–ª—å–∑—è –ø–µ—Ä–µ–¥–∞—Ç—å unused space –≤ –°–µ–∫—Ü–∏—é A!
```

**–° LVM:**
```
üè≠ LVM WAREHOUSE (Flexible Layout)
‚îÇ
‚îú‚îÄ üì¶ Volume "databases" ‚Äî 150GB (–º–æ–∂–Ω–æ resize!)
‚îú‚îÄ üì¶ Volume "logs" ‚Äî 100GB (–º–æ–∂–Ω–æ resize!)
‚îî‚îÄ üì¶ Volume "backups" ‚Äî 50GB (–º–æ–∂–Ω–æ resize!)
    ‚îî‚îÄ Unused space: 200GB (–º–æ–∂–Ω–æ allocate later!)
    ‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π volume
    ‚úÖ –ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
    ‚úÖ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –º–µ–∂–¥—É –¥–∏—Å–∫–∞–º–∏
```

**–î–∏—Ä–µ–∫—Ç–æ—Ä —Å–∫–ª–∞–¥–∞ (LVM)** —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º –≥–∏–±–∫–æ:
- –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–µ —Å–µ–∫—Ü–∏–∏ (logical volumes)
- –†–∞—Å—à–∏—Ä—è–µ—Ç —Å–µ–∫—Ü–∏–∏ (lvextend)
- –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –º–µ–∂–¥—É –¥–∏—Å–∫–∞–º–∏ (pvmove)
- –°–æ–∑–¥–∞—ë—Ç snapshot (–±—ç–∫–∞–ø —Å–æ—Å—Ç–æ—è–Ω–∏—è)

---

#### üéØ LVM Architecture: 3 —É—Ä–æ–≤–Ω—è

LVM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **3-level architecture**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LOGICAL VOLUMES (LV)                    ‚îÇ  ‚Üê –ß–¢–û –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
‚îÇ  /dev/vg_data/lv_databases   (150GB)     ‚îÇ
‚îÇ  /dev/vg_data/lv_logs        (100GB)     ‚îÇ
‚îÇ  /dev/vg_data/lv_backups      (50GB)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚Üë
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  VOLUME GROUPS (VG)                      ‚îÇ  ‚Üê –ü—É–ª storage
‚îÇ  vg_data  (300GB used / 500GB total)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚Üë
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PHYSICAL VOLUMES (PV)                   ‚îÇ  ‚Üê –§–∏–∑–∏—á–µ—Å–∫–∏–µ –¥–∏—Å–∫–∏
‚îÇ  /dev/sdc1  (500GB)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**3 —É—Ä–æ–≤–Ω—è:**

1. **Physical Volume (PV)** ‚Äî —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫ –∏–ª–∏ partition
   - –ù–∞–ø—Ä–∏–º–µ—Ä: `/dev/sdc1`, `/dev/sdd1`
   - –≠—Ç–æ "raw materials" –¥–ª—è LVM

2. **Volume Group (VG)** ‚Äî –ø—É–ª –∏–∑ Physical Volumes
   - –ù–∞–ø—Ä–∏–º–µ—Ä: `vg_data` (–æ–±—ä–µ–¥–∏–Ω—è–µ—Ç `/dev/sdc1` + `/dev/sdd1`)
   - –≠—Ç–æ "warehouse" ‚Äî –æ–±—â–∏–π –ø—É–ª storage

3. **Logical Volume (LV)** ‚Äî –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª
   - –ù–∞–ø—Ä–∏–º–µ—Ä: `lv_databases`, `lv_logs`
   - –≠—Ç–æ "shelves in warehouse" ‚Äî —Ç–æ —á—Ç–æ –º–æ–Ω—Ç–∏—Ä—É–µ—à—å –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å

**Kristjan:**
*"PV = —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫. VG = –≥—Ä—É–ø–ø–∞ –¥–∏—Å–∫–æ–≤. LV = –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª. PV ‚Üí VG ‚Üí LV. –ó–∞–ø–æ–º–Ω–∏ —ç—Ç—É —Ü–µ–ø–æ—á–∫—É."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–Ω–∏–µ Physical Volume

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Å–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–∏—Å–∫ –ø—É—Å—Ç–æ–π –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
lsblk | grep sdc

# –í—ã–≤–æ–¥:
# sdc      8:32   0  500G  0 disk

# –°–æ–∑–¥–∞—Ç—å partition –Ω–∞ –¥–∏—Å–∫–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ—Å—å –¥–∏—Å–∫)
sudo fdisk /dev/sdc

# –í fdisk:
# n  ‚Üí new partition
# p  ‚Üí primary
# 1  ‚Üí partition number 1
# Enter ‚Üí default first sector
# Enter ‚Üí default last sector (use entire disk)
# t  ‚Üí change partition type
# 8e ‚Üí Linux LVM (–∏–ª–∏ 31 –¥–ª—è GPT)
# w  ‚Üí write changes and exit

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
lsblk | grep sdc
# sdc      8:32   0  500G  0 disk
# ‚îî‚îÄsdc1   8:33   0  500G  0 part  ‚Üê –Ω–æ–≤–∞—è partition
```

**‚ö†Ô∏è –û–°–¢–û–†–û–ñ–ù–û:**
`fdisk /dev/sdc` ‚Äî —ç—Ç–æ destructive operation! –£–±–µ–¥–∏—Å—å —á—Ç–æ –≤—ã–±—Ä–∞–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–∏—Å–∫!

---

#### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Physical Volume

```bash
# –°–æ–∑–¥–∞—Ç—å PV –∏–∑ partition
sudo pvcreate /dev/sdc1

# –í—ã–≤–æ–¥:
#   Physical volume "/dev/sdc1" successfully created.

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PV
sudo pvs

# –í—ã–≤–æ–¥:
#   PV         VG      Fmt  Attr PSize   PFree
#   /dev/sdc1          lvm2 ---  500.00g 500.00g

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
sudo pvdisplay /dev/sdc1

# –í—ã–≤–æ–¥:
#   "/dev/sdc1" is a new physical volume of "500.00 GiB"
#   --- NEW Physical volume ---
#   PV Name               /dev/sdc1
#   VG Name
#   PV Size               500.00 GiB
#   Allocatable           NO
#   PE Size               0
#   Total PE              0
#   Free PE               0
#   Allocated PE          0
#   PV UUID               xK3rGf-aBcD-eFgH-iJkL-mNoP-qRsT-uVwXyZ
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
- LVM –ø–æ–º–µ—Ç–∏–ª `/dev/sdc1` –∫–∞–∫ Physical Volume
- –ó–∞–ø–∏—Å–∞–ª metadata –Ω–∞ –¥–∏—Å–∫
- –î–∏—Å–∫ –≥–æ—Ç–æ–≤ –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –≤ Volume Group

---

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: PV –∏–∑ —Ü–µ–ª–æ–≥–æ –¥–∏—Å–∫–∞ (–±–µ–∑ partition)

```bash
# –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ—Å—å –¥–∏—Å–∫ –±–µ–∑ partitioning
sudo pvcreate /dev/sdc

# –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ best practice ‚Äî —Å–æ–∑–¥–∞—Ç—å partition —Å–Ω–∞—á–∞–ª–∞
# –ó–∞—á–µ–º? Partition table —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á—Ç–æ —ç—Ç–æ LVM disk
```

**Best practice:**
–°–æ–∑–¥–∞–≤–∞–π partition (`/dev/sdc1`), –ø–æ—Ç–æ–º PV. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ–Ω—è—Ç–Ω–µ–µ.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Physical Volume –∏ partition?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**Partition:**
- –õ–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ **–æ–¥–Ω–æ–≥–æ** —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Å–∫–∞
- –°–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `fdisk` –∏–ª–∏ `parted`
- –ü—Ä–∏–º–µ—Ä: `/dev/sda1`, `/dev/sda2`
- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä** (–Ω–µ–ª—å–∑—è resize –±–µ–∑ —Ä–∏—Å–∫–∞ data loss)

**Physical Volume (PV):**
- **LVM –º–µ—Ç–∫–∞** –Ω–∞ –¥–∏—Å–∫–µ –∏–ª–∏ partition
- –°–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `pvcreate`
- –ü—Ä–∏–º–µ—Ä: PV –Ω–∞ `/dev/sdc1`
- –ú–æ–∂–µ—Ç –±—ã—Ç—å **—á–∞—Å—Ç—å Volume Group** (VG)
- **Flexible** ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ VG, —É–¥–∞–ª—è—Ç—å, –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ

**–°–≤—è–∑—å:**
```
Physical Disk (/dev/sdc)
  ‚Üì
Partition (/dev/sdc1)      ‚Üê —Å–æ–∑–¥–∞—ë—Ç—Å—è fdisk
  ‚Üì
Physical Volume (/dev/sdc1) ‚Üê —Å–æ–∑–¥–∞—ë—Ç—Å—è pvcreate (LVM label)
  ‚Üì
Volume Group (vg_data)     ‚Üê –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ VG
  ‚Üì
Logical Volume (lv_db)     ‚Üê —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª
```

**Kristjan:** *"Partition ‚Äî —ç—Ç–æ physical division. PV ‚Äî —ç—Ç–æ LVM abstraction. PV –∏—Å–ø–æ–ª—å–∑—É–µ—Ç partition (–∏–ª–∏ –≤–µ—Å—å –¥–∏—Å–∫), –Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç LVM magic."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ú–æ–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞—Ç—å PV –∏–∑ —Ü–µ–ª–æ–≥–æ –¥–∏—Å–∫–∞ –±–µ–∑ partitioning?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–î–∞, –º–æ–∂–Ω–æ:**

```bash
sudo pvcreate /dev/sdc
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ (skip partitioning step)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Å—å –¥–∏—Å–∫ (no partition table overhead)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ—Ç partition table ‚Üí tools –º–æ–≥—É—Ç –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —á—Ç–æ —ç—Ç–æ LVM disk
- ‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ backup/disaster recovery tools –Ω–µ —É–≤–∏–¥—è—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- ‚ùå –ú–µ–Ω–µ–µ –ø–æ–Ω—è—Ç–Ω–æ –ø—Ä–∏ –∏–Ω—Å–ø–µ–∫—Ü–∏–∏ (`lsblk` –Ω–µ –ø–æ–∫–∞–∂–µ—Ç partition type)

**Best practice (production):**
```bash
# 1. –°–æ–∑–¥–∞—Ç—å partition
sudo fdisk /dev/sdc
# (—Å–æ–∑–¥–∞—Ç—å partition type 8e - Linux LVM)

# 2. –°–æ–∑–¥–∞—Ç—å PV –Ω–∞ partition
sudo pvcreate /dev/sdc1
```

**–ó–∞—á–µ–º:**
- Partition table —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–µ (LVM)
- Tools –≤–∏–¥—è—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- Disaster recovery –ø—Ä–æ—â–µ

**Liisa:** *"–í production –º—ã –í–°–ï–ì–î–ê —Å–æ–∑–¥–∞—ë–º partition —Å–Ω–∞—á–∞–ª–∞. –≠—Ç–æ documentation ‚Äî –ª—é–±–æ–π admin —É–≤–∏–¥–∏—Ç —á—Ç–æ —ç—Ç–æ LVM disk."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 3

- [ ] –ü–æ–Ω–∏–º–∞—é LVM –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (PV ‚Üí VG ‚Üí LV)
- [ ] –ó–Ω–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ Physical Volume (PV = –¥–∏—Å–∫/partition —Å LVM label)
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å partition —á–µ—Ä–µ–∑ `fdisk`
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å PV (`pvcreate /dev/sdX1`)
- [ ] –£–º–µ—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å PV (`pvs`, `pvdisplay`)
- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º –Ω—É–∂–Ω–∞ LVM (flexibility vs fixed partitions)

**LILITH:**
*"Physical Volume ‚Äî —ç—Ç–æ foundation LVM. –ë–µ–∑ PV –Ω–µ—Ç VG. –ë–µ–∑ VG –Ω–µ—Ç LV. –¶–µ–ø–æ—á–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞."*

---

## üîÑ –¶–ò–ö–õ 4: LVM ‚Äî Volume Groups & Logical Volumes (25-30 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**Kristjan:**
*"–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å Physical Volume `/dev/sdc1` (500GB). –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ ‚Äî —Å–æ–∑–¥–∞—Ç—å Volume Group. VG ‚Äî —ç—Ç–æ –ø—É–ª storage. –ú–æ–∂–µ—à—å –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ PV –≤ –æ–¥–∏–Ω VG."*

**–ú–∞–∫—Å:**
*"–ö–∞–∫ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∏—Å–∫–æ–≤?"*

**Kristjan:**
*"–ò–º–µ–Ω–Ω–æ! –ü—Ä–µ–¥—Å—Ç–∞–≤—å: —É —Ç–µ–±—è —Ç—Ä–∏ –¥–∏—Å–∫–∞ –ø–æ 500GB. –°–æ–∑–¥–∞—ë—à—å PV –Ω–∞ –∫–∞–∂–¥–æ–º, –¥–æ–±–∞–≤–ª—è–µ—à—å –≤ –æ–¥–∏–Ω VG ‚Äî –ø–æ–ª—É—á–∞–µ—à—å 1.5TB –ø—É–ª. –ü–æ—Ç–æ–º —Å–æ–∑–¥–∞—ë—à—å Logical Volumes –∏–∑ —ç—Ç–æ–≥–æ –ø—É–ª–∞. Flexibility magic."*

**Liisa:**
*"–ò —Å–∞–º–æ–µ –∫—Ä—É—Ç–æ–µ ‚Äî –º–æ–∂–µ—à—å resize LV –Ω–∞–ª—ë—Ç. –ë–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞? `lvextend` –∏ done. –ë–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏."*

---

### üìö –¢–µ–æ—Ä–∏—è: Volume Groups & Logical Volumes

#### üè¢ –ú–µ—Ç–∞—Ñ–æ—Ä–∞: VG = Warehouse, LV = Shelves

**Volume Group (VG):**
```
üè≠ WAREHOUSE "vg_data" (500GB total)
‚îÇ
‚îî‚îÄ Built from:
   ‚îî‚îÄ üì¶ Physical Volume /dev/sdc1 (500GB)
```

**Logical Volumes (LV) –≤–Ω—É—Ç—Ä–∏ VG:**
```
üè≠ WAREHOUSE "vg_data"
‚îÇ
‚îú‚îÄ üóÑÔ∏è Shelf "lv_databases" ‚Äî 200GB (used: 150GB)
‚îú‚îÄ üóÑÔ∏è Shelf "lv_logs"      ‚Äî 100GB (used: 80GB)
‚îú‚îÄ üóÑÔ∏è Shelf "lv_backups"   ‚Äî  50GB (used: 20GB)
‚îî‚îÄ üì≠ Unused space         ‚Äî 150GB (can allocate later!)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ Flexible —Ä–∞–∑–º–µ—Ä (lvextend/lvreduce)
- ‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ LV –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ Snapshot –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (backup –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)
- ‚úÖ Thin provisioning (allocate on demand)

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–Ω–∏–µ VG –∏ LV

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Volume Group

```bash
# –°–æ–∑–¥–∞—Ç—å VG —Å –∏–º–µ–Ω–µ–º "vg_data" –∏–∑ PV /dev/sdc1
sudo vgcreate vg_data /dev/sdc1

# –í—ã–≤–æ–¥:
#   Volume group "vg_data" successfully created

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å VG
sudo vgs

# –í—ã–≤–æ–¥:
#   VG      #PV #LV #SN Attr   VSize   VFree
#   vg_data   1   0   0 wz--n- 500.00g 500.00g

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
sudo vgdisplay vg_data

# –í—ã–≤–æ–¥:
#   --- Volume group ---
#   VG Name               vg_data
#   System ID
#   Format                lvm2
#   Metadata Areas        1
#   Metadata Sequence No  1
#   VG Access             read/write
#   VG Status             resizable
#   MAX LV                0
#   Cur LV                0
#   Open LV               0
#   Max PV                0
#   Cur PV                1
#   Act PV                1
#   VG Size               500.00 GiB
#   PE Size               4.00 MiB
#   Total PE              127999
#   Alloc PE / Size       0 / 0
#   Free  PE / Size       127999 / 500.00 GiB
#   VG UUID               AbCdEf-GhIj-KlMn-OpQr-StUv-WxYz-123456
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
- –°–æ–∑–¥–∞–Ω Volume Group "vg_data"
- `/dev/sdc1` –¥–æ–±–∞–≤–ª–µ–Ω –≤ —ç—Ç–æ—Ç VG
- VG Size = 500GB (–≤–µ—Å—å PV)
- Free space = 500GB (–ø–æ–∫–∞ –Ω–µ—Ç LV)

---

#### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Logical Volumes

```bash
# –°–æ–∑–¥–∞—Ç—å LV –¥–ª—è databases (200GB)
sudo lvcreate -L 200G -n lv_databases vg_data

# –í—ã–≤–æ–¥:
#   Logical volume "lv_databases" created.

# –°–æ–∑–¥–∞—Ç—å LV –¥–ª—è logs (100GB)
sudo lvcreate -L 100G -n lv_logs vg_data

# –°–æ–∑–¥–∞—Ç—å LV –¥–ª—è backups (50GB)
sudo lvcreate -L 50G -n lv_backups vg_data

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å LV
sudo lvs

# –í—ã–≤–æ–¥:
#   LV           VG      Attr       LSize   Pool Origin Data%
#   lv_backups   vg_data -wi-a-----  50.00g
#   lv_databases vg_data -wi-a----- 200.00g
#   lv_logs      vg_data -wi-a----- 100.00g

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
sudo lvdisplay /dev/vg_data/lv_databases

# –í—ã–≤–æ–¥:
#   --- Logical volume ---
#   LV Path                /dev/vg_data/lv_databases
#   LV Name                lv_databases
#   VG Name                vg_data
#   LV UUID                xYzAbC-dEfGh-IjKlM-nOpQr-StUvW-xYzAb-CdEfGh
#   LV Write Access        read/write
#   LV Creation host, time server01, 2025-10-11 12:00:00 +0000
#   LV Status              available
#   # open                 0
#   LV Size                200.00 GiB
#   Current LE             51200
#   Segments               1
#   Allocation             inherit
#   Read ahead sectors     auto
#   Block device           253:0
```

---

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```bash
# –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
lsblk

# –í—ã–≤–æ–¥:
# NAME                      MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
# sdc                         8:32   0  500G  0 disk
# ‚îî‚îÄsdc1                      8:33   0  500G  0 part
#   ‚îú‚îÄvg_data-lv_databases  253:0    0  200G  0 lvm
#   ‚îú‚îÄvg_data-lv_logs       253:1    0  100G  0 lvm
#   ‚îî‚îÄvg_data-lv_backups    253:2    0   50G  0 lvm

# VG summary
sudo vgs

# –í—ã–≤–æ–¥:
#   VG      #PV #LV #SN Attr   VSize   VFree
#   vg_data   1   3   0 wz--n- 500.00g 150.00g
#                                       ^^^^^^^ unused space!
```

**–ß—Ç–æ –∏–º–µ–µ–º:**
- PV: `/dev/sdc1` (500GB)
- VG: `vg_data` (500GB total, 150GB free)
- LV:
  - `lv_databases` (200GB)
  - `lv_logs` (100GB)
  - `lv_backups` (50GB)
- **150GB unused** ‚Äî –º–æ–∂–Ω–æ allocate –ø–æ–∑–∂–µ!

---

### üé® LVM Operations: Resize, Extend, Snapshot

#### 1. Extend Logical Volume (—É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä)

```bash
# –ë–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞
# –†–∞—Å—à–∏—Ä–∏—Ç—å lv_databases –Ω–∞ 50GB
sudo lvextend -L +50G /dev/vg_data/lv_databases

# –í—ã–≤–æ–¥:
#   Size of logical volume vg_data/lv_databases changed from 200.00 GiB to 250.00 GiB
#   Logical volume vg_data/lv_databases successfully resized.

# –†–∞—Å—à–∏—Ä–∏—Ç—å filesystem (–ö–†–ò–¢–ò–ß–ù–û!)
# –ë–µ–∑ —ç—Ç–æ–≥–æ OS –Ω–µ —É–≤–∏–¥–∏—Ç –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
sudo resize2fs /dev/vg_data/lv_databases

# –î–ª—è xfs:
# sudo xfs_growfs /mnt/databases

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
df -h | grep databases
```

**Kristjan:**
*"–î–≤–∞ —à–∞–≥–∞: 1) lvextend –¥–ª—è LV, 2) resize2fs –¥–ª—è filesystem. –ó–∞–±—ã–ª –≤—Ç–æ—Ä–æ–π —à–∞–≥ ‚Äî LV –±–æ–ª—å—à–µ, –Ω–æ filesystem –Ω–µ –∑–Ω–∞–µ—Ç."*

---

#### 2. Reduce Logical Volume (—É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä)

```bash
# ‚ö†Ô∏è –û–ü–ê–°–ù–û! –ú–æ–∂–µ—Ç –ø–æ—Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ!

# 1. Unmount filesystem
sudo umount /mnt/logs

# 2. Check filesystem
sudo e2fsck -f /dev/vg_data/lv_logs

# 3. Resize filesystem (—Å–Ω–∞—á–∞–ª–∞ filesystem!)
sudo resize2fs /dev/vg_data/lv_logs 80G

# 4. Reduce LV
sudo lvreduce -L 80G /dev/vg_data/lv_logs

# 5. Remount
sudo mount /dev/vg_data/lv_logs /mnt/logs
```

**‚ö†Ô∏è –û–°–¢–û–†–û–ñ–ù–û:**
`lvreduce` –º–æ–∂–µ—Ç —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!
–í—Å–µ–≥–¥–∞: backup ‚Üí unmount ‚Üí resize2fs ‚Üí lvreduce

---

#### 3. Snapshot (–º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –±—ç–∫–∞–ø)

```bash
# –°–æ–∑–¥–∞—Ç—å snapshot lv_databases –ø–µ—Ä–µ–¥ update
sudo lvcreate -L 10G -s -n lv_databases_snap /dev/vg_data/lv_databases

# -L 10G: —Ä–∞–∑–º–µ—Ä snapshot (–¥–ª—è delta changes)
# -s: snapshot flag
# -n: –∏–º—è snapshot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
sudo lvs

# –í—ã–≤–æ–¥:
#   LV                  VG      Attr       LSize   Origin       Data%
#   lv_databases        vg_data owi-aos--- 250.00g
#   lv_databases_snap   vg_data swi-a-s---  10.00g lv_databases 0.00

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
# 1. Mount snapshot (read-only)
sudo mount -o ro /dev/vg_data/lv_databases_snap /mnt/snapshot

# 2. Backup snapshot
sudo rsync -av /mnt/snapshot/ /backup/databases/

# 3. Remove snapshot –ø–æ—Å–ª–µ backup
sudo lvremove /dev/vg_data/lv_databases_snap
```

**Liisa:**
*"Snapshot ‚Äî —ç—Ç–æ magic –¥–ª—è backup. –°–æ–∑–¥–∞—ë—à—å snapshot, –±—ç–∫–∞–ø–∏—à—å snapshot (–Ω–µ live volume), —É–¥–∞–ª—è–µ—à—å snapshot. Zero downtime."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Volume Group –∏ Logical Volume?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**Volume Group (VG):**
- **–ü—É–ª storage** –∏–∑ Physical Volumes
- –ö–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∏—Å–∫–æ–≤ –≤ –æ–¥–∏–Ω –ø—É–ª
- –ü—Ä–∏–º–µ—Ä: `vg_data` (500GB –∏–∑ `/dev/sdc1`)
- –ê–Ω–∞–ª–æ–≥–∏—è: **Warehouse** (—Å–∫–ª–∞–¥)

**Logical Volume (LV):**
- **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª** –≤–Ω—É—Ç—Ä–∏ VG
- –ê–Ω–∞–ª–æ–≥ partition, –Ω–æ flexible
- –ü—Ä–∏–º–µ—Ä: `lv_databases` (200GB –≤–Ω—É—Ç—Ä–∏ `vg_data`)
- –ê–Ω–∞–ª–æ–≥–∏—è: **Shelf** (—Å—Ç–µ–ª–ª–∞–∂ –≤–Ω—É—Ç—Ä–∏ —Å–∫–ª–∞–¥–∞)

**–°–≤—è–∑—å:**
```
PV (/dev/sdc1)   ‚Üí   VG (vg_data)   ‚Üí   LV (lv_databases)
–§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫  ‚Üí   –ü—É–ª storage    ‚Üí   –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª
```

**–ß—Ç–æ –º–æ–Ω—Ç–∏—Ä—É–µ—à—å:**
- ‚ùå –ù–µ –º–æ–Ω—Ç–∏—Ä—É–µ—à—å PV
- ‚ùå –ù–µ –º–æ–Ω—Ç–∏—Ä—É–µ—à—å VG
- ‚úÖ **–ú–æ–Ω—Ç–∏—Ä—É–µ—à—å LV** (–∫–∞–∫ –æ–±—ã—á–Ω—ã–π partition)

```bash
sudo mount /dev/vg_data/lv_databases /mnt/databases
```

**Kristjan:** *"VG ‚Äî —ç—Ç–æ container. LV ‚Äî —ç—Ç–æ content. VG —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—É–ª–æ–º, LV ‚Äî —ç—Ç–æ —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ú–æ–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –¥–∏—Å–∫ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π VG?

<details>
<summary>üí° –î–∞, —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö —Ñ–∏—à–µ–∫ LVM!</summary>

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
VG –ø–æ–ª–æ–Ω, –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –¥–∏—Å–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä /dev/sdd)
# 2. –°–æ–∑–¥–∞—Ç—å PV
sudo pvcreate /dev/sdd1

# 3. –î–æ–±–∞–≤–∏—Ç—å PV –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π VG
sudo vgextend vg_data /dev/sdd1

# –í—ã–≤–æ–¥:
#   Volume group "vg_data" successfully extended

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
sudo vgs

# –í—ã–≤–æ–¥:
#   VG      #PV #LV #SN Attr   VSize VFree
#   vg_data   2   3   0 wz--n- 1.0T  500.00g
#             ^                ^^^^^  ^^^^^^
#          2 PV now!         1TB!   500GB free!

# 5. –†–∞—Å—à–∏—Ä–∏—Ç—å LV (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo lvextend -L +200G /dev/vg_data/lv_databases
sudo resize2fs /dev/vg_data/lv_databases
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –ë–µ–∑ unmount —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö LV
- ‚úÖ –ë–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Online expansion

**–≠—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ partitions!**

**Liisa:** *"–í production —Å–µ—Ä–≤–µ—Ä–∞—Ö –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –¥–∏—Å–∫–∏ –≤ VG –Ω–∞–ª—ë—Ç. –ù—É–∂–Ω–æ –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è databases? 10 –º–∏–Ω—É—Ç ‚Äî –Ω–æ–≤—ã–π –¥–∏—Å–∫ –≤ VG, lvextend, done."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ó–∞—á–µ–º –¥–≤–∞ —à–∞–≥–∞ (lvextend + resize2fs)?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**–î–≤–∞ —É—Ä–æ–≤–Ω—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏:**

1. **LVM Level (lvextend):**
   - –†–∞—Å—à–∏—Ä—è–µ—Ç **Logical Volume** (block device)
   - LVM –≥–æ–≤–æ—Ä–∏—Ç kernel: "—Ç–µ–ø–µ—Ä—å `/dev/vg_data/lv_databases` = 250GB, –Ω–µ 200GB"

2. **Filesystem Level (resize2fs):**
   - –†–∞—Å—à–∏—Ä—è–µ—Ç **filesystem** (ext4, xfs, etc.)
   - Filesystem –≥–æ–≤–æ—Ä–∏—Ç kernel: "—Ç–µ–ø–µ—Ä—å —è –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å–µ 250GB, –Ω–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 200GB"

**–ë–µ–∑ resize2fs:**
```bash
sudo lvextend -L +50G /dev/vg_data/lv_databases

df -h | grep databases
# –í—ã–≤–æ–¥: 200GB (filesystem –Ω–µ –∑–Ω–∞–µ—Ç –æ –Ω–æ–≤—ã—Ö 50GB!)

sudo resize2fs /dev/vg_data/lv_databases

df -h | grep databases
# –í—ã–≤–æ–¥: 250GB ‚úÖ
```

**–ê–Ω–∞–ª–æ–≥–∏—è:**
- `lvextend` = —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–∫–ª–∞–¥ (–¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —ç—Ç–∞–∂)
- `resize2fs` = —Å–∫–∞–∑–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É "–∏—Å–ø–æ–ª—å–∑—É–π –Ω–æ–≤—ã–π —ç—Ç–∞–∂!"

**–î–ª—è XFS:**
```bash
sudo xfs_growfs /mnt/databases  # XFS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç mountpoint, –Ω–µ device
```

**Kristjan:** *"LVM –∏ filesystem ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ layers. –û–±–∞ –¥–æ–ª–∂–Ω—ã –∑–Ω–∞—Ç—å –æ resize. lvextend –¥–ª—è LVM, resize2fs –¥–ª—è filesystem."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 4

- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ Volume Group (–ø—É–ª –∏–∑ PV)
- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ Logical Volume (–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª)
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å VG (`vgcreate vg_name /dev/sdX1`)
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å LV (`lvcreate -L 100G -n lv_name vg_name`)
- [ ] –£–º–µ—é —Ä–∞—Å—à–∏—Ä–∏—Ç—å LV (`lvextend` + `resize2fs`)
- [ ] –ü–æ–Ω–∏–º–∞—é snapshot –∫–æ–Ω—Ü–µ–ø—Ç (–º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –±—ç–∫–∞–ø)

**LILITH:**
*"LVM ‚Äî —ç—Ç–æ flexibility. Traditional partitions ‚Äî —ç—Ç–æ concrete walls. LVM ‚Äî —ç—Ç–æ movable walls. Production —Ç—Ä–µ–±—É–µ—Ç flexibility."*

---

## üîÑ –¶–ò–ö–õ 5: Filesystems & /etc/fstab (20-25 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**Kristjan:**
*"–£ –Ω–∞—Å –µ—Å—Ç—å Logical Volumes. –ù–æ OS –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å raw LV. –ù—É–∂–µ–Ω filesystem ‚Äî ext4, xfs, btrfs. Filesystem ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π."*

**–ú–∞–∫—Å:**
*"–ö–∞–∫–æ–π –≤—ã–±—Ä–∞—Ç—å?"*

**Kristjan:**
*"–ó–∞–≤–∏—Å–∏—Ç –æ—Ç use case. ext4 ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, universal. xfs ‚Äî high performance –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤. btrfs ‚Äî modern —Å snapshot support. –í e-Estonia –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º xfs –¥–ª—è databases, ext4 –¥–ª—è –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ."*

**Liisa:**
*"–ò –Ω–µ –∑–∞–±—É–¥—å `/etc/fstab` ‚Äî —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ. –ë–µ–∑ fstab ‚Äî LV –Ω–µ —Å–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ reboot."*

---

### üìö –¢–µ–æ—Ä–∏—è: Filesystems

#### üìö –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Filesystem = Library Catalog System

–ü—Ä–µ–¥—Å—Ç–∞–≤—å **–±–∏–±–ª–∏–æ—Ç–µ–∫—É** (disk):

**–ë–µ–∑ filesystem:**
```
üì¶ Raw Storage (LV)
‚îî‚îÄ Binary data: 01001010110...
   ‚ùå –ì–¥–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ñ–∞–π–ª?
   ‚ùå –ì–¥–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è?
   ‚ùå –ö–∞–∫ –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª?
```

**–° filesystem:**
```
üìö LIBRARY (ext4 filesystem)
‚îÇ
‚îú‚îÄ üìñ Catalog (metadata)
‚îÇ  ‚îú‚îÄ Book "database.sql" ‚Üí Shelf A, Row 5
‚îÇ  ‚îú‚îÄ Book "logs.txt" ‚Üí Shelf B, Row 2
‚îÇ  ‚îî‚îÄ Book "backup.tar.gz" ‚Üí Shelf C, Row 10
‚îÇ
‚îî‚îÄ üìö Shelves (data blocks)
   ‚îú‚îÄ Shelf A: [database.sql content]
   ‚îú‚îÄ Shelf B: [logs.txt content]
   ‚îî‚îÄ Shelf C: [backup.tar.gz content]
```

**Filesystem:**
- **–û—Ä–≥–∞–Ω–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ** –≤ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- **Metadata** (–∏–º—è —Ñ–∞–π–ª–∞, —Ä–∞–∑–º–µ—Ä, permissions, timestamps)
- **Allocation** (–∫–∞–∫–∏–µ blocks –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª)
- **Free space tracking** (–∫–∞–∫–∏–µ blocks —Å–≤–æ–±–æ–¥–Ω—ã)

---

#### üéØ Popular Filesystems

| Filesystem | Use Case | Pros | Cons |
|------------|----------|------|------|
| **ext4** | Universal, stable | ‚úÖ Stable<br>‚úÖ Well-tested<br>‚úÖ Good performance | ‚ùå No snapshots<br>‚ùå Max 16TB file |
| **xfs** | Large files, databases | ‚úÖ High performance<br>‚úÖ Handles large files well<br>‚úÖ Online resize (grow only) | ‚ùå Cannot shrink<br>‚ùå Complex to recover |
| **btrfs** | Modern, snapshots | ‚úÖ Built-in snapshots<br>‚úÖ Compression<br>‚úÖ Online defrag | ‚ö†Ô∏è Less mature<br>‚ö†Ô∏è RAID5/6 unstable |
| **f2fs** | SSD-optimized | ‚úÖ Optimized for flash | ‚ùå Not widely used |

**Kristjan:**
*"ext4 ‚Äî —ç—Ç–æ Toyota. –ù–∞–¥—ë–∂–Ω—ã–π, —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π. xfs ‚Äî —ç—Ç–æ Ferrari. –ë—ã—Å—Ç—Ä—ã–π, –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á. btrfs ‚Äî —ç—Ç–æ Tesla. Modern, –Ω–æ –µ—â—ë –Ω–µ fully mature."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–Ω–∏–µ Filesystems

#### –°–æ–∑–¥–∞–Ω–∏–µ ext4 filesystem

```bash
# –°–æ–∑–¥–∞—Ç—å ext4 –Ω–∞ lv_logs
sudo mkfs.ext4 /dev/vg_data/lv_logs

# –í—ã–≤–æ–¥:
# mke2fs 1.46.5 (30-Dec-2021)
# Creating filesystem with 26214400 4k blocks and 6553600 inodes
# Filesystem UUID: a1b2c3d4-e5f6-4a5b-9c8d-7e6f5a4b3c2d
# Superblock backups stored on blocks:
#         32768, 98304, 163840, 229376, 294912
#
# Allocating group tables: done
# Writing inode tables: done
# Creating journal (131072 blocks): done
# Writing superblocks and filesystem accounting information: done

# –° label (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è fstab)
sudo mkfs.ext4 -L LOGS /dev/vg_data/lv_logs
```

---

#### –°–æ–∑–¥–∞–Ω–∏–µ xfs filesystem

```bash
# –°–æ–∑–¥–∞—Ç—å xfs –Ω–∞ lv_databases
sudo mkfs.xfs /dev/vg_data/lv_databases

# –í—ã–≤–æ–¥:
# meta-data=/dev/vg_data/lv_databases isize=512    agcount=4, agsize=13107200 blks
#          =                       sectsz=512   attr=2, projid32bit=1
#          =                       crc=1        finobt=1, sparse=1, rmapbt=0
#          =                       reflink=1
# data     =                       bsize=4096   blocks=52428800, imaxpct=25
#          =                       sunit=0      swidth=0 blks
# naming   =version 2              bsize=4096   ascii-ci=0, ftype=1
# log      =internal log           bsize=4096   blocks=25600, version=2
#          =                       sectsz=512   sunit=0 blks, lazy-count=1
# realtime =none                   extsz=4096   blocks=0, rtextents=0

# –° label
sudo mkfs.xfs -L DATABASES /dev/vg_data/lv_databases
```

---

### üìã Mounting & /etc/fstab

#### Manual mounting

```bash
# –°–æ–∑–¥–∞—Ç—å mount point
sudo mkdir -p /mnt/databases
sudo mkdir -p /mnt/logs

# Mount
sudo mount /dev/vg_data/lv_databases /mnt/databases
sudo mount /dev/vg_data/lv_logs /mnt/logs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
df -h | grep -E "databases|logs"

# –í—ã–≤–æ–¥:
# /dev/mapper/vg_data-lv_databases  197G   61M  187G   1% /mnt/databases
# /dev/mapper/vg_data-lv_logs        99G   24M   94G   1% /mnt/logs

# Unmount
sudo umount /mnt/databases
sudo umount /mnt/logs
```

---

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ mounting —á–µ—Ä–µ–∑ /etc/fstab

**`/etc/fstab`** ‚Äî —ç—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.

**–§–æ—Ä–º–∞—Ç:**
```
<device>  <mount point>  <filesystem type>  <options>  <dump>  <pass>
```

**–ü—Ä–∏–º–µ—Ä `/etc/fstab`:**

```bash
# Backup original
sudo cp /etc/fstab /etc/fstab.backup

# Edit
sudo nano /etc/fstab

# –î–æ–±–∞–≤–∏—Ç—å:
/dev/vg_data/lv_databases  /mnt/databases  xfs   defaults,noatime  0  2
/dev/vg_data/lv_logs       /mnt/logs       ext4  defaults,noatime  0  2

# –ò–ª–∏ —á–µ—Ä–µ–∑ UUID (recommended!):
UUID=a1b2c3d4-e5f6-4a5b-9c8d-7e6f5a4b3c2d  /mnt/databases  xfs   defaults,noatime  0  2
UUID=f1e2d3c4-b5a6-4f5e-9d8c-7e6f5a4b3c2d  /mnt/logs       ext4  defaults,noatime  0  2
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **defaults:** rw, suid, dev, exec, auto, nouser, async
- **noatime:** –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å access time (performance boost!)
- **0:** dump (–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å backup)
- **2:** fsck pass (–ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ—Å–ª–µ root filesystem)

**–ù–∞–π—Ç–∏ UUID:**
```bash
sudo blkid /dev/vg_data/lv_databases
# /dev/vg_data/lv_databases: UUID="a1b2c3d4-e5f6-4a5b-9c8d-7e6f5a4b3c2d" TYPE="xfs"
```

---

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ fstab

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å fstab
sudo mount -a

# –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –∏—Å–ø—Ä–∞–≤—å fstab –î–û reboot!
# –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π fstab –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Å–∏—Å—Ç–µ–º—É unbootable!

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å
df -h | grep -E "databases|logs"

# Reboot test (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω)
sudo reboot
```

**‚ö†Ô∏è CRITICAL:**
–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `/etc/fstab` –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Å–∏—Å—Ç–µ–º—É **unbootable**!
–í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π `sudo mount -a` –ø–µ—Ä–µ–¥ reboot!

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UUID –≤–º–µ—Å—Ç–æ `/dev/vg_data/lv_name` –≤ fstab?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

**UUID (Universally Unique Identifier):**
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ filesystem
- **–ù–ï –º–µ–Ω—è–µ—Ç—Å—è** –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ LV –∏–ª–∏ VG
- **–ù–ï –∑–∞–≤–∏—Å–∏—Ç** –æ—Ç –ø–æ—Ä—è–¥–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤

**Device path (`/dev/vg_data/lv_name`):**
- –ú–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç LVM configuration

**–ü—Ä–æ–±–ª–µ–º–∞ —Å device path:**
```bash
# fstab:
/dev/vg_data/lv_databases  /mnt/databases  xfs  defaults  0  2

# –ü–æ—Ç–æ–º —Ç—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª VG:
sudo vgrename vg_data vg_production

# –ü–æ—Å–ª–µ reboot:
# ‚ùå /dev/vg_data/lv_databases –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
# ‚ùå Filesystem –Ω–µ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è!
# ‚ùå Applications fail!
```

**–° UUID:**
```bash
# fstab:
UUID=a1b2c3d4-e5f6-4a5b-9c8d-7e6f5a4b3c2d  /mnt/databases  xfs  defaults  0  2

# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª VG:
sudo vgrename vg_data vg_production

# –ü–æ—Å–ª–µ reboot:
# ‚úÖ UUID –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è!
# ‚úÖ Filesystem –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è!
```

**Kristjan:** *"UUID ‚Äî —ç—Ç–æ fingerprint filesystem. Device path –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è, UUID ‚Äî –Ω–∏–∫–æ–≥–¥–∞. –í production –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π UUID –≤ fstab."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–ø—Ü–∏—è `noatime` –≤ fstab?

<details>
<summary>üí° Performance Optimization</summary>

**`noatime`** ‚Äî –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å **access time** (atime) –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞.

**–ë–µ–∑ noatime (default):**
```bash
# –ö–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ —Ç—ã —á–∏—Ç–∞–µ—à—å —Ñ–∞–π–ª:
cat /mnt/databases/data.sql

# Kernel –æ–±–Ω–æ–≤–ª—è–µ—Ç atime metadata:
# - Read file content (I/O operation)
# - Write updated atime (ADDITIONAL I/O operation!)
```

**–° noatime:**
```bash
# –ß–∏—Ç–∞–µ—à—å —Ñ–∞–π–ª:
cat /mnt/databases/data.sql

# Kernel –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç atime:
# - Read file content (I/O operation)
# - No write! (skip atime update)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **Performance boost** (–º–µ–Ω—å—à–µ disk I/O)
- ‚úÖ **–ú–µ–Ω—å—à–µ wear** –Ω–∞ SSD (–º–µ–Ω—å—à–µ writes)
- ‚úÖ –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è read-heavy workloads

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ–ª—å–∑—è —É–∑–Ω–∞—Ç—å –∫–æ–≥–¥–∞ —Ñ–∞–π–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ —á–∏—Ç–∞–ª—Å—è
- ‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ backup tools –∏—Å–ø–æ–ª—å–∑—É—é—Ç atime (—Ä–µ–¥–∫–æ)

**Production best practice:**
```
/dev/vg_data/lv_databases  /mnt/databases  xfs  defaults,noatime  0  2
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: `relatime`** (default –≤ modern Linux):
- –û–±–Ω–æ–≤–ª—è–µ—Ç atime —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ñ–∞–π–ª –∏–∑–º–µ–Ω–∏–ª—Å—è –∏–ª–∏ atime —Å—Ç–∞—Ä–µ–µ 1 –¥–Ω—è
- –ö–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É performance –∏ functionality

**Liisa:** *"–í production databases –º—ã –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–µ–º noatime. –ö–∞–∂–¥—ã–π I/O operation —Ü–µ–Ω–µ–Ω."*

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –µ—Å–ª–∏ fstab —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫—É?

<details>
<summary>üí° System –º–æ–∂–µ—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è!</summary>

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
```bash
# –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π fstab:
/dev/vg_data/lv_nonexistent  /mnt/data  ext4  defaults  0  2
                  ^^^^^^^^^^
                  LV –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!

# Reboot:
sudo reboot

# System boot process:
# 1. Kernel –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚úÖ
# 2. Init (systemd) –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è ‚úÖ
# 3. systemd –ø—ã—Ç–∞–µ—Ç—Å—è mount filesystems –∏–∑ fstab...
# 4. ‚ùå Cannot mount /dev/vg_data/lv_nonexistent
# 5. ‚ùå Boot fails –∏–ª–∏ emergency mode
```

**Emergency mode:**
- –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ recovery shell
- –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å `/etc/fstab` –≤—Ä—É—á–Ω—É—é
- –ú–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É!

**Best Practices:**

1. **Backup fstab –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:**
```bash
sudo cp /etc/fstab /etc/fstab.backup.$(date +%Y%m%d)
```

2. **–¢–µ—Å—Ç–∏—Ä—É–π –î–û reboot:**
```bash
# Unmount all
sudo umount /mnt/databases
sudo umount /mnt/logs

# Test mount -a
sudo mount -a

# –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –∏—Å–ø—Ä–∞–≤—å –°–ï–ô–ß–ê–°, –Ω–µ –ø–æ—Å–ª–µ reboot!
```

3. **–ò—Å–ø–æ–ª—å–∑—É–π `nofail` –æ–ø—Ü–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
```bash
# –ï—Å–ª–∏ mount fails ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å boot
/dev/vg_data/lv_databases  /mnt/databases  xfs  defaults,noatime,nofail  0  2
```

**Kristjan:** *"–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π fstab ‚Äî —ç—Ç–æ —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞ unbootable systems. –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π mount -a –ø–µ—Ä–µ–¥ reboot. –í–°–ï–ì–î–ê."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 5

- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ filesystem (ext4, xfs, btrfs)
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å filesystem (`mkfs.ext4`, `mkfs.xfs`)
- [ ] –£–º–µ—é mount/unmount filesystem
- [ ] –ü–æ–Ω–∏–º–∞—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É `/etc/fstab`
- [ ] –ó–Ω–∞—é –∑–∞—á–µ–º UUID –≤–º–µ—Å—Ç–æ device path
- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ `noatime` –ø–æ–≤—ã—à–∞–µ—Ç performance
- [ ] –ó–Ω–∞—é –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å fstab (`mount -a`)

**LILITH:**
*"Filesystem –±–µ–∑ fstab ‚Äî —ç—Ç–æ manual labor –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ. fstab ‚Äî —ç—Ç–æ automation. –ù–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π fstab ‚Äî —ç—Ç–æ disaster. Test before reboot."*

---

## üîÑ –¶–ò–ö–õ 6: Data Migration ‚Äî –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å failing disk (15-20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**Liisa** (—Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ SMART dashboard):
*"–ú–∞–∫—Å, –¥–∏—Å–∫ `/dev/sdb` –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç –±—ã—Å—Ç—Ä–æ. Reallocated sectors: 267 (–±—ã–ª–æ 247 —á–∞—Å –Ω–∞–∑–∞–¥). –ù—É–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –°–ï–ô–ß–ê–°, –ø–æ–∫–∞ –¥–∏—Å–∫ –∂–∏–≤."*

**–ú–∞–∫—Å:**
*"–ö–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —É–º–∏—Ä–∞—é—â–µ–≥–æ –¥–∏—Å–∫–∞?"*

**Kristjan:**
*"`rsync` ‚Äî —Ç–≤–æ–π –¥—Ä—É–≥. –ö–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å checksums, –º–æ–∂–µ—Ç —Ä–µ–∑—é–º–∏—Ç—å –µ—Å–ª–∏ –ø—Ä–µ—Ä–≤ –∞–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç progress. –î–ª—è block-level –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –µ—Å—Ç—å `dd`, –Ω–æ –æ–Ω –æ–ø–∞—Å–Ω—ã–π ‚Äî –∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å—ë –≤—Å–ª–µ–ø—É—é."*

---

### üìö –¢–µ–æ—Ä–∏—è: Data Migration Strategies

#### üöö –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Data Migration = –ü–µ—Ä–µ–µ–∑–¥ –∫–≤–∞—Ä—Ç–∏—Ä—ã

–ü—Ä–µ–¥—Å—Ç–∞–≤—å **–ø–µ—Ä–µ–µ–∑–¥ –∏–∑ —Å—Ç–∞—Ä–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã –≤ –Ω–æ–≤—É—é**:

**Bad approach (`cp` –∏–ª–∏ `mv`):**
```
üöö ONE TRUCK, ONE TRIP
‚îú‚îÄ –ì—Ä—É–∑–∏—à—å –í–°–Å –≤ –æ–¥–∏–Ω –≥—Ä—É–∑–æ–≤–∏–∫
‚îú‚îÄ –ï—Å–ª–∏ –≥—Ä—É–∑–æ–≤–∏–∫ —Å–ª–æ–º–∞–µ—Ç—Å—è –≤ –ø—É—Ç–∏ ‚Üí –ø–æ—Ç–µ—Ä—è –í–°–ï–ì–û
‚îî‚îÄ –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞
```

**Good approach (`rsync`):**
```
üöõ MULTIPLE TRUCKS, VERIFIED DELIVERY
‚îú‚îÄ –ì—Ä—É–∑–æ–≤–∏–∫ #1: –ö–æ–ø–∏—Ä—É–µ—Ç —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
‚îÇ  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç checksums (–Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ—Ç–µ—Ä—è–ª–∏?)
‚îú‚îÄ –ì—Ä—É–∑–æ–≤–∏–∫ #2: –ö–æ–ø–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —á–∞—Å—Ç—å
‚îÇ  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç checksums
‚îú‚îÄ –ì—Ä—É–∑–æ–≤–∏–∫ #3: –ö–æ–ø–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–≤—à–µ–µ—Å—è
‚îÇ  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç checksums
‚îî‚îÄ –ï—Å–ª–∏ –≥—Ä—É–∑–æ–≤–∏–∫ —Å–ª–æ–º–∞–ª—Å—è ‚Üí resume —Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞ –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å!
```

**rsync –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **Checksum verification** (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç integrity)
- ‚úÖ **Resume capability** (–º–æ–∂–Ω–æ –ø—Ä–µ—Ä–≤–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å)
- ‚úÖ **Progress bar** (–≤–∏–¥–∏—à—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç)
- ‚úÖ **Preserves metadata** (permissions, timestamps)

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

#### Scenario: –ú–∏–≥—Ä–∞—Ü–∏—è —Å `/dev/sdb1` (failing) –Ω–∞ `/dev/vg_data/lv_databases` (new LV)

```bash
# 1. Mount old disk (read-only –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
sudo mkdir -p /mnt/old_db
sudo mount -o ro /dev/sdb1 /mnt/old_db

# 2. Mount new LV
sudo mkdir -p /mnt/databases
sudo mount /dev/vg_data/lv_databases /mnt/databases

# 3. –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å rsync
sudo rsync -avh --progress /mnt/old_db/ /mnt/databases/

# -a: archive mode (preserve permissions, timestamps, symlinks)
# -v: verbose (–ø–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è)
# -h: human-readable sizes
# --progress: –ø–æ–∫–∞–∑–∞—Ç—å progress bar
```

---

#### rsync output (–ø—Ä–∏–º–µ—Ä)

```
sending incremental file list
./
mysql/
mysql/ibdata1
      15,728,640 100%   45.32MB/s    0:00:00 (xfr#1, to-chk=5247/5250)
mysql/ib_logfile0
      50,331,648 100%   87.54MB/s    0:00:00 (xfr#2, to-chk=5246/5250)
mysql/mydb/
mysql/mydb/users.frm
           8,788 100%   14.23kB/s    0:00:00 (xfr#3, to-chk=5245/5250)
mysql/mydb/users.ibd
     104,857,600  32%   92.15MB/s    0:00:01

sent 235,678,432 bytes  received 1,024 bytes  44,567,123.45 bytes/sec
total size is 524,288,000  speedup is 2.22
```

---

#### Advanced: rsync —Å checksums –∏ retry

```bash
# –î–ª—è critical data –∏—Å–ø–æ–ª—å–∑—É–π checksums
sudo rsync -avh --progress --checksum /mnt/old_db/ /mnt/databases/

# --checksum: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç file content, –Ω–µ —Ç–æ–ª—å–∫–æ —Ä–∞–∑–º–µ—Ä/timestamp
# –ú–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–∞–¥—ë–∂–Ω–µ–µ

# –î–ª—è –±–æ–ª—å—à–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π: –ª–æ–≥–∏ + resume
sudo rsync -avh --progress \
  --log-file=/var/log/migration.log \
  --partial \
  /mnt/old_db/ /mnt/databases/

# --partial: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–¥–ª—è resume)
# --log-file: –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏

# –ï—Å–ª–∏ –ø—Ä–µ—Ä–≤–∞–ª–æ—Å—å ‚Äî resume (–∑–∞–ø—É—Å—Ç–∏ —Ç—É –∂–µ –∫–æ–º–∞–Ω–¥—É —Å–Ω–æ–≤–∞)
# rsync —É–º–Ω—ã–π ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞ –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è
```

---

#### Block-level –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (dd ‚Äî use with CAUTION!)

```bash
# dd ‚Äî –∫–æ–ø–∏—Ä—É–µ—Ç –í–°–Å –Ω–∞ block level (–≤–∫–ª—é—á–∞—è empty space!)
# ‚ö†Ô∏è –û–ü–ê–°–ù–û! –ú–æ–∂–µ—Ç —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ —Å–ø—É—Ç–∞—Ç—å if= –∏ of=

# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫ —Ü–µ–ª–∏–∫–æ–º
sudo dd if=/dev/sdb of=/dev/sdc bs=4M status=progress

# if= (input file): SOURCE
# of= (output file): DESTINATION
# bs= (block size): 4MB chunks (faster)
# status=progress: –ø–æ–∫–∞–∑–∞—Ç—å progress

# ‚ö†Ô∏è –ü–†–û–í–ï–†–¨ –î–í–ê –†–ê–ó–ê!
# if= SOURCE (—Å—Ç–∞—Ä—ã–π –¥–∏—Å–∫)
# of= DESTINATION (–Ω–æ–≤—ã–π –¥–∏—Å–∫)
# –ü–µ—Ä–µ–ø—É—Ç–∞–ª ‚Äî —É–Ω–∏—á—Ç–æ–∂–∏–ª –¥–∞–Ω–Ω—ã–µ!
```

**Kristjan:**
*"`dd` ‚Äî —ç—Ç–æ chainsaw. –ú–æ—â–Ω—ã–π, –Ω–æ –æ–ø–∞—Å–Ω—ã–π. `rsync` ‚Äî —ç—Ç–æ precision tool. –î–ª—è data migration –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `rsync`, –∫—Ä–æ–º–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–ª—É—á–∞–µ–≤."*

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `rsync` –∏ `cp`?

<details>
<summary>üí° –û—Ç–≤–µ—Ç</summary>

| –§—É–Ω–∫—Ü–∏—è | `cp` | `rsync` |
|---------|------|---------|
| **Incremental copy** | ‚ùå –ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å—ë –∑–∞–Ω–æ–≤–æ | ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è |
| **Resume capability** | ‚ùå –ù–µ–ª—å–∑—è resume | ‚úÖ –ú–æ–∂–Ω–æ resume |
| **Checksum verification** | ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ | ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ |
| **Progress bar** | ‚ùå –ù–µ—Ç | ‚úÖ `--progress` |
| **Network transfer** | ‚ùå –¢–æ–ª—å–∫–æ local | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ SSH |
| **Speed** | –ë—ã—Å—Ç—Ä–µ–µ –¥–ª—è –ø–µ—Ä–≤–æ–π –∫–æ–ø–∏–∏ | –ë—ã—Å—Ç—Ä–µ–µ –¥–ª—è incremental updates |

**–ü—Ä–∏–º–µ—Ä:**
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å 100GB database
cp -r /mnt/old/ /mnt/new/  # 10 –º–∏–Ω—É—Ç

# –î–æ–±–∞–≤–∏–ª–∏ 1GB –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
cp -r /mnt/old/ /mnt/new/  # –°–Ω–æ–≤–∞ 10 –º–∏–Ω—É—Ç! (–∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å—ë)

# –° rsync:
rsync -av /mnt/old/ /mnt/new/  # 10 –º–∏–Ω—É—Ç
# –î–æ–±–∞–≤–∏–ª–∏ 1GB –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
rsync -av /mnt/old/ /mnt/new/  # 30 —Å–µ–∫—É–Ω–¥! (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
```

**Best practice:**
- ‚úÖ `rsync` –¥–ª—è data migration, backups, sync
- ‚ö†Ô∏è `cp` –¥–ª—è simple single-file copies

**Liisa:** *"rsync ‚Äî —ç—Ç–æ industry standard –¥–ª—è data migration. cp ‚Äî —ç—Ç–æ toy. Production data —Ç—Ä–µ–±—É–µ—Ç rsync."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ó–∞—á–µ–º `-o ro` (read-only) –ø—Ä–∏ mounting failing disk?

<details>
<summary>üí° Safety First</summary>

**Read-only mount (`-o ro`):**
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö:** –ù–µ–ª—å–∑—è —Å–ª—É—á–∞–π–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å
- ‚úÖ **–ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ dying disk:** –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, no writes
- ‚úÖ **Filesystem consistency:** –ï—Å–ª–∏ filesystem –ø–æ–≤—Ä–µ–∂–¥—ë–Ω ‚Äî –Ω–µ —É—Ö—É–¥—à–∞–µ–º

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
```bash
# Mount read-write (default)
sudo mount /dev/sdb1 /mnt/old_db

# –°–ª—É—á–∞–π–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª:
rm -rf /mnt/old_db/important_data/  # üí• DATA LOSS!

# Mount read-only
sudo mount -o ro /dev/sdb1 /mnt/old_db

# –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å:
rm -rf /mnt/old_db/important_data/
# rm: cannot remove '/mnt/old_db/important_data/': Read-only file system ‚úÖ
```

**Failing disk:**
- –ö–∞–∂–¥–∞—è write operation –º–æ–∂–µ—Ç **—É—Å–∫–æ—Ä–∏—Ç—å —Å–º–µ—Ä—Ç—å**
- Read-only mode = **minimal stress**

**Best practice –¥–ª—è migration:**
```bash
# 1. Mount source read-only
sudo mount -o ro /dev/sdb1 /mnt/old

# 2. –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
sudo rsync -av /mnt/old/ /mnt/new/

# 3. Verify
diff -r /mnt/old/ /mnt/new/

# 4. Unmount source
sudo umount /mnt/old

# 5. Retire old disk
```

**Kristjan:** *"Failing disk ‚Äî —ç—Ç–æ time bomb. Read-only mount –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–∏—Å–∫. –ö–∞–∂–¥–∞—è write operation –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–π."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 6

- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º –Ω—É–∂–Ω–∞ data migration (failing disk rescue)
- [ ] –£–º–µ—é –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å `rsync` (`rsync -avh --progress`)
- [ ] –ó–Ω–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `rsync` –∏ `cp` (incremental vs full copy)
- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º read-only mount (`-o ro`)
- [ ] –ó–Ω–∞—é —á—Ç–æ `dd` –æ–ø–∞—Å–µ–Ω (block-level, –º–æ–∂–µ—Ç —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –¥–∞–Ω–Ω—ã–µ)
- [ ] –£–º–µ—é resume –º–∏–≥—Ä–∞—Ü–∏—é –µ—Å–ª–∏ –ø—Ä–µ—Ä–≤–∞–ª–∞—Å—å

**LILITH:**
*"Data migration ‚Äî —ç—Ç–æ surgery. Failing disk ‚Äî —ç—Ç–æ patient —É–º–∏—Ä–∞—é—â–∏–π –Ω–∞ —Å—Ç–æ–ª–µ. rsync ‚Äî —ç—Ç–æ scalpel. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π chainsaw (dd) –≥–¥–µ –Ω—É–∂–µ–Ω scalpel."*

---

## üîÑ –¶–ò–ö–õ 7: RAID Concepts ‚Äî Redundancy (15-20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç

**Kristjan:**
*"–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –î–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–æ–≤–æ–º LV. –ù–æ —á—Ç–æ –µ—Å–ª–∏ —ç—Ç–æ—Ç –¥–∏—Å–∫ —Ç–æ–∂–µ —É–º—Ä—ë—Ç? –í production –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –æ–¥–∏–Ω –¥–∏—Å–∫."*

**–ú–∞–∫—Å:**
*"RAID?"*

**Kristjan:**
*"Exactly. RAID (Redundant Array of Independent Disks) ‚Äî —ç—Ç–æ technique –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤ –¥–ª—è redundancy –∏–ª–∏ performance. RAID 1 ‚Äî –∑–µ—Ä–∫–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ. RAID 5 ‚Äî parity. RAID 10 ‚Äî combination."*

**Liisa:**
*"–í e-Estonia –≤—Å–µ critical databases –Ω–∞ RAID 10. –î–≤–∞ –¥–∏—Å–∫–∞ —É–º—Ä—É—Ç ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç. –≠—Ç–æ insurance policy."*

---

### üìö –¢–µ–æ—Ä–∏—è: RAID Levels

#### üõ°Ô∏è –ú–µ—Ç–∞—Ñ–æ—Ä–∞: RAID = Backup Team

–ü—Ä–µ–¥—Å—Ç–∞–≤—å **–∫–æ–º–∞–Ω–¥—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤**:

**–ë–µ–∑ RAID (single disk):**
```
üë§ ONE PERSON
‚îî‚îÄ –ï—Å–ª–∏ –∑–∞–±–æ–ª–µ–ª ‚Üí –ø—Ä–æ–µ–∫—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è ‚ùå
```

**RAID 1 (mirroring):**
```
üë§üë§ TWO PEOPLE, SAME TASK
‚îú‚îÄ Person A: –î–µ–ª–∞–µ—Ç –∑–∞–¥–∞—á—É
‚îú‚îÄ Person B: –î–µ–ª–∞–µ—Ç –¢–£ –ñ–ï –∑–∞–¥–∞—á—É (mirror)
‚îî‚îÄ –ï—Å–ª–∏ Person A –∑–∞–±–æ–ª–µ–ª ‚Üí Person B –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç ‚úÖ
```

**RAID 5 (parity):**
```
üë§üë§üë§ THREE PEOPLE, DISTRIBUTED WORK
‚îú‚îÄ Person A: –ß–∞—Å—Ç—å 1
‚îú‚îÄ Person B: –ß–∞—Å—Ç—å 2
‚îú‚îÄ Person C: Parity (checksum –ß–∞—Å—Ç–∏ 1+2)
‚îî‚îÄ –ï—Å–ª–∏ Person A –∑–∞–±–æ–ª–µ–ª ‚Üí –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ß–∞—Å—Ç—å 1 –∏–∑ B+C ‚úÖ
```

**RAID 10 (mirror + stripe):**
```
üë§üë§ + üë§üë§ FOUR PEOPLE, PAIRS
‚îú‚îÄ Pair 1 (A+B mirror): –ß–∞—Å—Ç—å 1
‚îú‚îÄ Pair 2 (C+D mirror): –ß–∞—Å—Ç—å 2
‚îî‚îÄ –ï—Å–ª–∏ A+C –∑–∞–±–æ–ª–µ–ª–∏ ‚Üí B+D –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç ‚úÖ
```

---

#### üéØ RAID Levels Comparison

| RAID | –î–∏—Å–∫–æ–≤ | Capacity | Performance | Fault Tolerance | Use Case |
|------|--------|----------|-------------|-----------------|----------|
| **RAID 0** | 2+ | 100% (2x1TB = 2TB) | ‚ö°‚ö°‚ö° Fast (striping) | ‚ùå 0 (–ª—é–±–æ–π –¥–∏—Å–∫ —É–º–µ—Ä = data loss) | Performance, non-critical |
| **RAID 1** | 2+ | 50% (2x1TB = 1TB) | ‚ö°‚ö° Good read | ‚úÖ n-1 disks | OS drives, critical data |
| **RAID 5** | 3+ | 66-90% (3x1TB = 2TB) | ‚ö°‚ö° Good | ‚úÖ 1 disk | File servers |
| **RAID 6** | 4+ | 50-80% (4x1TB = 2TB) | ‚ö° OK | ‚úÖ 2 disks | High reliability |
| **RAID 10** | 4+ (even) | 50% (4x1TB = 2TB) | ‚ö°‚ö°‚ö° Fast | ‚úÖ Half disks | Databases, VMs |

---

#### RAID 0 (Striping ‚Äî –ù–ï–¢ redundancy!)

```
DISK 1        DISK 2
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ A1  ‚îÇ      ‚îÇ A2  ‚îÇ  ‚Üê File A split
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ B1  ‚îÇ      ‚îÇ B2  ‚îÇ  ‚Üê File B split
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ C1  ‚îÇ      ‚îÇ C2  ‚îÇ  ‚Üê File C split
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° **2x performance** (—á–∏—Ç–∞–µ—Ç/–ø–∏—à–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
- ‚úÖ **100% capacity** (–Ω–µ—Ç overhead)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå **NO fault tolerance** (–ª—é–±–æ–π –¥–∏—Å–∫ —É–º–µ—Ä = ALL data lost!)

**Use case:**
- Temp data, cache
- Video editing (speed –≤–∞–∂–Ω–µ–µ redundancy)

**Kristjan:** *"RAID 0 ‚Äî —ç—Ç–æ gambling. Fast, –Ω–æ zero protection. –û–¥–∏–Ω –¥–∏—Å–∫ —É–º–µ—Ä ‚Äî —Ç—ã –ø–æ—Ç–µ—Ä—è–ª –í–°–Å."*

---

#### RAID 1 (Mirroring ‚Äî 100% redundancy)

```
DISK 1        DISK 2
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ A   ‚îÇ ‚ïê‚ïê‚ïê‚ñ∂ ‚îÇ A   ‚îÇ  ‚Üê Exact copy
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ B   ‚îÇ ‚ïê‚ïê‚ïê‚ñ∂ ‚îÇ B   ‚îÇ  ‚Üê Exact copy
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ C   ‚îÇ ‚ïê‚ïê‚ïê‚ñ∂ ‚îÇ C   ‚îÇ  ‚Üê Exact copy
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **100% redundancy** (–ª—é–±–æ–π –¥–∏—Å–∫ —É–º–µ—Ä ‚Äî –¥–∞–Ω–Ω—ã–µ —Ü–µ–ª—ã)
- ‚ö° **Fast read** (—á–∏—Ç–∞–µ—Ç —Å –æ–±–æ–∏—Ö –¥–∏—Å–∫–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
- ‚úÖ **Simple recovery** (–ø—Ä–æ—Å—Ç–æ replace failed disk)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå **50% capacity** (2x1TB = —Ç–æ–ª—å–∫–æ 1TB usable)
- ‚ö° **Slow write** (–ø–∏—à–µ—Ç –Ω–∞ –æ–±–∞ –¥–∏—Å–∫–∞)

**Use case:**
- OS drives
- Critical databases (–µ—Å–ª–∏ capacity –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞)

---

#### RAID 5 (Striping + Parity)

```
DISK 1      DISK 2      DISK 3
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ A1  ‚îÇ    ‚îÇ A2  ‚îÇ    ‚îÇ Ap  ‚îÇ  ‚Üê A1+A2 ‚Üí parity Ap
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ B1  ‚îÇ    ‚îÇ Bp  ‚îÇ    ‚îÇ B2  ‚îÇ  ‚Üê B1+B2 ‚Üí parity Bp
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Cp  ‚îÇ    ‚îÇ C1  ‚îÇ    ‚îÇ C2  ‚îÇ  ‚Üê C1+C2 ‚Üí parity Cp
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **Fault tolerance** (1 disk —É–º–µ—Ä ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏–∑ parity)
- ‚úÖ **Good capacity** (3x1TB = 2TB usable, 66%)
- ‚ö° **Good read performance**

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö° **Slower write** (–Ω—É–∂–Ω–æ calculate parity)
- ‚ùå **–¢–æ–ª—å–∫–æ 1 disk failure** (2 –¥–∏—Å–∫–∞ —É–º–µ—Ä–ª–∏ = data loss!)
- ‚ö†Ô∏è **Rebuild stress** (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–∏—Å–∫–∏)

**Use case:**
- File servers
- Archive storage

---

#### RAID 10 (1+0 = Mirror + Stripe)

```
  RAID 1 PAIR 1    RAID 1 PAIR 2
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ A1  ‚îÇ A1  ‚îÇ    ‚îÇ A2  ‚îÇ A2  ‚îÇ ‚Üê File A striped + mirrored
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ B1  ‚îÇ B1  ‚îÇ    ‚îÇ B2  ‚îÇ B2  ‚îÇ ‚Üê File B striped + mirrored
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
DISK1   DISK2     DISK3   DISK4
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **High fault tolerance** (–¥–æ 2 disks —É–º–µ—Ä–ª–∏ ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚ö°‚ö° **Fast read + write** (striping performance)
- ‚úÖ **Fast rebuild** (–ø—Ä–æ—Å—Ç–æ mirror rebuild, –Ω–µ parity calculation)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå **50% capacity** (4x1TB = 2TB usable)
- ‚ùå **–ú–∏–Ω–∏–º—É–º 4 –¥–∏—Å–∫–∞**

**Use case:**
- Production databases
- Virtual machines
- High I/O applications

**Liisa:** *"RAID 10 ‚Äî —ç—Ç–æ gold standard –¥–ª—è databases. Fast, reliable, production-proven. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º RAID 10 –¥–ª—è –≤—Å–µ—Ö critical —Å–∏—Å—Ç–µ–º."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: LVM + RAID (mdadm)

Linux –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç software RAID —á–µ—Ä–µ–∑ `mdadm`.

#### –°–æ–∑–¥–∞–Ω–∏–µ RAID 1 (mirror)

```bash
# Install mdadm
sudo apt install mdadm

# –°–æ–∑–¥–∞—Ç—å RAID 1 –∏–∑ /dev/sdc –∏ /dev/sdd
sudo mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdc /dev/sdd

# –í—ã–≤–æ–¥:
# mdadm: Defaulting to version 1.2 metadata
# mdadm: array /dev/md0 started.

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å status
cat /proc/mdstat

# –í—ã–≤–æ–¥:
# Personalities : [raid1]
# md0 : active raid1 sdd[1] sdc[0]
#       524224 blocks super 1.2 [2/2] [UU]
#
# [UU] = –æ–±–∞ –¥–∏—Å–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
sudo mdadm --detail /dev/md0
```

---

#### RAID + LVM (best practice)

```bash
# 1. –°–æ–∑–¥–∞—Ç—å RAID array
sudo mdadm --create /dev/md0 --level=10 --raid-devices=4 /dev/sd{c,d,e,f}

# 2. –°–æ–∑–¥–∞—Ç—å PV –Ω–∞ RAID
sudo pvcreate /dev/md0

# 3. –î–æ–±–∞–≤–∏—Ç—å –≤ VG
sudo vgcreate vg_raid /dev/md0

# 4. –°–æ–∑–¥–∞—Ç—å LV
sudo lvcreate -L 500G -n lv_databases vg_raid

# –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è:
# - RAID 10 redundancy (hardware level)
# - LVM flexibility (logical level)
# - Best of both worlds!
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –ö–∞–∫–æ–π RAID –¥–ª—è production databases: RAID 5 –∏–ª–∏ RAID 10?

<details>
<summary>üí° RAID 10 –¥–ª—è databases</summary>

**RAID 10 ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è databases:**

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° **Faster writes** (no parity calculation)
- ‚úÖ **Better fault tolerance** (–¥–æ 2 disks failure)
- ‚ö° **Faster rebuild** (mirror rebuild –±—ã—Å—Ç—Ä–µ–µ parity rebuild)
- ‚úÖ **No write penalty** (RAID 5 –∏–º–µ–µ—Ç write penalty –∏–∑-–∑–∞ parity)

**RAID 5 –ø—Ä–æ–±–ª–µ–º—ã –¥–ª—è databases:**
- ‚ö†Ô∏è **Write penalty:** –ö–∞–∂–¥–∞—è write ‚Üí read old data ‚Üí calculate parity ‚Üí write data+parity (4 I/O operations!)
- ‚ö†Ô∏è **Rebuild risk:** Rebuild –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–∏—Å–∫–∏ ‚Üí –≤—Ç–æ—Ä–æ–π –¥–∏—Å–∫ –º–æ–∂–µ—Ç —É–º–µ—Ä–µ—Ç—å –≤–æ –≤—Ä–µ–º—è rebuild ‚Üí data loss
- ‚ö†Ô∏è **URE (Unrecoverable Read Error):** –ù–∞ –±–æ–ª—å—à–∏—Ö –¥–∏—Å–∫–∞—Ö (>2TB) –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å URE –≤–æ –≤—Ä–µ–º—è rebuild –≤—ã—Å–æ–∫–∞—è

**Benchmark (–ø—Ä–∏–º–µ—Ä–Ω—ã–π):**
```
RAID 5:  10,000 IOPS write
RAID 10: 20,000 IOPS write
```

**Cost:**
- RAID 5: 3x1TB = 2TB usable ($300 for 3 disks)
- RAID 10: 4x1TB = 2TB usable ($400 for 4 disks)
- **+$100 –∑–∞ 2x performance –∏ better reliability = worth it!**

**Kristjan:** *"RAID 5 ‚Äî —ç—Ç–æ legacy. –ë—ã–ª OK –¥–ª—è HDD —ç—Ä—ã, –Ω–æ modern databases —Ç—Ä–µ–±—É—é—Ç RAID 10. Performance –∏ reliability –∫—Ä–∏—Ç–∏—á–Ω—ã."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ú–æ–∂–Ω–æ –ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ 2 –¥–∏—Å–∫–∞ —É–º–µ—Ä–ª–∏ –≤ RAID 5?

<details>
<summary>üí° –ù–ï–¢ (–±–µ–∑ backup)</summary>

**RAID 5 ‚Äî tolerates ONLY 1 disk failure.**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
```
RAID 5: 3 –¥–∏—Å–∫–∞ (A, B, C)
‚îú‚îÄ –î–µ–Ω—å 1: Disk A —É–º–µ—Ä ‚ö†Ô∏è
‚îÇ  ‚îî‚îÄ RAID degraded, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑ B+C parity)
‚îÇ
‚îú‚îÄ –î–µ–Ω—å 2: –ù–∞—á–∞–ª—Å—è rebuild (–¥–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –¥–∏—Å–∫ D)
‚îÇ  ‚îî‚îÄ Rebuild: 12 —á–∞—Å–æ–≤ (heavy I/O load –Ω–∞ B –∏ C)
‚îÇ
‚îî‚îÄ –î–µ–Ω—å 2, —á–∞—Å 8: Disk B —É–º–µ—Ä ‚ùå (stress –æ—Ç rebuild)
   ‚îî‚îÄ 2 –¥–∏—Å–∫–∞ –º–µ—Ä—Ç–≤—ã ‚Üí RAID failed ‚Üí DATA LOSS!
```

**–ë–µ–∑ backup ‚Üí –¥–∞–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä—è–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞.**

**RAID ‚Äî —ç—Ç–æ –ù–ï backup!**

**RAID protects against:** Hardware failure (–¥–∏—Å–∫ —É–º–µ—Ä)
**RAID –ù–ï protects against:**
- ‚ùå Accidental deletion (`rm -rf /`)
- ‚ùå Ransomware
- ‚ùå Fire, theft
- ‚ùå Multiple simultaneous failures
- ‚ùå Filesystem corruption

**Best practice:**
```
RAID (redundancy) + Backup (disaster recovery)
```

**Liisa:** *"RAID ‚Äî —ç—Ç–æ airbag. Backup ‚Äî —ç—Ç–æ fire insurance. –ù—É–∂–Ω—ã –û–ë–ê. –ì–æ–≤–æ—Ä–∏—à—å '—É –º–µ–Ω—è RAID, –Ω–µ –Ω—É–∂–µ–Ω backup' ‚Äî —Ç—ã –ø–æ—Ç–µ—Ä—è–µ—à—å –¥–∞–Ω–Ω—ã–µ. –í–æ–ø—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 7

- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Ç–∞–∫–æ–µ RAID (Redundant Array of Independent Disks)
- [ ] –ó–Ω–∞—é difference –º–µ–∂–¥—É RAID levels (0, 1, 5, 10)
- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ RAID 10 –ª—É—á—à–µ –¥–ª—è databases (performance + reliability)
- [ ] –ó–Ω–∞—é —á—Ç–æ RAID ‚Äî –ù–ï backup (protects –æ—Ç hardware failure only)
- [ ] –ü–æ–Ω–∏–º–∞—é –∫–æ–Ω—Ü–µ–ø—Ç striping (performance) –∏ mirroring (redundancy)

**LILITH:**
*"RAID ‚Äî —ç—Ç–æ insurance –ø—Ä–æ—Ç–∏–≤ hardware failure. –ù–æ insurance –Ω–µ —Å–ø–∞—Å—ë—Ç –æ—Ç –ø–æ–∂–∞—Ä–∞ –µ—Å–ª–∏ –Ω–µ—Ç backup. RAID + Backup = production ready."*

---

## üîÑ –¶–ò–ö–õ 8: Production Monitoring ‚Äî systemd disk monitoring (15-20 –º–∏–Ω—É—Ç)

### üé¨ –°—é–∂–µ—Ç (—Ñ–∏–Ω–∞–ª)

**Liisa:**
*"–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. LVM –Ω–∞—Å—Ç—Ä–æ–µ–Ω. fstab —Ä–∞–±–æ—Ç–∞–µ—Ç. –ù–æ –∫–∞–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å disk space? –í production –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –∫–æ–≥–¥–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –º–µ—Å—Ç–æ –î–û —Ç–æ–≥–æ –∫–∞–∫ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è."*

**Kristjan:**
*"systemd service + timer. –ü—Ä–æ–≤–µ—Ä—è–µ–º disk space –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç. –ï—Å–ª–∏ >90% ‚Äî alert –≤ Slack. Automation, –Ω–µ manual checks."*

**–ú–∞–∫—Å —Å–æ–∑–¥–∞—ë—Ç systemd service –¥–ª—è disk monitoring.**

**3 —á–∞—Å–∞ —Å–ø—É—Å—Ç—è:**

**Kristjan:**
*"–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –ú–∞–∫—Å. –î–∞–Ω–Ω—ã–µ —Å–ø–∞—Å–µ–Ω—ã. LVM –Ω–∞—Å—Ç—Ä–æ–µ–Ω. Monitoring —Ä–∞–±–æ—Ç–∞–µ—Ç. –¢—ã –æ—Å–≤–æ–∏–ª disk management."*

**Liisa:**
*"–î–∏—Å–∫ `/dev/sdb` —Ç–µ–ø–µ—Ä—å retired. –ù–æ–≤—ã–π LVM setup production-ready. Welcome to disk management world."*

**–ú–∞–∫—Å —É–ª—ã–±–∞–µ—Ç—Å—è, –≥–ª—è–¥—è –Ω–∞ monitoring dashboard. –í—Å–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–µ–ª—ë–Ω—ã–µ.**

---

### üìö –¢–µ–æ—Ä–∏—è: Disk Space Monitoring

#### üì° –ú–µ—Ç–∞—Ñ–æ—Ä–∞: Monitoring = Early Warning System

–ü—Ä–µ–¥—Å—Ç–∞–≤—å **–¥–∞–º–±—É —Å –¥–∞—Ç—á–∏–∫–∞–º–∏**:

**–ë–µ–∑ monitoring:**
```
üåä DAM (disk space)
‚îî‚îÄ –£—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã: ???
   ‚îî‚îÄ –í–Ω–µ–∑–∞–ø–Ω–æ: OVERFLOW! üí•
      ‚îî‚îÄ Database crash, application failure
```

**–° monitoring:**
```
üì° EARLY WARNING SYSTEM
‚îú‚îÄ –î–∞—Ç—á–∏–∫ —É—Ä–æ–≤–Ω—è –≤–æ–¥—ã: 70% ‚úÖ
‚îú‚îÄ –î–∞—Ç—á–∏–∫ —É—Ä–æ–≤–Ω—è –≤–æ–¥—ã: 85% ‚ö†Ô∏è (alert sent)
‚îú‚îÄ –î–∞—Ç—á–∏–∫ —É—Ä–æ–≤–Ω—è –≤–æ–¥—ã: 90% üö® (CRITICAL!)
‚îî‚îÄ Engineer —Ä–µ–∞–≥–∏—Ä—É–µ—Ç: clean up logs, extend LV ‚úÖ
```

**systemd service + timer** = –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞—Ç—á–∏–∫–∏.

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: systemd Disk Monitoring Service

#### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å monitoring script

```bash
sudo nano /usr/local/bin/disk-monitor.sh
```

```bash
#!/bin/bash

################################################################################
# DISK SPACE MONITORING SCRIPT
# Episode 11: Disk Management & LVM
# KERNEL SHADOWS Operation
################################################################################

set -e

# Configuration
THRESHOLD=90
EMAIL="admin@example.com"
SLACK_WEBHOOK="https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

# Colors
RED='\033[0;31m'
YELLOW='\033[1;33m'
GREEN='\033[0;32m'
NC='\033[0m'

# Function: Check disk usage
check_disk_usage() {
    local mount_point="$1"
    local threshold="$2"

    local usage=$(df -h "$mount_point" | tail -1 | awk '{print $5}' | sed 's/%//')

    if [[ $usage -ge $threshold ]]; then
        echo -e "${RED}CRITICAL: $mount_point is ${usage}% full!${NC}"
        send_alert "$mount_point" "$usage"
        return 1
    elif [[ $usage -ge 80 ]]; then
        echo -e "${YELLOW}WARNING: $mount_point is ${usage}% full${NC}"
        return 0
    else
        echo -e "${GREEN}OK: $mount_point is ${usage}% full${NC}"
        return 0
    fi
}

# Function: Send alert (Slack)
send_alert() {
    local mount_point="$1"
    local usage="$2"

    local message="üö® DISK SPACE ALERT: $mount_point is ${usage}% full on $(hostname)"

    # Slack notification
    if [[ -n "$SLACK_WEBHOOK" ]]; then
        curl -X POST -H 'Content-type: application/json' \
            --data "{\"text\":\"$message\"}" \
            "$SLACK_WEBHOOK" 2>/dev/null
    fi

    # Email notification (optional)
    if command -v mail &> /dev/null; then
        echo "$message" | mail -s "Disk Space Alert" "$EMAIL"
    fi

    # Log to syslog
    logger -t disk-monitor "$message"
}

# Main: Check all mounted filesystems
main() {
    echo "=== Disk Space Monitoring - $(date) ==="

    # Check specific mount points
    check_disk_usage "/" "$THRESHOLD"
    check_disk_usage "/mnt/databases" "$THRESHOLD" || true
    check_disk_usage "/mnt/logs" "$THRESHOLD" || true

    echo "=== Monitoring complete ==="
}

main "$@"
```

```bash
# Make executable
sudo chmod +x /usr/local/bin/disk-monitor.sh

# Test
sudo /usr/local/bin/disk-monitor.sh
```

---

#### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å systemd service

```bash
sudo nano /etc/systemd/system/disk-monitor.service
```

```ini
[Unit]
Description=Disk Space Monitoring Service
After=local-fs.target
Documentation=https://github.com/kernel-shadows/episode-11

[Service]
Type=oneshot
ExecStart=/usr/local/bin/disk-monitor.sh
StandardOutput=journal
StandardError=journal
SyslogIdentifier=disk-monitor

# Security hardening
NoNewPrivileges=true
PrivateTmp=true

[Install]
WantedBy=multi-user.target
```

---

#### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å systemd timer (scheduler)

```bash
sudo nano /etc/systemd/system/disk-monitor.timer
```

```ini
[Unit]
Description=Disk Space Monitoring Timer
Documentation=https://github.com/kernel-shadows/episode-11

[Timer]
# Run every 30 minutes
OnCalendar=*:0/30
# Run 5 minutes after boot
OnBootSec=5min
# If missed (system was off), run on next boot
Persistent=true

[Install]
WantedBy=timers.target
```

---

#### –®–∞–≥ 4: Enable –∏ Start

```bash
# Reload systemd
sudo systemctl daemon-reload

# Enable timer (start on boot)
sudo systemctl enable disk-monitor.timer

# Start timer
sudo systemctl start disk-monitor.timer

# Check timer status
sudo systemctl status disk-monitor.timer

# List all timers
systemctl list-timers disk-monitor.timer

# –í—ã–≤–æ–¥:
# NEXT                         LEFT       LAST  PASSED  UNIT                   ACTIVATES
# Sat 2025-10-11 13:00:00 UTC  2min left  n/a   n/a     disk-monitor.timer     disk-monitor.service
```

---

#### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# Logs service
sudo journalctl -u disk-monitor.service -f

# Logs timer
sudo journalctl -u disk-monitor.timer -f

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 entries
sudo journalctl -u disk-monitor.service -n 20
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–í–æ–ø—Ä–æ—Å 1:** –ó–∞—á–µ–º systemd timer –≤–º–µ—Å—Ç–æ cron?

<details>
<summary>üí° systemd timers ‚Äî modern replacement for cron</summary>

**systemd timer –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. **Centralized logging:**
```bash
# systemd timer:
sudo journalctl -u disk-monitor.service  # –í—Å–µ –ª–æ–≥–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ

# cron:
# –õ–æ–≥–∏ –≤ /var/log/syslog, –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã —Å –¥—Ä—É–≥–∏–º–∏, –Ω–µ—É–¥–æ–±–Ω–æ
```

2. **Dependencies:**
```ini
# systemd timer:
[Unit]
After=network.target  # Wait for network

# cron:
# No dependency management, –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –¥–æ network ready
```

3. **Resource control:**
```ini
# systemd service:
CPUQuota=20%
MemoryLimit=512M

# cron:
# No resource limits!
```

4. **Persistent:**
```ini
# systemd timer:
Persistent=true  # If system was off, run on boot

# cron:
# Missed runs = lost forever
```

5. **Human-readable:**
```ini
# systemd:
OnCalendar=*:0/30  # Every 30 minutes

# cron:
*/30 * * * *  # Less readable
```

**cron still OK for:**
- Legacy systems
- Simple user-level tasks
- Quick ad-hoc automation

**Production best practice: systemd timers**

**Kristjan:** *"cron ‚Äî —ç—Ç–æ legacy. systemd timers ‚Äî —ç—Ç–æ modern, integrated, production-ready."*

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ disk space alert –ø—Ä–∏—à—ë–ª?

<details>
<summary>üí° Troubleshooting Workflow</summary>

**Step 1: Identify —á—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ**

```bash
# 1. –û–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞
df -h

# 2. –¢–æ–ø 10 –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –ø–æ —Ä–∞–∑–º–µ—Ä—É
sudo du -sh /* 2>/dev/null | sort -h | tail -10

# 3. Find large files (>1GB)
sudo find / -type f -size +1G -exec ls -lh {} \; 2>/dev/null

# 4. –¢–æ–ø 20 largest files
sudo find / -type f -exec du -h {} + 2>/dev/null | sort -h | tail -20
```

---

**Step 2: Clean up**

```bash
# Old logs
sudo journalctl --vacuum-size=500M  # Keep only 500MB of logs
sudo journalctl --vacuum-time=7d    # Keep only 7 days

# Package cache
sudo apt clean
sudo apt autoclean

# Old kernels (Ubuntu)
sudo apt autoremove --purge

# Temp files
sudo find /tmp -type f -atime +7 -delete  # Files not accessed for 7 days
```

---

**Step 3: Extend LV (–µ—Å–ª–∏ cleanup –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)**

```bash
# Check VG free space
sudo vgs

# If –µ—Å—Ç—å free space –≤ VG:
sudo lvextend -L +50G /dev/vg_data/lv_databases
sudo resize2fs /dev/vg_data/lv_databases  # ext4
# or
sudo xfs_growfs /mnt/databases  # xfs

# If –Ω–µ—Ç free space ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π disk –≤ VG
sudo pvcreate /dev/sde1
sudo vgextend vg_data /dev/sde1
sudo lvextend -L +100G /dev/vg_data/lv_databases
sudo resize2fs /dev/vg_data/lv_databases
```

---

**Step 4: Prevent –≤ –±—É–¥—É—â–µ–º**

```bash
# Log rotation
sudo nano /etc/logrotate.d/myapp

# /var/log/myapp/*.log {
#     daily
#     rotate 7
#     compress
#     delaycompress
#     missingok
#     notifempty
# }

# Automatic cleanup script
# (–¥–æ–±–∞–≤–∏—Ç—å –≤ cron –∏–ª–∏ systemd timer)
```

**Liisa:** *"Disk space alerts ‚Äî —ç—Ç–æ opportunity –¥–ª—è cleanup –∏ optimization. –†–µ–∞–≥–∏—Ä—É–π –±—ã—Å—Ç—Ä–æ, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —á—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ, prevent –≤ –±—É–¥—É—â–µ–º."*

</details>

---

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¶–∏–∫–ª 8

- [ ] –ü–æ–Ω–∏–º–∞—é –∑–∞—á–µ–º –Ω—É–∂–µ–Ω disk monitoring (prevent disk full)
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å systemd service –¥–ª—è monitoring
- [ ] –£–º–µ—é —Å–æ–∑–¥–∞—Ç—å systemd timer (scheduler)
- [ ] –ó–Ω–∞—é –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ (`journalctl -u service_name`)
- [ ] –ü–æ–Ω–∏–º–∞—é workflow troubleshooting disk space issues
- [ ] –ó–Ω–∞—é –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ systemd timers vs cron

**LILITH:**
*"Monitoring ‚Äî —ç—Ç–æ not optional –≤ production. Reactive management (–∂–¥–∞—Ç—å –ø–æ–∫–∞ –¥–∏—Å–∫ full) ‚Äî —ç—Ç–æ disaster. Proactive monitoring ‚Äî —ç—Ç–æ professionalism."*

---

## üéØ –ò—Ç–æ–≥–æ–≤–æ–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ

### üìù –ó–∞–¥–∞–Ω–∏–µ: Full LVM Setup + Monitoring

**Scenario:**
–£ —Ç–µ–±—è 2 –Ω–æ–≤—ã—Ö –¥–∏—Å–∫–∞ (`/dev/sdc`, `/dev/sdd`). –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å production-ready storage —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

1. ‚úÖ **LVM Setup:**
   - –°–æ–∑–¥–∞—Ç—å PV –Ω–∞ `/dev/sdc1` –∏ `/dev/sdd1`
   - –°–æ–∑–¥–∞—Ç—å VG `vg_production`
   - –°–æ–∑–¥–∞—Ç—å 3 LV:
     - `lv_databases` (300GB, xfs)
     - `lv_logs` (150GB, ext4)
     - `lv_backups` (50GB, ext4)

2. ‚úÖ **Filesystems & Mount:**
   - –°–æ–∑–¥–∞—Ç—å filesystems (xfs –¥–ª—è databases, ext4 –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö)
   - Mount –≤ `/mnt/databases`, `/mnt/logs`, `/mnt/backups`
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `/etc/fstab` —Å UUID –∏ `noatime`

3. ‚úÖ **Monitoring:**
   - –°–æ–∑–¥–∞—Ç—å `disk-monitor.sh` script
   - –°–æ–∑–¥–∞—Ç—å systemd service + timer (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
   - Threshold: 90%

4. ‚úÖ **Testing:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ reboot (`sudo mount -a`)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ monitoring service —Ä–∞–±–æ—Ç–∞–µ—Ç
   - Simulate high disk usage (—Å–æ–∑–¥–∞—Ç—å large file, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å alert)

---

### üõ†Ô∏è –°—Ç–∞—Ä—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω

–ò—Å–ø–æ–ª—å–∑—É–π **`starter.sh`** –≤ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ ‚Äî —Ç–∞–º –µ—Å—Ç—å TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è.

---

## üéì –ò—Ç–æ–≥–∏ Episode 11

### –ß—Ç–æ –≤—ã –æ—Å–≤–æ–∏–ª–∏:

‚úÖ **Block Devices & Partitions:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–∞–∫ Linux –≤–∏–¥–∏—Ç –¥–∏—Å–∫–∏ (`/dev/sdX`, `/dev/nvmeXnY`)
- Partitioning concepts (MBR vs GPT)
- `lsblk`, `fdisk`, `parted`

‚úÖ **SMART Monitoring:**
- Disk health checks (`smartctl`)
- Critical attributes (Reallocated sectors, Pending sectors)
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ failures

‚úÖ **LVM (Logical Volume Manager):**
- PV ‚Üí VG ‚Üí LV architecture
- `pvcreate`, `vgcreate`, `lvcreate`
- Resize operations (`lvextend` + `resize2fs`)
- Snapshot –¥–ª—è backups

‚úÖ **Filesystems:**
- ext4, xfs, btrfs comparison
- `mkfs.ext4`, `mkfs.xfs`
- Mount/unmount operations

‚úÖ **`/etc/fstab`:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- UUID vs device paths
- Mount options (`noatime`, `defaults`)
- Testing (`mount -a`)

‚úÖ **Data Migration:**
- `rsync` –¥–ª—è safe data copy
- Read-only mounting (`-o ro`)
- Resume capability

‚úÖ **RAID:**
- RAID levels (0, 1, 5, 10) comparison
- Redundancy vs performance trade-offs
- RAID ‚Äî –ù–ï backup!

‚úÖ **Production Monitoring:**
- systemd service + timer –¥–ª—è disk monitoring
- `journalctl` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- Proactive alerts (Slack, email)

---

### –°—é–∂–µ—Ç–Ω—ã–π –∏—Ç–æ–≥:

**23:00. –¢–∞–ª–ª–∏–Ω. Ser–≤–µ—Ä–Ω–∞—è e-Residency.**

**Kristjan** (—Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ monitoring dashboard):
*"Perfect. All green. –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, LVM –Ω–∞—Å—Ç—Ä–æ–µ–Ω, monitoring —Ä–∞–±–æ—Ç–∞–µ—Ç. `/dev/sdb` retired –±–µ–∑ data loss. –≠—Ç–æ production-level work."*

**Liisa:**
*"–ú–∞–∫—Å, —Ç—ã —Å–ø–∞—Å 500GB production –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 —á–∞—Å–∞. –ü–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º. –≠—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∏–π sysadmin work."*

**–ú–∞–∫—Å:**
*"–Ø –¥—É–º–∞–ª disk management —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ 'add more space'. –¢–µ–ø–µ—Ä—å –ø–æ–Ω–∏–º–∞—é ‚Äî —ç—Ç–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, redundancy, monitoring."*

**Kristjan:**
*"Exactly. Disk management ‚Äî —ç—Ç–æ foundation –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ü—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –¥–∏—Å–∫–∞—Ö. –î–∞–Ω–Ω—ã–µ –∂–∏–≤—É—Ç –Ω–∞ –¥–∏—Å–∫–∞—Ö. –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ disk management ‚Äî –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ."*

**Liisa –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ú–∞–∫—Å—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:**

```
e-Estonia Infrastructure Stats:
- 180 Physical Disks
- 95% –Ω–∞ LVM
- 100% –Ω–∞ RAID 10 (critical data)
- SMART monitoring: 24/7
- Uptime: 99.97% (last 12 months)
- Zero data loss incidents (last 5 years)
```

**Kristjan:**
*"–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ disk management. –¢—ã –æ—Å–≤–æ–∏–ª –æ—Å–Ω–æ–≤—ã. –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å production storage."*

**–í–∏–∫—Ç–æ—Ä** (–∑–≤–æ–Ω–∏—Ç –ú–∞–∫—Å—É):
*"Kristjan —Å–∫–∞–∑–∞–ª ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞. Episode 11 –∑–∞–≤–µ—Ä—à—ë–Ω. –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ ‚Äî Backup & Recovery. Episode 12. –ì–æ—Ç–æ–≤?"*

**–ú–∞–∫—Å —É–ª—ã–±–∞–µ—Ç—Å—è:**
*"–ì–æ—Ç–æ–≤. Disk management ‚Äî —ç—Ç–æ –±—ã–ª–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ, –Ω–æ —è –ø–æ–Ω—è–ª. Storage ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ. –≠—Ç–æ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å, flexibility, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥."*

---

### üîó –ß—Ç–æ –¥–∞–ª—å—à–µ?

**Episode 12: Backup & Recovery**
- Backup strategies (full, incremental, differential)
- `rsync`, `tar`, `dd` –¥–ª—è backups
- systemd timers –¥–ª—è automated backups
- Disaster recovery procedures

**LILITH:**
*"–î–∏—Å–∫–∏ —Ç—ã –æ—Å–≤–æ–∏–ª. LVM –Ω–∞—Å—Ç—Ä–æ–∏–ª. Monitoring —Ä–∞–±–æ—Ç–∞–µ—Ç. –ù–æ –≤—Å—ë —ç—Ç–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ –±–µ–∑ backup. Episode 12 ‚Äî –Ω–∞—É—á–∏—à—å—Å—è –∑–∞—â–∏—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç –ª—é–±–æ–π –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã."*

---

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### Man pages:
```bash
man lvm
man pvcreate
man vgcreate
man lvcreate
man lvextend
man mkfs.ext4
man mkfs.xfs
man fstab
man mount
man rsync
man smartctl
man mdadm
man systemd.service
man systemd.timer
```

### Online:
- [LVM HOWTO](https://tldp.org/HOWTO/LVM-HOWTO/)
- [Red Hat LVM Guide](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_logical_volumes/)
- [Arch Wiki: LVM](https://wiki.archlinux.org/title/LVM)
- [Arch Wiki: RAID](https://wiki.archlinux.org/title/RAID)
- [systemd Timers vs Cron](https://wiki.archlinux.org/title/Systemd/Timers)
- [SMART Monitoring with smartmontools](https://www.smartmontools.org/)

---

**Episode 11 –∑–∞–≤–µ—Ä—à—ë–Ω! üéâ**

**LILITH:**
*"–û—Ç block devices –¥–æ production monitoring –∑–∞ 5 —á–∞—Å–æ–≤. –ù–µ–ø–ª–æ—Ö–æ. Disk management ‚Äî —ç—Ç–æ foundation Linux SysAdmin. –¢—ã –æ—Å–≤–æ–∏–ª –µ–≥–æ. –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å storage –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∞. Episode 12 –∂–¥—ë—Ç. Backup & Recovery. –ü–æ—Ç–æ–º—É —á—Ç–æ even best disk management –Ω–µ —Å–ø–∞—Å—ë—Ç –æ—Ç –≤—Å–µ—Ö –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ. –ì–æ—Ç–æ–≤?"*
