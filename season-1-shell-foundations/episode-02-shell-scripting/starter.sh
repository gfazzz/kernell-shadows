#!/bin/bash

################################################################################
# OPERATION KERNEL SHADOWS - Episode 02
# Server Monitoring Script - STARTER TEMPLATE
# Author: Max Sokolov
# Date: 03 October 2025
################################################################################

# TODO: Добавь строгий режим
# set -euo pipefail

# TODO: Определи цвета для вывода
# GREEN='\033[0;32m'
# RED='\033[0;31m'
# ...

# Файлы
SERVERS_FILE="servers.txt"
LOG_FILE="monitor.log"
ALERT_FILE="alerts.txt"

# TODO: Инициализируй счётчики
# total_servers=0
# online_servers=0
# offline_servers=0

################################################################################
# TODO: Функция: проверка доступности сервера
################################################################################
check_server_status() {
    local server_ip="$1"

    # YOUR CODE HERE
    # Используй ping для проверки доступности
    # Верни 0 если online, 1 если offline

    return 0
}

################################################################################
# TODO: Функция: логирование в файл с timestamp
################################################################################
log_to_file() {
    local message="$1"

    # YOUR CODE HERE
    # Добавь timestamp и запиши в LOG_FILE
}

################################################################################
# TODO: Функция: добавление алерта
################################################################################
add_alert() {
    local message="$1"

    # YOUR CODE HERE
    # Добавь timestamp и запиши в ALERT_FILE
}

################################################################################
# TODO: Функция: вывод статуса в терминал с цветом
################################################################################
print_status() {
    local server_name="$1"
    local server_ip="$2"
    local status="$3"

    # YOUR CODE HERE
    # Используй цвета для красивого вывода
}

################################################################################
# TODO: Функция: проверка всех серверов
################################################################################
check_all_servers() {
    echo "=== Проверка серверов ==="
    echo ""

    # YOUR CODE HERE
    # 1. Проверь существование SERVERS_FILE
    # 2. Читай файл построчно через while read
    # 3. Для каждого сервера:
    #    - Вызови check_server_status
    #    - Вызови print_status
    #    - Залогируй результат
    #    - Обнови счётчики
}

################################################################################
# TODO: Функция: вывод статистики
################################################################################
print_statistics() {
    echo ""
    echo "=== Статистика ==="

    # YOUR CODE HERE
    # Выведи: total, online, offline
    # Добавь предупреждение если есть проблемы
}

################################################################################
# Главная функция
################################################################################
main() {
    echo ""
    echo "╔════════════════════════════════════════════════════════════╗"
    echo "║        KERNEL SHADOWS - Server Monitoring Script          ║"
    echo "╚════════════════════════════════════════════════════════════╝"
    echo ""

    # TODO: Вызови check_all_servers

    # TODO: Вызови print_statistics

    # TODO: Верни правильный exit code
    # 0 если все серверы online
    # 1 если есть проблемы

    exit 0
}

################################################################################
# Запуск
################################################################################
main "$@"

