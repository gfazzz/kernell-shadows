# Episode 03 ‚Äî –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã: Text Processing

```
–õ–û–ö–ê–¶–ò–Ø: üá∑üá∫ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, –ù–ì–£
–ü–û–°–¢–ê–í–©–ò–ö: Anna Kovaleva (Lead Forensics Expert)
–ó–ê–î–ê–ß–ê: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –∞—Ç–∞–∫–∏ DDoS (04 –æ–∫—Ç—è–±—Ä—è 2025, 03:47 UTC)
```

---

## üì¶ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

–≠—Ç–æ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç **—Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** –¥–ª—è Episode 03:

```
artifacts/
‚îú‚îÄ‚îÄ README.md              ‚Üê –¢—ã –∑–¥–µ—Å—å (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
‚îú‚îÄ‚îÄ access.log             ‚Üê –õ–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (4400 —Å—Ç—Ä–æ–∫, –∞—Ç–∞–∫–∞ 03:47-04:00)
‚îú‚îÄ‚îÄ suspicious_ips.txt     ‚Üê –ë–∞–∑–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —É–≥—Ä–æ–∑ –æ—Ç Anna (threat intelligence)
‚îî‚îÄ‚îÄ report_template.txt    ‚Üê –®–∞–±–ª–æ–Ω –æ—Ç—á—ë—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π reference)
```

---

## üìÑ –§–∞–π–ª 1: `access.log`

### –û–ø–∏—Å–∞–Ω–∏–µ

**Apache Combined Log** —Ñ–æ—Ä–º–∞—Ç ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ª–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞.

**–ü–µ—Ä–∏–æ–¥:** 04 –æ–∫—Ç—è–±—Ä—è 2025, 02:00 ‚Äî 06:00 (UTC)
**–ê—Ç–∞–∫–∞:** 03:47:00 ‚Äî 04:00:00 (–ø–∏–∫: 03:47:25, 4,582 req/sec)
**–†–∞–∑–º–µ—Ä:** 4,400 —Å—Ç—Ä–æ–∫ (~400 KB)

### –§–æ—Ä–º–∞—Ç

```
IP - - [timestamp] "METHOD /path HTTP/1.1" status size "referer" "user-agent"
‚îÇ   ‚îÇ ‚îÇ  ‚îÇ          ‚îÇ                       ‚îÇ      ‚îÇ     ‚îÇ         ‚îÇ
‚îÇ   ‚îÇ ‚îÇ  ‚îÇ          ‚îÇ                       ‚îÇ      ‚îÇ     ‚îÇ         ‚îî‚îÄ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫–ª–∏–µ–Ω—Ç–∞
‚îÇ   ‚îÇ ‚îÇ  ‚îÇ          ‚îÇ                       ‚îÇ      ‚îÇ     ‚îî‚îÄ –û—Ç–∫—É–¥–∞ –ø—Ä–∏—à—ë–ª
‚îÇ   ‚îÇ ‚îÇ  ‚îÇ          ‚îÇ                       ‚îÇ      ‚îî‚îÄ –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (bytes)
‚îÇ   ‚îÇ ‚îÇ  ‚îÇ          ‚îÇ                       ‚îî‚îÄ HTTP status code
‚îÇ   ‚îÇ ‚îÇ  ‚îÇ          ‚îî‚îÄ –ó–∞–ø—Ä–æ—Å (–º–µ—Ç–æ–¥ + –ø—É—Ç—å)
‚îÇ   ‚îÇ ‚îÇ  ‚îî‚îÄ –î–∞—Ç–∞/–≤—Ä–µ–º—è
‚îÇ   ‚îÇ ‚îî‚îÄ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (- = –Ω–µ—Ç)
‚îÇ   ‚îî‚îÄ Remote logname (- = –Ω–µ—Ç)
‚îî‚îÄ IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
```

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏:**

```
185.220.101.47 - - [04/Oct/2025:03:47:23 +0000] "GET /admin HTTP/1.1" 404 0 "-" "nmap NSE"
```

**–†–∞–∑–±–æ—Ä:**
- **IP:** 185.220.101.47
- **Timestamp:** 04/Oct/2025:03:47:23 +0000
- **Method:** GET
- **Path:** /admin
- **Status:** 404 (Not Found)
- **User-Agent:** nmap NSE (—Å–∫–∞–Ω–µ—Ä –ø–æ—Ä—Ç–æ–≤! üö®)

### –ü–æ–ª—è (–¥–ª—è awk)

```
$1 = IP –∞–¥—Ä–µ—Å                   185.220.101.47
$2 = -                          -
$3 = -                          -
$4 = [timestamp]                [04/Oct/2025:03:47:23
$5 = timezone]                  +0000]
$6 = "METHOD                    "GET
$7 = /path                      /admin
$8 = HTTP/1.1"                  HTTP/1.1"
$9 = status                     404
$10 = size                      0
$11 = "referer"                 "-"
$12 = "user-agent"              "nmap

# –î–ª—è User-Agent –∏—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∫–∞–≤—ã—á–∫–∏:
# awk -F'"' '{print $6}' access.log
```

### –ö–ª—é—á–µ–≤—ã–µ timestamps –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

| –ü–µ—Ä–∏–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|--------|----------|------------|
| `02:00-03:46` | –ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ | ~1,200 |
| `03:47` | **–ü–∏–∫ –∞—Ç–∞–∫–∏** ‚ö†Ô∏è | ~1,200 |
| `03:48-04:00` | –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∞—Ç–∞–∫–∏ | ~1,000 |
| `04:01-06:00` | –ó–∞—Ç—É—Ö–∞–Ω–∏–µ | ~1,000 |

**–î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∞—Ç–∞–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π:**

```bash
grep "03:47" access.log   # –¢–æ–ª—å–∫–æ –ø–∏–∫
grep -E "03:4[789]" access.log   # 03:47-03:49
grep -E "0[34]:[0-9]{2}" access.log   # –í—Å—ë –æ–∫–Ω–æ 03:00-04:59
```

### HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã

| Code | –ó–Ω–∞—á–µ–Ω–∏–µ | –¢–∏–ø–∏—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|------|----------|---------------------|
| 200 | OK | ~3,200 |
| 404 | Not Found | ~800 |
| 403 | Forbidden | ~250 |
| 500 | Server Error | ~100 |
| 503 | Service Unavailable | ~50 |

### TOP User-Agents –∞—Ç–∞–∫—É—é—â–∏—Ö

```
nmap NSE          ‚Äî Port scanner (reconnaissance)
sqlmap/1.5.2      ‚Äî SQL injection tool
curl/7.58.0       ‚Äî HTTP client (automation)
Nikto/2.1.6       ‚Äî Web vulnerability scanner
ZmEu              ‚Äî Known PHP exploit scanner
```

---

## üìÑ –§–∞–π–ª 2: `suspicious_ips.txt`

### –û–ø–∏—Å–∞–Ω–∏–µ

**Threat Intelligence Database** ‚Äî –±–∞–∑–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–æ–≤.

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ Anna Kovaleva –∏–∑ –±–∞–∑—ã FSB Cyber Crime Unit.

**–§–æ—Ä–º–∞—Ç:** –û–¥–∏–Ω IP per line, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `#`

**–ü—Ä–∏–º–µ—Ä:**

```
# Threat Intelligence Database
# Updated: 04 Oct 2025
# Source: FSB Cyber Crime Unit + Open Threat Exchange

185.220.101.47    # Tor exit node, multiple attacks
45.155.205.67     # Known botnet C&C server
91.234.56.78      # SQL injection attempts (last 30 days)

# Comment lines start with #
# Empty lines are ignored
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏—à–ª–æ –æ—Ç –∫–∞–∂–¥–æ–≥–æ IP –∏–∑ –±–∞–∑—ã.

**–ü–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ loop:**

```bash
while read -r ip; do
    # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
    [[ "$ip" =~ ^#.*$ || -z "$ip" ]] && continue

    # –ü–æ—Å—á–∏—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç —ç—Ç–æ–≥–æ IP
    count=$(grep -c "$ip" access.log)

    # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã - –≤—ã–≤–µ—Å—Ç–∏
    [[ $count -gt 0 ]] && echo "FOUND: $ip ($count requests)"
done < suspicious_ips.txt
```

**–ü–æ—á–µ–º—É loop, –∞ –Ω–µ ONE-LINER?**

–ü–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å **—Å–ø–∏—Å–æ–∫ IP** (—Ñ–∞–π–ª) –ø—Ä–æ—Ç–∏–≤ **–ª–æ–≥–æ–≤**.
`grep -f` –º–æ–≥–ª–∞ –±—ã —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ loop –¥–∞—ë—Ç –±–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è (–ø–æ–¥—Å—á—ë—Ç, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ).

**–≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ –≤ —Å–∫—Ä–∏–ø—Ç–µ –≥–¥–µ –Ω—É–∂–µ–Ω loop!** –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ = ONE-LINERS.

---

## üìÑ –§–∞–π–ª 3: `report_template.txt` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–®–∞–±–ª–æ–Ω —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç—á—ë—Ç–∞** –¥–ª—è reference.

–¢—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ –ø—Ä–∏–º–µ—Ä, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ.

**Type B –ø–æ–¥—Ö–æ–¥:** –¢–≤–æ–π —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç –∏—Å–ø–æ–ª—å–∑—É—è ONE-LINERS, –Ω–µ —Å–ª–æ–∂–Ω—ã–π bash.

---

## üéØ –ó–∞–¥–∞—á–∞ Episode 03

### –ü–æ—Å—Ç—Ä–æ–∏—Ç—å `log_analyzer.sh`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

1. ‚úÖ –ß–∏—Ç–∞–µ—Ç `access.log`
2. ‚úÖ –í—ã–≤–æ–¥–∏—Ç TOP-10 –∞—Ç–∞–∫—É—é—â–∏—Ö IP (–≤–æ –≤—Ä–µ–º—è –∞—Ç–∞–∫–∏ 03:47)
3. ‚úÖ –í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É HTTP status codes
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç IP –∏–∑ `suspicious_ips.txt` (threat database)
5. ‚úÖ –í—ã–≤–æ–¥–∏—Ç TOP-5 User-Agents
6. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `final_report.txt`

**Type B approach:**

- 70% Linux tools (grep, awk, sort, uniq)
- 30% bash wrapper (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ–¥–∏–Ω loop, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –§–æ–∫—É—Å –Ω–∞ **ONE-LINERS**, –Ω–µ –Ω–∞ bash –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏

---

## üíª –ö–ª—é—á–µ–≤—ã–µ ONE-LINERS

### 1. –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```bash
# –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤:
wc -l < access.log

# –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP:
awk '{print $1}' access.log | sort -u | wc -l

# –ó–∞–ø—Ä–æ—Å–æ–≤ –≤–æ –≤—Ä–µ–º—è –∞—Ç–∞–∫–∏:
grep -c "03:47" access.log
```

### 2. TOP-10 –∞—Ç–∞–∫—É—é—â–∏—Ö IP

```bash
# –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π pattern –¥–ª—è TOP-N:
grep "03:47" access.log | awk '{print $1}' | sort | uniq -c | sort -nr | head -10

# –í—ã–≤–æ–¥:
#     523 185.220.101.47
#     234 45.155.205.67
#     156 91.234.56.78
#     ...
```

### 3. HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã

```bash
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–¥–∞–º:
awk '{print $9}' access.log | sort | uniq -c | sort -nr

# –í—ã–≤–æ–¥:
#   3200 200
#    800 404
#    250 403
#    ...
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ threat database

```bash
# Loop (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ –≥–¥–µ –Ω—É–∂–µ–Ω bash):
while read -r ip; do
    [[ "$ip" =~ ^#.*$ || -z "$ip" ]] && continue
    count=$(grep -c "$ip" access.log)
    [[ $count -gt 0 ]] && echo "FOUND: $ip ($count requests)"
done < suspicious_ips.txt
```

### 5. TOP-5 User-Agents

```bash
# –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å = –∫–∞–≤—ã—á–∫–∞, –ø–æ–ª–µ #6:
grep "03:47" access.log | awk -F'"' '{print $6}' | sort | uniq -c | sort -nr | head -5

# –í—ã–≤–æ–¥:
#    523 nmap NSE
#    234 sqlmap/1.5.2
#    156 curl/7.58.0
#    ...
```

### 6. TOP-10 –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –ø—É—Ç–µ–π

```bash
# –ü–æ–ª–µ #7 = path (URL):
awk '{print $7}' access.log | sort | uniq -c | sort -nr | head -10

# –í—ã–≤–æ–¥:
#    523 /admin
#    234 /wp-admin
#    156 /login
#    ...
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ—Å—Ç—Ä–æ–π —Å–≤–æ–π —Å–∫—Ä–∏–ø—Ç

```bash
cd ~/kernel-shadows/season-1-shell-foundations/episode-03-text-processing

# –û—Ç–∫—Ä–æ–π starter.sh –∏ –∑–∞–ø–æ–ª–Ω–∏ TODO —Å–µ–∫—Ü–∏–∏:
nano starter.sh

# –ó–∞–ø—É—Å—Ç–∏:
chmod +x starter.sh
./starter.sh artifacts/access.log

# –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
cat final_report.txt
cat top_attackers.txt

# –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã:
./tests/test.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–ò—Å–ø–æ–ª—å–∑—É–π ONE-LINERS –Ω–∞–ø—Ä—è–º—É—é –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```bash
cd artifacts/

# TOP-10 –∞—Ç–∞–∫—É—é—â–∏—Ö:
grep "03:47" access.log | awk '{print $1}' | sort | uniq -c | sort -nr | head -10

# HTTP —Å—Ç–∞—Ç—É—Å—ã:
awk '{print $9}' access.log | sort | uniq -c | sort -nr

# –ü—Ä–æ–≤–µ—Ä–∫–∞ threats:
while read ip; do [[ "$ip" =~ ^#.*$ ]] || grep -c "$ip" access.log; done < suspicious_ips.txt

# User-Agents:
grep "03:47" access.log | awk -F'"' '{print $6}' | sort | uniq -c | sort -nr | head -5
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤:
cd ~/kernel-shadows/season-1-shell-foundations/episode-03-text-processing
./tests/test.sh

# –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
#   ‚úÖ –°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ final_report.txt
#   ‚úÖ –°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ top_attackers.txt
#   ‚úÖ –§–æ—Ä–º–∞—Ç TOP-10 (count + IP)
#   ‚úÖ –ù–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö IP (185.220.101.47, etc.)
#   ‚úÖ –ù–∞–ª–∏—á–∏–µ —Å–µ–∫—Ü–∏–π –≤ –æ—Ç—á—ë—Ç–µ
```

---

## üìö –°–ø—Ä–∞–≤–∫–∞: –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|------------|--------|
| `grep "pattern" file` | –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–∏ | `grep "03:47" access.log` |
| `grep -c "pattern" file` | –ü–æ—Å—á–∏—Ç–∞—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è | `grep -c "404" access.log` |
| `awk '{print $N}' file` | –ò–∑–≤–ª–µ—á—å N-–µ –ø–æ–ª–µ | `awk '{print $1}' access.log` |
| `awk -F'X' '{print $N}'` | –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å | `awk -F'"' '{print $6}'` |
| `sort` | –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å | `sort file.txt` |
| `sort -n` | –ß–∏—Å–ª–æ–≤–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ | `sort -n numbers.txt` |
| `sort -r` | –û–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ | `sort -r file.txt` |
| `sort -u` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ | `sort -u file.txt` |
| `uniq` | –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã | `sort file \| uniq` |
| `uniq -c` | –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è | `sort file \| uniq -c` |
| `head -N` | –ü–µ—Ä–≤—ã–µ N —Å—Ç—Ä–æ–∫ | `head -10 file.txt` |
| `tail -N` | –ü–æ—Å–ª–µ–¥–Ω–∏–µ N —Å—Ç—Ä–æ–∫ | `tail -10 file.txt` |
| `wc -l` | –ü–æ—Å—á–∏—Ç–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ | `wc -l file.txt` |

---

## üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –º–æ–∂–µ—à—å –∏–∑–≤–ª–µ—á—å User-Agent

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π `-F'"'` (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å = –∫–∞–≤—ã—á–∫–∞)

```bash
# –õ–æ–≥-—Å—Ç—Ä–æ–∫–∞:
# IP - - [timestamp] "GET /path HTTP/1.1" 404 0 "-" "nmap NSE"
#                     ^1^                        ^2^ ^3^

# –ü—Ä–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ = –∫–∞–≤—ã—á–∫–∞:
# $1 = –≤—Å—ë –¥–æ –ø–µ—Ä–≤–æ–π –∫–∞–≤—ã—á–∫–∏
# $2 = GET /path HTTP/1.1  (–º–µ–∂–¥—É 1-–π –∏ 2-–π –∫–∞–≤—ã—á–∫–∞–º–∏)
# $4 = -  (–º–µ–∂–¥—É 3-–π –∏ 4-–π)
# $6 = nmap NSE  (–º–µ–∂–¥—É 5-–π –∏ 6-–π) ‚Üê User-Agent!

awk -F'"' '{print $6}' access.log
```

### –ü—Ä–æ–±–ª–µ–º–∞: `sort | uniq -c` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã

**–ü—Ä–∏—á–∏–Ω–∞:** `uniq` —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É!

```bash
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
awk '{print $1}' file | uniq -c

# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
awk '{print $1}' file | sort | uniq -c
```

### –ü—Ä–æ–±–ª–µ–º–∞: `sort` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç —á–∏—Å–ª–∞

**–ü—Ä–∏—á–∏–Ω–∞:** –õ–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (9 > 100)

```bash
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
uniq -c file | sort -r

# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
uniq -c file | sort -nr   # -n = numeric
```

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç

**–ü—Ä–æ–≤–µ—Ä—å:**

1. –§–∞–π–ª `final_report.txt` —Å–æ–∑–¥–∞–Ω?
2. –§–∞–π–ª `top_attackers.txt` —Å–æ–∑–¥–∞–Ω?
3. –§–æ—Ä–º–∞—Ç TOP-10: `–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ IP` (—á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª)
4. –ó–∞–ø—É—Å–∫–∞–ª –∏–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏?

```bash
# –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:
cd ~/kernel-shadows/season-1-shell-foundations/episode-03-text-processing
./starter.sh artifacts/access.log
```

---

## üéì –§–∏–ª–æ—Å–æ—Ñ–∏—è Type B

> **LILITH:**
> *"–≠—Ç–∏ –ª–æ–≥–∏ ‚Äî 4,400 —Å—Ç—Ä–æ–∫. –í—Ä—É—á–Ω—É—é = 12 —á–∞—Å–æ–≤.*
>
> *–° –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ = 2 —Å–µ–∫—É–Ω–¥—ã.*
>
> *grep, awk, pipes ‚Äî –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–º–∞–Ω–¥—ã. –≠—Ç–æ –æ—Ä—É–∂–∏–µ Linux –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.*
>
> *Bash ‚Äî –∫–ª–µ–π –º–µ–∂–¥—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏, –Ω–µ –∑–∞–º–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.*
>
> *–ü–æ—Å—Ç—Ä–æ–π ONE-LINERS. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º wrapper. –≠—Ç–æ Type B."*

---

**–£–¥–∞—á–∏!** ‚Äî Anna Kovaleva & Dmitry Orlov

---
