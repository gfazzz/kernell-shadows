# AIDE Configuration — Episode 17
# Advanced Intrusion Detection Environment
# Мониторинг целостности критических файлов системы
# Скопируйте в /etc/aide/aide.conf

# Database paths
database=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new

# Report settings
report_url=stdout
report_url=file:/var/log/aide/aide.log

# Verbose level (0-255)
verbose=5

# ========================================
# ПРАВИЛА МОНИТОРИНГА
# ========================================

# Полный мониторинг (permissions, ownership, content, timestamps)
Full = p+i+n+u+g+s+b+m+c+md5+sha256

# Только изменения содержимого (не timestamps)
Content = sha256+md5

# Только metadata (permissions, ownership)
Metadata = p+u+g

# ========================================
# ДИРЕКТОРИИ ДЛЯ МОНИТОРИНГА
# ========================================

# System binaries (критичные команды)
/bin Full
/sbin Full
/usr/bin Full
/usr/sbin Full

# System libraries
/lib Full
/lib64 Full
/usr/lib Full

# Configuration files
/etc Full

# Boot files (критично!)
/boot Full

# SSH keys и конфигурация
/root/.ssh Full
/home/*/.ssh Full

# ========================================
# ИСКЛЮЧЕНИЯ (что НЕ мониторить)
# ========================================

# Temporary files
!/tmp
!/var/tmp

# Logs (меняются постоянно)
!/var/log

# Cache
!/var/cache

# Run files
!/var/run
!/run

# Proc и sys (динамические)
!/proc
!/sys
!/dev

# ========================================
# ЗАДАНИЕ: Настройте мониторинг
# ========================================
# 1. Добавьте мониторинг /opt (если там есть приложения)
# 2. Добавьте мониторинг /var/www (если есть веб-сервер)
# 3. Настройте правильные исключения для вашей системы

# Примеры дополнительных правил:
# /opt Full
# /var/www Content

# LILITH: "AIDE — это tripwire нового поколения. Любое изменение в /etc или /bin —
#          и ты узнаешь. Rootkit не спрячется. Backdoor не останется незамеченным."



