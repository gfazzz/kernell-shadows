# Fail2ban Configuration — Episode 17
# Защита SSH от brute-force атак
# Скопируйте в /etc/fail2ban/jail.local

[DEFAULT]
# Ban hosts for 1 hour (3600 seconds)
bantime = 3600

# A host is banned if it has generated "maxretry" during "findtime" seconds
findtime = 600

# "maxretry" is the number of failures before a host get banned
maxretry = 5

# Destination email for alerts (замените на свой email)
destemail = admin@yourdomain.com

# Sender email
sender = fail2ban@yourdomain.com

# Action: ban and send email
action = %(action_mwl)s

# ========================================
# SSH PROTECTION
# ========================================
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 7200

# ========================================
# ЗАДАНИЕ: Настройте защиту
# ========================================
# 1. Установите более строгие параметры:
#    - maxretry = 3 (вместо 5)
#    - bantime = 7200 (2 часа вместо 1 часа)
# 2. Добавьте дополнительные jails для других сервисов (apache, nginx)
# 3. Настройте email alerts (если нужно)

# Пример дополнительных jails:

# [apache-auth]
# enabled = false
# port = http,https
# filter = apache-auth
# logpath = /var/log/apache*/*error.log
# maxretry = 3

# [nginx-http-auth]
# enabled = false
# port = http,https
# filter = nginx-http-auth
# logpath = /var/log/nginx/error.log

# LILITH: "3 попытки входа — и бан на 2 часа. Это не жестоко.
#          Это адекватная реакция на brute-force. Krylov не будет церемониться с тобой."



