[Unit]
Description=Daily AIDE File Integrity Check
Documentation=man:aide(1)
Requires=aide-check.service

[Timer]
# Запуск каждый день в 04:00
OnCalendar=daily
# Или более конкретно:
# OnCalendar=*-*-* 04:00:00

# Если пропущен запуск (машина была выключена), запустить сразу после загрузки
Persistent=true

# Случайная задержка до 30 минут (чтобы не нагружать систему точно в 04:00)
RandomizedDelaySec=30min

# Точность (не обязательно запускать точно в 04:00:00)
AccuracySec=1h

[Install]
WantedBy=timers.target

# ========================================
# ИСПОЛЬЗОВАНИЕ
# ========================================
# 1. Скопируйте в /etc/systemd/system/aide-check.timer
# 2. Перезагрузите systemd: sudo systemctl daemon-reload
# 3. Включите автозапуск: sudo systemctl enable aide-check.timer
# 4. Запустите timer: sudo systemctl start aide-check.timer
# 5. Проверьте статус: sudo systemctl status aide-check.timer
# 6. Список всех timers: systemctl list-timers

# ПРОВЕРКА:
# - Когда следующий запуск: systemctl list-timers aide-check.timer
# - История запусков: journalctl -u aide-check.service

# ========================================
# ЗАДАНИЕ: Настройте расписание
# ========================================
# Варианты OnCalendar:
# - daily (каждый день в 00:00)
# - weekly (каждую неделю в понедельник 00:00)
# - *-*-* 04:00:00 (каждый день в 04:00)
# - Mon,Wed,Fri *-*-* 02:00:00 (понедельник, среда, пятница в 02:00)
# - *:0/30 (каждые 30 минут) — для тестирования!

# Для production рекомендуется: ежедневно в нерабочее время (04:00-06:00)

# LILITH: "systemd timer вместо cron — это современный подход.
#          Persistent=true значит проверка не пропустится, даже если сервер был выключен.
#          RandomizedDelaySec — чтобы не грузить все 50 серверов одновременно в 04:00."



