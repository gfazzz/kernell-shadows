# Fail2ban Production Configuration â€” Episode 17 Solution
# Optimized for security operations

[DEFAULT]
# Ban duration
bantime  = 7200      # 2 hours
findtime = 600       # 10 minutes window
maxretry = 3         # Max 3 attempts

# Email configuration (set your email)
destemail = security@yourdomain.com
sendername = Fail2Ban-Alert
sender = fail2ban@yourdomain.com

# Action with email notifications
action = %(action_mwl)s

# Ignore localhost and trusted IPs
ignoreip = 127.0.0.1/8 ::1

[sshd]
enabled  = true
port     = ssh
filter   = sshd
logpath  = /var/log/auth.log
maxretry = 3
bantime  = 7200

[sshd-ddos]
enabled  = true
port     = ssh
filter   = sshd-ddos
logpath  = /var/log/auth.log
maxretry = 2
bantime  = 14400  # 4 hours for DoS

[recidive]
# Ban IPs that get banned multiple times
enabled  = true
filter   = recidive
logpath  = /var/log/fail2ban.log
bantime  = 604800  # 1 week
findtime = 86400   # Check last 24 hours
maxretry = 3

[nginx-http-auth]
enabled  = false
port     = http,https
filter   = nginx-http-auth
logpath  = /var/log/nginx/error.log
maxretry = 3

[nginx-noscript]
enabled  = false
port     = http,https
filter   = nginx-noscript
logpath  = /var/log/nginx/access.log
maxretry = 6

[nginx-badbots]
enabled  = false
port     = http,https
filter   = nginx-badbots
logpath  = /var/log/nginx/access.log
maxretry = 2

[nginx-noproxy]
enabled  = false
port     = http,https
filter   = nginx-noproxy
logpath  = /var/log/nginx/access.log
maxretry = 2
