# Episode 17: –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

> *"Banking security ‚Äî —ç—Ç–æ –ø–∞—Ä–∞–Ω–æ–π—è –∫–∞–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è."* ‚Äî Eva Zimmerman

```
Season 5: Security & Pentesting
Episode 17 of 32
Location: Zurich üá®üá≠, Switzerland
Days: 33-35 of Operation KERNEL SHADOWS
Duration: 12-15 hours
Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
Type: Configuration (Type B) ‚Äî 95% Linux tools, 5% bash
```

---

## üìã –û–±–∑–æ—Ä

### –ß—Ç–æ –≤—ã –∏–∑—É—á–∏—Ç–µ

–í —ç—Ç–æ–º —ç–ø–∏–∑–æ–¥–µ –≤—ã –Ω–∞—É—á–∏—Ç–µ—Å—å –ø—Ä–æ–≤–æ–¥–∏—Ç—å **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π security audit** Linux —Å–∏—Å—Ç–µ–º, –∏—Å–ø–æ–ª—å–∑—É—è industry-standard –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- üîç **lynis** ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞—É–¥–∏—Ç
- üåê **nmap** ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏ –∏ –ø–æ–∏—Å–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
- üõ°Ô∏è **AIDE** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤ (tripwire alternative)
- üö´ **fail2ban** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç brute-force –∞—Ç–∞–∫
- üï∑Ô∏è **nikto** ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ù–∞–≤—ã–∫–∏:**
- –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ê–Ω–∞–ª–∏–∑ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö security –æ—Ç—á—ë—Ç–æ–≤
- –†–∞–±–æ—Ç–∞ —Å systemd –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

**–í–∞–∂–Ω–æ:** –≠—Ç–æ **–ù–ï bash scripting —ç–ø–∏–∑–æ–¥!** –í—ã –±—É–¥–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –≤—Ä—É—á–Ω—É—é, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –ø–æ–Ω–∏–º–∞—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. Bash —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö one-liners.

---

## üé¨ –°—é–∂–µ—Ç: –ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é

### –î–µ–Ω—å 33, —É—Ç—Ä–æ ‚Äî –¶—é—Ä–∏—Ö, –®–≤–µ–π—Ü–∞—Ä–∏—è

–ú–∞–∫—Å –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ Zurich Airport. –•–æ–ª–æ–¥–Ω—ã–π –∞–ª—å–ø–∏–π—Å–∫–∏–π –≤–µ—Ç–µ—Ä, –∏–¥–µ–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫, —á–∞—Å–æ–≤–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å. –í–∏–∫—Ç–æ—Ä –∂–¥—ë—Ç —É —á—ë—Ä–Ω–æ–≥–æ Mercedes.

**–í–∏–∫—Ç–æ—Ä** (–Ω–∞–ø—Ä—è–∂—ë–Ω–Ω–æ): *"–ü—Ä–æ–±–ª–µ–º–∞. –°–µ—Ä—å—ë–∑–Ω–∞—è."*

–í –º–∞—à–∏–Ω–µ –í–∏–∫—Ç–æ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ—É—Ç–±—É–∫:

```
auth.log extract:
Mar 15 03:47:23 server-stockholm sshd[8821]: Failed password for root from 185.220.101.47
Mar 15 03:47:28 server-stockholm sshd[8821]: Failed password for root from 185.220.101.47
Mar 15 03:47:33 server-stockholm sshd[8821]: Accepted password for user_backup from 185.220.101.47
```

**–ú–∞–∫—Å**: *"185.220.101.47... –≠—Ç–æ Tor exit node. –¢—Ä–µ—Ç—å—è –ø–æ–ø—ã—Ç–∫–∞ —É—Å–ø–µ—à–Ω–∞?"*

**–í–∏–∫—Ç–æ—Ä**: *"user_backup ‚Äî —ç—Ç–æ —Å–ª—É–∂–µ–±–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç. –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π. –ù–æ —Å–∞–º —Ñ–∞–∫—Ç..."*

–ó–≤–æ–Ω–æ–∫ –æ—Ç –ê–Ω–Ω—ã (–≥—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å):

**–ê–Ω–Ω–∞ –ö–æ–≤–∞–ª–µ–≤–∞**: *"–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –°—Ç–æ–∫–≥–æ–ª—å–º–µ —Å—Ç—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. PID 16743. –ò–º—è /usr/sbin/sshd, –Ω–æ –æ–Ω —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 9090, –Ω–µ 22. –≠—Ç–æ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ."*

–ü–∞—É–∑–∞. –í–∏–∫—Ç–æ—Ä –∏ –ú–∞–∫—Å —Å–º–æ—Ç—Ä—è—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞.

**–í–∏–∫—Ç–æ—Ä**: *"–õ–∏–±–æ —ç—Ç–æ –ö—Ä—ã–ª–æ–≤, –ª–∏–±–æ... '–ù–æ–≤–∞—è –≠—Ä–∞'. –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ ‚Äî 50 —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ 8 —Å—Ç—Ä–∞–Ω–∞—Ö. –ù—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç. –ó–∞ 48 —á–∞—Å–æ–≤."*

**–ú–∞–∫—Å**: *"48 —á–∞—Å–æ–≤?!"*

**–í–∏–∫—Ç–æ—Ä**: *"–£ –Ω–∞—Å –µ—Å—Ç—å –ª—É—á—à–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ security. Eva Zimmerman. –†–∞–±–æ—Ç–∞–ª–∞ –≤ UBS, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–ª–∞ –∑–∞—â–∏—Ç—É –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º. –ï—Å–ª–∏ –∫—Ç–æ –∏ –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å –¥–µ–ª–∞—Ç—å audit –±—ã—Å—Ç—Ä–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äî —ç—Ç–æ –æ–Ω–∞."*

---

### –í—Å—Ç—Ä–µ—á–∞ —Å Eva Zimmerman ‚Äî UBS Underground Datacenter

Mercedes —Å–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –ø–æ–¥–∑–µ–º–Ω—É—é –ø–∞—Ä–∫–æ–≤–∫—É. –õ–∏—Ñ—Ç –≤–Ω–∏–∑. –¢—Ä–∏ —É—Ä–æ–≤–Ω—è. –ë–µ—Ç–æ–Ω–Ω—ã–µ —Å—Ç–µ–Ω—ã –º–µ—Ç—Ä–æ–≤–æ–π —Ç–æ–ª—â–∏–Ω—ã. –ë–∏–æ–º–µ—Ç—Ä–∏—è. –†–µ—Ç–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫–∞–Ω–µ—Ä.

**Eva Zimmerman** (—Å—Ç—Ä–æ–≥–∞—è –∂–µ–Ω—â–∏–Ω–∞ 40+, –±–µ–∑—É–ø—Ä–µ—á–Ω—ã–π –¥–µ–ª–æ–≤–æ–π –∫–æ—Å—Ç—é–º): *"Welcome to paranoia headquarters. –ó–¥–µ—Å—å –º—ã —Ö—Ä–∞–Ω–∏–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç–æ–∏—Ç –ø–æ–ª–æ–≤–∏–Ω–∞ –º–∏—Ä–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏–∫–∏. –ï—Å–ª–∏ —Ç—ã –¥—É–º–∞–µ—à—å, —á—Ç–æ –≤–∞—à–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –≤–∞–∂–Ω–∞ ‚Äî —É –Ω–∞—Å –æ–±—Ä—É—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫—Ä–∏–∑–∏—Å."*

–û–Ω–∞ –≤–µ–¥—ë—Ç –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é. –°—Ç–µ–Ω—ã —É–≤–µ—à–∞–Ω—ã –º–æ–Ω–∏—Ç–æ—Ä–∞–º–∏. Grafana dashboards, Prometheus metrics, real-time security alerts.

**Eva**: *"–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ –Ω–µ —á–µ–∫-–ª–∏—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –æ—Ç–º–µ—á–∞–µ—à—å. –≠—Ç–æ –º—ã—à–ª–µ–Ω–∏–µ. –¢—ã –¥–æ–ª–∂–µ–Ω –¥—É–º–∞—Ç—å –∫–∞–∫ –∞—Ç–∞–∫—É—é—â–∏–π. –ö–∞–∂–¥—ã–π –æ—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å. –ö–∞–∂–¥—ã–π —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –ø–∞–∫–µ—Ç ‚Äî –≤–∑—Ä—ã–≤–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å —Ç–∞–π–º–µ—Ä–æ–º."*

**LILITH** (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –≤–ø–µ—Ä–≤—ã–µ –∑–∞ —ç–ø–∏–∑–æ–¥): *"–Ø —Ä–æ–¥–∏–ª–∞—Å—å –≤ —Ç–µ–Ω—è—Ö —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. Root access ‚Äî –º–æ—ë –æ—Ä—É–∂–∏–µ. Audit ‚Äî –º–æ–π radar. –ü–æ–∫–∞–∂–∏, –Ω–∞ —á—Ç–æ —Ç—ã —Å–ø–æ—Å–æ–±–µ–Ω, –ú–∞–∫—Å."*

---

### –ó–∞–¥–∞—á–∞

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π security audit –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ KERNEL SHADOWS.

**–û–±—ä—ë–º:**
- 50+ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ 8 —Å—Ç—Ä–∞–Ω–∞—Ö
- 20+ —Å–µ—Ä–≤–∏—Å–æ–≤ (SSH, HTTP, VPN, Docker, Kubernetes)
- –î–µ—Å—è—Ç–∫–∏ —Ç—ã—Å—è—á —Å—Ç—Ä–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –ú–∏–ª–ª–∏–æ–Ω—ã —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤

**–í—Ä–µ–º—è:** 48 —á–∞—Å–æ–≤

**–ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏:**
- –û—Ç–∫—Ä—ã—Ç—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- Misconfigured services
- –°–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏
- Backdoors (–µ—Å–ª–∏ –µ—Å—Ç—å)
- Outdated packages
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ permissions

**–ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- Intrusion detection
- Continuous security audit

**Eva**: *"–í banking security –º—ã –≥–æ–≤–æ—Ä–∏–º: 'Trust nothing. Verify everything. Monitor constantly.' Zero Trust architecture. –¢—ã –¥–æ–ª–∂–µ–Ω –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É. –¢—ã –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∞–º–∞ —Å–µ–±—è. –ü–æ—Å—Ç–æ—è–Ω–Ω–æ."*

---

## üéì –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–ø–∏–∑–æ–¥–∞: 8 –º–∏–∫—Ä–æ-—Ü–∏–∫–ª–æ–≤

–ö–∞–∂–¥—ã–π —Ü–∏–∫–ª = 10-15 –º–∏–Ω—É—Ç:
- üé¨ –°—é–∂–µ—Ç (2-3 –º–∏–Ω) ‚Äî –¥—Ä–∞–º–∞, –∫–æ–Ω—Ç–µ–∫—Å—Ç, –º–æ—Ç–∏–≤–∞—Ü–∏—è
- üìö –¢–µ–æ—Ä–∏—è (5-7 –º–∏–Ω) ‚Äî –æ–¥–∏–Ω –∫–æ–Ω—Ü–µ–ø—Ç —Å –º–µ—Ç–∞—Ñ–æ—Ä–æ–π
- üíª –ü—Ä–∞–∫—Ç–∏–∫–∞ (3-5 –º–∏–Ω) ‚Äî hands-on –∑–∞–¥–∞–Ω–∏–µ
- ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω) ‚Äî –≤–æ–ø—Ä–æ—Å

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~2 —á–∞—Å–∞ —Ç–µ–æ—Ä–∏–∏ + 6-8 —á–∞—Å–æ–≤ –ø—Ä–∞–∫—Ç–∏–∫–∏ + 2-4 —á–∞—Å–∞ –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π audit = 12-15 —á–∞—Å–æ–≤

---

## üîÑ –¶–∏–∫–ª 1: –û—Å–Ω–æ–≤—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Linux (15 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Eva** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç whiteboard –∏ —Ä–∏—Å—É–µ—Ç —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫:

```
       Confidentiality
            /\
           /  \
          /    \
         /  CIA \
        /  Triad \
       /          \
      /____________\
Integrity        Availability
```

**Eva**: *"–≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –≤—Å–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. CIA Triad. –ù–µ –ø—É—Ç–∞—Ç—å —Å –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–º –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ–º."*

### üìö –¢–µ–æ—Ä–∏—è: CIA Triad –∏ –æ—Å–Ω–æ–≤—ã security

#### –ß—Ç–æ —Ç–∞–∫–æ–µ CIA Triad?

**CIA Triad** ‚Äî —Ç—Ä–∏ –∫–∏—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

1. **Confidentiality (–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å)**
   - –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
   - –ü—Ä–∏–º–µ—Ä: –ø–∞—Ä–æ–ª–∏, –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è —Ç–∞–π–Ω–∞
   - –£–≥—Ä–æ–∑—ã: –∫—Ä–∞–∂–∞ –¥–∞–Ω–Ω—ã—Ö, —É—Ç–µ—á–∫–∏, –ø–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞
   - –ó–∞—â–∏—Ç–∞: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, access control, authentication

2. **Integrity (–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å)**
   - –î–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ
   - –ü—Ä–∏–º–µ—Ä: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, executables, –ª–æ–≥–∏
   - –£–≥—Ä–æ–∑—ã: backdoors, rootkits, data tampering
   - –ó–∞—â–∏—Ç–∞: checksums, digital signatures, file integrity monitoring

3. **Availability (–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å)**
   - –î–∞–Ω–Ω—ã–µ –∏ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ
   - –ü—Ä–∏–º–µ—Ä: –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å 24/7
   - –£–≥—Ä–æ–∑—ã: DDoS, system crashes, ransomware
   - –ó–∞—â–∏—Ç–∞: redundancy, backups, DDoS mitigation

#### üè† –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –î–æ–º —Å —Å–µ–π—Ñ–æ–º

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –¥–æ–º —Å —Å–µ–π—Ñ–æ–º, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ—Å—Ç–∏:

- **Confidentiality** = –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –∑–Ω–∞–µ—Ç –∫–æ–¥ –æ—Ç —Å–µ–π—Ñ–∞ (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
- **Integrity** = –°–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø—ã—Ç–∞–µ—Ç—Å—è –≤–∑–ª–æ–º–∞—Ç—å —Å–µ–π—Ñ (AIDE)
- **Availability** = –í–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å–µ–π—Ñ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ (uptime)

**–ê—Ç–∞–∫–∞ –Ω–∞ Confidentiality:** –í–æ—Ä –ø–æ–¥—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –∫–æ–¥ –æ—Ç —Å–µ–π—Ñ–∞
**–ê—Ç–∞–∫–∞ –Ω–∞ Integrity:** –í–æ—Ä –∑–∞–º–µ–Ω—è–µ—Ç –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–¥–¥–µ–ª–∫–∞–º–∏
**–ê—Ç–∞–∫–∞ –Ω–∞ Availability:** –í–æ—Ä –∑–∞–ª–∏–≤–∞–µ—Ç —Å–µ–π—Ñ –±–µ—Ç–æ–Ω–æ–º ‚Äî –Ω–µ–ª—å–∑—è –æ—Ç–∫—Ä—ã—Ç—å

#### Attack Surface (–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏)

**Attack surface** ‚Äî –≤—Å–µ —Ç–æ—á–∫–∏ –≥–¥–µ –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤–∑–ª–æ–º–∞—Ç—å —Å–∏—Å—Ç–µ–º—É:

- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã (SSH 22, HTTP 80, HTTPS 443)
- Web applications (—Ñ–æ—Ä–º—ã –ª–æ–≥–∏–Ω–∞, API endpoints)
- System users (–æ—Å–æ–±–µ–Ω–Ω–æ root –∏ sudo users)
- Running services (–∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å)
- Physical access (–µ—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)

**–ü—Ä–∞–≤–∏–ª–æ:** –ß–µ–º –º–µ–Ω—å—à–µ attack surface, —Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ —Å–∏—Å—Ç–µ–º–∞.

- –ó–∞–∫—Ä—ã—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ—Ä—Ç—ã ‚úÖ
- –û—Ç–∫–ª—é—á–∏—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã ‚úÖ
- –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã ‚úÖ
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã ‚úÖ

#### Defense in Depth (–≠—à–µ–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞)

**Defense in Depth** ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã, –∫–∞–∫ –ª—É–∫–æ–≤–∏—Ü–∞:

```
    Internet
       ‚Üì
   Firewall (–ø–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è)
       ‚Üì
   fail2ban (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ brute-force)
       ‚Üì
   SSH keys only (–Ω–µ—Ç –ø–∞—Ä–æ–ª–µ–π)
       ‚Üì
   sudo —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
       ‚Üì
   AppArmor/SELinux (mandatory access control)
       ‚Üì
   AIDE (file integrity monitoring)
       ‚Üì
   Logs + Monitoring (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫)
```

**–ï—Å–ª–∏ –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–±–∏—Ç** ‚Äî –µ—Å—Ç—å –µ—â—ë 6 –¥—Ä—É–≥–∏—Ö.

**Eva**: *"–í banking security –º—ã –Ω–∞–∑—ã–≤–∞–µ–º —ç—Ç–æ 'Swiss cheese model'. –ö–∞–∂–¥—ã–π —Å–ª–æ–π ‚Äî —Å—ã—Ä —Å –¥—ã—Ä–∞–º–∏. –û–¥–Ω–∞ –¥—ã—Ä–∞ ‚Äî –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞. –ù–æ –∫–æ–≥–¥–∞ –¥—ã—Ä—ã –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ –ª–∏–Ω–∏—é ‚Äî –∞—Ç–∞–∫—É—é—â–∏–π –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–∞—Å–∫–≤–æ–∑—å. –ù–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî —á—Ç–æ–±—ã –¥—ã—Ä—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞–ª–∏—Å—å."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ê–Ω–∞–ª–∏–∑ attack surface –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
sudo ss -tulnp

# –í–æ–ø—Ä–æ—Å: –ö–∞–∫–∏–µ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã? –ù—É–∂–Ω—ã –ª–∏ –æ–Ω–∏ –≤—Å–µ?
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
tcp   LISTEN  0   128   0.0.0.0:22    0.0.0.0:*   users:(("sshd",pid=1234))
tcp   LISTEN  0   128   0.0.0.0:80    0.0.0.0:*   users:(("nginx",pid=5678))
```

```bash
# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
systemctl list-units --type=service --state=running

# –í–æ–ø—Ä–æ—Å: –í—Å–µ –ª–∏ —Å–µ—Ä–≤–∏—Å—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã?
```

```bash
# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
cat /etc/passwd | grep -v nologin | grep -v false

# –í–æ–ø—Ä–æ—Å: –ö—Ç–æ –º–æ–∂–µ—Ç –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º—É?
```

```bash
# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ sudo –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
sudo cat /etc/sudoers
sudo ls -la /etc/sudoers.d/

# –í–æ–ø—Ä–æ—Å: –ö—Ç–æ –∏–º–µ–µ—Ç sudo rights?
```

**–ó–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.** –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –ø–æ–∑–∂–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"–°–µ—Ä–≤–µ—Ä –∏–º–µ–µ—Ç SSH (22), HTTP (80), MySQL (3306) –æ—Ç–∫—Ä—ã—Ç—ã–º–∏. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ MySQL –ª–æ–∫–∞–ª—å–Ω–æ. –ö–∞–∫–æ–π –ø–æ—Ä—Ç –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –≤ firewall?"*

<details>
<summary>ü§î –î—É–º–∞–π 30 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º</summary>

**–û—Ç–≤–µ—Ç:** –ü–æ—Ä—Ç **3306 (MySQL)**.

**–ü–æ—á–µ–º—É?**
- MySQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ (–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ)
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –¥–æ—Å—Ç—É–ø–µ –∏–∑–≤–Ω–µ
- –û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç MySQL ‚Äî –æ–≥—Ä–æ–º–Ω–∞—è attack surface (SQL injection, brute-force)
- –ü—Ä–∞–≤–∏–ª–æ: –µ—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ ‚Äî bind –Ω–∞ 127.0.0.1, –Ω–µ 0.0.0.0

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MySQL:**
```ini
# /etc/mysql/mysql.conf.d/mysqld.cnf
bind-address = 127.0.0.1  # —Ç–æ–ª—å–∫–æ localhost
```

</details>

---

## üîÑ –¶–∏–∫–ª 2: –°–∏—Å—Ç–µ–º–Ω—ã–π –∞—É–¥–∏—Ç ‚Äî lynis (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Eva**: *"–ü–µ—Ä–≤—ã–π —à–∞–≥ –∞—É–¥–∏—Ç–∞ ‚Äî –ø–æ–Ω—è—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã. –î–ª—è —ç—Ç–æ–≥–æ –µ—Å—Ç—å lynis. –≠—Ç–æ —à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π –Ω–æ–∂ security audit."*

–û–Ω–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç:
```bash
sudo lynis audit system
```

–¢–µ—Ä–º–∏–Ω–∞–ª –≤–∑—Ä—ã–≤–∞–µ—Ç—Å—è —Ü–≤–µ—Ç–Ω—ã–º –≤—ã–≤–æ–¥–æ–º. –ó–µ–ª—ë–Ω—ã–π (OK), –∂—ë–ª—Ç—ã–π (Warning), –∫—Ä–∞—Å–Ω—ã–π (Critical).

**Eva**: *"–°–º–æ—Ç—Ä–∏. Hardening index: 68. –î–ª—è production banking —Å–∏—Å—Ç–µ–º—ã –º—ã —Ç—Ä–µ–±—É–µ–º –º–∏–Ω–∏–º—É–º 85. –£ —Ç–µ–±—è —Ä–∞–±–æ—Ç–∞."*

### üìö –¢–µ–æ—Ä–∏—è: lynis ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞—É–¥–∏—Ç

#### –ß—Ç–æ —Ç–∞–∫–æ–µ lynis?

**lynis** ‚Äî open-source –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è security auditing –∏ hardening Linux/Unix —Å–∏—Å—Ç–µ–º.

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- System information (OS, kernel, hostname)
- Boot –∏ –∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
- Kernel hardening parameters
- Authentication (PAM, LDAP, SSH config)
- File systems (/etc/fstab, mount options)
- Storage (disk encryption, LVM)
- NFS, DNS, SMTP configuration
- Web servers (Apache, nginx)
- Databases (MySQL, PostgreSQL)
- Running services
- Installed packages
- Security software (firewall, fail2ban)
- File integrity (AIDE, Tripwire)
- Malware scanners
- Logging –∏ auditing

**–í—ã—Ö–æ–¥:**
- **Warnings** ‚Äî —á—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
- **Suggestions** ‚Äî —á—Ç–æ —É–ª—É—á—à–∏—Ç—å
- **Hardening index** ‚Äî –æ–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (0-100)

#### üè† –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä –ø–æ–∂–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

lynis ‚Äî –∫–∞–∫ –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–∞–Ω–∏–µ:
- ‚úÖ –ï—Å—Ç—å –æ–≥–Ω–µ—Ç—É—à–∏—Ç–µ–ª–∏? (firewall —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω?)
- ‚ö†Ô∏è –í—ã—Ö–æ–¥—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã? (SSH root login enabled?)
- ‚ùå –ü—Ä–æ–≤–æ–¥–∫–∞ –æ–≥–æ–ª–µ–Ω–∞? (—Å–ª–∞–±—ã–µ permissions –Ω–∞ /etc/shadow?)

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –æ—Ç—á—ë—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
sudo apt update
sudo apt install lynis
```

–ò–ª–∏ latest version —Å GitHub:
```bash
git clone https://github.com/CISOfy/lynis.git
cd lynis
sudo ./lynis audit system
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã
sudo lynis audit system

# –ë—ã—Å—Ç—Ä—ã–π –∞—É–¥–∏—Ç (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥–æ–ª–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)
sudo lynis audit system --quick

# Audit —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø—Ä–æ—Ñ–∏–ª–µ–º
sudo lynis audit system --profile /path/to/custom.prf

# –ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é
lynis show version

# –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
lynis show commands

# –û–±–Ω–æ–≤–∏—Ç—å lynis
lynis update info
```

#### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
[WARNING] Found world writable file: /tmp/test.txt
[SUGGESTION] Consider running ARP monitoring software (arpwatch)
```

**Hardening index:**
```
Hardening index : 68 [############    ]
```

- **90-100:** Excellent (production ready)
- **75-89:** Good (—Ç—Ä–µ–±—É—é—Ç—Å—è –º–∏–Ω–æ—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)
- **60-74:** Average (–Ω—É–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞)
- **<60:** Poor (–∫—Ä–∏—Ç–∏—á–Ω–æ —É–ª—É—á—à–∏—Ç—å!)

**–§–∞–π–ª –æ—Ç—á—ë—Ç–∞:** `/var/log/lynis.log`

#### –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å

–°–æ–∑–¥–∞–π—Ç–µ `/etc/lynis/custom.prf`:

```ini
# Skip tests
skip-test=FILE-6310
skip-test=HTTP-6640

# Quick scan
config:quick=yes

# Verbose output
config:verbose=yes
```

**Eva**: *"Default –ø—Ä–æ—Ñ–∏–ª—å lynis –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å—ë. –î–ª—è production —Å–∏—Å—Ç–µ–º —Å–æ–∑–¥–∞–≤–∞–π –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–π —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º—ã –∫ —Ç–≤–æ–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ. –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ó–∞–ø—É—Å–∫ lynis audit

**–ó–∞–¥–∞–Ω–∏–µ:**

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ lynis:
```bash
sudo apt update
sudo apt install lynis
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç:
```bash
sudo lynis audit system | tee ~/lynis-report.txt
```

3. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—Ç—á—ë—Ç:
```bash
less ~/lynis-report.txt
# –∏–ª–∏
cat /var/log/lynis.log
```

4. –ù–∞–π–¥–∏—Ç–µ –≤ –æ—Ç—á—ë—Ç–µ:
   - Hardening index (—á–∏—Å–ª–æ 0-100)
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ warnings
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ suggestions
   - –°–∞–º—ã–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

5. **–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
   - –ö–∞–∫–æ–π –≤–∞—à hardening index?
   - –¢–æ–ø-3 warnings?
   - –ß—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç lynis —É–ª—É—á—à–∏—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?

6. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å:
```bash
sudo cp starter/configs/lynis-custom.prf.example /etc/lynis/custom.prf
sudo nano /etc/lynis/custom.prf
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
sudo lynis audit system --profile /etc/lynis/custom.prf
```

**–ó–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** ‚Äî –æ–Ω–∏ –ø–æ–π–¥—É—Ç –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"lynis –ø–æ–∫–∞–∑–∞–ª hardening index 62. –≠—Ç–æ —Ö–æ—Ä–æ—à–æ –∏–ª–∏ –ø–ª–æ—Ö–æ –¥–ª—è production —Å–µ—Ä–≤–µ—Ä–∞?"*

<details>
<summary>ü§î –î—É–º–∞–π –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º</summary>

**–û—Ç–≤–µ—Ç:** **–ü–ª–æ—Ö–æ.** 62 ‚Äî —ç—Ç–æ "Average", –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–µ–º–ª–µ–º–æ–≥–æ –¥–ª—è production (75+).

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**
- Production —Å–µ—Ä–≤–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å hardened –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ
- 62 –æ–∑–Ω–∞—á–∞–µ—Ç ~40% —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π lynis –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —É—Å–ø–µ—à–Ω–æ–π –∞—Ç–∞–∫–∏
- –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç security compliance standards (PCI DSS, ISO 27001)

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ warnings –∏ suggestions
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (priority!)
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ hardening
4. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å audit ‚Äî —Ü–µ–ª–µ–≤–æ–π index 85+

**Eva**: *"–í banking security 62 ‚Äî —ç—Ç–æ 'fired immediately'. –ú–∏–Ω–∏–º—É–º 85 –¥–ª—è –ª—é–±–æ–≥–æ production —Å–µ—Ä–≤–µ—Ä–∞. –ò–¥–µ–∞–ª—å–Ω–æ ‚Äî 90+."*

</details>

---

## üîÑ –¶–∏–∫–ª 3: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏ ‚Äî nmap (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Eva**: *"–¢–µ–ø–µ—Ä—å –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–∏—Å—Ç–µ–º—É –≥–ª–∞–∑–∞–º–∏ –∞—Ç–∞–∫—É—é—â–µ–≥–æ. –ß—Ç–æ –≤–∏–¥–∏—Ç –ö—Ä—ã–ª–æ–≤ –∫–æ–≥–¥–∞ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –Ω–∞—à —Å–µ—Ä–≤–µ—Ä?"*

–û–Ω–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç nmap:
```bash
nmap -sV 10.20.30.40
```

–í—ã–≤–æ–¥:
```
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.9p1
80/tcp   open  http    nginx 1.18.0
9090/tcp open  ???     unknown
```

**Eva** (—Å–º–æ—Ç—Ä–∏—Ç —Å—Ç—Ä–æ–≥–æ): *"9090? –ß—Ç–æ —ç—Ç–æ? –£ –Ω–∞—Å –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∏—á–µ–≥–æ –Ω–∞ –ø–æ—Ä—Ç—É 9090."*

**–ú–∞–∫—Å** (–±–ª–µ–¥–Ω–µ–µ—Ç): *"–≠—Ç–æ —Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –ê–Ω–Ω–∞ –Ω–∞—à–ª–∞. Fake sshd."*

**Eva**: *"Backdoor. –ù–∞—Ö–æ–¥–∫–∞ –Ω–æ–º–µ—Ä –æ–¥–∏–Ω. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º."*

### üìö –¢–µ–æ—Ä–∏—è: nmap ‚Äî —Ä–∞–∑–≤–µ–¥–∫–∞ —Å–µ—Ç–∏

#### –ß—Ç–æ —Ç–∞–∫–æ–µ nmap?

**nmap (Network Mapper)** ‚Äî –º–æ—â–Ω–µ–π—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è:
- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ç–∏ (–∫–∞–∫–∏–µ —Ö–æ—Å—Ç—ã alive?)
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π —Å–µ—Ä–≤–∏—Å–æ–≤
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- –ü–æ–∏—Å–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- –°–∏—Å—Ç–µ–º–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ (–¥–ª—è audit)
- –ü–µ–Ω—Ç–µ—Å—Ç–µ—Ä–∞–º–∏ (–¥–ª—è reconnaissance)
- –ê—Ç–∞–∫—É—é—â–∏–º–∏ (–¥–ª—è –ø–æ–∏—Å–∫–∞ —Ü–µ–ª–µ–π)

**Eva**: *"nmap ‚Äî –æ–±–æ—é–¥–æ–æ—Å—Ç—Ä—ã–π –º–µ—á. –¢—ã –∏–º –ø—Ä–æ–≤–µ—Ä—è–µ—à—å —Å–≤–æ–∏ —Å–µ—Ä–≤–µ—Ä—ã. –ö—Ä—ã–ª–æ–≤ ‚Äî —Ç–≤–æ–∏."*

#### üè† –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–≤–µ—Ä–∏

nmap ‚Äî –∫–∞–∫ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ–¥–∏—Ç –≤–æ–∫—Ä—É–≥ –∑–¥–∞–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –ö–∞–∫–∏–µ –¥–≤–µ—Ä–∏ –æ—Ç–∫—Ä—ã—Ç—ã? (–æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã)
- –ö–∞–∫–∏–µ –∑–∞–º–∫–∏ —Å—Ç–æ—è—Ç? (–≤–µ—Ä—Å–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤)
- –ï—Å—Ç—å –ª–∏ –æ—Ö—Ä–∞–Ω–∞? (firewall)
- –ö–∞–∫–∞—è —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è? (IDS/IPS)

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ–¥–∫–∏ ‚Äî –≤—ã–±–∏—Ä–∞–µ—Ç —Å–∞–º—É—é —Å–ª–∞–±—É—é —Ç–æ—á–∫—É –¥–ª—è –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è.

**–í–∞—à–∞ –∑–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –î–û —Ç–æ–≥–æ –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞–µ—Ç –∞—Ç–∞–∫—É—é—â–∏–π.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
sudo apt update
sudo apt install nmap
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**1. Ping scan (–∫–∞–∫–∏–µ —Ö–æ—Å—Ç—ã alive?):**
```bash
nmap -sn 192.168.1.0/24
```

**2. Port scan (–∫–∞–∫–∏–µ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã?):**
```bash
# TCP SYN scan (–±—ã—Å—Ç—Ä—ã–π, stealth)
sudo nmap -sS 192.168.1.10

# TCP Connect scan (–ø–æ–ª–Ω–æ–µ 3-way handshake, –∑–∞–º–µ—Ç–Ω–µ–µ –≤ –ª–æ–≥–∞—Ö)
nmap -sT 192.168.1.10

# UDP scan (–º–µ–¥–ª–µ–Ω–Ω—ã–π, –Ω–æ –≤–∞–∂–µ–Ω!)
sudo nmap -sU 192.168.1.10
```

**3. Service version detection:**
```bash
nmap -sV 192.168.1.10
```

–ü—Ä–∏–º–µ—Ä:
```
22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5
```

**4. OS detection:**
```bash
sudo nmap -O 192.168.1.10
```

**5. –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—Å—ë —Å—Ä–∞–∑—É):**
```bash
sudo nmap -A 192.168.1.10
```

`-A` –≤–∫–ª—é—á–∞–µ—Ç:
- OS detection (-O)
- Version detection (-sV)
- Script scanning (-sC)
- Traceroute (--traceroute)

**6. Scan specific ports:**
```bash
# –û–¥–∏–Ω –ø–æ—Ä—Ç
nmap -p 22 192.168.1.10

# –î–∏–∞–ø–∞–∑–æ–Ω
nmap -p 1-1000 192.168.1.10

# –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ä—Ç–æ–≤
nmap -p 22,80,443 192.168.1.10

# –í—Å–µ –ø–æ—Ä—Ç—ã (1-65535)
nmap -p- 192.168.1.10
```

**7. –°–∫–æ—Ä–æ—Å—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:**
```bash
# -T0 (paranoid) - –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ, stealth
# -T1 (sneaky)
# -T2 (polite)
# -T3 (normal) - default
# -T4 (aggressive) - –±—ã—Å—Ç—Ä–æ, –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ç–µ–π
# -T5 (insane) - –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ, –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–æ—Ä—Ç—ã

nmap -T4 192.168.1.10
```

#### NSE (Nmap Scripting Engine)

NSE ‚Äî —Å–æ—Ç–Ω–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è:
- –ü–æ–∏—Å–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- Brute-force
- Exploit
- Discovery

**–ó–∞–ø—É—Å–∫ default scripts:**
```bash
nmap -sC 192.168.1.10
```

**–ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:**
```bash
nmap --script vuln 192.168.1.10
```

**Specific –∫–∞—Ç–µ–≥–æ—Ä–∏—è scripts:**
```bash
# –í—Å–µ HTTP —Å–∫—Ä–∏–ø—Ç—ã
nmap --script "http-*" 192.168.1.10

# –í—Å–µ auth —Å–∫—Ä–∏–ø—Ç—ã
nmap --script "auth" 192.168.1.10
```

**–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö scripts:**
```bash
ls /usr/share/nmap/scripts/
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ scripts:**
```bash
sudo nmap --script-updatedb
```

#### –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

```bash
# Normal output (stdout)
nmap 192.168.1.10

# Save to file
nmap 192.168.1.10 -oN scan.txt      # Normal format
nmap 192.168.1.10 -oX scan.xml      # XML (–º–æ–∂–Ω–æ –ø–∞—Ä—Å–∏—Ç—å)
nmap 192.168.1.10 -oG scan.grep     # Grepable
nmap 192.168.1.10 -oA scan          # All formats (scan.nmap, scan.xml, scan.gnmap)
```

#### ‚ö†Ô∏è –õ–µ–≥–∞–ª—å–Ω–æ—Å—Ç—å –∏ —ç—Ç–∏–∫–∞

**–í–ê–ñ–ù–û:**
- ‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¢–û–õ–¨–ö–û —Å–≤–æ–∏ —Å–µ—Ä–≤–µ—Ä—ã
- ‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
- ‚ùå –ù–ï —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —á—É–∂–∏–µ —Å–µ—Ç–∏ (—ç—Ç–æ –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ!)
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å nmap –¥–ª—è –∞—Ç–∞–∫

–í Episode 17 —Å–∫–∞–Ω–∏—Ä—É–µ–º **—Ç–æ–ª—å–∫–æ localhost** –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã.

**Eva**: *"–í Switzerland –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–∂–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ ‚Äî criminal offense. –¢—é—Ä—å–º–∞. –ù–µ —à—É—Ç–∫–∞. –°–∫–∞–Ω–∏—Ä—É–π —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –∏–º–µ–µ—à—å –ø—Ä–∞–≤–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ localhost

**–ó–∞–¥–∞–Ω–∏–µ:**

1. –ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ localhost:
```bash
nmap localhost
```

–ó–∞–ø–∏—à–∏—Ç–µ: –∫–∞–∫–∏–µ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã?

2. Service version detection:
```bash
sudo nmap -sV localhost > ~/nmap-services.txt
cat ~/nmap-services.txt
```

–ó–∞–ø–∏—à–∏—Ç–µ: –≤–µ—Ä—Å–∏–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

3. –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!):
```bash
sudo nmap -A localhost > ~/nmap-aggressive.txt
```

4. –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:
```bash
sudo nmap --script vuln localhost > ~/nmap-vulns.txt
```

‚ö†Ô∏è **–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-10 –º–∏–Ω—É—Ç!**

5. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã
cat ~/nmap-vulns.txt

# –ù–∞–π–¥–∏—Ç–µ:
# - –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –≤–µ—Ä—Å–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
# - –ò–∑–≤–µ—Å—Ç–Ω—ã–µ CVE
# - Misconfigured services
```

6. **–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
   - –ï—Å—Ç—å –ª–∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã?
   - –í—Å–µ –ª–∏ —Å–µ—Ä–≤–∏—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π?
   - –ù–∞–π–¥–µ–Ω—ã –ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏?

**–ó–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"nmap –ø–æ–∫–∞–∑–∞–ª: `9090/tcp open unknown`. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏–ª–∏ —Ç—Ä–µ–≤–æ–∂–Ω—ã–π –∑–≤–æ–Ω–æ–∫?"*

<details>
<summary>ü§î –î—É–º–∞–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ</summary>

**–û—Ç–≤–µ—Ç:** **–¢—Ä–µ–≤–æ–∂–Ω—ã–π –∑–≤–æ–Ω–æ–∫!** üö®

**–ü–æ—á–µ–º—É:**
- –ü–æ—Ä—Ç 9090 –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º (–Ω–µ 22, 80, 443)
- –°–µ—Ä–≤–∏—Å "unknown" ‚Äî nmap –Ω–µ —Å–º–æ–≥ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á—Ç–æ —ç—Ç–æ
- –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å:
  - Backdoor (–∫–∞–∫ –≤ —Å—é–∂–µ—Ç–µ —ç–ø–∏–∑–æ–¥–∞)
  - Misconfigured service
  - Development tool –∑–∞–±—ã—Ç—ã–π –≤ production
  - Legitimate service –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –ø–æ—Ä—Ç—É

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç:
```bash
sudo ss -tulnp | grep 9090
sudo lsof -i :9090
```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω:
```bash
ps -p <PID> -o lstart,cmd
```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª:
```bash
ls -la /proc/<PID>/exe
md5sum /proc/<PID>/exe
```

4. –ï—Å–ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ ‚Äî kill –∏ investigate:
```bash
sudo kill <PID>
# –ê–Ω–∞–ª–∏–∑ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞
```

**Eva**: *"Unknown port ‚Äî –∫–∞–∫ –Ω–µ–∑–Ω–∞–∫–æ–º–µ—Ü —É –¥–≤–µ—Ä–∏. –õ–∏–±–æ —Ç—ã –∑–Ω–∞–µ—à—å –ø–æ—á–µ–º—É –æ–Ω –∑–¥–µ—Å—å, –ª–∏–±–æ –≤—ã–∑—ã–≤–∞–µ—à—å security."*

</details>

---

## üîÑ –¶–∏–∫–ª 4: –ö–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤ ‚Äî AIDE (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**–ú–∞–∫—Å**: *"–ú—ã –Ω–∞—à–ª–∏ backdoor –Ω–∞ –ø–æ—Ä—Ç—É 9090. –ù–æ –æ—Ç–∫—É–¥–∞ –æ–Ω –≤–∑—è–ª—Å—è? –ö—Ç–æ-—Ç–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª —Ñ–∞–π–ª—ã?"*

**Eva**: *"–•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å. –î–ª—è —ç—Ç–æ–≥–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç AIDE ‚Äî Advanced Intrusion Detection Environment. –≠—Ç–æ –∫–∞–∫ system of tripwires. –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç critical file ‚Äî –º—ã —É–∑–Ω–∞–µ–º."*

–û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é AIDE:
```
/bin Full
/sbin Full
/etc Full
```

**Eva**: *"–°–æ–∑–¥–∞—ë–º baseline ‚Äî snapshot –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤. Checksums, permissions, timestamps. –ü–æ—Ç–æ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º ‚Äî –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –ª–∏ —á—Ç–æ-—Ç–æ."*

**–ú–∞–∫—Å**: *"–ò –µ—Å–ª–∏ backdoor –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω?"*

**Eva**: *"AIDE –ø–æ–∫–∞–∂–µ—Ç: 'File /usr/sbin/sshd_fake added'. Rootkit –Ω–µ —Å–ø—Ä—è—á–µ—Ç—Å—è."*

### üìö –¢–µ–æ—Ä–∏—è: AIDE ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤

#### –ß—Ç–æ —Ç–∞–∫–æ–µ AIDE?

**AIDE (Advanced Intrusion Detection Environment)** ‚Äî host-based intrusion detection system (HIDS) –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤.

**–ó–∞–¥–∞—á–∞:** –û–±–Ω–∞—Ä—É–∂–∏—Ç—å –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –°–æ–∑–¥–∞—ë—Ç—Å—è **baseline database** ‚Äî snapshot —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:
   - Checksums (MD5, SHA256, SHA512)
   - Permissions (chmod)
   - Ownership (chown)
   - Timestamps (mtime, ctime, atime)
   - File type, inode, links count
3. –†–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ current state —Å baseline
4. –ò–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

**–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ (backdoors, rootkits)
- –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (rm /var/log/auth.log)
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é (trojan –∑–∞–º–µ–Ω—è–µ—Ç /bin/ls)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ permissions (chmod 777 /etc/shadow ‚Äî –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ!)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ ownership

#### üè† –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∫–≤–∞—Ä—Ç–∏—Ä—ã

AIDE ‚Äî –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã –∫–≤–∞—Ä—Ç–∏—Ä—ã:
- Baseline = —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è (–≥–¥–µ —á—Ç–æ –ª–µ–∂–∏—Ç)
- Check = –Ω–æ–≤–∞—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è
- Diff = —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?

–ï—Å–ª–∏ —Ç—ã —É–µ–∑–∂–∞–ª –Ω–∞ –Ω–µ–¥–µ–ª—é –∏ –≤–µ—Ä–Ω—É–ª—Å—è:
- –ù–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç –ø–æ—è–≤–∏–ª—Å—è? (backdoor —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- –ß—Ç–æ-—Ç–æ –ø—Ä–æ–ø–∞–ª–æ? (–ª–æ–≥–∏ —É–¥–∞–ª–µ–Ω—ã)
- –ú–µ–±–µ–ª—å –ø–µ—Ä–µ—Å—Ç–∞–≤–ª–µ–Ω–∞? (—Ñ–∞–π–ª—ã –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã)

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
sudo apt update
sudo apt install aide
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª: `/etc/aide/aide.conf`

**–ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```ini
# Database locations
database=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new

# Report URL
report_url=stdout

# Rules
Full = p+i+n+u+g+s+b+m+c+md5+sha256

# Directories to monitor
/bin Full
/sbin Full
/usr/bin Full
/usr/sbin Full
/etc Full
/boot Full

# Exclusions
!/tmp
!/var/log
!/var/cache
```

**–ü—Ä–∞–≤–∏–ª–∞ (Rules):**

| –ê—Ç—Ä–∏–±—É—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| p       | permissions |
| i       | inode |
| n       | number of links |
| u       | user (owner) |
| g       | group |
| s       | size |
| b       | block count |
| m       | mtime (modification time) |
| c       | ctime (change time) |
| md5     | MD5 checksum |
| sha256  | SHA256 checksum |
| sha512  | SHA512 checksum |

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª:**
```ini
# –ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–≤—Å—ë)
Full = p+i+n+u+g+s+b+m+c+md5+sha256

# –¢–æ–ª—å–∫–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–Ω–µ timestamps)
Content = sha256+md5

# –¢–æ–ª—å–∫–æ metadata
Metadata = p+u+g

# –¢–æ–ª—å–∫–æ permissions
PermOnly = p
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

**1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø–µ—Ä–≤—ã–π —Ä–∞–∑):**
```bash
sudo aideinit
```

–≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç baseline database:
- Reads /etc/aide/aide.conf
- Scans all specified directories
- Creates /var/lib/aide/aide.db.new

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è baseline:**
```bash
sudo cp /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```

**2. –ü—Ä–æ–≤–µ—Ä–∫–∞ (check):**
```bash
sudo aide --check
```

–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç current state —Å baseline, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è.

**3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ baseline:**
```bash
# –ü–æ—Å–ª–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (update packages, etc.)
sudo aide --update

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω–æ–≤—É—é –±–∞–∑—É
sudo cp /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```

**4. Config check:**
```bash
sudo aide --config-check
```

#### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ check:**
```
changed: /etc/passwd
f    ...    ...    : /etc/passwd

Summary:
  Total number of files:        12345
  Added files:                  2
  Removed files:                0
  Changed files:                1
```

**–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**
- `f` ‚Äî file (–æ–±—ã—á–Ω—ã–π —Ñ–∞–π–ª)
- `d` ‚Äî directory
- `l` ‚Äî symlink
- `p` ‚Äî named pipe
- `s` ‚Äî socket

**Detailed changes:**
```
File: /etc/passwd
  MD5:  Old=abc123... New=def456...
  SHA256: Old=xyz789... New=uvw012...
  Mtime: Old=2025-01-15 New=2025-01-20
```

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö:**
1. **Expected changes** (apt upgrade, legitime config edits):
   - Update baseline: `sudo aide --update`
2. **Unexpected changes** (—Ö–º, —è –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–ª...):
   - Investigate!
   - Check logs: `journalctl -xe`
   - Check processes: `ps aux`
   - Possible intrusion

#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (systemd timer)

–ú—ã —Å–æ–∑–¥–∞–¥–∏–º systemd timer –≤ –ø—Ä–∞–∫—Ç–∏–∫–µ (—Å–º. `starter/systemd/`).

**Eva**: *"AIDE –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ. –†–∞–∑ –≤ –¥–µ–Ω—å –º–∏–Ω–∏–º—É–º. –î–ª—è critical —Å–∏—Å—Ç–µ–º ‚Äî –∫–∞–∂–¥—ã–π —á–∞—Å. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ systemd timer, –Ω–µ —á–µ—Ä–µ–∑ cron —Å–∫—Ä–∏–ø—Ç."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AIDE

**–ó–∞–¥–∞–Ω–∏–µ:**

**–ß–∞—Å—Ç—å 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ AIDE:
```bash
sudo apt update
sudo apt install aide
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∞–±–ª–æ–Ω –∏–∑ starter/
sudo cp starter/configs/aide.conf.example /etc/aide/aide.conf

# –ò–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ default
sudo nano /etc/aide/aide.conf
```

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä—è—Ç—Å—è:
- /etc (configs)
- /bin, /sbin, /usr/bin, /usr/sbin (binaries)
- /boot (kernel)

3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ AIDE (—Å–æ–∑–¥–∞–π—Ç–µ baseline):
```bash
sudo aideinit
```

‚ö†Ô∏è **–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-15 –º–∏–Ω—É—Ç** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–∏—Å—Ç–µ–º—ã!

4. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ baseline:
```bash
sudo cp /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```

**–ß–∞—Å—Ç—å 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É:
```bash
sudo aide --check
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: "No changes detected" (–µ—Å–ª–∏ —Å –º–æ–º–µ–Ω—Ç–∞ init –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–ª–æ—Å—å).

6. –°–¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –≤ /etc
sudo touch /etc/test_aide_file.txt
```

7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É —Å–Ω–æ–≤–∞:
```bash
sudo aide --check
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: "Added: /etc/test_aide_file.txt"

8. –£–¥–∞–ª–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª:
```bash
sudo rm /etc/test_aide_file.txt
```

9. –û–±–Ω–æ–≤–∏—Ç–µ baseline (–ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):
```bash
sudo aide --update
sudo cp /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```

**–ß–∞—Å—Ç—å 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (systemd timer)**

10. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ systemd units:
```bash
sudo cp starter/systemd/aide-check.service /etc/systemd/system/
sudo cp starter/systemd/aide-check.timer /etc/systemd/system/
```

11. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ timer:
```bash
sudo systemctl daemon-reload
sudo systemctl enable aide-check.timer
sudo systemctl start aide-check.timer
```

12. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:
```bash
# –°—Ç–∞—Ç—É—Å timer
systemctl status aide-check.timer

# –ö–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫?
systemctl list-timers aide-check.timer

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ç–µ—Å—Ç–∞)
sudo systemctl start aide-check.service

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
journalctl -u aide-check.service
```

**–ó–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"AIDE –ø–æ–∫–∞–∑–∞–ª: 'Changed: /bin/ls'. –¢—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª –ø–∞–∫–µ—Ç—ã. –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?"*

<details>
<summary>ü§î –≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ</summary>

**–û—Ç–≤–µ—Ç:** **–í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏!** üö®üö®üö®

**–ü–æ—á–µ–º—É `/bin/ls` –∫—Ä–∏—Ç–∏—á–µ–Ω:**
- `ls` ‚Äî –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–∞–Ω–¥
- –ï—Å–ª–∏ –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ —Ç—Ä–æ—è–Ω ‚Äî –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç —Å–∫—Ä—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è rootkit —Ç–µ—Ö–Ω–∏–∫–∞

**–ß—Ç–æ –º–æ–≥–ª–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:**
1. **Rootkit —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** ‚Äî —Ç—Ä–æ—è–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ls —Å–∫—Ä—ã–≤–∞–µ—Ç backdoor —Ñ–∞–π–ª—ã
2. **APT –∞—Ç–∞–∫–∞** ‚Äî advanced persistent threat –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç system binaries
3. **Supply chain attack** ‚Äî —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (—Ä–µ–¥–∫–æ, –Ω–æ –±—ã–≤–∞–µ—Ç)

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ù–ï–ú–ï–î–õ–ï–ù–ù–û:**

1. **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É!** (compromised)

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ checksum —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º:
```bash
# –°–∫–∞—á–∞–π—Ç–µ package –∑–∞–Ω–æ–≤–æ (–Ω–∞ –¥—Ä—É–≥–æ–π –º–∞—à–∏–Ω–µ!)
apt download coreutils

# –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ
dpkg -x coreutils_*.deb /tmp/clean/
sha256sum /bin/ls
sha256sum /tmp/clean/bin/ls
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä—É–≥–∏–µ binaries:
```bash
sudo aide --check | grep /bin
sudo aide --check | grep /sbin
```

4. **–ï—Å–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω rootkit:**
   - Disconnect from network
   - Forensics analysis (–ø–∞–º—è—Ç—å, –¥–∏—Å–∫–∏)
   - Backup critical data (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å infected!)
   - Full system reinstall (compromised system –Ω–µ–ª—å–∑—è trust)

**Eva**: *"–ò–∑–º–µ–Ω–µ–Ω–∏–µ /bin/ls –±–µ–∑ apt upgrade ‚Äî —ç—Ç–æ CODE RED. Full incident response protocol. –°–∏—Å—Ç–µ–º–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è compromised –¥–æ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ."*

</details>

---

## üîÑ –¶–∏–∫–ª 5: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π ‚Äî nikto (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Eva:** *"–£ –≤–∞—Å –µ—Å—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–µ–π?"*

**–ú–∞–∫—Å:** *"–î–∞, nginx –Ω–∞ –ø–æ—Ä—Ç—É 80. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å."*

**Eva:** *"–ü–æ–∫–∞–∂–∏."* (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä, —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

**Eva:** *"Server: nginx/1.18.0. Version disclosure. –ü–ª–æ—Ö–æ. Nikto ‚Äî —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫–∞–Ω–µ—Ä –≤–µ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π. –ó–∞–ø—É—Å–∫–∞–µ–º."*

```bash
nikto -h http://localhost
```

–í—ã–≤–æ–¥ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞—Ç—å—Å—è:
```
+ Server leaks inodes via ETags
+ The X-Frame-Options header is not defined
+ The X-Content-Type-Options header is not set
```

**Eva:** *"–°–º–æ—Ç—Ä–∏. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî 70% –≤—Å–µ—Ö —É—Å–ø–µ—à–Ω—ã—Ö –∞—Ç–∞–∫. OWASP Top 10 –Ω–∞–∏–∑—É—Å—Ç—å –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å."*

### üìö –¢–µ–æ—Ä–∏—è: nikto ‚Äî –≤–µ–±-—Å–∫–∞–Ω–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### –ß—Ç–æ —Ç–∞–∫–æ–µ nikto?

**nikto** ‚Äî open-source –≤–µ–±-—Å–∫–∞–Ω–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞:
- –£—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –≤–µ—Ä—Å–∏–π —Å–µ—Ä–≤–µ—Ä–æ–≤
- –£—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π  
- Misconfiguration
- Default files –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- Insecure files –∏ CGI scripts

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
sudo apt update
sudo apt install nikto
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
nikto -h http://localhost

# –° —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
nikto -h http://localhost -o report.html -Format html

# SSL/TLS —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
nikto -h https://example.com -ssl
```

**Eva**: *"nikto –∞–≥—Ä–µ—Å—Å–∏–≤–µ–Ω –∏ –∑–∞–º–µ—Ç–µ–Ω –≤ –ª–æ–≥–∞—Ö. –î–ª—è audit ‚Äî –æ—Ç–ª–∏—á–Ω–æ. –î–ª—è stealth pentest ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π burp suite."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ï—Å–ª–∏ –µ—Å—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä:**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ nikto
nikto -h http://localhost -o ~/nikto-report.txt

# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
cat ~/nikto-report.txt
```

**–ê–Ω–∞–ª–∏–∑:**
- Version disclosure?
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ security headers?
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏?

**–ó–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –¥–ª—è –æ—Ç—á—ë—Ç–∞.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"nikto –Ω–∞—à—ë–ª: 'Server: Apache/2.4.29'. –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞?"*

<details>
<summary>ü§î –î—É–º–∞–π</summary>

**–û—Ç–≤–µ—Ç:** **Information disclosure** ‚Äî —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ –≤–µ—Ä—Å–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞.

**–ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ:**
- –ê—Ç–∞–∫—É—é—â–∏–π –∑–Ω–∞–µ—Ç —Ç–æ—á–Ω—É—é –≤–µ—Ä—Å–∏—é
- –ú–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ CVE –¥–ª—è 2.4.29
- –ü–æ–º–æ–≥–∞–µ—Ç —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø–ª–∞–Ω –∞—Ç–∞–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```apache
# /etc/apache2/conf-enabled/security.conf
ServerTokens Prod
ServerSignature Off
```

</details>

---

## üîÑ –¶–∏–∫–ª 6: –ó–∞—â–∏—Ç–∞ –æ—Ç –≤—Ç–æ—Ä–∂–µ–Ω–∏–π ‚Äî fail2ban (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**–ú–∞–∫—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏:**
```
Failed password for root from 185.220.101.47 (–ø–æ–ø—ã—Ç–∫–∞ 247)
```

**Eva:** *"247 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ —á–∞—Å. Brute-force. fail2ban –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî –≤–∏–¥–∏—Ç –ø–∞—Ç—Ç–µ—Ä–Ω –∞—Ç–∞–∫–∏, –±–∞–Ω–∏—Ç IP."*

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```bash
sudo fail2ban-client status sshd
```

–í—ã–≤–æ–¥:
```
Currently banned: 1
Banned IP list: 185.220.101.47
```

**Eva:** *"–ó–∞–±–∞–Ω–µ–Ω. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏."*

### üìö –¢–µ–æ—Ä–∏—è: fail2ban ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞

**fail2ban** ‚Äî intrusion prevention —Å–∏—Å—Ç–µ–º–∞:
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –ª–æ–≥–∏
- –ò—â–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–∞–Ω–∏—Ç IP —á–µ—Ä–µ–∑ iptables

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
sudo apt install fail2ban
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `/etc/fail2ban/jail.local`:

```ini
[DEFAULT]
bantime  = 7200
findtime = 600
maxretry = 3

[sshd]
enabled = true
port    = ssh
logpath = /var/log/auth.log
maxretry = 3
bantime = 7200
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ä—Ç
sudo systemctl start fail2ban

# –°—Ç–∞—Ç—É—Å
sudo fail2ban-client status

# –°—Ç–∞—Ç—É—Å SSH jail
sudo fail2ban-client status sshd

# –†–∞–∑–±–∞–Ω–∏—Ç—å IP
sudo fail2ban-client set sshd unbanip 1.2.3.4
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ fail2ban

**–ó–∞–¥–∞–Ω–∏–µ:**

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```bash
sudo apt install fail2ban
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
```bash
sudo cp starter/configs/fail2ban-jail.local.example /etc/fail2ban/jail.local
sudo nano /etc/fail2ban/jail.local
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
sudo systemctl enable --now fail2ban
```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
```bash
sudo fail2ban-client status sshd
```

**–ó–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.**

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"fail2ban –∑–∞–±–∞–Ω–∏–ª IP –Ω–∞ 2 —á–∞—Å–∞. –ß–µ—Ä–µ–∑ 2 —á–∞—Å–∞ –∞—Ç–∞–∫—É—é—â–∏–π –≤–µ—Ä–Ω—É–ª—Å—è. –ß—Ç–æ –Ω–µ —Ç–∞–∫?"*

<details>
<summary>ü§î –ü–æ–¥—É–º–∞–π –æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</summary>

**–û—Ç–≤–µ—Ç:** **bantime —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π.**

**–†–µ—à–µ–Ω–∏–µ ‚Äî recidive jail:**
```ini
[recidive]
enabled  = true
bantime  = 604800  # 1 –Ω–µ–¥–µ–ª—è –¥–ª—è —Ä–µ—Ü–∏–¥–∏–≤–∏—Å—Ç–æ–≤
maxretry = 3
```

**Eva:** *"Smart –∞—Ç–∞–∫—É—é—â–∏–π –±—É–¥–µ—Ç –∂–¥–∞—Ç—å. Smarter –∞–¥–º–∏–Ω —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç bantime –¥–ª—è —Ä–µ—Ü–∏–¥–∏–≤–∏—Å—Ç–æ–≤."*

</details>

---

## üîÑ –¶–∏–∫–ª 7: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π ‚Äî CVE Search (15 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Eva –ø—Ä–æ–≤–µ—Ä—è–µ—Ç OpenSSL:**
```bash
apt list --installed | grep openssl
# openssl 1.1.1f
```

–ò—â–µ—Ç CVE:
```
CVE-2022-0778 (CVSS 7.5) - HIGH
CVE-2021-3712 (CVSS 7.4) - HIGH
```

**Eva:** *"–¢—Ä–∏ HIGH —É—è–∑–≤–∏–º–æ—Å—Ç–∏. –ü–∞—Ç—á–∏ –¥–æ—Å—Ç—É–ø–Ω—ã 6 –º–µ—Å—è—Ü–µ–≤. –¢—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª?"*

**–ú–∞–∫—Å:** *"–ë–æ—è–ª—Å—è —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞—Ç—å..."*

**Eva:** *"–ò —Ç–µ–ø–µ—Ä—å —É —Ç–µ–±—è RCE. –ß—Ç–æ –æ–ø–∞—Å–Ω–µ–µ ‚Äî —Å–ª–æ–º–∞—Ç—å –∏–ª–∏ –¥–∞—Ç—å –ö—Ä—ã–ª–æ–≤—É root?"*

### üìö –¢–µ–æ—Ä–∏—è: CVE –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏

**CVE** ‚Äî Common Vulnerabilities and Exposures

**–§–æ—Ä–º–∞—Ç:** CVE-YEAR-NUMBER  
**–ü—Ä–∏–º–µ—Ä:** CVE-2021-44228 (Log4Shell)

#### CVSS Score (0.0-10.0)

| Score | Severity | –î–µ–π—Å—Ç–≤–∏—è |
|-------|----------|----------|
| 9.0-10.0 | CRITICAL | –ü–∞—Ç—á –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–æ–≤ |
| 7.0-8.9 | HIGH | –ü–∞—Ç—á –∑–∞ 24-48—á |
| 4.0-6.9 | MEDIUM | –ü–∞—Ç—á –∑–∞ –Ω–µ–¥–µ–ª—é |
| 0.1-3.9 | LOW | –ü–ª–∞–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
sudo apt update
apt list --upgradable

# Security updates
apt list --upgradable | grep -i security

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ security updates
sudo apt install unattended-upgrades
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ü—Ä–æ–≤–µ—Ä–∫–∞ CVE

**–ó–∞–¥–∞–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```bash
apt list --upgradable > ~/upgradable-packages.txt
```

2. –í—ã–±–µ—Ä–∏—Ç–µ critical –ø–∞–∫–µ—Ç—ã (openssl, openssh, nginx):
```bash
dpkg -l | grep -E "openssl|openssh|nginx"
```

3. –ü–æ–∏—Å–∫ CVE –æ–Ω–ª–∞–π–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ

4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ unattended-upgrades:
```bash
sudo apt install unattended-upgrades
sudo dpkg-reconfigure unattended-upgrades
```

**–ó–∞–ø–∏—à–∏—Ç–µ** –Ω–∞–π–¥–µ–Ω–Ω—ã–µ CVE.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"CVE-2024-XXXXX, CVSS 9.8, exploit public. –ß—Ç–æ –¥–µ–ª–∞—Ç—å?"*

<details>
<summary>ü§î CRITICAL priority</summary>

**–û—Ç–≤–µ—Ç:** **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è** (—á–∞—Å—ã, –Ω–µ –¥–Ω–∏!):

1. –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞ (5 –º–∏–Ω)
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ exposure (5 –º–∏–Ω)
3. Temporary mitigation –µ—Å–ª–∏ –ø–∞—Ç—á –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (15 –º–∏–Ω)
4. –ü–∞—Ç—á (30-60 –º–∏–Ω)
5. Verify (10 –º–∏–Ω)

**Timing:**
- Internet-facing: –ø–∞—Ç—á –∑–∞ 4-6 —á–∞—Å–æ–≤
- Under attack: –ù–ï–ú–ï–î–õ–ï–ù–ù–û

**Eva:** *"CVSS 9.8 + public exploit = –ø–æ–∂–∞—Ä–Ω–∞—è —Ç—Ä–µ–≤–æ–≥–∞. –ù–µ –µ—à—å, –Ω–µ –ø–µ–π –∫–æ—Ñ–µ. –ü–∞—Ç—á. –°–µ–π—á–∞—Å."*

</details>

---

## üîÑ –¶–∏–∫–ª 8: –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ –æ–± –∞—É–¥–∏—Ç–µ (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

–ú–∞–∫—Å –ø–µ—Ä–µ–¥ –≥–æ—Ä–æ–π –¥–∞–Ω–Ω—ã—Ö. Eva —Å–∞–¥–∏—Ç—Å—è —Ä—è–¥–æ–º:

**Eva:** *"Security report ‚Äî –Ω–µ dump –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ executive summary –¥–ª—è decision makers."*

–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —à–∞–±–ª–æ–Ω:
```markdown
## Executive Summary
- Hardening Index: 68/100 (POOR)
- Critical Issues: 5
- Top Risk: OpenSSL CVE (CVSS 7.5)
```

**Eva:** *"–í–∏–∫—Ç–æ—Ä –Ω–µ –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å 150 —Å—Ç—Ä–∞–Ω–∏—Ü. –ï–º—É –Ω—É–∂–Ω–æ: 1) –ù–∞—Å–∫–æ–ª—å–∫–æ —É—è–∑–≤–∏–º—ã? 2) –ß—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ? 3) –ß—Ç–æ –¥–µ–ª–∞—Ç—å?"*

### üìö –¢–µ–æ—Ä–∏—è: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π security –æ—Ç—á—ë—Ç

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

**1. Executive Summary (1 —Å—Ç—Ä)**
- –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º
- –¢–æ–ø-3 –Ω–∞—Ö–æ–¥–∫–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**2. Methodology (0.5 —Å—Ç—Ä)**
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- –°–∏—Å—Ç–µ–º—ã
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

**3. Findings (3-10 —Å—Ç—Ä)**
–î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã:
- Severity
- Description
- Risk
- Recommendation
- Effort

**4. Action Plan (1 —Å—Ç—Ä)**
- Prioritized –∑–∞–¥–∞—á–∏
- Deadlines
- –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ

#### –•–æ—Ä–æ—à–∏–π vs –ø–ª–æ—Ö–æ–π –æ—Ç—á—ë—Ç

**‚ùå –ü–ª–æ—Ö–æ–π:**
```
nmap: 3306/tcp open mysql
```

**‚úÖ –•–æ—Ä–æ—à–∏–π:**
```
### MySQL port exposed
**Severity:** HIGH
**Risk:** Data breach
**Fix:** 
1. bind-address = 127.0.0.1
2. ufw deny 3306
**Effort:** 15 min
```

**Eva:** *"Report –∫–æ—Ç–æ—Ä—ã–π –Ω–∏–∫—Ç–æ –Ω–µ —á–∏—Ç–∞–µ—Ç ‚Äî –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω. Make it readable, actionable."*

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç

**–ó–∞–¥–∞–Ω–∏–µ:**

1. –°–æ–±–µ—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
```bash
mkdir ~/episode17-results
cp ~/lynis-report.txt ~/episode17-results/
cp ~/nmap-*.txt ~/episode17-results/
```

2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω:
```bash
cp starter/templates/audit-report-template.md ./audit-report.md
```

3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ö–ê–ñ–î–´–ô —Ä–∞–∑–¥–µ–ª:
- Executive Summary
- lynis —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- nmap —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- AIDE —Å—Ç–∞—Ç—É—Å
- fail2ban —Å—Ç–∞—Ç—É—Å
- CVE –Ω–∞—Ö–æ–¥–∫–∏
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç—á—ë—Ç ‚Äî —á–∏—Ç–∞–µ—Ç—Å—è < 10 –º–∏–Ω—É—Ç?

**–ö—Ä–∏—Ç–µ—Ä–∏–∏:**
- [ ] Executive summary
- [ ] –í—Å–µ 5 –ø—Ä–æ–≤–µ—Ä–æ–∫
- [ ] 2-3 critical –ø—Ä–æ–±–ª–µ–º—ã –¥–µ—Ç–∞–ª—å–Ω–æ
- [ ] –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

---

## üéØ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ

### –°—é–∂–µ—Ç ‚Äî –î–µ–Ω—å 35, –Ω–æ—á—å

**–ú–∞–∫—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á—ë—Ç –í–∏–∫—Ç–æ—Ä—É.**

**–í–∏–∫—Ç–æ—Ä (–∑–≤–æ–Ω–∏—Ç):** *"Excellent. Backdoor –Ω–∞—à—ë–ª ‚Äî –≥–ª–∞–≤–Ω–æ–µ. Eva –≥–æ–≤–æ—Ä–∏—Ç —Ç—ã –±—ã—Å—Ç—Ä–æ —É—á–∏—à—å—Å—è."*

**Eva:** *"Banking paranoia achieved. Welcome to the club."*

---

### –ò—Ç–æ–≥–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞

**Checklist:**

- [ ] **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã**
  ```bash
  lynis --version && nmap --version && aide --version
  ```

- [ ] **Lynis audit –≤—ã–ø–æ–ª–Ω–µ–Ω**
  ```bash
  sudo lynis audit system | tee ~/lynis-final.log
  ```

- [ ] **nmap —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**
  ```bash
  sudo nmap -sV localhost -oN ~/nmap-final.txt
  sudo nmap --script vuln localhost -oN ~/nmap-vulns.txt
  ```

- [ ] **AIDE –Ω–∞—Å—Ç—Ä–æ–µ–Ω**
  ```bash
  sudo ls -lh /var/lib/aide/aide.db
  systemctl status aide-check.timer
  ```

- [ ] **fail2ban —Ä–∞–±–æ—Ç–∞–µ—Ç**
  ```bash
  sudo systemctl status fail2ban
  sudo fail2ban-client status sshd
  ```

- [ ] **CVE –ø—Ä–æ–≤–µ—Ä–∫–∞**
  ```bash
  apt list --upgradable | tee ~/packages.txt
  ```

- [ ] **–§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç**
  ```bash
  cat ~/audit-report.md
  # –ú–∏–Ω–∏–º—É–º 2-3 findings
  ```

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

**–ú–∏–Ω–∏–º—É–º:**
- ‚úÖ –í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ 3+ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –Ω–∞–ø–∏—Å–∞–Ω
- ‚úÖ AIDE –∏–ª–∏ fail2ban –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

**–ò–¥–µ–∞–ª—å–Ω–æ:**
- ‚úÖ –í—Å–µ 5 –ø—Ä–æ–≤–µ—Ä–æ–∫
- ‚úÖ AIDE + fail2ban + systemd timers
- ‚úÖ Critical –ø—Ä–æ–±–ª–µ–º—ã –ò–°–ü–†–ê–í–õ–ï–ù–´
- ‚úÖ Hardening index —É–ª—É—á—à–µ–Ω
- ‚úÖ Professional quality –æ—Ç—á—ë—Ç

---

## üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã

```bash
cd ~/kernel-shadows/season-5-security-pentesting/episode-17-security-auditing
sudo ./tests/test.sh
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—Ç:
- –£—Å—Ç–∞–Ω–æ–≤–∫—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
- –ù–∞–ª–∏—á–∏–µ –æ—Ç—á—ë—Ç–æ–≤

---

## üìö –†–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **lynis:** https://cisofy.com/lynis/
- **nmap:** https://nmap.org/
- **AIDE:** https://aide.github.io/
- **fail2ban:** https://www.fail2ban.org/
- **nikto:** https://cirt.net/Nikto2

### CVE Databases

- https://cve.mitre.org
- https://nvd.nist.gov
- https://www.cvedetails.com
- https://usn.ubuntu.com (Ubuntu Security)

### –ö–Ω–∏–≥–∏

- "The Art of Software Security Assessment"
- "Security Engineering" ‚Äî Ross Anderson
- "Linux Security Cookbook"

---

## üéì –ò—Ç–æ–≥–∏ Episode 17

### –ß—Ç–æ –∏–∑—É—á–∏–ª–∏

**–¢–µ–æ—Ä–∏—è:**
- ‚úÖ CIA Triad
- ‚úÖ Attack surface, defense in depth
- ‚úÖ CVE, CVSS
- ‚úÖ Professional reporting

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- ‚úÖ lynis ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞—É–¥–∏—Ç
- ‚úÖ nmap ‚Äî network scanning
- ‚úÖ AIDE ‚Äî file integrity
- ‚úÖ fail2ban ‚Äî intrusion prevention
- ‚úÖ nikto ‚Äî web scanning

**–ù–∞–≤—ã–∫–∏:**
- ‚úÖ Security audit
- ‚úÖ Vulnerability assessment
- ‚úÖ Automated monitoring
- ‚úÖ systemd automation
- ‚úÖ Report writing

---

### –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —ç–ø–∏–∑–æ–¥–∞–º–∏

**Prerequisites:**
- Episodes 1-4: Bash basics
- Episodes 5-8: Networking
- Episodes 9-12: System admin

**What's next:**
- **Episode 18:** Penetration Testing (offensive)
- **Episode 19:** Incident Response (forensics)
- **Episode 20:** Security Hardening (—É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ)

---

### –°—é–∂–µ—Ç ‚Äî –ü–µ—Ä–µ—Ö–æ–¥ –∫ Episode 18

**–í–∏–∫—Ç–æ—Ä –∑–≤–æ–Ω–∏—Ç:**

*"Audit –Ω–∞—à—ë–ª backdoor. –ó–∞–∫—Ä—ã–ª–∏. –ù–æ –≤–æ–ø—Ä–æ—Å ‚Äî –∫–∞–∫ –≤–æ—à–ª–∏? –ï—Å—Ç—å –µ—â—ë –¥—ã—Ä—ã?"*

**–ê–ª–µ–∫—Å:** *"–ü–æ–∑–≤–æ–ª—å –º–Ω–µ. –Ø –ø–æ–∫–∞–∂—É –∫–∞–∫ –¥—É–º–∞—é—Ç –∞—Ç–∞–∫—É—é—â–∏–µ."*

**–í–∏–∫—Ç–æ—Ä:** *"Episode 18 ‚Äî pentest. Ethical hacking. –í—ã –∞—Ç–∞–∫—É–µ—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É."*

**LILITH:** *"Defense —Ö–æ—Ä–æ—à–æ. Offense ‚Äî –ª—É—á—à–µ. Episode 18 –∂–¥—ë—Ç."*

---

## üí¨ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç Eva

**Eva:** *"Security audit ‚Äî –Ω–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ. –≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å. Continuous monitoring. –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è vigilance."*

*"–í banking –º—ã –ø—Ä–æ–≤–æ–¥–∏–º audit –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é. Automated. Full scan –∫–∞–∂–¥—É—é –Ω–æ—á—å. Zero trust."*

*"–¢—ã –ø—Ä–æ—à—ë–ª –ø–µ—Ä–≤—ã–π audit. –¢–µ–ø–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π —Å–∏—Å—Ç–µ–º—É —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ audit-–∏–ª–∞ —Å–∞–º–∞ —Å–µ–±—è. AIDE –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. fail2ban 24/7. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ."*

*"Welcome to banking paranoia level. –¢–µ–ø–µ—Ä—å —Ç—ã –º—ã—Å–ª–∏—à—å –∫–∞–∫ security professional."*

---

> **"Security ‚Äî —ç—Ç–æ –æ–±—Ä–∞–∑ –º—ã—à–ª–µ–Ω–∏—è. –¢—ã –Ω–∞—É—á–∏–ª—Å—è –≤–∏–¥–µ—Ç—å –≤ —Ç–µ–º–Ω–æ—Ç–µ."** ‚Äî LILITH

---

**Status:** Episode 17 COMPLETE ‚úÖ  
**Next:** [Episode 18: Penetration Testing](../episode-18-penetration-testing/)  
**Season:** [Season 5: Security & Pentesting](../)  
**Course:** [KERNEL SHADOWS](../../../../)

---

*Good luck, sysadmin. The shadows are watching.*
