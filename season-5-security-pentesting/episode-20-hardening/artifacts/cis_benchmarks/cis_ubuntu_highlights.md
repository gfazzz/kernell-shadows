# CIS Benchmarks Ubuntu 22.04 LTS â€” Highlights

## ðŸ“‹ Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ CIS Benchmarks?

**CIS (Center for Internet Security) Benchmarks** â€” industry-standard security configuration guides:
- Created by consensus of cybersecurity experts
- Used globally for compliance (PCI-DSS, HIPAA, etc.)
- Two levels: Level 1 (basic) Ð¸ Level 2 (Ð²Ñ‹ÑÐ¾ÐºÐ°Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ)

---

## ðŸ”’ Level 1 Recommendations (MUST HAVE)

### 1. Filesystem Configuration
```bash
# 1.1.1 Disable unused filesystems
cat >> /etc/modprobe.d/cis.conf << EOF
install cramfs /bin/true
install freevxfs /bin/true
install jffs2 /bin/true
install hfs /bin/true
install hfsplus /bin/true
install udf /bin/true
EOF

# 1.1.2 Ensure /tmp is configured
# Mount /tmp with noexec,nodev,nosuid
```

### 2. Configure Software Updates
```bash
# 1.8 Ensure updates, patches, and security software installed
sudo apt update && sudo apt upgrade
sudo apt install unattended-upgrades
sudo dpkg-reconfigure --priority=low unattended-upgrades
```

### 3. Filesystem Integrity
```bash
# 1.3 Install AIDE
sudo apt install aide
sudo aideinit
sudo mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```

### 4. Secure Boot Settings
```bash
# 1.4 Configure bootloader
# Set GRUB password
sudo grub-mkpasswd-pbkdf2
# Add to /etc/grub.d/40_custom
```

### 5. Access Control
```bash
# 1.5.1 AppArmor enabled
sudo aa-enforce /etc/apparmor.d/*

# 1.5.2 Ensure SELinux or AppArmor
systemctl status apparmor
```

---

## ðŸ›¡ï¸ Level 2 Recommendations (HIGH SECURITY)

### 1. Kernel Parameters (sysctl)
```bash
# 3.1 Network Parameters
cat >> /etc/sysctl.d/99-cis.conf << EOF
# IP Forwarding
net.ipv4.ip_forward = 0
net.ipv6.conf.all.forwarding = 0

# ICMP Redirects
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0

# Source Routing
net.ipv4.conf.all.accept_source_route = 0
net.ipv6.conf.all.accept_source_route = 0

# ICMP Redirect Acceptance
net.ipv4.conf.all.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0

# Martian Packets
net.ipv4.conf.all.log_martians = 1

# RFC 1337
net.ipv4.tcp_rfc1337 = 1

# Randomize memory addresses
kernel.randomize_va_space = 2
EOF

sysctl -p /etc/sysctl.d/99-cis.conf
```

### 2. SSH Hardening
```bash
# 5.2 SSH Server Configuration
sudo nano /etc/ssh/sshd_config

# Recommended settings:
Protocol 2
PermitRootLogin no
PubkeyAuthentication yes
PasswordAuthentication no
PermitEmptyPasswords no
X11Forwarding no
MaxAuthTries 3
ClientAliveInterval 300
ClientAliveCountMax 0
LoginGraceTime 60
AllowUsers admin@192.168.1.0/24
```

### 3. User Accounts and Environment
```bash
# 5.4 Password policies
sudo nano /etc/login.defs

PASS_MAX_DAYS 90
PASS_MIN_DAYS 7
PASS_WARN_AGE 14
PASS_MIN_LEN 14

# 5.5 Ensure password reuse limited
sudo nano /etc/pam.d/common-password
# Add: remember=5
```

### 4. System Maintenance
```bash
# 6.1 Ensure permissions on system files
chmod 600 /etc/shadow
chmod 600 /etc/gshadow
chmod 644 /etc/passwd
chmod 644 /etc/group

# 6.2 Remove legacy services
sudo apt purge telnet nis rsh-client talk
```

---

## ðŸ“Š CIS Scoring

**Level 1 (Basic Security):** ~80-100 controls  
**Level 2 (High Security):** ~150-200 controls

**Typical Scoring:**
- 0-50%: High Risk
- 50-70%: Moderate Risk  
- 70-85%: Low Risk
- 85-100%: Compliant âœ…

**CERN Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚:** 90%+ (Level 2)

---

## ðŸ”§ Automation Tools

```bash
# OpenSCAP - CIS compliance checking
sudo apt install libopenscap8
oscap info /usr/share/xml/scap/ssg/content/ssg-ubuntu2204-ds.xml

# Lynis - Audit
sudo lynis audit system --quick

# CIS-CAT Pro (official, requires license)
# https://www.cisecurity.org/
```

---

> **Reference:** CIS Ubuntu Linux 22.04 LTS Benchmark v1.0.0  
> **Download:** https://www.cisecurity.org/benchmark/ubuntu_linux
