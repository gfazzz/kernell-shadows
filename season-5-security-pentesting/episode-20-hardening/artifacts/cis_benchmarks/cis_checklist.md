# CIS Benchmarks Checklist ‚Äî Ubuntu 22.04

## ‚úÖ Pre-Hardening Checklist

### Initial Assessment
- [ ] Run Lynis audit: `sudo lynis audit system`
- [ ] Run OpenSCAP: `oscap xccdf eval`
- [ ] Document baseline score
- [ ] Identify critical gaps

---

## üîß Hardening Checklist

### 1. Filesystem (CIS 1.x)
- [ ] Disable unused filesystems (cramfs, freevxfs, jffs2, hfs, hfsplus, udf)
- [ ] Configure /tmp with noexec,nodev,nosuid
- [ ] Install AIDE for file integrity
- [ ] Set GRUB bootloader password
- [ ] Enable AppArmor/SELinux

### 2. Services (CIS 2.x)
- [ ] Remove unnecessary services
- [ ] Disable Avahi server
- [ ] Disable CUPS (if not needed)
- [ ] Disable NFS/RPC (if not needed)
- [ ] Configure time synchronization (systemd-timesyncd/NTP)

### 3. Network (CIS 3.x)
- [ ] Disable IP forwarding
- [ ] Disable ICMP redirects
- [ ] Enable martian packet logging
- [ ] Disable source routing
- [ ] Enable TCP SYN cookies
- [ ] Configure IPv6 (disable if not used)

### 4. Firewall (CIS 3.5)
- [ ] Install and enable UFW/iptables
- [ ] Configure default deny policy
- [ ] Allow only required ports
- [ ] Log dropped packets

### 5. Audit Logging (CIS 4.x)
- [ ] Install auditd
- [ ] Configure audit rules
- [ ] Ensure logs are immutable
- [ ] Configure log rotation

### 6. SSH (CIS 5.2)
- [ ] Protocol 2 only
- [ ] PermitRootLogin no
- [ ] PubkeyAuthentication yes
- [ ] PasswordAuthentication no
- [ ] X11Forwarding no
- [ ] MaxAuthTries 3
- [ ] ClientAliveInterval 300

### 7. PAM and Password Policy (CIS 5.3-5.4)
- [ ] Password minimum length: 14
- [ ] Password complexity requirements
- [ ] Password history: remember=5
- [ ] PASS_MAX_DAYS 90
- [ ] PASS_MIN_DAYS 7
- [ ] Account lockout after failed attempts

### 8. User Accounts (CIS 5.5-5.6)
- [ ] Set password expiration for all users
- [ ] Ensure no accounts have empty passwords
- [ ] Ensure no legacy "+" entries in /etc/passwd
- [ ] Verify root is only UID 0

### 9. File Permissions (CIS 6.1)
- [ ] /etc/passwd: 644
- [ ] /etc/shadow: 600 (or 000)
- [ ] /etc/group: 644
- [ ] /etc/gshadow: 600 (or 000)
- [ ] /etc/ssh/sshd_config: 600

### 10. System Maintenance (CIS 6.2)
- [ ] Check for unowned files
- [ ] Check for world-writable files
- [ ] Check for unauthorized SUID/SGID files
- [ ] Review user dot files

---

## üß™ Post-Hardening Verification

- [ ] Re-run Lynis: target 85-90/100
- [ ] Re-run OpenSCAP: target 90%+
- [ ] Test SSH access (key-based only)
- [ ] Verify firewall rules
- [ ] Check auditd logs
- [ ] Red team test (Episode 20 Cycle 8)

---

## üìä Scoring Goals

**Baseline:** 68/100 (pre-hardening)  
**Target:** 90/100 (production-ready)  
**CERN Standard:** 95/100 (paranoia level 100)

---

> **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç checklist –¥–ª—è tracking hardening progress!**
