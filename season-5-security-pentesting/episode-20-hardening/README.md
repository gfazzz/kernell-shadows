# Episode 20: Security Hardening & Best Practices

> *"Hardening ‚Äî —ç—Ç–æ –Ω–µ –ø–∞—Ä–∞–Ω–æ–π—è. –≠—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≤–æ–π–Ω–µ."* ‚Äî Dr. Heinrich Bauer

```
Season 5: Security & Pentesting  
Episode 20 of 32 ‚Äî SEASON 5 FINALE
Location: Geneva üá®üá≠, Switzerland (CERN Security Lab)
Days: 40-42 of Operation KERNEL SHADOWS
Duration: 12-15 hours
Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
Type: Configuration (Type B) ‚Äî —Å–∏—Å—Ç–µ–º–Ω–æ–µ hardening
```

---

## üìã –û–±–∑–æ—Ä

### –ß—Ç–æ –≤—ã –∏–∑—É—á–∏—Ç–µ

–í —ç—Ç–æ–º —ç–ø–∏–∑–æ–¥–µ –≤—ã –ø—Ä–æ–≤–µ–¥—ë—Ç–µ **comprehensive security hardening** –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –±–∏—Ç–≤–µ:

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- üõ°Ô∏è **AppArmor** ‚Äî Mandatory Access Control (MAC)
- ‚öôÔ∏è **sysctl** ‚Äî kernel security parameters
- üìã **CIS Benchmarks** ‚Äî industry-standard compliance
- üîß **Lynis/OpenSCAP** ‚Äî security audit
- ü§ñ **Ansible** ‚Äî hardening automation (50 —Å–µ—Ä–≤–µ—Ä–æ–≤)
- üî• **UFW/iptables** ‚Äî firewall hardening

**–ù–∞–≤—ã–∫–∏:**
- Security hardening methodology
- AppArmor profile creation
- Kernel parameter tuning
- CIS Benchmarks –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
- Service hardening (SSH, Apache, MySQL)
- Infrastructure as Code –¥–ª—è hardening
- Red team validation testing

**–í–∞–∂–Ω–æ:** –≠—Ç–æ **–ù–ï bash scripting —ç–ø–∏–∑–æ–¥!** –í—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç–µ —Å–∏—Å—Ç–µ–º—ã, —Å–æ–∑–¥–∞—ë—Ç–µ profiles, –ø–∏—à–µ—Ç–µ Ansible YAML. Type B ‚Äî configuration, –Ω–µ automation —á–µ—Ä–µ–∑ bash.

---

## üé¨ –°—é–∂–µ—Ç: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### –î–µ–Ω—å 40, –≤–µ—á–µ—Ä ‚Äî –ü–æ—Å–ª–µ Episode 19

**–í–∏–∫—Ç–æ—Ä** (—ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫, –Ω–∞–ø—Ä—è–∂—ë–Ω–Ω—ã–π –≥–æ–ª–æ—Å):

*"Episode 19 –ø–æ–∫–∞–∑–∞–ª: '–ù–æ–≤–∞—è –≠—Ä–∞' ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—ã. APT –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞. State-sponsored –≤–æ–∑–º–æ–∂–Ω–æ. –û–¥–∏–Ω —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ‚Äî —ç—Ç–æ warning."*

–ü–∞—É–∑–∞.

*"–£ –Ω–∞—Å 50 —Å–µ—Ä–≤–µ—Ä–æ–≤. Stockholm –±—ã–ª test attack. Real attack –±—É–¥–µ—Ç –Ω–∞ –≤—Å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É. –ù—É–∂–µ–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã. Hardening. –í—Å—ë. –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä. –°–µ–π—á–∞—Å."*

**–ú–∞–∫—Å:** *"–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏?"*

**–í–∏–∫—Ç–æ—Ä:** *"–£ –Ω–∞—Å intelligence: '–ù–æ–≤–∞—è –≠—Ä–∞' –ø–ª–∞–Ω–∏—Ä—É–µ—Ç major attack. 72 —á–∞—Å–∞ maximum. Hardening –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≤–µ—Ä—à—ë–Ω –∑–∞ 48 —á–∞—Å–æ–≤."*

---

### –î–µ–Ω—å 41, —É—Ç—Ä–æ ‚Äî CERN Security Lab, –ñ–µ–Ω–µ–≤–∞

**Dr. Heinrich Bauer** (CERN security architect) ‚Äî 60 –ª–µ—Ç, —Å–µ–¥—ã–µ –≤–æ–ª–æ—Å—ã, —Å—Ç—Ä–æ–≥–∏–π –≤–∑–≥–ª—è–¥. 30 –ª–µ—Ç –≤ security.

**Heinrich:** *"CERN —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ Large Hadron Collider. Petabytes sensitive research. –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç LHC data ‚Äî —ç—Ç–æ global scientific catastrophe."*

–û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç CERN security dashboard:

```
CERN Infrastructure:
- Servers: 15,000+
- Data: 300+ Petabytes
- Security Score: 96/100 (CIS Level 2)
- Hardening Level: PARANOIA 100
```

**Heinrich:** *"–ù–∞—à–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî paranoia level 100. Defense in depth. Mandatory Access Control. Kernel hardening. Zero Trust architecture. –ü–æ–∫–∞–∂—É –≤–∞–º –∫–∞–∫."*

**–ú–∞–∫—Å:** *"48 —á–∞—Å–æ–≤ –¥–ª—è 50 —Å–µ—Ä–≤–µ—Ä–æ–≤?"*

**Heinrich:** *"Automation. Ansible. Episode 16 –∑–Ω–∞–Ω–∏—è. Infrastructure as Code. –û–¥–∏–Ω playbook ‚Äî 50 —Å–µ—Ä–≤–µ—Ä–æ–≤ –∑–∞ 6 hours. –ù–æ playbook –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å perfect. –ü–æ–∫–∞–∂—É."*

---

### –ö–æ–º–∞–Ω–¥–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

**–ê–Ω–Ω–∞:** *"Episode 17 ‚Äî audit. Episode 18 ‚Äî pentest. Episode 19 ‚Äî incident response. Episode 20 ‚Äî hardening. Full security lifecycle. –≠—Ç–æ culmination."*

**–ê–ª–µ–∫—Å:** *"–ü–æ—Å–ª–µ hardening ‚Äî —è –ø–æ–ø—Ä–æ–±—É—é –≤–∑–ª–æ–º–∞—Ç—å. Red team testing. –ï—Å–ª–∏ —è –ø—Ä–æ–Ω–∏–∫–Ω—É ‚Äî hardening –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π. –ï—Å–ª–∏ fail ‚Äî –≤—ã –≥–æ—Ç–æ–≤—ã."*

**LILITH** (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è): *"Hardening ‚Äî —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã –ø–µ—Ä–µ–¥ –≤–æ–π–Ω–æ–π. –ö–∞–∂–¥—ã–π parameter ‚Äî —â–∏—Ç. –ö–∞–∂–¥—ã–π profile ‚Äî –±—Ä–æ–Ω—è. –ö–∞–∂–¥–∞—è misconfiguration ‚Äî –¥—ã—Ä–∞. No mistakes."*

---

### –ú–∏—Å—Å–∏—è

**–¶–µ–ª—å:** Hardening –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã KERNEL SHADOWS

**Scope:**
- 50 —Å–µ—Ä–≤–µ—Ä–æ–≤ (15 web, 20 app, 10 database, 5 monitoring)
- Operating Systems: Ubuntu 22.04 LTS
- Services: SSH, Apache, MySQL, Docker
- Target: CIS Level 2 compliance (90%+)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. Baseline audit (Lynis)
2. AppArmor profiles —Å–æ–∑–¥–∞–Ω–∏–µ
3. Kernel hardening (sysctl)
4. CIS Benchmarks –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
5. Service hardening
6. Ansible automation
7. Deployment –Ω–∞ 50 —Å–µ—Ä–≤–µ—Ä–æ–≤
8. Red team validation (–ê–ª–µ–∫—Å)

**Timeline:** 48 —á–∞—Å–æ–≤

**Heinrich:** *"If '–ù–æ–≤–∞—è –≠—Ä–∞' attacks after hardening ‚Äî they will fail. My reputation on it."*

---

## üéì –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–ø–∏–∑–æ–¥–∞: 8 –º–∏–∫—Ä–æ-—Ü–∏–∫–ª–æ–≤

–ö–∞–∂–¥—ã–π —Ü–∏–∫–ª = 20-30 –º–∏–Ω—É—Ç:
- üé¨ –°—é–∂–µ—Ç (2-3 –º–∏–Ω) ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç
- üìö –¢–µ–æ—Ä–∏—è (10-15 –º–∏–Ω) ‚Äî –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è
- üíª –ü—Ä–∞–∫—Ç–∏–∫–∞ (7-12 –º–∏–Ω) ‚Äî hands-on hardening
- ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~3 —á–∞—Å–∞ —Ç–µ–æ—Ä–∏–∏ + 8-10 —á–∞—Å–æ–≤ –ø—Ä–∞–∫—Ç–∏–∫–∏ + 2 —á–∞—Å–∞ Ansible deployment = 13-15 —á–∞—Å–æ–≤

---

## üîÑ –¶–∏–∫–ª 1: Hardening Methodology & Baseline Audit (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich —Ä–∏—Å—É–µ—Ç –Ω–∞ whiteboard:**

```
Security Hardening Process:

1. Audit      ‚Üí Find gaps
2. Prioritize ‚Üí Critical first
3. Harden     ‚Üí Apply controls
4. Test       ‚Üí Red team
5. Monitor    ‚Üí Continuous
6. Repeat     ‚Üí Never stop
```

**Heinrich:** *"Hardening ‚Äî —ç—Ç–æ –Ω–µ one-time task. –≠—Ç–æ continuous process. Audit ‚Üí Harden ‚Üí Test ‚Üí Repeat. Forever."*

### üìö –¢–µ–æ—Ä–∏—è: Security Hardening Principles

#### –ß—Ç–æ —Ç–∞–∫–æ–µ Security Hardening?

**Security Hardening** ‚Äî –ø—Ä–æ—Ü–µ—Å—Å —É–º–µ–Ω—å—à–µ–Ω–∏—è attack surface —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑:
- –£–¥–∞–ª–µ–Ω–∏–µ unnecessary services
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ secure defaults
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ principle of least privilege
- –£—Å–∏–ª–µ–Ω–∏–µ access controls
- Minimizing exposure

**–¶–µ–ª–∏:**
- –°–Ω–∏–∑–∏—Ç—å attack surface
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å potential damage
- Compliance —Å standards (CIS, NIST, PCI-DSS)
- Defense in depth

#### üè† –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∑–∞–º–∫–∞

**Hardening —ç—Ç–æ:**
- –ö–∞–∫ —É–∫—Ä–µ–ø–∏—Ç—å –∑–∞–º–æ–∫ –ø–µ—Ä–µ–¥ –æ—Å–∞–¥–æ–π
- –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –æ–∫–Ω–∞ (disable services)
- –£—Å–∏–ª–∏—Ç—å —Å—Ç–µ–Ω—ã (kernel hardening)
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ—à—ë—Ç–∫–∏ (MAC/AppArmor)
- –í–æ–æ—Ä—É–∂–∏—Ç—å —Å—Ç—Ä–∞–∂—É (monitoring)
- –ü–ª–∞–Ω —ç–≤–∞–∫—É–∞—Ü–∏–∏ (incident response)

#### Defense in Depth

**Layers of security:**

```
Layer 7: Data           ‚Üí Encryption, DLP
Layer 6: Application    ‚Üí AppArmor, sandboxing
Layer 5: Host           ‚Üí Kernel hardening, services
Layer 4: Internal Network ‚Üí Segmentation, firewall
Layer 3: Perimeter      ‚Üí Border firewall, IDS/IPS
Layer 2: Physical       ‚Üí Access control, cameras
Layer 1: Policies       ‚Üí Training, procedures
```

**Principle:** –ï—Å–ª–∏ –æ–¥–∏–Ω layer fails ‚Äî others protect.

#### Baseline Security Audit

**–ü–µ—Ä–µ–¥ hardening ‚Äî audit:**

**Lynis (Linux security audit):**
```bash
sudo apt install lynis
sudo lynis audit system

# Output:
# - Hardening index: 68/100
# - Warnings: 23
# - Suggestions: 47
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç Lynis:**
- Boot –∏ services
- Kernel
- Users –∏ authentication
- File permissions
- Network configuration
- Installed software
- Security tools (firewall, IDS)
- Logging

**OpenSCAP (CIS compliance):**
```bash
sudo apt install libopenscap8
oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_cis \
  /usr/share/xml/scap/ssg/content/ssg-ubuntu2204-ds.xml
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Baseline Audit

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Lynis:**
```bash
sudo apt update
sudo apt install lynis
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ audit:**
```bash
sudo lynis audit system --quick
```

3. **–ò–∑—É—á–∏—Ç–µ results:**
```bash
# View summary
cat /var/log/lynis.log | grep -E "Hardening index|Warning|Suggestion"

# Warnings
grep "Warning" /var/log/lynis.log

# Suggestions
grep "Suggestion" /var/log/lynis.log
```

4. **–°—Ä–∞–≤–Ω–∏—Ç–µ —Å baseline:**
```bash
# –ù–∞—à baseline (–∏–∑ artifacts)
cat artifacts/baseline_audit/lynis_baseline.txt

# –í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç
# Hardening index: [X]/100
```

5. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ priorities:**
```markdown
## Hardening Priorities (–Ω–∞ –æ—Å–Ω–æ–≤–µ audit)

**Critical (fix first):**
- [ ] UFW firewall not enabled
- [ ] SSH PermitRootLogin yes
- [ ] auditd not installed

**High:**
- [ ] NOPASSWD in sudoers
- [ ] /tmp not mounted with noexec
- [ ] Password policy weak

**Medium:**
- [ ] AppArmor profiles incomplete
- [ ] Core dumps enabled
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"Hardening index 68/100. –ù–∞—á–∞—Ç—å —Å Medium priority fixes?"*

<details>
<summary>ü§î Prioritization strategy</summary>

**–û—Ç–≤–µ—Ç:** **–ù–ï–¢! Critical first, always.**

**–ü–æ—á–µ–º—É –ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω:**

**Critical vulnerabilities:**
- –ê–∫—Ç–∏–≤–Ω–æ exploitable RIGHT NOW
- Direct path to compromise
- –í—ã—Å–æ–∫–∏–π immediate impact

**High/Medium:**
- Requires combination attacks
- Lower immediate risk
- –í–∞–∂–Ω—ã, –Ω–æ –Ω–µ urgent

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫:**
1. **Critical** (0-24 hours)
   - SSH root login
   - No firewall
   - Missing auditd
   
2. **High** (24-48 hours)
   - sudo misconfigurations
   - Service hardening
   
3. **Medium** (48-72 hours)
   - AppArmor enhancement
   - Additional controls

4. **Low** (ongoing)
   - Nice-to-have improvements
   - Optimization

**Triage principle:**
- Stop the bleeding first (critical)
- Then stabilize (high)
- Then improve (medium/low)

**Heinrich:** *"In CERN –º—ã fixing critical –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞. High ‚Äî –¥–µ–Ω—å. Medium ‚Äî –Ω–µ–¥–µ–ª—è. Priority management ‚Äî —ç—Ç–æ skill. Wrong priorities = wasted effort while critical holes open."*

</details>

---

[–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç...]

*Part 1 of Episode 20 README.md*
*–¶–∏–∫–ª—ã 2-8 –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏*
## üîÑ –¶–∏–∫–ª 2: AppArmor ‚Äî Mandatory Access Control (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich:** *"DAC ‚Äî Discretionary Access Control. Owner –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç. –ü—Ä–æ–±–ª–µ–º–∞: –µ—Å–ª–∏ process compromised ‚Äî attacker –Ω–∞—Å–ª–µ–¥—É–µ—Ç –≤—Å–µ permissions."*

**Heinrich:** *"MAC ‚Äî Mandatory Access Control. System enforces rules. Even root cannot bypass. AppArmor ‚Äî —ç—Ç–æ MAC –¥–ª—è Linux."*

–û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
```bash
sudo aa-status
# 23 profiles loaded
# 12 in enforce mode
# 11 in complain mode
```

**Heinrich:** *"Enforce mode ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç violations. Complain mode ‚Äî only logs. Production –≤—Å–µ–≥–¥–∞ enforce."*

### üìö –¢–µ–æ—Ä–∏—è: AppArmor Mandatory Access Control

#### MAC vs DAC

**DAC (Traditional Linux):**
- User/Group/Other permissions (rwx)
- Owner decides access
- Problem: root bypasses everything
- Problem: compromised process = full user permissions

**MAC (AppArmor/SELinux):**
- System-wide mandatory policies
- Even root restricted
- Process confined to profile
- Principle of least privilege enforced

#### AppArmor Basics

**Profile modes:**
- **Enforce** ‚Äî violations blocked
- **Complain** ‚Äî violations logged only
- **Disabled** ‚Äî no protection

**Profile syntax:**
```
/path/to/binary {
  capability CAPABILITY,
  /path/to/file r,    # read
  /path/to/file w,    # write
  /path/to/file x,    # execute
  network FAMILY,     # network access
  deny /sensitive/** rwx,  # explicit deny
}
```

**Capabilities:**
```
capability net_bind_service,  # Bind ports <1024
capability setuid,             # Change UID
capability sys_admin,          # Admin operations
capability dac_override,       # Bypass DAC checks
```

#### Creating AppArmor Profiles

**Method 1: aa-genprof (automated):**
```bash
sudo aa-genprof /usr/sbin/apache2
# Run apache, generate traffic
# aa-genprof learns behavior
# Creates profile
```

**Method 2: Manual creation:**
```bash
sudo nano /etc/apparmor.d/usr.sbin.apache2
# Write profile based on requirements
sudo apparmor_parser -r /etc/apparmor.d/usr.sbin.apache2
```

**Method 3: Template-based:**
```bash
# Copy starter template
sudo cp starter/apparmor/usr.sbin.apache2 /etc/apparmor.d/
# Customize
# Load
```

#### Best Practices

1. **Start in complain mode:**
   ```bash
   sudo aa-complain /etc/apparmor.d/usr.sbin.apache2
   ```

2. **Monitor logs:**
   ```bash
   sudo tail -f /var/log/syslog | grep apparmor
   ```

3. **Iterate and tighten:**
   ```bash
   # Fix denials
   # Switch to enforce
   sudo aa-enforce /etc/apparmor.d/usr.sbin.apache2
   ```

4. **Test thoroughly:**
   ```bash
   sudo aa-status
   # Verify no denials in production
   ```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: AppArmor Profile Creation

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **Check AppArmor status:**
```bash
sudo systemctl status apparmor
sudo aa-status
```

2. **–°–æ–∑–¥–∞–π—Ç–µ profile –¥–ª—è Apache:**
```bash
# Copy template
sudo cp starter/apparmor/usr.sbin.apache2 /etc/apparmor.d/

# Load in complain mode (testing)
sudo aa-complain /etc/apparmor.d/usr.sbin.apache2
```

3. **Test Apache:**
```bash
sudo systemctl restart apache2
# Generate traffic
curl http://localhost
# Check logs
sudo tail /var/log/syslog | grep apparmor
```

4. **Switch to enforce mode:**
```bash
sudo aa-enforce /etc/apparmor.d/usr.sbin.apache2
sudo systemctl restart apache2
```

5. **Verify:**
```bash
sudo aa-status | grep apache2
# Should show "enforce mode"
```

6. **Create custom profile (advanced):**
```bash
# For custom service
sudo aa-genprof /path/to/your/service
# Follow prompts
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"AppArmor profile —Å–ª–∏—à–∫–æ–º restrictive. –°–µ—Ä–≤–∏—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. Disable AppArmor?"*

<details>
<summary>ü§î Troubleshooting approach</summary>

**–û—Ç–≤–µ—Ç:** **–ù–ï–¢! Fix profile, –Ω–µ disable protection.**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Profile too restrictive = service breaks
- Tempting to disable AppArmor
- But that removes all protection!

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**

1. **Switch to complain mode:**
   ```bash
   sudo aa-complain /etc/apparmor.d/service
   sudo systemctl restart service
   ```

2. **Monitor what's blocked:**
   ```bash
   sudo tail -f /var/log/syslog | grep DENIED
   # Shows what service trying to access
   ```

3. **Update profile:**
   ```bash
   sudo nano /etc/apparmor.d/service
   # Add necessary permissions
   ```

4. **Reload and test:**
   ```bash
   sudo apparmor_parser -r /etc/apparmor.d/service
   sudo systemctl restart service
   # Test functionality
   ```

5. **When working, enforce:**
   ```bash
   sudo aa-enforce /etc/apparmor.d/service
   ```

**Never disable security because of inconvenience!**

**Heinrich:** *"AppArmor profile error ‚Äî —ç—Ç–æ feedback. System telling you what service needs. Listen. Adjust profile. Security –∏ functionality both achievable. –ù–æ disable AppArmor? Never. That's defeat."*

</details>

---

## üîÑ –¶–∏–∫–ª 3: Kernel Hardening via sysctl (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/etc/sysctl.conf`:**

**Heinrich:** *"Linux kernel ‚Äî 20+ million lines –∫–æ–¥. –¢—ã—Å—è—á–∏ parameters. Most defaults designed –¥–ª—è compatibility, –Ω–µ security."*

–û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
```bash
sysctl -a | wc -l
# 1247 parameters

sysctl net.ipv4.ip_forward
# net.ipv4.ip_forward = 1  # DANGEROUS if not router!
```

**Heinrich:** *"ip_forward=1 ‚Äî server –º–æ–∂–µ—Ç forward packets. Attacker uses as pivot point. One parameter ‚Äî whole network compromise possible. Hardening ‚Äî –∑–Ω–∞—Ç—å –∫–∞–∂–¥—ã–π critical parameter."*

### üìö –¢–µ–æ—Ä–∏—è: Kernel Security Parameters

#### sysctl Overview

**sysctl** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è kernel parameters –≤–æ –≤—Ä–µ–º—è runtime.

**Configuration:**
- `/etc/sysctl.conf` ‚Äî main config
- `/etc/sysctl.d/*.conf` ‚Äî modular configs
- Runtime: `sysctl -w parameter=value`

**Persistence:**
```bash
# Temporary
sudo sysctl -w net.ipv4.ip_forward=0

# Permanent
echo "net.ipv4.ip_forward = 0" | sudo tee -a /etc/sysctl.d/99-hardening.conf
sudo sysctl -p /etc/sysctl.d/99-hardening.conf
```

#### Critical Kernel Parameters

**1. Network Security:**

```bash
# Disable IP forwarding (unless router)
net.ipv4.ip_forward = 0
net.ipv6.conf.all.forwarding = 0

# Disable ICMP redirects (MITM attacks)
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0

# Disable source routing (spoofing)
net.ipv4.conf.all.accept_source_route = 0
net.ipv6.conf.all.accept_source_route = 0

# Enable reverse path filtering (anti-spoofing)
net.ipv4.conf.all.rp_filter = 1

# Log suspicious packets
net.ipv4.conf.all.log_martians = 1

# SYN flood protection
net.ipv4.tcp_syncookies = 1

# Protect against time-wait assassination
net.ipv4.tcp_rfc1337 = 1
```

**2. Kernel Security:**

```bash
# Address Space Layout Randomization (ASLR)
kernel.randomize_va_space = 2

# Restrict kernel pointer exposure
kernel.kptr_restrict = 2

# Restrict dmesg (prevent info leak)
kernel.dmesg_restrict = 1

# Disable kernel debugging (production)
kernel.panic_on_oops = 1

# Core dump restrictions
kernel.core_uses_pid = 1
fs.suid_dumpable = 0

# Ptrace restrictions
kernel.yama.ptrace_scope = 1
```

**3. Filesystem Security:**

```bash
# Protected symlinks (prevent symlink attacks)
fs.protected_symlinks = 1

# Protected hardlinks
fs.protected_hardlinks = 1
```

#### CIS Recommended Parameters

From CIS Benchmarks Level 2:

```bash
## Network
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.default.secure_redirects = 0
net.ipv4.conf.all.log_martians = 1
net.ipv4.conf.default.log_martians = 1
net.ipv4.icmp_echo_ignore_broadcasts = 1
net.ipv4.icmp_ignore_bogus_error_responses = 1
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.tcp_syncookies = 1

## IPv6 (if not used, disable)
net.ipv6.conf.all.accept_ra = 0
net.ipv6.conf.default.accept_ra = 0
net.ipv6.conf.all.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0

## Kernel
kernel.randomize_va_space = 2
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Kernel Hardening

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **Check current parameters:**
```bash
# IP forwarding
sysctl net.ipv4.ip_forward

# ASLR
sysctl kernel.randomize_va_space

# View all network parameters
sysctl -a | grep net.ipv4 | less
```

2. **Create hardening config:**
```bash
# Copy template
sudo cp starter/sysctl-hardening.conf.example /etc/sysctl.d/99-hardening.conf

# Or create manually
sudo nano /etc/sysctl.d/99-hardening.conf
```

Add minimum:
```bash
net.ipv4.ip_forward = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.all.send_redirects = 0
net.ipv4.tcp_syncookies = 1
kernel.randomize_va_space = 2
kernel.dmesg_restrict = 1
```

3. **Apply configuration:**
```bash
# Load config
sudo sysctl -p /etc/sysctl.d/99-hardening.conf

# Verify
sysctl net.ipv4.ip_forward  # Should be 0
sysctl kernel.randomize_va_space  # Should be 2
```

4. **Test persistence:**
```bash
# Reboot
sudo reboot

# After reboot, verify
sysctl -a | grep -f /etc/sysctl.d/99-hardening.conf
```

5. **Document changes:**
```markdown
## Kernel Hardening Applied

**Network:**
- IP forwarding: disabled
- ICMP redirects: blocked
- SYN cookies: enabled

**Kernel:**
- ASLR: enabled (level 2)
- dmesg: restricted to root
- Ptrace: restricted
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"Application breaks –ø–æ—Å–ª–µ kernel hardening. Rollback –∏–∑–º–µ–Ω–µ–Ω–∏—è?"*

<details>
<summary>ü§î Hardening vs Compatibility</summary>

**–û—Ç–≤–µ—Ç:** **Investigate first, selective rollback if needed.**

**Workflow:**

1. **Identify breaking parameter:**
   ```bash
   # Check logs
   sudo journalctl -xe
   sudo dmesg | tail -50
   
   # Systematic test
   sudo sysctl -w parameter=old_value
   # Test application
   # If works ‚Äî found culprit
   ```

2. **Understand why it breaks:**
   - Application legitimately needs it?
   - Or poorly designed application?

3. **Options:**

   **Option A: Fix application (preferred)**
   ```bash
   # Example: App needs ptrace
   # Instead of kernel.yama.ptrace_scope=0
   # Use CAP_SYS_PTRACE capability for specific binary
   ```

   **Option B: Selective exception**
   ```bash
   # Comment out specific parameter
   # Document WHY
   # net.ipv4.conf.all.send_redirects = 0  # Disabled: breaks routing daemon XYZ
   ```

   **Option C: Compensating controls**
   ```bash
   # If must relax parameter
   # Add additional monitoring/restrictions
   # Example: Allow IP forward but strict firewall rules
   ```

**Never blindly rollback all hardening!**

**Heinrich:** *"Hardening breaks application? Two possibilities: 1) Application is shit ‚Äî fix application. 2) Application has legitimate need ‚Äî understand why, apply minimum exception, compensate with other controls. Full rollback? Never. That's surrender."*

</details>

---

## üîÑ –¶–∏–∫–ª 4: CIS Benchmarks Application (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 200-—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π PDF:**

**Heinrich:** *"CIS Benchmark Ubuntu 22.04 LTS. 194 controls. Level 1 ‚Äî basic security. Level 2 ‚Äî high security, CERN standard."*

–û–Ω –ª–∏—Å—Ç–∞–µ—Ç:
- 1.1 Filesystem Configuration  
- 1.5 Mandatory Access Control  
- 3.1 Network Configuration  
- 5.2 SSH Server Configuration  
- 6.1 System File Permissions  
...

**Heinrich:** *"Manual –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö 194 controls ‚Äî 40+ hours. Automation ‚Äî 6 hours. OpenSCAP –ø–æ–º–æ–≥–∞–µ—Ç."*

### üìö –¢–µ–æ—Ä–∏—è: CIS Benchmarks

#### –ß—Ç–æ —Ç–∞–∫–æ–µ CIS Benchmarks?

**CIS (Center for Internet Security)** ‚Äî non-profit organization creating security standards:

- Industry consensus-based
- Free to download
- Used globally for compliance
- Updated regularly
- Two levels: Basic (Level 1) –∏ High Security (Level 2)

**Coverage:**
- Operating Systems (Linux, Windows, macOS)
- Cloud (AWS, Azure, GCP)
- Databases (MySQL, PostgreSQL, MongoDB)
- Applications (Apache, Nginx, Docker)

#### CIS Levels

**Level 1 (Basic Security):**
- No impact –Ω–∞ business functionality
- Should be applied to ALL systems
- ~80-100 controls
- Example: Disable unused services, set permissions

**Level 2 (High Security):**
- May impact some functionality
- For high-security environments
- Additional ~100 controls
- Example: Restrictive network parameters, advanced logging

**CERN requirement:** Level 2 (90%+ compliance)

#### Key CIS Controls for Ubuntu

**1. Filesystem (CIS 1.x):**
```bash
# Disable unused filesystems
cat >> /etc/modprobe.d/cis.conf << EOF
install cramfs /bin/true
install freevxfs /bin/true
install jffs2 /bin/true
install hfs /bin/true
install hfsplus /bin/true
install udf /bin/true
EOF

# Ensure /tmp is configured
# Edit /etc/fstab or use systemd
```

**2. SSH (CIS 5.2):**
```bash
Protocol 2
PermitRootLogin no
PubkeyAuthentication yes
PasswordAuthentication no
PermitEmptyPasswords no
X11Forwarding no
MaxAuthTries 3
ClientAliveInterval 300
ClientAliveCountMax 0
```

**3. File Permissions (CIS 6.1):**
```bash
chmod 600 /etc/shadow
chmod 600 /etc/gshadow
chmod 644 /etc/passwd
chmod 644 /etc/group
chmod 600 /etc/ssh/sshd_config
chmod 644 /etc/hosts
chmod 644 /etc/crontab
```

**4. User Accounts (CIS 5.4):**
```bash
# /etc/login.defs
PASS_MAX_DAYS 90
PASS_MIN_DAYS 7
PASS_WARN_AGE 14
PASS_MIN_LEN 14

# PAM password requirements
# /etc/pam.d/common-password
password requisite pam_pwquality.so retry=3 minlen=14 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1
password required pam_pwhistory.so remember=5
```

#### Automated Compliance Checking

**OpenSCAP:**
```bash
sudo apt install libopenscap8

# Evaluate
oscap xccdf eval \
  --profile xccdf_org.ssgproject.content_profile_cis \
  /usr/share/xml/scap/ssg/content/ssg-ubuntu2204-ds.xml

# Generate report
oscap xccdf eval \
  --profile xccdf_org.ssgproject.content_profile_cis \
  --results-arf arf.xml \
  --report report.html \
  /usr/share/xml/scap/ssg/content/ssg-ubuntu2204-ds.xml
```

**Lynis CIS mode:**
```bash
sudo lynis audit system --tests-from-group cis
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: CIS Benchmarks

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **Download CIS Benchmark reference:**
```bash
# Use artifacts
cat artifacts/cis_benchmarks/cis_ubuntu_highlights.md | less
cat artifacts/cis_benchmarks/cis_checklist.md
```

2. **Run OpenSCAP compliance check:**
```bash
sudo apt install libopenscap8

# Quick eval
oscap xccdf eval \
  --profile xccdf_org.ssgproject.content_profile_cis \
  /usr/share/xml/scap/ssg/content/ssg-ubuntu2204-ds.xml \
  2>&1 | tee oscap_results.txt

# Count pass/fail
grep "Result.*pass" oscap_results.txt | wc -l
grep "Result.*fail" oscap_results.txt | wc -l
```

3. **Apply key CIS controls:**

```bash
# File permissions
sudo chmod 600 /etc/shadow /etc/gshadow
sudo chmod 644 /etc/passwd /etc/group

# SSH hardening
sudo cp starter/service-configs/sshd_config.hardened /etc/ssh/sshd_config
sudo systemctl restart sshd

# Disable unused filesystems
sudo nano /etc/modprobe.d/cis.conf
# Add disable commands

# Password policy
sudo nano /etc/login.defs
# PASS_MAX_DAYS 90
# PASS_MIN_DAYS 7
```

4. **Re-evaluate:**
```bash
# Run OpenSCAP again
oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_cis \
  /usr/share/xml/scap/ssg/content/ssg-ubuntu2204-ds.xml \
  2>&1 | tee oscap_after.txt

# Compare
diff oscap_results.txt oscap_after.txt
```

5. **Use CIS checklist:**
```bash
# Track progress
cp artifacts/cis_benchmarks/cis_checklist.md ~/cis_progress.md
# Mark completed items
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"CIS Benchmark 194 controls. Apply –≤—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–º?"*

<details>
<summary>ü§î Automation vs Understanding</summary>

**–û—Ç–≤–µ—Ç:** **Understand first, automate second.**

**–ü—Ä–æ–±–ª–µ–º–∞ —Å blind automation:**
- CIS control –º–æ–∂–µ—Ç –Ω–µ fit –≤–∞—à—É —Å—Ä–µ–¥—É
- –ú–æ–∂–µ—Ç break critical functionality
- Compliance ‚â† Security (–º–æ–∂–Ω–æ –±—ã—Ç—å compliant –Ω–æ insecure)

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**

**Phase 1: Understand (manual):**
```bash
# Read each control
# Understand what it does
# Assess if applicable
# Test impact
```

**Phase 2: Prioritize:**
```bash
# Critical applicable controls first
# Skip non-applicable (document why)
# Plan exceptions (with compensating controls)
```

**Phase 3: Automate (after validation):**
```bash
# ansible-playbook cis-hardening.yml
# But playbook –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å reviewed –∏ understood
```

**Example non-applicable control:**
```
CIS 1.1.22: Disable USB storage
```
If —ç—Ç–æ workstation –≥–¥–µ USB needed –¥–ª—è —Ä–∞–±–æ—Ç—ã:
- Skip control
- Document exception
- Compensating control: USB device whitelisting (USBGuard)

**Heinrich:** *"CIS Benchmarks ‚Äî excellent guide. –ù–æ –Ω–µ bible. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ controls –Ω–µ fit specific environment. Blind compliance script ‚Äî –æ–ø–∞—Å–Ω–æ. Understand, assess, apply intelligently. Compliance –±–µ–∑ understanding ‚Äî —ç—Ç–æ checkbox security. –í—ã–≥–ª—è–¥–∏—Ç —Ö–æ—Ä–æ—à–æ –Ω–∞ paper, fails –≤ reality."*

</details>

---

[–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç...]

*Part 2 of Episode 20 README*
*–¶–∏–∫–ª—ã 5-8 + —Ñ–∏–Ω–∞–ª –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏*
## üîÑ –¶–∏–∫–ª 5: Service Hardening (SSH, Apache, MySQL) (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich:** *"Kernel hardened. AppArmor configured. –ù–æ services still exposed. SSH, Apache, MySQL ‚Äî —ç—Ç–æ front door. Weak configuration = –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —É—Å–∏–ª–∏—è wasted."*

–û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç SSH config:
```bash
PermitRootLogin yes       # DANGER!
PasswordAuthentication yes # DANGER!
X11Forwarding yes          # DANGER!
```

**Heinrich:** *"–û–¥–∏–Ω weak SSH config ‚Äî –≤—Å—ë —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–æ. Service hardening –∫—Ä–∏—Ç–∏—á–µ–Ω."*

### üìö –¢–µ–æ—Ä–∏—è: Service-Specific Hardening

#### SSH Hardening (CIS 5.2)

**Critical settings:**
```bash
# /etc/ssh/sshd_config

## Protocol
Protocol 2  # SSH-1 vulnerable

## Authentication
PermitRootLogin no          # No root login
PubkeyAuthentication yes     # Keys only
PasswordAuthentication no    # Disable passwords
PermitEmptyPasswords no      # No empty passwords
MaxAuthTries 3               # Limit attempts

## Network
X11Forwarding no             # Disable X11
AllowTcpForwarding no        # Disable port forwarding (if not needed)

## Crypto (modern only)
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
KexAlgorithms curve25519-sha256,diffie-hellman-group14-sha256

## Access Control
AllowUsers admin@192.168.1.0/24  # Whitelist
DenyUsers root guest              # Blacklist

## Session
ClientAliveInterval 300     # Timeout idle
ClientAliveCountMax 0       # No keepalive

## Logging
LogLevel VERBOSE           # Detailed logs
```

#### Apache Hardening

**httpd.conf / apache2.conf:**
```apache
# Hide version info
ServerTokens Prod
ServerSignature Off

# Disable directory listing
<Directory /var/www/html>
    Options -Indexes +FollowSymLinks
    AllowOverride None
</Directory>

# Limit HTTP methods
<Directory /var/www/html>
    <LimitExcept GET POST>
        Require all denied
    </LimitExcept>
</Directory>

# Headers security
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-Content-Type-Options "nosniff"
Header always set X-XSS-Protection "1; mode=block"
Header always set Strict-Transport-Security "max-age=31536000"

# Disable trace
TraceEnable off

# Timeouts
Timeout 60
```

#### MySQL Hardening

**my.cnf:**
```ini
[mysqld]
# Network
bind-address = 127.0.0.1  # Local only (if possible)
skip-networking           # Disable TCP (if only local)

# Users
skip-show-database        # Hide DB list from users

# Logging
log-error = /var/log/mysql/error.log
log-warnings = 2

# Security
local-infile = 0          # Disable LOAD DATA INFILE

# Remove test database and anonymous users
# mysql_secure_installation
```

#### General Principles

1. **Disable unused features**
2. **Minimum privileges**
3. **Strong crypto only**
4. **Detailed logging**
5. **Network restrictions**
6. **Regular updates**

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Service Hardening

**–ó–∞–¥–∞–Ω–∏–µ:**

**1. SSH Hardening:**
```bash
# Backup original
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak

# Apply hardened config
sudo cp starter/service-configs/sshd_config.hardened /etc/ssh/sshd_config

# Test config (CRITICAL!)
sudo sshd -t

# Apply
sudo systemctl restart sshd

# KEEP current session open, test new session in another terminal!
```

**2. Apache Hardening (if applicable):**
```bash
# Hide version
echo "ServerTokens Prod" | sudo tee -a /etc/apache2/conf-available/security.conf
echo "ServerSignature Off" | sudo tee -a /etc/apache2/conf-available/security.conf

# Enable security headers module
sudo a2enmod headers

# Add headers
cat >> /etc/apache2/conf-available/security-headers.conf << 'EOF'
<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>
EOF

sudo a2enconf security-headers
sudo systemctl restart apache2
```

**3. MySQL Hardening:**
```bash
# Run secure installation
sudo mysql_secure_installation
# Remove anonymous users: Y
# Disallow root remote: Y
# Remove test database: Y

# Bind to localhost only
sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf
# bind-address = 127.0.0.1

sudo systemctl restart mysql
```

**4. Verify:**
```bash
# SSH
ssh -v user@localhost 2>&1 | grep -i "cipher\|mac\|kex"

# Apache
curl -I http://localhost | grep Server

# MySQL
sudo netstat -tlnp | grep mysql
# Should be 127.0.0.1:3306, not 0.0.0.0
```

---

## üîÑ –¶–∏–∫–ª 6: Network Hardening (Firewall) (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich:** *"–í—Å–µ services hardened. –ù–æ network still open. Firewall ‚Äî —ç—Ç–æ perimeter defense."*

```bash
sudo ufw status
# Status: inactive   # ‚Üê DANGER!
```

**Heinrich:** *"No firewall = no network security. Default deny policy –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω."*

### üìö –¢–µ–æ—Ä–∏—è: Firewall Configuration

#### UFW (Uncomplicated Firewall)

**Philosophy:** Default DENY, explicit ALLOW.

**Basic commands:**
```bash
# Enable
sudo ufw enable

# Default policies
sudo ufw default deny incoming
sudo ufw default allow outgoing

# Allow specific
sudo ufw allow 22/tcp    # SSH
sudo ufw allow from 192.168.1.0/24 to any port 22  # SSH from subnet

# Deny
sudo ufw deny 23/tcp    # Deny telnet

# Delete rule
sudo ufw delete allow 80/tcp

# Status
sudo ufw status numbered
```

#### Production Firewall Rules

**Principle:** Whitelist ONLY necessary.

```bash
# Reset
sudo ufw --force reset

# Defaults
sudo ufw default deny incoming
sudo ufw default deny outgoing  # Strict!
sudo ufw default deny routed

# Allow SSH (management)
sudo ufw allow from 192.168.1.0/24 to any port 22 proto tcp

# Allow HTTP/HTTPS (if web server)
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# Allow outgoing DNS, HTTP, HTTPS, NTP
sudo ufw allow out 53
sudo ufw allow out 80/tcp
sudo ufw allow out 443/tcp
sudo ufw allow out 123/udp

# Logging
sudo ufw logging on

# Enable
sudo ufw enable
```

#### iptables (Advanced)

For complex scenarios:
```bash
# Flush
sudo iptables -F

# Default DROP
sudo iptables -P INPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -P OUTPUT DROP

# Allow loopback
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT

# Allow established connections
sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Allow SSH from specific subnet
sudo iptables -A INPUT -p tcp -s 192.168.1.0/24 --dport 22 -j ACCEPT

# Allow HTTP/HTTPS out
sudo iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT

# Save
sudo iptables-save | sudo tee /etc/iptables/rules.v4
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Firewall Hardening

**–ó–∞–¥–∞–Ω–∏–µ:**

**1. Configure UFW:**
```bash
# Install
sudo apt install ufw

# Reset (start fresh)
sudo ufw --force reset

# Defaults (DENY all)
sudo ufw default deny incoming
sudo ufw default deny outgoing
sudo ufw default deny routed

# Essential rules
# SSH (replace with your management subnet!)
sudo ufw allow from 192.168.1.0/24 to any port 22

# DNS
sudo ufw allow out 53

# HTTP/HTTPS (outgoing for updates)
sudo ufw allow out 80/tcp
sudo ufw allow out 443/tcp

# NTP
sudo ufw allow out 123/udp

# Enable logging
sudo ufw logging medium

# Enable firewall
sudo ufw enable

# Verify
sudo ufw status verbose
```

**2. Test connectivity:**
```bash
# Should work (from allowed subnet)
ssh user@localhost

# Should work (outgoing)
curl -I https://ubuntu.com

# Should fail (blocked port)
telnet localhost 23
```

**3. Review logs:**
```bash
sudo tail -f /var/log/ufw.log
```

---

## üîÑ –¶–∏–∫–ª 7: Ansible Automation ‚Äî 50 Servers (30 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich:** *"Manual hardening ‚Äî 1 server, 6 hours. 50 servers ‚Äî 300 hours. Impossible."*

**Heinrich:** *"Ansible ‚Äî Infrastructure as Code. –û–¥–∏–Ω playbook. 50 servers. 6 hours. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç. –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ."*

–û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç playbook:
```yaml
- hosts: all
  tasks:
    - name: Apply sysctl hardening
      sysctl: ...
```

**Heinrich:** *"Episode 16 –∑–Ω–∞–Ω–∏—è. Ansible –¥–ª—è hardening. Production deployment."*

### üìö –¢–µ–æ—Ä–∏—è: IaC –¥–ª—è Hardening

#### Why Ansible for Hardening

**Benefits:**
- Consistent configuration (all servers identical)
- Reproducible (run again = same result)
- Version controlled (Git)
- Fast (parallel execution)
- Auditable (playbook = documentation)

#### Hardening Playbook Structure

```yaml
- name: Security Hardening
  hosts: all
  become: yes
  
  vars:
    cis_level: 2
    
  roles:
    - kernel_hardening
    - apparmor
    - service_hardening
    - firewall
    
  tasks:
    - name: Apply sysctl
      sysctl: ...
      
    - name: Deploy configs
      template: ...
      
    - name: Restart services
      systemd: ...
      
  handlers:
    - name: restart sshd
      systemd:
        name: sshd
        state: restarted
```

#### Best Practices

1. **Idempotent:** Safe to run multiple times
2. **Check mode:** Test before apply (`--check`)
3. **Tags:** Selective execution
4. **Validation:** Test configs before restart
5. **Rollback plan:** –ì–æ—Ç–æ–≤ revert

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Ansible Hardening Deployment

**–ó–∞–¥–∞–Ω–∏–µ:**

**1. Prepare playbook:**
```bash
cd starter/ansible/

# Edit inventory
nano inventory.ini
# Add your servers

# Review playbook
cat hardening-playbook.yml
```

**2. Test (dry-run):**
```bash
# Check mode (no changes)
ansible-playbook -i inventory.ini hardening-playbook.yml --check

# Limit to one server first
ansible-playbook -i inventory.ini hardening-playbook.yml --limit server01 --check
```

**3. Deploy to test server:**
```bash
# Single server
ansible-playbook -i inventory.ini hardening-playbook.yml --limit server01

# Verify
ssh server01 "sudo lynis audit system --quick"
```

**4. Deploy to all servers:**
```bash
# All servers (parallel)
ansible-playbook -i inventory.ini hardening-playbook.yml

# With specific tags only
ansible-playbook -i inventory.ini hardening-playbook.yml --tags sysctl,ssh
```

**5. Verification:**
```bash
# Check all servers
ansible all -i inventory.ini -m shell -a "sudo lynis audit system --quick" > audit_results.txt

# Parse results
grep "Hardening index" audit_results.txt
```

---

## üîÑ –¶–∏–∫–ª 8: Red Team Testing & Final Report (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç ‚Äî –î–µ–Ω—å 42, –≤–µ—á–µ—Ä

**Hardening complete. 50 servers.**

**–ê–ª–µ–∫—Å:** *"–í—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏ hardening. –¢–µ–ø–µ—Ä—å —è –ø—Ä–æ–±—É—é –≤–∑–ª–æ–º–∞—Ç—å. Real attack simulation."*

**Heinrich:** *"Red team testing ‚Äî final validation. If –ê–ª–µ–∫—Å breaks in ‚Äî hardening failed."*

–ê–ª–µ–∫—Å —Å–∞–¥–∏—Ç—Å—è –∑–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª. –ù–∞—á–∏–Ω–∞–µ—Ç –∞—Ç–∞–∫—É.

```
[01:00] SSH brute-force attempt... BLOCKED (fail2ban)
[01:15] SQL injection attempt... BLOCKED (AppArmor)
[01:30] Privilege escalation... BLOCKED (sudo restrictions)
[02:00] Kernel exploit attempt... BLOCKED (kernel hardening)
[02:30] Lateral movement... BLOCKED (firewall)
[03:00] Data exfiltration... BLOCKED (network restrictions)
```

**–ê–ª–µ–∫—Å (–ø–æ—Å–ª–µ 3 —á–∞—Å–æ–≤):** *"I can't get in. Properly hardened. Impressed."*

**Heinrich:** *"Red team validation ‚Äî passed. Infrastructure ready."*

---

### üìö –¢–µ–æ—Ä–∏—è: Red Team Validation

#### Why Red Team Testing?

**Validation methods:**
1. **Automated scanners** ‚Äî finds known vulns
2. **Penetration testing** ‚Äî human attempts
3. **Red team** ‚Äî adversarial simulation

**Red team best:**
- Real attack simulation
- Tests defense in depth
- Finds configuration errors
- Validates hardening effectiveness

#### Testing Methodology

**1. Reconnaissance:**
- Port scanning
- Service enumeration
- Version detection

**2. Initial Access:**
- SSH brute-force
- Web exploitation
- Known vulnerabilities

**3. Privilege Escalation:**
- sudo misconfigurations
- SUID binaries
- Kernel exploits

**4. Persistence:**
- Backdoor attempts
- Cron jobs
- SSH keys

**5. Defense Evasion:**
- AppArmor bypass attempts
- Log deletion
- Rootkits

**6. Lateral Movement:**
- Network pivoting
- Service exploitation

**7. Data Exfiltration:**
- Database dumps
- File transfers

#### Success Criteria

**Hardening —É—Å–ø–µ—à–µ–Ω –µ—Å–ª–∏:**
- ‚úÖ No initial access gained
- ‚úÖ Privilege escalation blocked
- ‚úÖ Persistence prevented
- ‚úÖ All attacks logged
- ‚úÖ Alerts triggered

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Red Team Test & Report

**–ó–∞–¥–∞–Ω–∏–µ:**

**1. Simulate attacks (safe environment!):**
```bash
# Port scan
nmap -sV -p- localhost

# SSH brute-force
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://localhost

# Web vulnerability scan
nikto -h http://localhost

# Privilege escalation check
sudo -l
find / -perm -4000 2>/dev/null  # SUID binaries
```

**2. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```markdown
## Red Team Test Results

**Date:** [Date]
**Duration:** [X hours]
**Tester:** [Name]

### Attack Attempts:

1. **SSH Brute-Force**
   - Status: BLOCKED
   - Protection: fail2ban + key-only auth
   
2. **Web Exploitation**
   - Status: BLOCKED
   - Protection: AppArmor profiles

3. **Privilege Escalation**
   - Status: BLOCKED
   - Protection: sudo restrictions + ASLR

### Conclusion:
All attacks blocked. Hardening effective.
```

**3. Create final hardening report:**
```bash
# Copy template
cp solution/hardening_report.md ~/final_hardening_report.md

# Fill in:
# - Baseline audit results
# - Applied configurations
# - Red team results
# - Recommendations
```

---

## üéØ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ

### –°—é–∂–µ—Ç ‚Äî –î–µ–Ω—å 42, 22:00

**–ú–∞–∫—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç final hardening report –í–∏–∫—Ç–æ—Ä—É.**

**–í–∏–∫—Ç–æ—Ä (—á–∏—Ç–∞–µ—Ç):**

*"Baseline: 68/100"*  
*"After hardening: 92/100"*  
*"50 servers deployed"*  
*"Red team test: PASSED"*  
*"Infrastructure: READY"*

–ü–∞—É–∑–∞.

**–í–∏–∫—Ç–æ—Ä:** *"–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞. Season 5 complete. –¢—ã –ø—Ä–æ—à—ë–ª –ø—É—Ç—å –æ—Ç audit –∫ hardening. –ó–Ω–∞–µ—à—å –∫–∞–∫ –∑–∞—â–∏—â–∞—Ç—å –∏ –∫–∞–∫ –∞—Ç–∞–∫–æ–≤–∞—Ç—å."*

**Heinrich:** *"92/100 ‚Äî CERN level. Production-ready. '–ù–æ–≤–∞—è –≠—Ä–∞' will have hard time."*

**–ê–ª–µ–∫—Å:** *"–Ø –ø—Ä–æ–±–æ–≤–∞–ª –≤—Å—ë. –ù–µ —Å–º–æ–≥ –ø—Ä–æ–Ω–∏–∫–Ω—É—Ç—å. Solid hardening."*

**–ê–Ω–Ω–∞:** *"Season 5 journey: Episode 17 ‚Äî –Ω–∞—à—ë–ª —É—è–∑–≤–∏–º–æ—Å—Ç–∏. Episode 18 ‚Äî –Ω–∞—É—á–∏–ª—Å—è –¥—É–º–∞—Ç—å –∫–∞–∫ —Ö–∞–∫–µ—Ä. Episode 19 ‚Äî —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–ª incident. Episode 20 ‚Äî —É–∫—Ä–µ–ø–∏–ª –≤—Å—ë. Complete security professional."*

**LILITH:** *"Season 5 –∑–∞–≤–µ—Ä—à—ë–Ω. Security expertise achieved. –¢—ã —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å:*
- *Audit —Å–∏—Å—Ç–µ–º—ã (Episode 17)*
- *Pentest –∫–∞–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª (Episode 18)*
- *Investigate incidents (Episode 19)*
- *Harden infrastructure (Episode 20)*

*–ù–æ –ø–æ–º–Ω–∏: security –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è. It's continuous process. Hardening —Å–µ–≥–æ–¥–Ω—è ‚Äî audit –∑–∞–≤—Ç—Ä–∞. –°–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞."*

**–ú–∞–∫—Å:** *"–Ø –≥–æ—Ç–æ–≤. –ü—É—Å—Ç—å '–ù–æ–≤–∞—è –≠—Ä–∞' –ø—Ä–∏—Ö–æ–¥–∏—Ç."*

**–í–∏–∫—Ç–æ—Ä:** *"–û–Ω–∏ –ø—Ä–∏–¥—É—Ç. Season 6, Season 7... Season 8 ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –±–∏—Ç–≤–∞. –ù–æ —Å–µ–π—á–∞—Å ‚Äî —Ç—ã –≥–æ—Ç–æ–≤."*

---

### –ò—Ç–æ–≥–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ ‚Äî Hardening Checklist

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**

- [ ] **Baseline audit –≤—ã–ø–æ–ª–Ω–µ–Ω**
  ```bash
  sudo lynis audit system --quick
  # Score recorded
  ```

- [ ] **AppArmor profiles —Å–æ–∑–¥–∞–Ω—ã**
  ```bash
  sudo aa-status | grep "profiles loaded"
  # At least 3 custom profiles
  ```

- [ ] **Kernel hardening –ø—Ä–∏–º–µ–Ω—ë–Ω**
  ```bash
  cat /etc/sysctl.d/99-hardening.conf
  # Minimum 10 parameters set
  ```

- [ ] **CIS Benchmarks applied**
  ```bash
  # At least 20 controls applied
  # Documented in checklist
  ```

- [ ] **Services hardened**
  ```bash
  # SSH key-only auth
  # Apache headers configured
  # MySQL local-only (if applicable)
  ```

- [ ] **Firewall configured**
  ```bash
  sudo ufw status
  # Default deny, explicit allow only necessary
  ```

- [ ] **Ansible playbook created**
  ```bash
  cat starter/ansible/hardening-playbook.yml
  # Tasks for all hardening steps
  ```

- [ ] **Final hardening report**
  ```bash
  cat ~/final_hardening_report.md
  # Includes: baseline, applied configs, test results
  ```

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

**–ú–∏–Ω–∏–º—É–º (Pass):**
- ‚úÖ Hardening index 80+ (–±—ã–ª–æ 68)
- ‚úÖ 3+ AppArmor profiles
- ‚úÖ Kernel hardening applied
- ‚úÖ SSH hardened (no root, keys only)
- ‚úÖ Firewall enabled (default deny)
- ‚úÖ Final report –Ω–∞–ø–∏—Å–∞–Ω

**–ò–¥–µ–∞–ª—å–Ω–æ (Excellence):**
- ‚úÖ Hardening index 90+ (CERN level!)
- ‚úÖ Full CIS Level 2 compliance
- ‚úÖ Ansible automation complete
- ‚úÖ Red team test passed
- ‚úÖ All 50 servers hardened
- ‚úÖ Comprehensive documentation

---

## üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã

```bash
cd ~/kernel-shadows/season-5-security-pentesting/episode-20-hardening
./tests/test.sh
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—Ç:
- Hardening configs –Ω–∞–ª–∏—á–∏–µ
- Firewall status
- Service configurations
- Final report

---

## üìö –†–µ—Å—É—Ä—Å—ã

### Standards & Benchmarks
- **CIS Benchmarks:** https://www.cisecurity.org/cis-benchmarks/
- **NIST Cybersecurity Framework:** https://www.nist.gov/cyberframework
- **OWASP:** https://owasp.org/

### Tools
- **Lynis:** https://cisofy.com/lynis/
- **OpenSCAP:** https://www.open-scap.org/
- **AppArmor:** https://gitlab.com/apparmor/apparmor/-/wikis/home

### Books
- "Security Engineering" (Ross Anderson)
- "Linux Hardening in Hostile Networks"
- "Practical Unix & Internet Security"

---

## üéì –ò—Ç–æ–≥–∏ Episode 20

### –ß—Ç–æ –∏–∑—É—á–∏–ª–∏

**–¢–µ–æ—Ä–∏—è:**
- ‚úÖ Security hardening methodology
- ‚úÖ Defense in depth principles
- ‚úÖ CIS Benchmarks framework
- ‚úÖ Compliance vs Security

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- ‚úÖ AppArmor ‚Äî MAC profiles
- ‚úÖ sysctl ‚Äî kernel hardening
- ‚úÖ Lynis/OpenSCAP ‚Äî compliance
- ‚úÖ UFW/iptables ‚Äî firewalling
- ‚úÖ Ansible ‚Äî IaC automation

**–ù–∞–≤—ã–∫–∏:**
- ‚úÖ Baseline security audit
- ‚úÖ Profile creation (AppArmor)
- ‚úÖ Kernel parameter tuning
- ‚úÖ Service hardening (SSH, Apache, MySQL)
- ‚úÖ Network security (firewall)
- ‚úÖ Automation (Ansible)
- ‚úÖ Red team validation

---

## üèÜ SEASON 5 COMPLETE!

### Season 5 Journey

**Episode 17: Security Auditing**
- Lynis, nmap, AIDE, fail2ban
- Found vulnerabilities
- Defensive mindset

**Episode 18: Penetration Testing**
- Burp Suite, sqlmap, metasploit
- Exploitation techniques
- Offensive mindset

**Episode 19: Incident Response**
- auditd, ELK, osquery, Volatility
- APT investigation
- Forensics mindset

**Episode 20: Security Hardening**
- AppArmor, sysctl, CIS, Ansible
- Infrastructure —É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ
- Production mindset

### Skills Achieved

**–ú–∞–∫—Å —Ç–µ–ø–µ—Ä—å:**
- üîç **Auditor** ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- üéØ **Pentester** ‚Äî –¥—É–º–∞–µ—Ç –∫–∞–∫ —Ö–∞–∫–µ—Ä
- üî¨ **Investigator** ‚Äî —Ä–∞—Å—Å–ª–µ–¥—É–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
- üõ°Ô∏è **Hardener** ‚Äî —É–∫—Ä–µ–ø–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º—ã

**Complete Security Professional! üéâ**

---

### –§–∏–Ω–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞

**Dr. Heinrich Bauer:** *"CERN paranoia level 100 ‚Äî —ç—Ç–æ –Ω–µ paranoia. –≠—Ç–æ professional caution. –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è. 50 —Å–µ—Ä–≤–µ—Ä–æ–≤ hardened –∑–∞ 48 —á–∞—Å–æ–≤. Red team can't break in. Production-ready. Impressed."*

**–ê–ª–µ–∫—Å:** *"Episode 17 —Ç—ã –±—ã–ª student. Episode 20 ‚Äî colleague. –Ø –Ω–µ —Å–º–æ–≥ –≤–∑–ª–æ–º–∞—Ç—å —Ç–≤–æ–π hardening. Respect."*

**–ê–Ω–Ω–∞:** *"Season 5 ‚Äî —ç—Ç–æ –±—ã–ª –≤–∞—à MBA in cybersecurity. Audit, Pentest, IR, Hardening. Full lifecycle. –¢—ã —Ç–µ–ø–µ—Ä—å blue team –∏ red team. Both."*

**–í–∏–∫—Ç–æ—Ä:** *"Season 5 complete. Infrastructure secure. Team trained. '–ù–æ–≤–∞—è –≠—Ä–∞' –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –∞—Ç–∞–∫—É. –ù–æ –º—ã –≥–æ—Ç–æ–≤—ã. Season 6-8 ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –±–∏—Ç–≤–∞. –ù–æ foundation laid –∑–¥–µ—Å—å. –í Season 5."*

**LILITH:** *"Security ‚Äî —ç—Ç–æ never-ending journey. Audit ‚Üí Find ‚Üí Fix ‚Üí Harden ‚Üí Monitor ‚Üí Audit again. Circle. Forever.*

*Episode 20 ‚Äî —ç—Ç–æ –Ω–µ –∫–æ–Ω–µ—Ü. –≠—Ç–æ beginning of continuous security. Hardening index 92. –•–æ—Ä–æ—à–æ. –ù–æ –∑–∞–≤—Ç—Ä–∞ ‚Äî audit —Å–Ω–æ–≤–∞. New vulnerabilities. New threats. Security professionals never rest.*

*–ù–æ —Å–µ–π—á–∞—Å ‚Äî –æ—Ç–¥–æ—Ö–Ω–∏. Season 5 –∑–∞–≤–µ—Ä—à—ë–Ω. –¢—ã earned it."*

---

> **"Security is not a product, but a process. Not a destination, but a journey. Episode 20 taught you the process. Now walk the journey."** ‚Äî Dr. Heinrich Bauer

---

**Status:** Episode 20 COMPLETE ‚úÖ  
**Season 5:** COMPLETE ‚úÖ‚úÖ‚úÖ‚úÖ  
**Next:** [Season 6: Embedded Linux & IoT Security](../../season-6-embedded-iot/)  
**Course:** [KERNEL SHADOWS](../../../../)

---

*Defense in depth. Hardening in breadth. Security forever.*
