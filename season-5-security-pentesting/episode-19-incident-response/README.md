# Episode 19: Incident Response & Digital Forensics

> *"–ö–∞–∂–¥—ã–π –ª–æ–≥ ‚Äî —É–ª–∏–∫–∞. –ö–∞–∂–¥—ã–π timestamp ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ. –ù–∞–π–¥–∏ –∏—Ö —Å–ª–µ–¥."* ‚Äî Isabella Rossi

```
Season 5: Security & Pentesting  
Episode 19 of 32
Location: Geneva üá®üá≠, Switzerland (Interpol HQ + CERN)
Days: 39-40 of Operation KERNEL SHADOWS
Duration: 12-15 hours
Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
Type: Configuration (Type B) ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SIEM –∏ forensics tools
```

---

## üìã –û–±–∑–æ—Ä

### –ß—Ç–æ –≤—ã –∏–∑—É—á–∏—Ç–µ

–í —ç—Ç–æ–º —ç–ø–∏–∑–æ–¥–µ –≤—ã –ø—Ä–æ–≤–µ–¥—ë—Ç–µ **—Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ APT –∞—Ç–∞–∫–∏** –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- üîç **auditd** ‚Äî Linux Audit Framework (—Å–∏—Å—Ç–µ–º–Ω—ã–π –∞—É–¥–∏—Ç)
- üìä **ELK Stack** ‚Äî Elasticsearch + Logstash + Kibana (SIEM)
- üîé **osquery** ‚Äî SQL-powered endpoint monitoring
- üíæ **Volatility** ‚Äî memory forensics (demo)
- üìù **journalctl, ausearch** ‚Äî –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

**–ù–∞–≤—ã–∫–∏:**
- Incident response methodology (NIST framework)
- Log analysis –∏ correlation
- Timeline reconstruction
- Digital forensics
- SIEM configuration
- Threat hunting
- Forensic reporting

**–í–∞–∂–Ω–æ:** –≠—Ç–æ **–ù–ï bash scripting —ç–ø–∏–∑–æ–¥!** –í—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ SIEM –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ. Type B ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è.

---

## üé¨ –°—é–∂–µ—Ç: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç

### –î–µ–Ω—å 39, 03:47 ‚Äî –¢—Ä–µ–≤–æ–≥–∞

–¢–µ–ª–µ—Ñ–æ–Ω –ú–∞–∫—Å–∞ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç –∑–≤–æ–Ω–∫–æ–≤.

**–ê–Ω–Ω–∞ (–∫—Ä–∏—á–∏—Ç, –ø–∞–Ω–∏–∫–∞ –≤ –≥–æ–ª–æ—Å–µ):** *"–ú–ê–ö–°! –°–µ—Ä–≤–µ—Ä –≤ –°—Ç–æ–∫–≥–æ–ª—å–º–µ! –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω! APT –∞—Ç–∞–∫–∞! –û–Ω–∏ –í–ù–£–¢–†–ò! –ü—Ä—è–º–æ –°–ï–ô–ß–ê–°!"*

–ú–∞–∫—Å –≤—Å–∫–∞–∫–∏–≤–∞–µ—Ç. Laptop –≤–∫–ª—é—á–∞–µ—Ç—Å—è.

```
CRITICAL ALERT: Stockholm Server
Status: COMPROMISED
Threat: APT Group "–ù–æ–≤–∞—è –≠—Ä–∞"
Action: Active Data Exfiltration
Time to Full Compromise: ~6 hours
```

**–í–∏–∫—Ç–æ—Ä** (—ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫, 03:50): *"–≠—Ç–æ –ø–æ–ª–∫–æ–≤–Ω–∏–∫ –ö—Ä—ã–ª–æ–≤. –û–Ω –Ω–∞—à—ë–ª –Ω–∞—Å. '–ù–æ–≤–∞—è –≠—Ä–∞' –≤–Ω—É—Ç—Ä–∏ –Ω–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ú–∞–∫—Å, —Ç–µ–±–µ –Ω—É–∂–Ω–æ –≤ –ñ–µ–Ω–µ–≤—É. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ."*

**–ú–∞–∫—Å:** *"–ß—Ç–æ... –∫–∞–∫ –æ–Ω–∏..."*

**–í–∏–∫—Ç–æ—Ä:** *"–í–æ–ø—Ä–æ—Å—ã –ø–æ—Ç–æ–º. –°–µ–π—á–∞—Å ‚Äî forensics. Isabella Rossi –∏–∑ Interpol –∂–¥—ë—Ç —Ç–µ–±—è. –û–Ω–∞ –≤–∏–¥–µ–ª–∞ –∏—Ö –ø–æ—á–µ—Ä–∫ —Ä–∞–Ω—å—à–µ. –õ–µ—Ç–∏—à—å —á–µ—Ä–µ–∑ —á–∞—Å. –ë–∏–ª–µ—Ç –Ω–∞ –ø–æ—á—Ç–µ."*

---

### –î–µ–Ω—å 39, 10:15 ‚Äî Interpol HQ, –ñ–µ–Ω–µ–≤–∞

–û–≥—Ä–æ–º–Ω—ã–π building, security –ø–æ–≤—Å—é–¥—É. –ú–∞–∫—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç 5 checkpoints.

**Isabella Rossi** ‚Äî sharp eyes, Italian accent, 15 –ª–µ—Ç –≤ Interpol Cybercrime Unit. –í—Å—Ç—Ä–µ—á–∞–µ—Ç –≤ forensics –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏.

**Isabella:** *"Max Sokolov? I'm Isabella. We have 6 hours before they own everything. APT –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—ã. –Ø –≤–∏–¥–µ–ª–∞ –∏—Ö —Ä–∞–±–æ—Ç—É –≤ Italy, Germany, —Ç–µ–ø–µ—Ä—å –∑–¥–µ—Å—å."*

–û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–∫—Ä–∞–Ω—ã:

```
Stockholm Server Timeline:
22:15 - Suspicious login from 185.220.101.47
22:23 - Kernel module loaded (rootkit.ko)
22:30 - Root access established
22:45 - Database dump started
23:12 - Data exfiltration: 2.3 GB
02:30 - Service stopped (cleanup attempt)
03:15 - Backdoor still active
```

**Isabella:** *"Episode 17 –±—ã–ª audit. Episode 18 ‚Äî pentest. Episode 19 ‚Äî war. –†–µ–∞–ª—å–Ω–∞—è –∞—Ç–∞–∫–∞. –†–µ–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è."*

**–ú–∞–∫—Å:** *"–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?"*

**Isabella:** *"Incident response. 6 —Ñ–∞–∑: Preparation, Detection, Containment, Eradication, Recovery, Lessons Learned. –£ –Ω–∞—Å –ø—Ä–æ–ø—É—â–µ–Ω—ã –ø–µ—Ä–≤—ã–µ –¥–≤–µ. –ù–∞—á–∏–Ω–∞–µ–º —Å Containment."*

–û–Ω–∞ –≤–≤–æ–¥–∏—Ç –∫–æ–º–∞–Ω–¥—É:

```bash
ssh -i incident_key stockholm-srv
```

**Isabella:** *"–°–µ—Ä–≤–µ—Ä –µ—â—ë –∞–∫—Ç–∏–≤–µ–Ω. –ù–æ backdoor —Ç–∞–º. –î–µ–π—Å—Ç–≤—É–µ–º –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ. –ö–∞–∂–¥—ã–π –ª–æ–≥ ‚Äî —É–ª–∏–∫–∞. –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ. Digital forensics –∫–∞–∫ —Ä–∞–±–æ—Ç–∞ –¥–µ—Ç–µ–∫—Ç–∏–≤–∞."*

---

### CERN Security Lab ‚Äî 12:00

**Dr. Heinrich Bauer** (CERN security architect) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ CERN forensics –ª–∞–±–µ.

**Heinrich:** *"Interpol –∑–∞–ø—Ä–æ—Å–∏–ª –Ω–∞—à—É –ø–æ–º–æ—â—å. –£ –Ω–∞—Å –ª—É—á—à–∏–µ forensics tools –≤ Europe. Isabella, Max ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á—Ç–æ –Ω—É–∂–Ω–æ."*

–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è: 20+ —Å–µ—Ä–≤–µ—Ä–æ–≤, ELK Stack, Volatility, –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–∏—Ä–∞.

**–ê–Ω–Ω–∞** (–ø—Ä–∏–µ–∑–∂–∞–µ—Ç –≤ 14:00): *"–Ø blue team lead. –≠—Ç–æ –º–æ—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è. –ü–æ–∫–∞–∂—É forensics process."*

---

### 16 —á–∞—Å–æ–≤ non-stop —Ä–∞–±–æ—Ç—ã

–ú–∞–∫—Å, Isabella, –ê–Ω–Ω–∞ ‚Äî –∫–æ–º–∞–Ω–¥–∞. –¶–µ–ª—å: –Ω–∞–π—Ç–∏ –í–°–Å.

**Timeline:**
- **12:00-15:00:** Log analysis (journalctl, auth.log, syslog)
- **15:00-18:00:** Auditd configuration (–¥–ª—è –±—É–¥—É—â–∏—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤)
- **18:00-21:00:** ELK Stack setup (centralized logging)
- **21:00-23:00:** Osquery threat hunting
- **23:00-02:00:** Memory forensics (Volatility demo)
- **02:00-04:00:** Timeline reconstruction
- **04:00-06:00:** Forensic report writing

**–ù–∞—Ö–æ–¥–∫–∏:**
- ‚úÖ Initial access: phishing email ‚Üí credentials stolen
- ‚úÖ Backdoor: `/tmp/.hidden/update.sh` (persistence —á–µ—Ä–µ–∑ cron)
- ‚úÖ Rootkit: `/tmp/.hidden/rootkit.ko` (kernel module)
- ‚úÖ Keylogger: `/tmp/.hidden/keylogger` ‚Üí `/tmp/.hidden/.keys`
- ‚úÖ Data exfiltration: 2.3 GB –∫ C2 —Å–µ—Ä–≤–µ—Ä `185.220.101.47`
- ‚úÖ Lateral movement: –ø–æ–ø—ã—Ç–∫–∏ SSH –∫ –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º (–Ω–µ—É–¥–∞—á–Ω–æ)

**Isabella:** *"–ú—ã –Ω–∞—à–ª–∏ –≤—Å—ë. Timeline complete. Evidence preserved. –¢–µ–ø–µ—Ä—å eradication –∏ recovery."*

**LILITH** (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è): *"Forensics ‚Äî —ç—Ç–æ puzzle. –ê—Ç–∞–∫—É—é—â–∏–π –¥—É–º–∞–ª —á—Ç–æ —Å–∫—Ä—ã–ª —Å–ª–µ–¥—ã. –£–¥–∞–ª–∏–ª –ª–æ–≥–∏. –ù–æ –∑–∞–±—ã–ª –ø—Ä–æ auditd. –ü—Ä–æ kernel logs. –ü—Ä–æ network connections. –í—Å–µ–≥–¥–∞ –æ—Å—Ç–∞—é—Ç—Å—è —Å–ª–µ–¥—ã. –¢—ã –∏—Ö –Ω–∞—à—ë–ª."*

---

### –î–µ–Ω—å 40, 06:30 ‚Äî –§–∏–Ω–∞–ª

**–ú–∞–∫—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç forensic report –í–∏–∫—Ç–æ—Ä—É.**

**–í–∏–∫—Ç–æ—Ä:** *"–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞. –í—Å–µ backdoors –Ω–∞–π–¥–µ–Ω—ã. Eradication –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. Recovery –∑–∞–π–º—ë—Ç —Å—É—Ç–∫–∏."*

**Isabella:** *"Professional level forensics, Max. –¢—ã work like Interpol investigator. Impressed."*

**–ê–Ω–Ω–∞:** *"–≠—Ç–æ –±—ã–ª–∞ real APT group. Advanced Persistent Threat. –¢—ã —Å–ø—Ä–∞–≤–∏–ª—Å—è. Incident response ‚Äî —Ç–µ–ø–µ—Ä—å —Ç–≤–æ–π skill."*

**Heinrich:** *"Episode 19 –∑–∞–∫–æ–Ω—á–µ–Ω. –ù–æ Episode 20 ‚Äî hardening. –ß—Ç–æ–±—ã —ç—Ç–æ –Ω–µ –ø–æ–≤—Ç–æ—Ä–∏–ª–æ—Å—å."*

---

## üéì –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–ø–∏–∑–æ–¥–∞: 8 –º–∏–∫—Ä–æ-—Ü–∏–∫–ª–æ–≤

–ö–∞–∂–¥—ã–π —Ü–∏–∫–ª = 20-30 –º–∏–Ω—É—Ç:
- üé¨ –°—é–∂–µ—Ç (2-3 –º–∏–Ω) ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
- üìö –¢–µ–æ—Ä–∏—è (10-15 –º–∏–Ω) ‚Äî –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- üíª –ü—Ä–∞–∫—Ç–∏–∫–∞ (7-10 –º–∏–Ω) ‚Äî hands-on forensics
- ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω) ‚Äî forensics –≤–æ–ø—Ä–æ—Å

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~3 —á–∞—Å–∞ —Ç–µ–æ—Ä–∏–∏ + 8-10 —á–∞—Å–æ–≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è + 2 —á–∞—Å–∞ –Ω–∞ –æ—Ç—á—ë—Ç = 13-15 —á–∞—Å–æ–≤

---

## üîÑ –¶–∏–∫–ª 1: Incident Response Methodology (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Isabella –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç NIST Incident Response framework diagram.**

**Isabella:** *"Incident response ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å. 6 —Ñ–∞–∑. –ü—Ä–æ–ø—É—Å—Ç–∏ –æ–¥–Ω—É ‚Äî –ø—Ä–æ–≤–∞–ª."*

```
1. Preparation     ‚Üí –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –¥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
2. Detection       ‚Üí –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫–∏
3. Containment     ‚Üí –ò–∑–æ–ª—è—Ü–∏—è —É–≥—Ä–æ–∑—ã
4. Eradication     ‚Üí –£–¥–∞–ª–µ–Ω–∏–µ malware
5. Recovery        ‚Üí –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º
6. Lessons Learned ‚Üí –ê–Ω–∞–ª–∏–∑ –∏ —É–ª—É—á—à–µ–Ω–∏—è
```

**Isabella:** *"–ú—ã —É–∂–µ –Ω–∞ —Ñ–∞–∑–µ 3. Preparation –∏ Detection ‚Äî failed. –ü–æ—ç—Ç–æ–º—É —Ç–∞–∫ –∫—Ä–∏—Ç–∏—á–Ω–æ."*

### üìö –¢–µ–æ—Ä–∏—è: NIST Incident Response Framework

#### –ß—Ç–æ —Ç–∞–∫–æ–µ Incident Response?

**Incident Response (IR)** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ security incidents –¥–ª—è:
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ damage
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±—É–¥—É—â–∏—Ö –∞—Ç–∞–∫
- –°–±–æ—Ä–∞ forensic evidence

**–û—Ç–ª–∏—á–∏—è –æ—Ç Penetration Testing:**

| Pentest (Episode 18) | Incident Response (Episode 19) |
|----------------------|-------------------------------|
| Controlled simulation | Real attack |
| Find vulnerabilities | Respond to breach |
| Before attack | During/After attack |
| Offensive | Defensive |
| PoC exploit | Contain & Eradicate |

#### üè† –ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ü–æ–∂–∞—Ä–Ω—ã–µ vs –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**Incident Response —ç—Ç–æ:**
- –ö–∞–∫ –ø–æ–∂–∞—Ä–Ω—ã–µ —Ç—É—à–∞—Ç –æ–≥–æ–Ω—å –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°
- –°–ø–∞—Å–∞—é—Ç —á—Ç–æ –º–æ–∂–Ω–æ
- –ù–∞—Ö–æ–¥—è—Ç –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ–∂–∞—Ä–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ

**–ù–ï Incident Response:**
- –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–≥–Ω–µ—Ç—É—à–∏—Ç–µ–ª–∏ (—ç—Ç–æ audit)
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ–∂–∞—Ä–Ω—É—é —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—é (—ç—Ç–æ pentest)

#### 6 —Ñ–∞–∑ NIST Incident Response

**1. Preparation (–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞)**

BEFORE –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞:
- Incident response plan
- Tools –≥–æ—Ç–æ–≤—ã (SIEM, forensics)
- Team trained
- Contacts list (–∫–æ–º—É –∑–≤–æ–Ω–∏—Ç—å)
- Backup –∏ recovery procedures

**–ü—Ä–∏–º–µ—Ä:**
```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- Auditd –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ELK Stack —Ä–∞–±–æ—Ç–∞–µ—Ç
- Osquery –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç
- Backup –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
- IR playbook –≥–æ—Ç–æ–≤
```

**2. Detection & Analysis (–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ)**

–û–±–Ω–∞—Ä—É–∂–∏—Ç—å –∞—Ç–∞–∫—É –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω—å—à–µ:
- SIEM alerts
- IDS/IPS notifications
- User reports
- Log analysis

**Indicators of Compromise (IoC):**
- Suspicious IPs
- Malware hashes
- Unusual processes
- Network anomalies

**–ü—Ä–∏–º–µ—Ä:**
```bash
# SIEM alert
CRITICAL: Multiple failed logins from 185.220.101.47
CRITICAL: Kernel module loaded: rootkit.ko
CRITICAL: Unusual outbound traffic: 2.3 GB to unknown IP
```

**3. Containment (–ò–∑–æ–ª—è—Ü–∏—è)**

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ:
- **Short-term:** –ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å affected systems
- **Long-term:** Temporary patches, network segmentation

**–ü—Ä–∏–º–µ—Ä:**
```bash
# Short-term containment
sudo iptables -A OUTPUT -d 185.220.101.47 -j DROP  # Block C2
sudo systemctl stop suspicious-service              # Stop malware

# Long-term
# Segment network
# Change all passwords
# Revoke compromised keys
```

**4. Eradication (–£–¥–∞–ª–µ–Ω–∏–µ)**

–£–¥–∞–ª–∏—Ç—å threat –ø–æ–ª–Ω–æ—Å—Ç—å—é:
- Remove malware
- Close vulnerabilities
- Patch systems

**–ü—Ä–∏–º–µ—Ä:**
```bash
# Eradication
sudo rm /tmp/.hidden/update.sh        # Remove backdoor
sudo rmmod rootkit                    # Unload rootkit
sudo rm /etc/cron.d/persistence       # Remove persistence
sudo apt update && sudo apt upgrade   # Patch vulnerabilities
```

**5. Recovery (–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)**

–í–µ—Ä–Ω—É—Ç—å —Å–∏—Å—Ç–µ–º—ã –≤ production:
- Restore from clean backups
- Rebuild compromised systems
- Monitor for re-infection

**–ü—Ä–∏–º–µ—Ä:**
```bash
# Recovery
sudo systemctl stop stockholm-srv
# Restore from backup (Day 38 - before attack)
sudo rsync -avz /backup/stockholm-20241011/ /var/www/
sudo systemctl start stockholm-srv
# Enhanced monitoring for 30 days
```

**6. Lessons Learned (–£—Ä–æ–∫–∏)**

Post-incident review:
- What happened?
- What worked?
- What failed?
- How to prevent?

**–ü—Ä–∏–º–µ—Ä:**
```markdown
## Lessons Learned
**What happened:** Phishing ‚Üí weak password ‚Üí full compromise
**What worked:** Forensics found everything
**What failed:** No 2FA, weak monitoring
**Prevention:** Implement 2FA, strengthen auditd, better training
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Initial Triage

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **–ë—ã—Å—Ç—Ä—ã–π triage —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
# –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
cd artifacts/compromised_logs/

# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏–Ω—ã
grep "Accepted" auth.log | tail -10

# 2. –ù–∞–π–¥–∏—Ç–µ suspicious IP
grep -oE '\b[0-9]{1,3}(\.[0-9]{1,3}){3}\b' auth.log | sort | uniq -c | sort -rn

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–µ–æ–±—ã—á–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (–∏–∑ memory dump)
cat ../memory_dumps/process_dump.txt | grep -E "tmp|hidden|suspicious"

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ network connections
cat ../memory_dumps/network_connections.txt | grep ESTABLISHED
```

2. **–°–æ–∑–¥–∞–π—Ç–µ initial incident report:**
```markdown
## Incident Initial Assessment

**Date:** [–î–∞—Ç–∞]
**System:** Stockholm Server
**Status:** COMPROMISED

**Initial Findings:**
- Suspicious IP: [IP –∏–∑ –ª–æ–≥–æ–≤]
- Suspicious processes: [–°–ø–∏—Å–æ–∫]
- Active connections: [C2 connections]

**Immediate Actions:**
- [ ] Isolate server
- [ ] Block C2 IP
- [ ] Preserve evidence
```

**–ó–∞–ø–∏—à–∏—Ç–µ** –≤–∞—à–∏ –Ω–∞—Ö–æ–¥–∫–∏. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ —ç–ø–∏–∑–æ–¥–∞.

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"–û–±–Ω–∞—Ä—É–∂–∏–ª–∏ backdoor. –°—Ä–∞–∑—É —É–¥–∞–ª–∏—Ç—å?"*

<details>
<summary>ü§î Forensics vs Immediate Fix</summary>

**–û—Ç–≤–µ—Ç:** **–ù–ï–¢! –°–Ω–∞—á–∞–ª–∞ evidence preservation!**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ = –ø–æ—Ç–µ—Ä—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤
- Forensics —Ç—Ä–µ–±—É–µ—Ç preserving the scene
- Legal evidence –º–æ–∂–µ—Ç –±—ã—Ç—å —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∞

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
1. **Containment** ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å (–Ω–µ —É–¥–∞–ª—è—Ç—å!)
   ```bash
   sudo chmod 000 /tmp/.hidden/update.sh  # –ó–∞–ø—Ä–µ—Ç–∏—Ç—å execution
   sudo iptables -A OUTPUT -d C2_IP -j DROP  # Block C2
   ```

2. **Evidence Collection:**
   ```bash
   # Preserve file
   sudo cp /tmp/.hidden/update.sh /evidence/backdoor.sh
   md5sum /evidence/backdoor.sh > /evidence/backdoor.md5
   
   # Document
   ls -la /tmp/.hidden/update.sh >> /evidence/timeline.txt
   stat /tmp/.hidden/update.sh >> /evidence/file_metadata.txt
   ```

3. **Eradication** (–ü–û–°–õ–ï —Å–±–æ—Ä–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤):
   ```bash
   sudo rm /tmp/.hidden/update.sh
   ```

**Chain of Custody:**
- –ö—Ç–æ –Ω–∞—à—ë–ª
- –ö–æ–≥–¥–∞ –Ω–∞—à—ë–ª
- –ì–¥–µ –Ω–∞—à—ë–ª
- –ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏–ª
- –ö—Ç–æ –∏–º–µ–ª –¥–æ—Å—Ç—É–ø

**Isabella:** *"Digital forensics –∫–∞–∫ crime scene investigation. –ù–µ —Ç—Ä–æ–≥–∞–π —É–ª–∏–∫–∏ –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏. Evidence preservation ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è legal prosecution –∏ post-incident analysis."*

</details>

---

## üîÑ –¶–∏–∫–ª 2: Linux Log Analysis (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–Ω–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç terminal, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É.**

**–ê–Ω–Ω–∞:** *"–õ–æ–≥–∏ ‚Äî —ç—Ç–æ history –∫–Ω–∏–≥–∞ —Å–µ—Ä–≤–µ—Ä–∞. –í—Å—ë –∑–∞–ø–∏—Å–∞–Ω–æ. –õ–æ–≥–∏–Ω—ã, –ø—Ä–æ—Ü–µ—Å—Å—ã, –æ—à–∏–±–∫–∏, connections."*

–û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
```bash
sudo journalctl -u sshd --since "2024-10-12 22:00" --until "2024-10-13 04:00"
```

–≠–∫—Ä–∞–Ω –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–æ–≥–∞–º–∏. –¢—ã—Å—è—á–∏ —Å—Ç—Ä–æ–∫.

**–ê–Ω–Ω–∞:** *"–ò—â–µ–º patterns. Suspicious IPs. Failed attempts. Privilege escalation. Timeline."*

### üìö –¢–µ–æ—Ä–∏—è: Linux Logging System

#### Linux Logging Structure

**1. systemd-journald** (modern)
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π logging
- Binary format (efficient)
- Rich metadata

```bash
# View all logs
journalctl

# Specific service
journalctl -u sshd

# Time range
journalctl --since "2024-10-12 22:00" --until "2024-10-13 04:00"

# Follow live
journalctl -f

# Priority filter
journalctl -p err  # Errors only
```

**2. syslog** (traditional)
- Text-based logs
- `/var/log/` directory

**Key log files:**
```
/var/log/auth.log      # Authentication (Ubuntu/Debian)
/var/log/secure        # Authentication (RHEL/CentOS)
/var/log/syslog        # System messages
/var/log/kern.log      # Kernel messages
/var/log/apache2/      # Web server
/var/log/mysql/        # Database
```

**3. auditd** (security)
- Linux Audit Framework
- Detailed system call logging
- Compliance requirements (PCI, HIPAA)

```bash
# View audit logs
sudo ausearch -k <keyname>
sudo ausearch -ts recent

# Audit report
sudo aureport
```

#### Log Analysis Workflow

**–®–∞–≥ 1: Identify time window**
```bash
# –ö–æ–≥–¥–∞ –Ω–∞—á–∞–ª–∞—Å—å –∞—Ç–∞–∫–∞?
grep "185.220.101.47" /var/log/auth.log | head -1
```

**–®–∞–≥ 2: Extract events**
```bash
# –í—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ time window
awk '$0 ~ /Oct 12 22:/ || $0 ~ /Oct 12 23:/ || $0 ~ /Oct 13 00:/' /var/log/syslog
```

**–®–∞–≥ 3: Filter suspicious**
```bash
# Failed logins
grep -i "failed\|invalid" /var/log/auth.log

# Privilege escalation
grep -i "sudo\|su " /var/log/auth.log

# New processes
grep -i "exec\|command" /var/log/syslog
```

**–®–∞–≥ 4: Correlate**
```bash
# Combine multiple logs
cat /var/log/auth.log /var/log/syslog | sort -k1,3
```

#### Common Attack Patterns –≤ –ª–æ–≥–∞—Ö

**1. Brute-Force Attack:**
```
Oct 12 22:15:33 server sshd[15892]: Failed password for invalid user backup from 185.220.101.47
Oct 12 22:15:45 server sshd[15892]: Failed password for invalid user backup from 185.220.101.47
Oct 12 22:16:01 server sshd[15892]: Failed password for invalid user postgres from 185.220.101.47
```

**2. Successful Compromise:**
```
Oct 12 22:16:23 server sshd[15923]: Accepted password for dbuser from 185.220.101.47
```

**3. Privilege Escalation:**
```
Oct 12 22:16:25 server sudo: dbuser : TTY=pts/1 ; PWD=/home/dbuser ; USER=root ; COMMAND=/bin/bash
```

**4. Persistence:**
```
Oct 12 22:18:45 server CRON[16234]: (root) CMD (/tmp/.hidden/update.sh >/dev/null 2>&1)
```

**5. Rootkit:**
```
Oct 12 22:23:34 server kernel: [892345.234123] rootkit: loading out-of-tree module taints kernel.
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Log Hunting

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **–ê–Ω–∞–ª–∏–∑ auth.log:**
```bash
cd artifacts/compromised_logs/

# –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ failed login attempts
grep -i "failed" auth.log

# –ù–∞–π–¥–∏—Ç–µ successful login –æ—Ç attacker IP
grep "185.220.101.47" auth.log | grep "Accepted"

# –ù–∞–π–¥–∏—Ç–µ privilege escalation
grep "sudo.*root" auth.log
```

2. **–ê–Ω–∞–ª–∏–∑ syslog:**
```bash
# –ù–∞–π–¥–∏—Ç–µ rootkit loading
grep -i "rootkit" syslog

# –ù–∞–π–¥–∏—Ç–µ cron job execution
grep "CRON" syslog | grep "tmp"

# –ù–∞–π–¥–∏—Ç–µ suspicious service
grep -i "suspicious-service" syslog
```

3. **Timeline extraction:**
```bash
# Extract all events –≤ time window
grep "Oct 12 22:" auth.log syslog | sort > ~/incident_timeline.txt

# View
cat ~/incident_timeline.txt | less
```

4. **–°–æ–∑–¥–∞–π—Ç–µ log analysis summary:**
```markdown
## Log Analysis Summary

**Failed Logins:** [–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ]
**Successful Compromise:** [Timestamp]
**Privilege Escalation:** [Timestamp]
**Rootkit Loaded:** [Timestamp]
**Persistence Installed:** [Timestamp]
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"Attacker –æ—á–∏—Å—Ç–∏–ª /var/log/auth.log. –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è?"*

<details>
<summary>ü§î Log Recovery</summary>

**–û—Ç–≤–µ—Ç:** **–ò—Å–ø–æ–ª—å–∑—É–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏!**

**–õ–æ–≥–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö:**

1. **journalctl (systemd):**
   ```bash
   # –î–∞–∂–µ –µ—Å–ª–∏ text logs –æ—á–∏—â–µ–Ω—ã, journald —Ö—Ä–∞–Ω–∏—Ç
   sudo journalctl -u sshd --since "2024-10-12"
   ```

2. **auditd:**
   ```bash
   # Audit logs –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç syslog
   sudo ausearch -ts 10/12/2024 22:00:00
   ```

3. **SIEM (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω):**
   ```bash
   # Centralized logging (ELK, Splunk)
   # –õ–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ remote server
   ```

4. **last, lastlog:**
   ```bash
   # Login history
   last -f /var/log/wtmp
   lastlog
   ```

5. **Filesystem timestamps:**
   ```bash
   # –ö–æ–≥–¥–∞ —Ñ–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
   find / -type f -mtime -2 -ls 2>/dev/null
   ```

6. **Network logs:**
   ```bash
   # Firewall logs, router logs, IDS logs
   ```

**Defense in Depth logging:**
- ‚úÖ Local logs (journald, syslog)
- ‚úÖ Centralized SIEM (remote)
- ‚úÖ Auditd (tamper-resistant)
- ‚úÖ Network logs (separate infrastructure)

**–ê–Ω–Ω–∞:** *"–ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å local logs. –ù–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π SIEM –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ? Audit logs —Å immutable flag? Network captures? Always have backup logging. Defense in depth —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è firewall."*

</details>

---

## üîÑ –¶–∏–∫–ª 3: Auditd Configuration (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Isabella:** *"–õ–æ–≥–∏ –ø–æ–∫–∞–∑–∞–ª–∏ —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ. –ù–æ –ø–æ—á–µ–º—É –º—ã –Ω–µ –≤–∏–¥–µ–ª–∏ —Ä–∞–Ω—å—à–µ? –ü–æ—Ç–æ–º—É —á—Ç–æ auditd –Ω–µ –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω."*

–û–Ω–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/etc/audit/rules.d/`:

```bash
ls -la /etc/audit/rules.d/
# total 8
# drwxr-x--- 2 root root 4096 Jan  1 00:00 .
# drwxr-x--- 3 root root 4096 Jan  1 00:00 ..
# -rw-r----- 1 root root  555 Jan  1 00:00 audit.rules
```

**Isabella:** *"Default rules ‚Äî –ø–æ—á—Ç–∏ –ø—É—Å—Ç—ã–µ. –ú—ã –Ω–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–ª–∏ /tmp/, –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–ª–∏ kernel modules, –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞–ª–∏ sudo. Attack –±—ã–ª invisible."*

**Heinrich (–∏–∑ CERN):** *"–ü–æ—Å–ª–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ ‚Äî comprehensive auditd. –í—Å—ë –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º."*

### üìö –¢–µ–æ—Ä–∏—è: Linux Audit Framework (auditd)

#### –ß—Ç–æ —Ç–∞–∫–æ–µ auditd?

**Linux Audit Framework** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π:
- File access
- System calls
- User commands
- Network connections
- Security events

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω:**
- Compliance (PCI, HIPAA, SOX)
- Intrusion detection
- Forensic analysis
- Security monitoring

**vs syslog:**
| syslog | auditd |
|--------|--------|
| Application logs | System calls |
| Services | Kernel events |
| General info | Security focus |
| Easy to tamper | Tamper-resistant |

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ auditd

```
User Space:
  auditctl    ‚Üí Configure rules
  ausearch    ‚Üí Search logs
  aureport    ‚Üí Generate reports
  
Kernel Space:
  audit.ko    ‚Üí Kernel module
  
Logs:
  /var/log/audit/audit.log
```

#### Audit Rules Syntax

**–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç:**
```bash
-w PATH -p PERMISSIONS -k KEYNAME
```

**-w** (watch) ‚Äî path to monitor  
**-p** (permissions):
- `r` ‚Äî read
- `w` ‚Äî write
- `x` ‚Äî execute
- `a` ‚Äî attribute change

**-k** (key) ‚Äî tag –¥–ª—è –ø–æ–∏—Å–∫–∞

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# Monitor /etc/passwd
-w /etc/passwd -p wa -k passwd_changes

# Monitor /tmp/ directory
-w /tmp/ -p wa -k tmp_activity

# Monitor sudo
-w /usr/bin/sudo -p x -k sudo_execution
```

**System call rules:**
```bash
-a always,exit -F arch=b64 -S SYSCALL -k KEYNAME
```

**-a** (action) ‚Äî always/never  
**-F** (field) ‚Äî filter  
**-S** (syscall) ‚Äî system call

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# Monitor all execve (program execution)
-a always,exit -F arch=b64 -S execve -k execution

# Monitor file deletions
-a always,exit -F arch=b64 -S unlink,unlinkat -k file_deletion

# Monitor network connections
-a always,exit -F arch=b64 -S socket,connect -k network
```

#### Essential Audit Rules

**1. Authentication:**
```bash
-w /var/log/auth.log -p wa -k authentication
-w /etc/passwd -p wa -k passwd_changes
-w /etc/shadow -p wa -k shadow_changes
```

**2. Suspicious Activity:**
```bash
-w /tmp/ -p wa -k tmp_activity
-w /dev/shm/ -p wa -k shared_memory
```

**3. Kernel Modules:**
```bash
-a always,exit -F arch=b64 -S init_module,delete_module -k kernel_modules
-w /sbin/insmod -p x -k kernel_modules
-w /sbin/modprobe -p x -k kernel_modules
```

**4. Privilege Escalation:**
```bash
-w /usr/bin/sudo -p x -k sudo_execution
-w /etc/sudoers -p wa -k sudoers_changes
```

**5. Persistence:**
```bash
-w /etc/cron.d/ -p wa -k cron_jobs
-w /etc/rc.local -p wa -k persistence
-w /root/.ssh/authorized_keys -p wa -k ssh_keys
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ auditd

**Configure:**
```bash
# Edit rules
sudo nano /etc/audit/rules.d/audit.rules

# Load rules
sudo augenrules --load

# Restart
sudo systemctl restart auditd
```

**View logs:**
```bash
# Search by key
sudo ausearch -k tmp_activity

# Search by time
sudo ausearch -ts today

# Search by user
sudo ausearch -ua www-data
```

**Reports:**
```bash
# Summary
sudo aureport

# Failed events
sudo aureport -f

# Anomaly report
sudo aureport -a
```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Auditd Setup

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ auditd:**
```bash
sudo apt update
sudo apt install auditd audispd-plugins
```

2. **–°–æ–∑–¥–∞–π—Ç–µ custom rules:**
```bash
# Copy template
sudo cp starter/audit.rules.example /etc/audit/rules.d/incident-response.rules

# Or create manually
sudo nano /etc/audit/rules.d/incident-response.rules
```

–î–æ–±–∞–≤—å—Ç–µ –º–∏–Ω–∏–º—É–º —ç—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞:
```bash
# Authentication
-w /var/log/auth.log -p wa -k authentication

# Suspicious directories
-w /tmp/ -p wa -k tmp_activity

# Kernel modules
-a always,exit -F arch=b64 -S init_module -k kernel_modules

# Sudo
-w /usr/bin/sudo -p x -k sudo_execution
```

3. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ rules:**
```bash
sudo augenrules --load
sudo systemctl restart auditd
```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
```bash
# View active rules
sudo auditctl -l

# Test
touch /tmp/test_audit
sudo ausearch -k tmp_activity
```

5. **–ü—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ Episode 19 incident:**
```bash
# –ï—Å–ª–∏ –±—ã auditd –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –º—ã –±—ã —É–≤–∏–¥–µ–ª–∏:
sudo ausearch -k kernel_modules  # rootkit loading
sudo ausearch -k tmp_activity     # backdoor creation
sudo ausearch -k sudo_execution   # privilege escalation
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"Auditd –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–Ω–Ω—ã –ª–æ–≥–æ–≤. Performance impact?"*

<details>
<summary>ü§î Performance vs Security</summary>

**–û—Ç–≤–µ—Ç:** **–î–∞, –µ—Å—Ç—å impact. –ù–æ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π.**

**Performance considerations:**

**1. Buffer size:**
```bash
# Larger buffer = less overhead
-b 8192  # Default 320, increase for busy systems
```

**2. Rate limiting:**
```bash
# Limit messages/second
-r 100   # 0=unlimited (risky)
```

**3. Targeted rules:**
```bash
# ‚ùå Too broad
-a always,exit -F arch=b64 -S all -k everything

# ‚úÖ Specific
-a always,exit -F arch=b64 -S execve -k execution
-w /etc/passwd -p wa -k passwd_changes
```

**4. Filtering:**
```bash
# Exclude noisy processes
-a never,exit -F exe=/usr/bin/cron
```

**5. Log rotation:**
```bash
# /etc/audit/auditd.conf
max_log_file = 50     # MB
num_logs = 5          # Rotate 5 files
```

**Benchmarks (—Ç–∏–ø–∏—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä):**
- Default rules: ~1-2% CPU overhead
- Comprehensive rules: ~5-10% CPU overhead
- Kernel call intensive: –¥–æ 20% (—Ä–µ–¥–∫–æ)

**Trade-off:**
- **Development:** Minimal auditd
- **Production (normal):** Essential rules only
- **High-security:** Comprehensive monitoring
- **Incident Response:** EVERYTHING (temporary)

**Isabella:** *"During normal operations ‚Äî balanced rules. During incident ‚Äî enable everything, performance –Ω–µ –≤–∞–∂–Ω–∞. –ü–æ—Å–ª–µ eradication ‚Äî return to baseline. Security vs Performance ‚Äî —ç—Ç–æ trade-off, –Ω–æ –≤ incident response security wins."*

</details>

---

## üîÑ –¶–∏–∫–ª 4: ELK Stack ‚Äî Centralized Logging (30 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Heinrich –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç CERN ELK Stack dashboard.**

–û–≥—Ä–æ–º–Ω—ã–π —ç–∫—Ä–∞–Ω: –≥—Ä–∞—Ñ–∏–∫–∏, real-time –ª–æ–≥–∏, alerts, –∫—Ä–∞—Å–∏–≤–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è.

**Heinrich:** *"20,000+ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ CERN. –ú—ã –Ω–µ –º–æ–∂–µ–º –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –Ω–∞ –∫–∞–∂–¥–æ–º. ELK Stack ‚Äî centralized SIEM. –í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ."*

–û–Ω –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ Kibana dashboard:
```
Timeline: Last 24 hours
Events: 2.3 million
Alerts: 47 critical
Top Source IPs: [list]
```

**Heinrich:** *"Real-time correlation. –ê—Ç–∞–∫–∞ –Ω–∞ Stockholm ‚Äî –º—ã —É–≤–∏–¥–µ–ª–∏ –±—ã –≤ 22:15, –Ω–µ –≤ 03:47. 5 —á–∞—Å–æ–≤ —Ä–∞–Ω—å—à–µ."*

**–ú–∞–∫—Å:** *"–ö–∞–∫ —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å?"*

**Heinrich:** *"Elasticsearch —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ. Logstash –ø–∞—Ä—Å–∏—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç. Kibana –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç. Classic SIEM stack. –ü–æ–∫–∞–∂—É."*

### üìö –¢–µ–æ—Ä–∏—è: ELK Stack (Elasticsearch, Logstash, Kibana)

#### –ß—Ç–æ —Ç–∞–∫–æ–µ ELK Stack?

**ELK** ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω–∞—è open-source SIEM –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞:

**E**lasticsearch ‚Äî search and analytics engine (—Ö—Ä–∞–Ω–∏–ª–∏—â–µ)  
**L**ogstash ‚Äî log pipeline (–æ–±—Ä–∞–±–æ—Ç–∫–∞)  
**K**ibana ‚Äî visualization (dashboard)

**+ Beats** ‚Äî log shippers (optional)

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Servers (–º–Ω–æ–∂–µ—Å—Ç–≤–æ)
    ‚Üì (logs via syslog/filebeat)
Logstash (parse, filter, enrich)
    ‚Üì (JSON documents)
Elasticsearch (index, store, search)
    ‚Üì (queries)
Kibana (visualize, dashboard, alerts)
    ‚Üì
Analyst (you)
```

#### 1. Elasticsearch

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** Distributed search and analytics engine

**–û—Å–Ω–æ–≤—ã:**
- –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ JSON documents
- Full-text search
- Real-time indexing
- Distributed (scale horizontally)

**–ü—Ä–∏–º–µ—Ä document:**
```json
{
  "@timestamp": "2024-10-12T22:16:23Z",
  "source_ip": "185.220.101.47",
  "event_type": "ssh_login",
  "user": "dbuser",
  "result": "success",
  "severity": "critical"
}
```

**Queries:**
```bash
# Search
curl -X GET "localhost:9200/incident-*/_search?q=source_ip:185.220.101.47"

# Aggregations
curl -X GET "localhost:9200/incident-*/_search" -H 'Content-Type: application/json' -d'
{
  "aggs": {
    "top_ips": {
      "terms": { "field": "source_ip" }
    }
  }
}'
```

#### 2. Logstash

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** Log processing pipeline

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```ruby
input {
  # –û—Ç–∫—É–¥–∞ –ª–æ–≥–∏
}

filter {
  # –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å
}

output {
  # –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å
}
```

**–ü—Ä–∏–º–µ—Ä pipeline:**
```ruby
input {
  tcp {
    port => 5000
    type => "syslog"
  }
}

filter {
  grok {
    match => { 
      "message" => "%{SYSLOGTIMESTAMP:timestamp} %{SYSLOGHOST:hostname} %{DATA:program}: %{GREEDYDATA:message}" 
    }
  }
  
  if [source_ip] == "185.220.101.47" {
    mutate {
      add_tag => ["suspicious_ip", "apt_attack"]
    }
  }
}

output {
  elasticsearch {
    hosts => ["localhost:9200"]
    index => "incident-%{+YYYY.MM.dd}"
  }
}
```

**Grok patterns:**
- Pre-built regex –¥–ª—è common log formats
- `%{IP:source_ip}` ‚Äî extract IP
- `%{TIMESTAMP_ISO8601:timestamp}` ‚Äî extract timestamp

#### 3. Kibana

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** Visualization and dashboards

**Features:**
- **Discover:** Search logs
- **Visualize:** Create charts
- **Dashboard:** Combine visualizations
- **Alerts:** Notifications

**Query examples (KQL - Kibana Query Language):**
```
source_ip: "185.220.101.47"
message: "failed" OR message: "error"
@timestamp: [now-24h TO now]
severity: critical AND event_type: ssh_login
```

**Useful visualizations:**
- Timeline (events over time)
- Top IPs (bar chart)
- Event types (pie chart)
- Geographic map (IP locations)

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: ELK Stack Setup (Simple)

**–ó–∞–¥–∞–Ω–∏–µ:**

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Full ELK —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤. –î–µ–ª–∞–µ–º simplified setup –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è.

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```bash
# Add Elastic repo
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg

echo "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list

sudo apt update

# Install Elasticsearch
sudo apt install elasticsearch

# Install Logstash
sudo apt install logstash

# Install Kibana
sudo apt install kibana
```

2. **Configure Elasticsearch:**
```bash
# Use template
sudo cp starter/elk/elasticsearch.yml /etc/elasticsearch/elasticsearch.yml

# Or minimal config
sudo nano /etc/elasticsearch/elasticsearch.yml
```

Add:
```yaml
cluster.name: incident-response
network.host: 127.0.0.1
http.port: 9200
discovery.type: single-node
xpack.security.enabled: false
```

3. **Start Elasticsearch:**
```bash
sudo systemctl enable elasticsearch
sudo systemctl start elasticsearch

# Test
curl http://localhost:9200
```

4. **Configure Logstash:**
```bash
# Copy pipeline
sudo cp starter/elk/logstash-syslog.conf /etc/logstash/conf.d/

# Start
sudo systemctl enable logstash
sudo systemctl start logstash
```

5. **Feed Episode 19 logs to Logstash:**
```bash
# Modify pipeline to read artifacts
sudo nano /etc/logstash/conf.d/logstash-syslog.conf
```

Add file input:
```ruby
input {
  file {
    path => "/home/*/kernel-shadows/season-5-security-pentesting/episode-19-incident-response/artifacts/compromised_logs/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
  }
}
```

Restart:
```bash
sudo systemctl restart logstash
```

6. **Configure Kibana:**
```bash
sudo cp starter/elk/kibana.yml /etc/kibana/kibana.yml

sudo systemctl enable kibana
sudo systemctl start kibana

# Access
firefox http://localhost:5601
```

7. **Create index pattern –≤ Kibana:**
- Open http://localhost:5601
- **Management ‚Üí Stack Management ‚Üí Index Patterns**
- Create: `incident-*`
- Select timestamp field: `@timestamp`

8. **Explore logs:**
- **Discover** ‚Üí select `incident-*` index
- Search: `source_ip: "185.220.101.47"`
- Filter: `severity: critical`

9. **Create simple dashboard:**
- **Visualize ‚Üí Create visualization**
- Type: Bar chart
- X-axis: `source_ip`
- Save as "Top Source IPs"

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"ELK –ø–æ–∫–∞–∑–∞–ª –∞—Ç–∞–∫—É –≤ 22:15. –ù–æ alert –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª. –ü–æ—á–µ–º—É?"*

<details>
<summary>ü§î Detection vs Alert</summary>

**–û—Ç–≤–µ—Ç:** **Detection ‚â† Alert. –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å rules!**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ELK —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –ù–æ –ù–ï –∞–ª–µ—Ä—Ç–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å alerting rules

**–†–µ—à–µ–Ω–∏–µ ‚Äî Kibana Alerting:**

1. **Create alert rule:**
```
Kibana ‚Üí Stack Management ‚Üí Rules and Connectors

Trigger: Suspicious IP detected
Conditions:
  - source_ip matches "185.220.101.47"
  OR
  - failed_logins > 5 in 5 minutes
  OR  
  - severity is "critical"

Actions:
  - Send email
  - Webhook to Slack
  - Execute script
```

2. **Example alert (KQL):**
```
# Alert if
source_ip: "185.220.101.47" AND severity: critical

# Or threshold based
failed_logins > 5 within 5m
```

3. **Integration:**
```bash
# Email
smtp.host: "smtp.gmail.com"
smtp.port: 587

# Slack
webhook_url: "https://hooks.slack.com/..."

# PagerDuty
integration_key: "..."
```

**SIEM = Collection + Detection + Response:**
- ‚úÖ Collection ‚Äî ELK –¥–µ–ª–∞–µ—Ç
- ‚ùå Detection ‚Äî –Ω—É–∂–Ω—ã rules
- ‚ùå Response ‚Äî –Ω—É–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (SOAR)

**Full SIEM stack:**
- ELK ‚Äî collection & visualization
- **Elastalert** / **Watcher** ‚Äî alerting
- **SOAR platform** ‚Äî automated response

**Heinrich:** *"ELK without alerts ‚Äî —ç—Ç–æ telescope –±–µ–∑ –∞—Å—Ç—Ä–æ–Ω–æ–º–∞. –í–∏–¥–∏—à—å –∑–≤—ë–∑–¥—ã, –Ω–æ –Ω–µ –∑–Ω–∞–µ—à—å –∫–∞–∫–∏–µ –≤–∞–∂–Ω—ã. Alerting rules ‚Äî —ç—Ç–æ —Ç–≤–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞—Å—Ç—Ä–æ–Ω–æ–º. –ù–∞—Å—Ç—Ä–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äî sleep —Å–ø–æ–∫–æ–π–Ω–æ."*

</details>

---

## üîÑ –¶–∏–∫–ª 5: Osquery ‚Äî Endpoint Monitoring (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Isabella:** *"ELK —Ö–æ—Ä–æ—à –¥–ª—è centralized logs. –ù–æ —á—Ç–æ –µ—Å–ª–∏ –Ω—É–∂–µ–Ω real-time query? –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã: –µ—Å—Ç—å –ª–∏ backdoor –°–ï–ô–ß–ê–°?"*

–û–Ω–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç osqueryi:
```bash
sudo osqueryi
osquery> SELECT * FROM processes WHERE path LIKE '/tmp/%';
```

–≠–∫—Ä–∞–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å 20 —Å–µ—Ä–≤–µ—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**Isabella:** *"Osquery ‚Äî SQL –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. Threat hunting like database query. –ù–∞—Ö–æ–¥–∏–º backdoors, rootkits, suspicious connections –∑–∞ —Å–µ–∫—É–Ω–¥—ã."*

### üìö –¢–µ–æ—Ä–∏—è: Osquery Framework

#### –ß—Ç–æ —Ç–∞–∫–æ–µ osquery?

**Osquery** ‚Äî open-source (Facebook) —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è:
- Endpoint monitoring
- Threat hunting
- Compliance checking
- Inventory management

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:** OS –∫–∞–∫ relational database

**SQL queries –¥–ª—è:**
- Processes ‚Üí `SELECT * FROM processes`
- Network ‚Üí `SELECT * FROM process_open_sockets`
- Files ‚Üí `SELECT * FROM file`
- Users ‚Üí `SELECT * FROM users`

#### Virtual Tables

Osquery –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç 100+ —Ç–∞–±–ª–∏—Ü:

**System Info:**
```sql
SELECT * FROM system_info;
SELECT * FROM os_version;
SELECT * FROM kernel_info;
```

**Processes:**
```sql
SELECT pid, name, path, cmdline, uid FROM processes;
SELECT * FROM processes WHERE name = 'suspicious-service';
```

**Network:**
```sql
SELECT * FROM process_open_sockets;
SELECT * FROM listening_ports;
```

**Files:**
```sql
SELECT * FROM file WHERE path LIKE '/tmp/%';
SELECT * FROM hash WHERE path = '/tmp/.hidden/update.sh';
```

**Security:**
```sql
SELECT * FROM authorized_keys;
SELECT * FROM kernel_modules;
SELECT * FROM crontab;
```

#### Threat Hunting Queries

**1. Backdoor Detection:**
```sql
-- Suspicious processes in /tmp
SELECT pid, name, path, cmdline 
FROM processes 
WHERE path LIKE '/tmp/%' OR path LIKE '/dev/shm/%';
```

**2. Rootkit Detection:**
```sql
-- Kernel modules not in standard paths
SELECT name, size, status, used_by 
FROM kernel_modules 
WHERE name NOT IN (SELECT name FROM kernel_modules WHERE path LIKE '/lib/modules%');
```

**3. C2 Connections:**
```sql
-- External network connections
SELECT pid, fd, remote_address, remote_port, state 
FROM process_open_sockets 
WHERE remote_address NOT IN ('127.0.0.1', '::1') 
  AND remote_address != '';
```

**4. Persistence Mechanisms:**
```sql
-- Suspicious cron jobs
SELECT command, path 
FROM cron_details 
WHERE path LIKE '/tmp/%' OR command LIKE '%wget%' OR command LIKE '%curl%';
```

**5. File Integrity:**
```sql
-- Check critical files
SELECT path, md5, mtime 
FROM hash 
WHERE path IN ('/etc/passwd', '/etc/shadow', '/etc/sudoers');
```

#### Scheduled Queries

**osquery.conf:**
```json
{
  "schedule": {
    "backdoor_detection": {
      "query": "SELECT * FROM processes WHERE path LIKE '/tmp/%';",
      "interval": 60
    },
    "network_monitoring": {
      "query": "SELECT * FROM process_open_sockets WHERE remote_address != '';",
      "interval": 120
    }
  }
}
```

**Results logging:**
```bash
# View results
sudo cat /var/log/osquery/osqueryd.results.log | jq
```

#### Fleet Management

**osquery-fleet** (for multiple servers):
- Central management
- Query all endpoints
- Real-time results
- Alerting

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Osquery Threat Hunting

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ osquery:**
```bash
sudo apt update
sudo apt install osquery
```

2. **Interactive mode:**
```bash
sudo osqueryi

# Explore tables
osquery> .tables

# System info
osquery> SELECT * FROM system_info;

# Processes
osquery> SELECT pid, name, path FROM processes LIMIT 10;
```

3. **Threat hunting –Ω–∞ Episode 19 artifacts:**

**Hunt 1: Find backdoor**
```sql
osquery> SELECT * FROM processes WHERE path LIKE '/tmp/%' OR name LIKE '%hidden%';
```

**Hunt 2: Find C2 connections**
```sql
osquery> SELECT pid, remote_address, remote_port 
         FROM process_open_sockets 
         WHERE remote_address = '185.220.101.47';
```

**Hunt 3: Find rootkit**
```sql
osquery> SELECT * FROM kernel_modules WHERE name = 'rootkit';
```

**Hunt 4: Check SSH keys**
```sql
osquery> SELECT * FROM authorized_keys;
```

4. **Simulate findings (use artifacts):**
```bash
# Based on memory_dumps/process_dump.txt
# –ö–∞–∫–∏–µ queries –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ –±—ã –∞—Ç–∞–∫—É?

# Process 16236: /tmp/.hidden/update.sh
# Query: SELECT * FROM processes WHERE path LIKE '/tmp/.hidden/%';

# Network: 185.220.101.47:4444
# Query: SELECT * FROM process_open_sockets WHERE remote_address = '185.220.101.47';
```

5. **Create scheduled queries:**
```bash
# Copy config
sudo cp starter/osquery/osquery.conf /etc/osquery/osquery.conf

# Start daemon
sudo systemctl enable osqueryd
sudo systemctl start osqueryd

# View logs
sudo journalctl -u osqueryd -f
```

6. **–ó–∞–ø–∏—à–∏—Ç–µ threat hunting results:**
```markdown
## Osquery Threat Hunting Results

**Backdoors found:** [List]
**C2 connections:** [IP:Port]
**Rootkits:** [Module names]
**Persistence:** [Cron jobs]
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"Osquery –Ω–∞—à—ë–ª backdoor. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–∏—Ç—å?"*

<details>
<summary>ü§î Detection vs Response</summary>

**–û—Ç–≤–µ—Ç:** **–ù–ï–¢! Osquery = detection, –ù–ï response.**

**–ß—Ç–æ osquery –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ (detection)
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (monitoring)
- ‚úÖ Inventory (what's running)
- ‚ùå –ù–ï –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- ‚ùå –ù–ï blocking
- ‚ùå –ù–ï response actions

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π workflow:**

1. **Osquery detects:**
   ```sql
   SELECT * FROM processes WHERE path = '/tmp/.hidden/update.sh';
   -- Result: Found!
   ```

2. **Alert triggers:**
   ```bash
   # Osquery ‚Üí Logging ‚Üí SIEM ‚Üí Alert
   # Or osquery-fleet ‚Üí Alerting
   ```

3. **Human verification:**
   ```bash
   # Incident responder –ø—Ä–æ–≤–µ—Ä—è–µ—Ç
   sudo ls -la /tmp/.hidden/update.sh
   sudo cat /tmp/.hidden/update.sh
   # Confirm: —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ backdoor
   ```

4. **Manual response:**
   ```bash
   # –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
   sudo chmod 000 /tmp/.hidden/update.sh  # Disable
   # Collect evidence
   sudo cp /tmp/.hidden/update.sh /evidence/
   # Then eradicate
   sudo rm /tmp/.hidden/update.sh
   ```

**–ü–æ—á–µ–º—É –ù–ï –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?**
- False positives –≤–æ–∑–º–æ–∂–Ω—ã
- Legitimate –ø—Ä–æ—Ü–µ—Å—Å –≤ /tmp? (—Ä–µ–¥–∫–æ, –Ω–æ –±—ã–≤–∞–µ—Ç)
- Evidence preservation –Ω—É–∂–Ω–∞
- Legal implications

**Automated response (SOAR):**
- –¢—Ä–µ–±—É–µ—Ç confidence threshold
- Whitelist –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- Human-in-the-loop –¥–ª—è critical actions
- Playbooks –¥–ª—è common scenarios

**Isabella:** *"Osquery ‚Äî eyes of security team. –í–∏–¥–∏—Ç –≤—Å—ë. –ù–æ decision to act ‚Äî –≤—Å–µ–≥–¥–∞ human. Automation —Ö–æ—Ä–æ—à–∞ –¥–ª—è containment (block IP, isolate host). –ù–æ eradication (delete files, kill processes) ‚Äî verify first. One false positive can break production."*

</details>

---

## üîÑ –¶–∏–∫–ª 6: Memory Forensics Basics (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**–ê–Ω–Ω–∞:** *"Disk forensics –Ω–∞—à–ª–∏ backdoor files. –ù–æ malware –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –≤ memory. Fileless attacks. RAM-only rootkits."*

–û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç memory dump:
```bash
ls -lh memory.dump
# -rw-r--r-- 1 root root 8.0G Oct 12 22:30 memory.dump
```

**–ê–Ω–Ω–∞:** *"8 GB RAM snapshot –Ω–∞ –º–æ–º–µ–Ω—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞. Volatility framework ‚Äî –º–æ–∂–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å: processes, network connections, loaded modules, –¥–∞–∂–µ extracted malware."*

**Heinrich:** *"Memory forensics ‚Äî advanced. –°–ª–æ–∂–Ω–æ, –Ω–æ powerful. –ü–æ–∫–∞–∂—É basics."*

### üìö –¢–µ–æ—Ä–∏—è: Memory Forensics (Volatility)

#### –ß—Ç–æ —Ç–∞–∫–æ–µ Memory Forensics?

**Memory Forensics** ‚Äî –∞–Ω–∞–ª–∏–∑ RAM snapshot –¥–ª—è:
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è malware (–≤–∫–ª—é—á–∞—è fileless)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏—è encryption keys
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–Ω–∞–ª–∏–∑–∞ running processes
- Network connection recovery

**vs Disk Forensics:**
| Disk | Memory |
|------|--------|
| Persistent | Volatile |
| Files, logs | Processes, RAM |
| Historical | Current state |
| Easy to collect | Needs live capture |

#### Volatility Framework

**Volatility** ‚Äî open-source memory forensics —Ñ—Ä–µ–π–º–≤–æ—Ä–∫

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ OS:**
- Windows (XP - 11)
- Linux
- macOS
- Android

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

**1. Profile Detection:**
```bash
# Identify OS version
volatility -f memory.dump imageinfo
```

**2. Process Analysis:**
```bash
# List processes
volatility -f memory.dump --profile=LinuxUbuntu2204x64 linux_pslist

# Process tree
volatility -f memory.dump --profile=LinuxUbuntu2204x64 linux_pstree

# Find hidden processes
volatility -f memory.dump --profile=LinuxUbuntu2204x64 linux_psxview
```

**3. Network Connections:**
```bash
# Active connections
volatility -f memory.dump --profile=LinuxUbuntu2204x64 linux_netstat
```

**4. Kernel Modules:**
```bash
# Loaded modules
volatility -f memory.dump --profile=LinuxUbuntu2204x64 linux_lsmod

# Find rootkits
volatility -f memory.dump --profile=LinuxUbuntu2204x64 linux_check_modules
```

**5. File Extraction:**
```bash
# Extract process memory
volatility -f memory.dump --profile=LinuxUbuntu2204x64 linux_dump_map -p <PID> -D output/
```

**6. Strings & Grep:**
```bash
# Search memory for patterns
strings memory.dump | grep "password"
strings memory.dump | grep -E "\b[0-9]{1,3}(\.[0-9]{1,3}){3}\b"
```

#### Memory Acquisition

**Live system:**
```bash
# LiME (Linux Memory Extractor)
sudo insmod lime.ko "path=/tmp/memory.dump format=lime"

# Or using dd (risky, may be incomplete)
sudo dd if=/dev/mem of=memory.dump bs=1M

# Or crash dump
sudo systemctl enable kdump
sudo kdump-config show
```

**–î–ª—è Episode 19:**
- –†–µ–∞–ª—å–Ω—ã–π memory dump = 8+ GB (—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è artifacts)
- –ò—Å–ø–æ–ª—å–∑—É–µ–º simulated outputs –≤ `memory_dumps/`

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Memory Analysis (Simulated)

**–ó–∞–¥–∞–Ω–∏–µ:**

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Full Volatility analysis —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π memory dump. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ outputs.

1. **–ò–∑—É—á–∏—Ç–µ process dump:**
```bash
cd artifacts/memory_dumps/

# View processes
cat process_dump.txt

# Find suspicious
grep -E "tmp|hidden|suspicious" process_dump.txt
```

**–ß—Ç–æ –Ω–∞–π–¥—ë—Ç–µ:**
- PID 16236: `/tmp/.hidden/update.sh` ‚Üê Backdoor
- PID 16890: `/tmp/.hidden/suspicious-service` ‚Üê Malware
- PID 16891: `/tmp/.hidden/keylogger` ‚Üê Keylogger

2. **Analyze network connections:**
```bash
cat network_connections.txt

# Find C2 connections
grep "185.220.101.47" network_connections.txt
```

**–ß—Ç–æ –Ω–∞–π–¥—ë—Ç–µ:**
- Connection to 185.220.101.47:4444 (reverse shell)
- Connection to 185.220.101.47:8080 (data exfiltration)

3. **Check kernel modules:**
```bash
cat loaded_modules.txt

# Find rootkit
grep -i "rootkit" loaded_modules.txt
```

**–ß—Ç–æ –Ω–∞–π–¥—ë—Ç–µ:**
- Module `rootkit` loaded (out-of-tree, suspicious!)

4. **Create memory forensics summary:**
```markdown
## Memory Forensics Summary

**Suspicious Processes:**
- PID 16236: /tmp/.hidden/update.sh (backdoor)
- PID 16890: /tmp/.hidden/suspicious-service
- PID 16891: /tmp/.hidden/keylogger

**C2 Connections:**
- 185.220.101.47:4444 (reverse shell)
- 185.220.101.47:8080 (exfiltration)

**Rootkits:**
- kernel module: rootkit (out-of-tree)

**Conclusion:**
Memory analysis confirms disk findings. 
APT –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞:
- Backdoor –¥–ª—è persistence
- Keylogger –¥–ª—è credential theft
- Rootkit –¥–ª—è hiding
- C2 –¥–ª—è control & exfiltration
```

5. **(Optional) Install Volatility –¥–ª—è practice:**
```bash
# Install Volatility 3
pip3 install volatility3

# Download sample dumps (if available)
# Analyze with real Volatility
vol -f sample.dump windows.pslist
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"Memory dump ‚Äî 8 GB. Server –∏–º–µ–µ—Ç 16 GB RAM. –ì–¥–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 8 GB?"*

<details>
<summary>ü§î Memory Acquisition Challenges</summary>

**–û—Ç–≤–µ—Ç:** **Memory dump ‚â† –ø–æ–ª–Ω–∞—è RAM copy. –ï—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.**

**–ü–æ—á–µ–º—É –Ω–µ –≤—Å–µ 16 GB:**

**1. Kernel reserved memory:**
```
Total RAM:     16 GB
Kernel space:  ~2 GB  (–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è dump)
Available:     ~14 GB
```

**2. Memory mapping issues:**
```bash
# –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–≥–∏–æ–Ω—ã –Ω–µ readable
# Hardware reserved
# MMIO (Memory-Mapped I/O)
```

**3. Dump method limitations:**
```bash
# LiME (Linux Memory Extractor)
# - Captures accessible pages
# - Skips unmapped regions

# dd from /dev/mem
# - –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å
# - Kernel restrictions (CONFIG_STRICT_DEVMEM)
```

**4. Running processes:**
```bash
# –ü—Ä–æ—Ü–µ—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç RAM –≤–æ –≤—Ä–µ–º—è dump
# Snapshot inconsistent (–º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è)
```

**5. Swap space:**
```bash
# –ß–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ –≤ swap (on disk)
# Memory dump –ù–ï –≤–∫–ª—é—á–∞–µ—Ç swap
# –ù—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π dump swap partition
```

**Best practices:**

**1. Use dedicated tools:**
```bash
# LiME for Linux
sudo insmod lime.ko "path=/tmp/memory.dump format=lime"

# WinPmem for Windows
winpmem.exe memory.dump
```

**2. Capture ASAP:**
```bash
# –ß–µ–º –±—ã—Å—Ç—Ä–µ–µ ‚Äî —Ç–µ–º –º–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
# Memory volatile ‚Äî –∫–∞–∂–¥–∞—è —Å–µ–∫—É–Ω–¥–∞ –≤–∞–∂–Ω–∞
```

**3. Hash –¥–ª—è integrity:**
```bash
md5sum memory.dump > memory.dump.md5
sha256sum memory.dump > memory.dump.sha256
```

**4. Multiple captures (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ):**
```bash
# Capture 1 (immediate)
# Capture 2 (–ø–æ—Å–ª–µ 5 –º–∏–Ω—É—Ç)
# Compare –¥–ª—è validation
```

**5. Also capture:**
```bash
sudo dd if=/dev/sda of=disk.img       # Disk image
sudo cp /proc/kcore kcore.dump         # Kernel memory (alternative)
sudo cat /proc/meminfo > meminfo.txt   # Memory stats
```

**–ê–Ω–Ω–∞:** *"Perfect memory dump ‚Äî —ç—Ç–æ ideal scenario. –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –¥–µ–ª–∞–π —á—Ç–æ –º–æ–∂–µ—à—å —Å —Ç–µ–º —á—Ç–æ –µ—Å—Ç—å. 8 GB –∏–∑ 16 GB ‚Äî –ª—É—á—à–µ —á–µ–º –Ω–∏—á–µ–≥–æ. Volatility —Ä–∞–±–æ—Ç–∞–µ—Ç —Å partial dumps. Critical evidence –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö 8 GB. Malware –æ–±—ã—á–Ω–æ –≤ user space ‚Äî —ç—Ç–æ –º—ã –∑–∞—Ö–≤–∞—Ç–∏–º."*

</details>

---

## üîÑ –¶–∏–∫–ª 7: Timeline Reconstruction (20 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**Isabella —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç findings –Ω–∞ timeline:**

```
22:10 - Reconnaissance (web scanning)
22:15 - Initial Access (brute-force SSH)
22:16 - Privilege Escalation (sudo to root)
22:18 - Persistence (cron job)
22:23 - Rootkit Installation
22:27 - Keylogger Started
22:30 - C2 Established
22:45 - Data Exfiltration Started
23:12 - Exfiltration Complete (2.3 GB)
02:30 - Cleanup Attempt
03:15 - Backdoor Still Active
```

**Isabella:** *"Timeline ‚Äî —ç—Ç–æ crime scene reconstruction. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ? –í –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ? –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —É –∞—Ç–∞–∫—É—é—â–µ–≥–æ? –ì–¥–µ –±—ã–ª–∏ gaps –≤ –Ω–∞—à–µ–π –∑–∞—â–∏—Ç–µ?"*

### üìö –¢–µ–æ—Ä–∏—è: Timeline Analysis

#### –ß—Ç–æ —Ç–∞–∫–æ–µ Timeline Reconstruction?

**Timeline Analysis** ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞:
- –ö–æ–≥–¥–∞ –Ω–∞—á–∞–ª–∞—Å—å –∞—Ç–∞–∫–∞
- –ö–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—ã
- –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —É –∞—Ç–∞–∫—É—é—â–µ–≥–æ
- –ö–æ–≥–¥–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞
- –í—Ä–µ–º—è –¥–ª—è response

#### –¢–∏–ø—ã Timestamps

**1. File Timestamps (MACB):**
- **M**odified (mtime) ‚Äî content –∏–∑–º–µ–Ω—ë–Ω
- **A**ccessed (atime) ‚Äî —Ñ–∞–π–ª –ø—Ä–æ—á–∏—Ç–∞–Ω
- **C**hanged (ctime) ‚Äî metadata –∏–∑–º–µ–Ω–µ–Ω—ã (permissions, ownership)
- **B**irth (btime/crtime) ‚Äî —Å–æ–∑–¥–∞–Ω (–Ω–µ –≤—Å–µ FS –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç)

```bash
# View timestamps
stat /path/to/file

# Find files modified –≤ time window
find / -type f -newermt "2024-10-12 22:00" ! -newermt "2024-10-13 04:00" -ls 2>/dev/null
```

**2. Log Timestamps:**
```bash
# Syslog format
Oct 12 22:16:23 server sshd[15923]: ...

# ISO 8601
2024-10-12T22:16:23+02:00

# Epoch (Unix time)
1697138183
```

**3. Network Timestamps:**
- Connection established
- Data transfer start/end
- DNS queries

#### Timeline Tools

**1. log2timeline (plaso):**
```bash
# Extract timestamps from multiple sources
log2timeline.py timeline.plaso /evidence/

# Create readable timeline
psort.py -o l2tcsv timeline.plaso > timeline.csv
```

**2. Manual (–¥–ª—è Episode 19):**
```bash
# Combine all logs with timestamps
cat /var/log/auth.log /var/log/syslog apache_access.log | \
  grep -E "^[A-Z][a-z]{2} [0-9 ]+" | \
  sort -k1,3 > combined_timeline.txt
```

**3. Correlation:**
```bash
# –°–æ–±—ã—Ç–∏—è –±–ª–∏–∑–∫–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ = —Å–≤—è–∑–∞–Ω—ã?
# Example:
# 22:16:23 SSH login
# 22:16:25 sudo to root
# ‚Üí –°–≤—è–∑–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (same session)
```

#### Timeline Format

**CSV format:**
```csv
Timestamp,Event Type,Source,Description,Severity
2024-10-12 22:15:33,Login Attempt,SSH,Failed login from 185.220.101.47,WARNING
2024-10-12 22:16:23,Login Success,SSH,dbuser login from 185.220.101.47,CRITICAL
2024-10-12 22:16:25,Privilege Escalation,Sudo,dbuser ‚Üí root,CRITICAL
```

**Visual timeline:**
```
22:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 04:00
  ‚îÇ                                                  ‚îÇ
  22:15 [Brute Force]
         ‚îÇ
         22:16 [Compromise]
                ‚îÇ
                22:23 [Rootkit]
                      ‚îÇ
                      22:30 [C2]
                            ‚îÇ
                            23:12 [Exfil Complete]
                                         ‚îÇ
                                         03:15 [Detected]
```

#### Analysis Questions

1. **Dwell Time:** –°–∫–æ–ª—å–∫–æ –∞—Ç–∞–∫—É—é—â–∏–π –±—ã–ª –≤ —Å–∏—Å—Ç–µ–º–µ?
   ```
   Initial Access (22:16) ‚Üí Detection (03:15) = 5 hours
   ```

2. **Time to Compromise:**
   ```
   Initial Access ‚Üí Root = 2 minutes (fast!)
   ```

3. **Time to Exfiltration:**
   ```
   Root Access ‚Üí Data Stolen = 56 minutes
   ```

4. **Detection Gap:**
   ```
   Exfiltration Complete ‚Üí Detection = 4 hours (too long!)
   ```

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Build Attack Timeline

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π timeline_raw.csv:**
```bash
cd artifacts/indicators/
cat timeline_raw.csv | column -t -s ','
```

2. **–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π timeline –≤—Ä—É—á–Ω—É—é:**
```bash
# Combine –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
cd ../compromised_logs/

# Extract timestamps –∏ events
echo "Timestamp,Event,Details" > ~/incident_timeline.csv

# Auth events
grep "185.220.101.47" auth.log | \
  awk '{print $1" "$2" "$3","$0}' >> ~/incident_timeline.csv

# Syslog events  
grep -i "rootkit\|suspicious\|tmp" syslog | \
  awk '{print $1" "$2" "$3","$0}' >> ~/incident_timeline.csv

# Sort
sort -t',' -k1 ~/incident_timeline.csv > ~/incident_timeline_sorted.csv
```

3. **Visualize (simple):**
```bash
# Create simple visualization
cat ~/incident_timeline_sorted.csv | \
  awk -F',' '{printf "%-20s | %s\n", $1, $2}' | \
  less
```

4. **Answer timeline questions:**
```markdown
## Timeline Analysis

**Attack Duration:**
Start: [First suspicious event]
End: [Last attacker activity]
Total: [Hours/Minutes]

**Key Milestones:**
- Initial Access: [Time]
- Root Obtained: [Time]
- Persistence: [Time]
- Exfiltration: [Time]

**Detection Gap:**
Attack Completed: [Time]
Detected: [Time]
Gap: [Hours]

**Lessons:**
- –ß—Ç–æ –º–æ–≥–ª–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ä–∞–Ω—å—à–µ?
- –ì–¥–µ –±—ã–ª–∏ gaps –≤ monitoring?
```

---

### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**LILITH:** *"Timeline –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç exfiltration –≤ 23:12. –ù–æ –º–æ–∂–Ω–æ –ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ß–¢–û —É–∫—Ä–∞–¥–µ–Ω–æ?"*

<details>
<summary>ü§î Data Attribution</summary>

**–û—Ç–≤–µ—Ç:** **–î–∞, –Ω–æ —Å–ª–æ–∂–Ω–æ. –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤.**

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:**

**1. Network logs (–µ—Å–ª–∏ –µ—Å—Ç—å):**
```bash
# Packet capture
tcpdump -r capture.pcap | grep 185.220.101.47

# Extracted data (–µ—Å–ª–∏ HTTP/FTP)
tcpdump -r capture.pcap -A | grep -A 100 "GET\|POST"
```

**2. Process analysis:**
```bash
# –ò–∑ memory dump: PID 17123 = mysqldump
# ‚Üí Likely database stolen

# Command line (–µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω)
ps -p 17123 -o cmd
# mysqldump --all-databases
```

**3. File access logs (auditd):**
```bash
# –ï—Å–ª–∏ auditd –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω
sudo ausearch -k database_access -ts 10/12/2024 23:00

# Accessed files
/var/lib/mysql/database1/table1.ibd
/var/lib/mysql/database2/table2.ibd
```

**4. File timestamps:**
```bash
# Files accessed around exfiltration time
find /var/lib/mysql -type f -atime 0 -ls
```

**5. Application logs:**
```bash
# MySQL logs
grep "2024-10-12 23:" /var/log/mysql/mysql.log
# Shows queries executed
```

**6. Backup comparison:**
```bash
# Compare pre-attack backup
diff -r /backup/mysql-20241011/ /var/lib/mysql/
# Files in backup but accessed recently = likely stolen
```

**Attribution confidence levels:**

**High Confidence:**
- Packet capture —Å plaintext data
- Application logs showing exact queries
- Process —Å clear command (mysqldump --all-databases)

**Medium Confidence:**
- File access timestamps matching exfiltration window
- Process name suggestive (mysqldump, tar, zip)
- Network traffic volume matching file sizes

**Low Confidence:**
- Just timeline correlation
- No packet capture
- Generic process names

**Isabella:** *"Perfect attribution ‚Äî —ç—Ç–æ ideal. Real world ‚Äî —á–∞—Å—Ç–æ circumstantial evidence. –ù–æ timeline + process + network volume + file access = strong case. –î–ª—è legal prosecution ‚Äî packet capture –ª—É—á—à–µ –≤—Å–µ–≥–æ. –î–ª—è internal investigation ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ high probability."*

</details>

---

## üîÑ –¶–∏–∫–ª 8: Forensic Reporting (25 –º–∏–Ω)

### üé¨ –°—é–∂–µ—Ç

**–î–µ–Ω—å 40, 04:30 ‚Äî –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç**

**Isabella:** *"16 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã. –í—Å–µ –Ω–∞—Ö–æ–¥–∫–∏ documented. –¢–µ–ø–µ—Ä—å forensic report –¥–ª—è –í–∏–∫—Ç–æ—Ä–∞ –∏ –¥–ª—è Interpol."*

–û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —à–∞–±–ª–æ–Ω:

```markdown
# INCIDENT RESPONSE REPORT
Classification: CONFIDENTIAL
Incident ID: KS-2024-10-12-001
Prepared by: Isabella Rossi (Interpol), –ê–Ω–Ω–∞ –ö–æ–≤–∞–ª–µ–≤–∞, Max Sokolov
Date: 2024-10-13

## Executive Summary
[High-level –¥–ª—è management]

## Incident Details
[Technical details]

## Timeline
[Chronological events]

## Evidence
[Files, logs, hashes]

## Impact Assessment
[Damage done]

## Recommendations
[How to prevent]
```

**Isabella:** *"Forensic report ‚Äî —ç—Ç–æ legal document. Chain of custody. Evidence integrity. Professional quality."*

### üìö –¢–µ–æ—Ä–∏—è: Forensic Reporting

#### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Forensic Report?

**–¶–µ–ª–∏:**
1. **Legal prosecution** ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –¥–ª—è —Å—É–¥–∞
2. **Insurance claims** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É—â–µ—Ä–±–∞
3. **Internal review** ‚Äî lessons learned
4. **Compliance** ‚Äî regulatory requirements
5. **Communication** ‚Äî stakeholders info

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Forensic Report

**1. Executive Summary (1-2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã)**
- –î–ª—è non-technical management
- High-level findings
- Business impact
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ summary

**–ü—Ä–∏–º–µ—Ä:**
```markdown
## Executive Summary

Stockholm server compromised by APT group "–ù–æ–≤–∞—è –≠—Ä–∞" on Oct 12, 2024.
Attack duration: 5 hours (22:15 - 03:15).
Data exfiltrated: 2.3 GB (database dump).
Root cause: Weak password + no 2FA.
Estimated damage: ‚Ç¨150,000 (data breach fines + recovery costs).
Immediate actions: All backdoors removed, passwords reset, 2FA enabled.
```

**2. Incident Details**
- What happened
- When discovered
- Who reported
- Initial assessment
- Response actions

**3. Technical Analysis**
- Attack vector
- TTPs (Tactics, Techniques, Procedures)
- MITRE ATT&CK mapping
- Vulnerabilities exploited
- Tools used by attacker

**4. Timeline**
- Chronological events
- Visual timeline
- Dwell time analysis

**5. Evidence**
- Files collected
- Hashes (MD5, SHA256)
- Chain of custody
- Storage location

**–ü—Ä–∏–º–µ—Ä:**
```markdown
## Evidence Inventory

| Item | Type | Hash (MD5) | Location | Collected By |
|------|------|------------|----------|--------------|
| backdoor.sh | File | d41d8cd98f00b204... | /evidence/001 | A.Kovaleva |
| rootkit.ko | Kernel Module | 5f4dcc3b5aa765d6... | /evidence/002 | M.Sokolov |
| memory.dump | RAM Image | 098f6bcd4621d373... | /evidence/003 | I.Rossi |
```

**6. Impact Assessment**
- Systems affected
- Data compromised
- Downtime
- Financial impact
- Reputation damage

**7. Root Cause Analysis**
- Primary cause
- Contributing factors
- Security gaps

**8. Remediation Actions**
- Immediate (containment, eradication)
- Short-term (patches, configuration)
- Long-term (process improvements)

**9. Recommendations**
- Technical controls
- Process improvements
- Training needs
- Tools/technologies

**10. Lessons Learned**
- What worked
- What failed
- Improvements needed

**11. Appendices**
- Full logs
- Screenshots
- Tool outputs
- References

#### Chain of Custody

**–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è legal evidence:**

```markdown
## Chain of Custody - Evidence 001: backdoor.sh

**Collected:**
- Date: 2024-10-12 22:35:00
- By: Anna Kovaleva
- Location: /tmp/.hidden/update.sh (Stockholm Server)
- Method: sudo cp + md5sum

**Stored:**
- Date: 2024-10-12 22:36:00
- Location: /evidence/secure/001/backdoor.sh
- Access: Read-only, encrypted partition
- Hash: d41d8cd98f00b204e9800998ecf8427e

**Accessed:**
- 2024-10-13 01:15:00 - Isabella Rossi (analysis)
- 2024-10-13 03:30:00 - Max Sokolov (verification)

**Integrity Verified:**
- 2024-10-13 04:00:00 - Hash matches original
```

#### Legal Considerations

**1. Admissibility:**
- Proper collection method
- Chain of custody maintained
- Authenticated by expert
- Relevant to case

**2. Privacy:**
- PII (Personally Identifiable Information) redacted
- GDPR compliance
- Only necessary data collected

**3. Preservation:**
- Write-once media
- Multiple copies (3-2-1 backup rule)
- Encrypted storage
- Access logs

---

### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Write Forensic Report

**–ó–∞–¥–∞–Ω–∏–µ:**

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ template:**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ report
cp artifacts/indicators/timeline_raw.csv ~/forensic_report_data.csv
nano ~/incident_forensic_report.md
```

2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (minimum):**
```markdown
# Incident Forensic Report

## Incident ID
KS-2024-10-12-001

## Executive Summary
[2-3 –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ –¥–ª—è management]

## Incident Timeline
[Key events —Å timestamps]

## Attack Analysis
**Initial Access:** [How]
**Privilege Escalation:** [How]
**Persistence:** [Mechanisms]
**Exfiltration:** [What data]

## Evidence Collected
[List —Å hashes]

## Impact
**Systems:** [Affected servers]
**Data:** [What compromised]
**Downtime:** [Hours]

## Root Cause
[Primary –ø—Ä–∏—á–∏–Ω–∞]

## Recommendations
1. [Immediate]
2. [Short-term]
3. [Long-term]

## Lessons Learned
[Key takeaways]
```

3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—è artifacts:**
- Timeline –∏–∑ `indicators/timeline_raw.csv`
- Evidence –∏–∑ `compromised_logs/`, `memory_dumps/`
- IoC –∏–∑ `indicators/ioc.txt`

4. **Verify completeness:**
- [ ] –í—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ timeline?
- [ ] –í—Å–µ evidence documented?
- [ ] Chain of custody —è—Å–µ–Ω?
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ?
- [ ] Lessons learned –ø–æ–ª–µ–∑–Ω—ã–µ?

---

## üéØ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ

### –°—é–∂–µ—Ç ‚Äî –î–µ–Ω—å 40, 06:30

**–ú–∞–∫—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç forensic report.**

**–í–∏–∫—Ç–æ—Ä** (—á–∏—Ç–∞–µ—Ç, 10 –º–∏–Ω—É—Ç –º–æ–ª—á–∞–Ω–∏—è): *"Comprehensive. Professional. Interpol quality. –í—Å–µ backdoors –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã. Timeline complete. Root cause —è—Å–µ–Ω."*

**Isabella:** *"Max —Ä–∞–±–æ—Ç–∞–ª –∫–∞–∫ seasoned investigator. Impressed."*

**–ê–Ω–Ω–∞:** *"Episode 17 ‚Äî audit. Episode 18 ‚Äî pentest. Episode 19 ‚Äî real war. –¢—ã –ø—Ä–æ—à—ë–ª –≤—Å–µ —Ç—Ä–∏. –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å –∏ –∑–∞—â–∏—â–∞—Ç—å (audit), –∏ –∞—Ç–∞–∫–æ–≤–∞—Ç—å (pentest), –∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å (forensics). Complete security skillset."*

**Heinrich:** *"Episode 20 ‚Äî hardening. –ß—Ç–æ–±—ã '–ù–æ–≤–∞—è –≠—Ä–∞' never comes back."*

**LILITH:** *"16 —á–∞—Å–æ–≤ non-stop. –¢—ã –Ω–∞—à—ë–ª –∫–∞–∂–¥—ã–π trace. Backdoor, rootkit, keylogger, exfiltration ‚Äî –≤—Å—ë documented. Incident response –∫–∞–∫ —Ä–∞–±–æ—Ç–∞ –¥–µ—Ç–µ–∫—Ç–∏–≤–∞ ‚Äî —Ç—ã detective —Ç–µ–ø–µ—Ä—å."*

---

### –ò—Ç–æ–≥–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞

**Checklist:**

- [ ] **Auditd –Ω–∞—Å—Ç—Ä–æ–µ–Ω**
  ```bash
  sudo auditctl -l | grep -E "tmp|passwd|sudo"
  ```

- [ ] **ELK Stack —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** (—Ö–æ—Ç—è –±—ã –ø–æ–ø—ã—Ç–∫–∞)
  ```bash
  curl http://localhost:9200
  curl http://localhost:5601
  ```

- [ ] **Osquery –≥–æ—Ç–æ–≤**
  ```bash
  sudo osqueryi "SELECT * FROM processes LIMIT 5;"
  ```

- [ ] **Log analysis –≤—ã–ø–æ–ª–Ω–µ–Ω**
  ```bash
  ls ~/incident_timeline*
  ```

- [ ] **Forensic report –Ω–∞–ø–∏—Å–∞–Ω**
  ```bash
  cat ~/incident_forensic_report.md
  # Minimum 50 —Å—Ç—Ä–æ–∫
  # –°–æ–¥–µ—Ä–∂–∏—Ç: timeline, evidence, impact, recommendations
  ```

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

**–ú–∏–Ω–∏–º—É–º:**
- ‚úÖ Auditd rules —Å–æ–∑–¥–∞–Ω—ã (minimum 5 rules)
- ‚úÖ Logs –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã (timeline –ø–æ—Å—Ç—Ä–æ–µ–Ω)
- ‚úÖ Forensic report –Ω–∞–ø–∏—Å–∞–Ω (basic structure)
- ‚úÖ –ü–æ–Ω–∏–º–∞–Ω–∏–µ incident response process

**–ò–¥–µ–∞–ª—å–Ω–æ:**
- ‚úÖ Full ELK Stack —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Osquery queries —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã
- ‚úÖ Comprehensive timeline (–≤—Å–µ —Å–æ–±—ã—Ç–∏—è)
- ‚úÖ Professional forensic report
- ‚úÖ Chain of custody documented
- ‚úÖ Lessons learned –¥–µ–π—Å—Ç–≤–µ–Ω–Ω—ã–µ

---

## üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã

```bash
cd ~/kernel-shadows/season-5-security-pentesting/episode-19-incident-response
./tests/test.sh
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—Ç:
- –ù–∞–ª–∏—á–∏–µ auditd rules
- Forensic report existence
- Timeline —Ñ–∞–π–ª
- Osquery configuration

---

## üìö –†–µ—Å—É—Ä—Å—ã

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **auditd:** https://linux.die.net/man/8/auditd
- **ELK Stack:** https://www.elastic.co/elastic-stack
- **Osquery:** https://osquery.io/
- **Volatility:** https://www.volatilityfoundation.org/

### Frameworks

- **NIST IR:** https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf
- **SANS IR:** https://www.sans.org/incident-response/
- **MITRE ATT&CK:** https://attack.mitre.org/

### –ö–Ω–∏–≥–∏

- "The Art of Memory Forensics"
- "Incident Response & Computer Forensics" (Luttgens)
- "Blue Team Handbook: Incident Response Edition"

---

## üéì –ò—Ç–æ–≥–∏ Episode 19

### –ß—Ç–æ –∏–∑—É—á–∏–ª–∏

**–¢–µ–æ—Ä–∏—è:**
- ‚úÖ NIST Incident Response framework
- ‚úÖ Log analysis –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è
- ‚úÖ Timeline reconstruction
- ‚úÖ Digital forensics principles
- ‚úÖ Chain of custody

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- ‚úÖ auditd ‚Äî Linux Audit Framework
- ‚úÖ ELK Stack ‚Äî centralized SIEM
- ‚úÖ osquery ‚Äî endpoint monitoring
- ‚úÖ Volatility ‚Äî memory forensics (basics)
- ‚úÖ journalctl, ausearch ‚Äî log tools

**–ù–∞–≤—ã–∫–∏:**
- ‚úÖ Real incident investigation
- ‚úÖ APT attack analysis
- ‚úÖ Evidence preservation
- ‚úÖ Forensic reporting
- ‚úÖ Threat hunting

---

### –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —ç–ø–∏–∑–æ–¥–∞–º–∏

**Prerequisites:**
- Episode 17: Security Audit (–∑–Ω–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)
- Episode 18: Pentest (–ø–æ–Ω–∏–º–∞–Ω–∏–µ –∞—Ç–∞–∫)

**What's next:**
- **Episode 20:** Security Hardening ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ lessons learned

---

### –°—é–∂–µ—Ç ‚Äî –ü–µ—Ä–µ—Ö–æ–¥ –∫ Episode 20

**–î–µ–Ω—å 40, 08:00 ‚Äî CERN Security Lab**

**Heinrich:** *"–í—Å–µ backdoors —É–¥–∞–ª–µ–Ω—ã. –ù–æ prevention –ª—É—á—à–µ —á–µ–º cure. Episode 20 ‚Äî comprehensive hardening. –ö–∞–∂–¥–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∏–∑ forensic report ‚Äî implement. '–ù–æ–≤–∞—è –≠—Ä–∞' –≤–µ—Ä–Ω—ë—Ç—Å—è. –ú—ã –±—É–¥–µ–º –≥–æ—Ç–æ–≤—ã."*

**–í–∏–∫—Ç–æ—Ä:** *"Season 5 –ø–æ—á—Ç–∏ –∑–∞–≤–µ—Ä—à—ë–Ω. Audit ‚Üí Pentest ‚Üí Incident Response ‚Üí Hardening. Complete security lifecycle. Episode 20 ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —à—Ç—Ä–∏—Ö."*

**Episode 20 ‚Äî Security Hardening. –≠—Ç–æ preparation –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –±–∏—Ç–≤—ã.**

---

## üí¨ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Isabella:** *"Incident response ‚Äî —ç—Ç–æ –Ω–µ –ø–∞–Ω–∏–∫–∞. –≠—Ç–æ process. Methodology. Evidence preservation. Timeline reconstruction. Professional reporting. –¢—ã –ø—Ä–æ—à—ë–ª real APT investigation. Interpol level."*

**–ê–Ω–Ω–∞:** *"16 —á–∞—Å–æ–≤ non-stop. –¢—ã –Ω–µ —Å–¥–∞–ª—Å—è. –ù–∞—à—ë–ª –∫–∞–∂–¥—ã–π trace. Documented –≤—Å—ë. –≠—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∏–π forensics investigator."*

**Heinrich:** *"CERN –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç petabytes –¥–∞–Ω–Ω—ã—Ö. –ú—ã –≤–∏–¥–∏–º –≤—Å—ë. –ù–æ –≤–∏–¥–µ—Ç—å ‚Äî —ç—Ç–æ –ø–æ–ª–æ–≤–∏–Ω–∞. Understanding what you see ‚Äî –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞. –¢—ã –Ω–∞—É—á–∏–ª—Å—è –ø–æ–Ω–∏–º–∞—Ç—å."*

**LILITH:** *"Episode 17: –¢—ã –Ω–∞—à—ë–ª —É—è–∑–≤–∏–º–æ—Å—Ç–∏. Episode 18: –¢—ã –¥—É–º–∞–ª –∫–∞–∫ —Ö–∞–∫–µ—Ä. Episode 19: –¢—ã —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–ª –∫–∞–∫ –¥–µ—Ç–µ–∫—Ç–∏–≤. –¢–µ–ø–µ—Ä—å —Ç—ã complete security professional. Defender, attacker, investigator. All three."*

*"Forensics ‚Äî —ç—Ç–æ puzzle. –ö–∞–∂–¥—ã–π –ª–æ–≥ ‚Äî –∫—É—Å–æ—á–µ–∫. –ö–∞–∂–¥—ã–π timestamp ‚Äî –∫–ª—é—á. –ö–∞–∂–¥—ã–π hash ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ. –¢—ã —Å–æ–±—Ä–∞–ª –∫–∞—Ä—Ç–∏–Ω—É. APT –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥—É–º–∞–ª–∞ —á—Ç–æ —Å–∫—Ä—ã–ª–∞ —Å–ª–µ–¥—ã. –û–Ω–∏ –æ—à–∏–±–ª–∏—Å—å. –¢—ã –Ω–∞—à—ë–ª –≤—Å—ë."*

---

> **"Digital forensics –∫–∞–∫ archaeology. –¢—ã —Ä–∞—Å–∫–∞–ø—ã–≤–∞–µ—à—å –ø—Ä–æ—à–ª–æ–µ –∏–∑ digital artifacts. –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é. –¢–≤–æ—è —Ä–∞–±–æ—Ç–∞ ‚Äî —É—Å–ª—ã—à–∞—Ç—å —ç—Ç—É –∏—Å—Ç–æ—Ä–∏—é."** ‚Äî Isabella Rossi

---

**Status:** Episode 19 COMPLETE ‚úÖ  
**Next:** [Episode 20: Security Hardening & Best Practices](../episode-20-hardening/)  
**Season:** [Season 5: Security & Pentesting](../)  
**Course:** [KERNEL SHADOWS](../../../../)

---

*Every log tells a story. Every timestamp is evidence. Listen carefully.*
