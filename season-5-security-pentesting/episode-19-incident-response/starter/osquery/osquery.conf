{
  "options": {
    "host_identifier": "hostname",
    "schedule_splay_percent": 10,
    "events_expiry": 3600,
    "disable_events": false,
    "disable_audit": false,
    "audit_allow_config": true,
    "audit_persist": true,
    "audit_allow_sockets": true
  },
  
  "schedule": {
    "incident_response_processes": {
      "query": "SELECT pid, name, path, cmdline, uid, gid FROM processes WHERE (path LIKE '/tmp/%' OR path LIKE '/dev/shm/%' OR name LIKE '%.hidden%');",
      "interval": 60,
      "description": "Monitor suspicious processes in temporary directories"
    },
    
    "network_connections": {
      "query": "SELECT pid, fd, family, protocol, local_address, local_port, remote_address, remote_port, state FROM process_open_sockets WHERE remote_address NOT IN ('127.0.0.1', '::1') AND remote_address != '';",
      "interval": 120,
      "description": "Monitor external network connections"
    },
    
    "kernel_modules": {
      "query": "SELECT name, size, used_by, status FROM kernel_modules WHERE status != 'Live' OR name LIKE '%rootkit%' OR name NOT IN (SELECT name FROM kernel_modules WHERE path LIKE '/lib/modules%');",
      "interval": 300,
      "description": "Detect suspicious kernel modules"
    },
    
    "cron_jobs": {
      "query": "SELECT command, path FROM cron_details WHERE (path LIKE '/tmp/%' OR command LIKE '%tmp%' OR command LIKE '%.sh%' OR command LIKE '%wget%' OR command LIKE '%curl%');",
      "interval": 300,
      "description": "Monitor suspicious cron jobs"
    },
    
    "file_integrity_tmp": {
      "query": "SELECT * FROM file WHERE (path LIKE '/tmp/.%' OR path LIKE '/tmp/.hidden/%') AND type = 'regular';",
      "interval": 180,
      "description": "Monitor hidden files in /tmp"
    },
    
    "ssh_keys": {
      "query": "SELECT * FROM authorized_keys;",
      "interval": 600,
      "description": "Monitor SSH authorized_keys changes"
    },
    
    "listening_ports": {
      "query": "SELECT pid, port, protocol, address, family FROM listening_ports WHERE port NOT IN (22, 80, 443, 3306) AND address NOT IN ('127.0.0.1', '::1');",
      "interval": 120,
      "description": "Detect unusual listening ports"
    },
    
    "user_logins": {
      "query": "SELECT * FROM last WHERE time > (SELECT unix_time FROM time) - 3600;",
      "interval": 300,
      "description": "Monitor recent user logins"
    }
  },
  
  "packs": {
    "incident-detection": "/usr/share/osquery/packs/incident-response.conf",
    "forensics": "/usr/share/osquery/packs/forensics.conf"
  }
}
