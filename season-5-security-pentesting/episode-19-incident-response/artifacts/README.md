# Episode 19: –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî Incident Response & Forensics

## üì¶ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç **—Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–µ–¥—ã APT –∞—Ç–∞–∫–∏** –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ incident response.

## ‚ö†Ô∏è –ö–û–ù–¢–ï–ö–°–¢ –°–Æ–ñ–ï–¢–ê

**–î–µ–Ω—å 39, 03:47 ‚Äî –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ò–ù–¶–ò–î–ï–ù–¢**

–°–µ—Ä–≤–µ—Ä –≤ –°—Ç–æ–∫–≥–æ–ª—å–º–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π "–ù–æ–≤–∞—è –≠—Ä–∞". APT (Advanced Persistent Threat) –∞—Ç–∞–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
1. **Initial Access:** Phishing email ‚Üí credentials —É–∫—Ä–∞–¥–µ–Ω—ã
2. **Execution:** Backdoor —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `/tmp/.hidden/`
3. **Persistence:** Cron job –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è reconnect
4. **Privilege Escalation:** Kernel exploit –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω
5. **Defense Evasion:** –õ–æ–≥–∏ —á–∞—Å—Ç–∏—á–Ω–æ –æ—á–∏—â–µ–Ω—ã
6. **Credential Access:** Keylogger —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
7. **Discovery:** Network scanning
8. **Lateral Movement:** SSH to other servers (attempted)
9. **Collection:** Database dump
10. **Exfiltration:** 2.3 GB –¥–∞–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ C2 —Å–µ—Ä–≤–µ—Ä

**–í–∞—à–∞ –∑–∞–¥–∞—á–∞:** –ù–∞–π—Ç–∏ –≤—Å–µ —Å–ª–µ–¥—ã, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å timeline, —Å–æ–±—Ä–∞—Ç—å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞.

---

## üìÅ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

### 1. compromised_logs/

–õ–æ–≥–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:

**auth.log** ‚Äî authentication events
- –£—Å–ø–µ—à–Ω—ã–µ/–Ω–µ—É–¥–∞—á–Ω—ã–µ –ª–æ–≥–∏–Ω—ã
- SSH connections
- sudo usage
- **–ò—â–∏—Ç–µ:** –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞, –Ω–µ–æ–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è

**syslog** ‚Äî system messages
- Kernel messages
- System services
- **–ò—â–∏—Ç–µ:** –ù–µ–æ–±—ã—á–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π

**apache_access.log** ‚Äî web server access
- HTTP requests
- IP addresses
- User agents
- **–ò—â–∏—Ç–µ:** Vulnerability scanning, suspicious requests

**apache_error.log** ‚Äî web server errors
- PHP errors
- Failed requests
- **–ò—â–∏—Ç–µ:** Exploit attempts

**auditd.log** ‚Äî Linux Audit events (–µ—Å–ª–∏ –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- File access
- System calls
- **–ò—â–∏—Ç–µ:** –ù–µ–æ–±—ã—á–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### 2. memory_dumps/

–ü—Ä–∏–º–µ—Ä—ã memory dumps –¥–ª—è forensics:

**process_dump.txt** ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –º–æ–º–µ–Ω—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
**network_connections.txt** ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
**loaded_modules.txt** ‚Äî –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ kernel modules

**–î–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ Volatility (advanced):**
- –†–µ–∞–ª—å–Ω—ã–µ dumps —Ç—Ä–µ–±—É—é—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞ (–Ω–µ –≤–∫–ª—é—á–µ–Ω—ã)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤

### 3. indicators/

Indicators of Compromise (IoC):

**ioc.txt** ‚Äî –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:
- IP –∞–¥—Ä–µ—Å–∞ C2 —Å–µ—Ä–≤–µ—Ä–æ–≤
- –•–µ—à–∏ malware —Ñ–∞–π–ª–æ–≤
- Suspicious domains
- Known exploit signatures

**timeline_raw.csv** ‚Äî —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è timeline reconstruction

---

## üîç –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd artifacts/compromised_logs/

# –ò—â–∏—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
grep -i "failed\|invalid\|error" auth.log
grep -E "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}" auth.log | sort | uniq

# –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏
awk '{print $1,$2,$3}' syslog | sort | uniq -c

# Web –∞—Ç–∞–∫–∏
grep -i "select\|union\|drop\|script" apache_access.log
```

### –®–∞–≥ 2: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Timeline

```bash
# –û–±—ä–µ–¥–∏–Ω–∏—Ç–µ timestamps –∏–∑ –≤—Å–µ—Ö –ª–æ–≥–æ–≤
cat compromised_logs/*.log | grep -E "^[A-Z][a-z]{2} [0-9 ]+" | sort

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ timeline_raw.csv
cd indicators/
cat timeline_raw.csv | column -t -s ','
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ IoC

```bash
cd indicators/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP –∞–¥—Ä–µ—Å–∞
cat ioc.txt | grep "IP:"

# –°—Ä–∞–≤–Ω–∏—Ç–µ —Å –≤–∞—à–∏–º–∏ –ª–æ–≥–∞–º–∏
grep -f <(cat ioc.txt | grep "IP:" | awk '{print $2}') ../compromised_logs/*.log
```

---

## üéØ –ó–∞–¥–∞–Ω–∏—è

**–ù–∞–π–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:**

1. **–ö–æ–≥–¥–∞ –Ω–∞—á–∞–ª–∞—Å—å –∞—Ç–∞–∫–∞?** (timestamp –ø–µ—Ä–≤–æ–≥–æ suspicious event)
2. **–û—Ç–∫—É–¥–∞ –ø—Ä–∏—à–ª–∞ –∞—Ç–∞–∫–∞?** (IP –∞–¥—Ä–µ—Å –∞—Ç–∞–∫—É—é—â–µ–≥–æ)
3. **–ö–∞–∫ –ø–æ–ª—É—á–∏–ª–∏ initial access?** (–º–µ—Ç–æ–¥ –≤–∑–ª–æ–º–∞)
4. **–ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã?**
5. **–ë—ã–ª –ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω backdoor?** (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
6. **–ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —É–∫—Ä–∞–ª–∏?** (—á—Ç–æ exfiltrated)
7. **–ö–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –∞—Ç–∞–∫–∞?** (–ø–æ—Å–ª–µ–¥–Ω–∏–π event)

**–ó–∞–ø–∏—à–∏—Ç–µ –Ω–∞—Ö–æ–¥–∫–∏ –¥–ª—è forensic report!**

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–≠—Ç–∏ –ª–æ–≥–∏ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –°–æ–¥–µ—Ä–∂–∞—Ç —Ç–∏–ø–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫
- ‚úÖ –û—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö APT –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞—Ö

**–ù–ï —Å–æ–¥–µ—Ä–∂–∞—Ç:**
- ‚ùå –†–µ–∞–ª—å–Ω—ã–µ credentials
- ‚ùå –ù–∞—Å—Ç–æ—è—â–∏–µ IP –∞–¥—Ä–µ—Å–∞
- ‚ùå Production –¥–∞–Ω–Ω—ã–µ

---

## üìö –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã

**MITRE ATT&CK Framework:**
- –¢–µ—Ö–Ω–∏–∫–∏ –∞—Ç–∞–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- –ö–∞–∂–¥—ã–π —à–∞–≥ –∞—Ç–∞–∫–∏ mapped to TTPs (Tactics, Techniques, Procedures)

**–¶–µ–ø–æ—á–∫–∞ –∞—Ç–∞–∫–∏ (–ø–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º):**
```
Initial Access (T1078) ‚Üí Execution (T1059) ‚Üí 
Persistence (T1053) ‚Üí Privilege Escalation (T1068) ‚Üí
Defense Evasion (T1070) ‚Üí Credential Access (T1056) ‚Üí
Discovery (T1046) ‚Üí Lateral Movement (T1021) ‚Üí
Collection (T1005) ‚Üí Exfiltration (T1041)
```

---

## üîó –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

**–ë–∞–∑–æ–≤—ã–µ (Linux):**
```bash
grep, awk, sed          # —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
journalctl              # systemd logs
ausearch                # auditd logs
last, lastlog           # login history
netstat, ss             # network
```

**–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ:**
```bash
Volatility              # memory forensics
Autopsy                 # disk forensics
Wireshark              # network forensics
ELK Stack              # log aggregation
```

---

> **Isabella Rossi (Interpol):** *"–ö–∞–∂–¥—ã–π –ª–æ–≥ ‚Äî –∫—É—Å–æ—á–µ–∫ –ø–∞–∑–ª–∞. –í–∞—à–∞ —Ä–∞–±–æ—Ç–∞ ‚Äî —Å–æ–±—Ä–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω—É. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ? –ö–æ–≥–¥–∞? –ö–∞–∫? –ö—Ç–æ? Timeline reconstruction ‚Äî —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ."*

> **LILITH:** *"–ê—Ç–∞–∫—É—é—â–∏–π –¥—É–º–∞–ª —á—Ç–æ —Å–∫—Ä—ã–ª —Å–ª–µ–¥—ã. –£–¥–∞–ª–∏–ª –ª–æ–≥–∏. –ù–æ –∑–∞–±—ã–ª –ø—Ä–æ auditd. –ü—Ä–æ kernel logs. –ü—Ä–æ network connections. –í—Å–µ–≥–¥–∞ –æ—Å—Ç–∞—é—Ç—Å—è —Å–ª–µ–¥—ã."*


