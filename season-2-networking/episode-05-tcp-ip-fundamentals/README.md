# Episode 05: TCP/IP Fundamentals

```
ะะะะะะฆะะฏ: KERNEL SHADOWS
ะกะะะะ: 2 โ Networking
ะญะะะะะ: 05 โ TCP/IP Fundamentals
ะะะะะฆะะฏ: ๐ท๐บ ะะพัะบะฒะฐ, ะะพััะธั (ะฆะะ "ะะพัะบะฒะฐ-1")
ะะะะฌ ะะะะะะฆะะ: 9 (ะธะท 60)
ะกะะะะะะกะขะฌ: โญโญโโโ
ะะะะะฏ: 5-5.5 ัะฐัะพะฒ
```

---

## ๐ ะะตะฝั 8 (10 ะพะบััะฑัั 2025, 21:37): ะะฒะพะฝะพะบ ะพั ะะปะตะบัะฐ

### ะะพะฒะพัะธะฑะธััะบ โ ะะพัะบะฒะฐ

**ะะพะบะฐัะธั:** ะะฒะฐััะธัะฐ ะะฐะบัะฐ, ะะบะฐะดะตะผะณะพัะพะดะพะบ. ะะฐ ะพะบะฝะพะผ ัะตะผะฝะพัะฐ ะธ ัะฝะตะณ. ะัะตะผั: 21:37.

ะะฐะบั ัะพะปัะบะพ ััะพ ะทะฐะบะพะฝัะธะป Episode 04 (package management). ะะธะบัะพั ะฟะตัะตะฒัะป $15K. 4 ัะฟะธะทะพะดะฐ ะฟัะพะนะดะตะฝั.

ะขะตะปะตัะพะฝ. **ะะปะตะบั ะกะพะบะพะปะพะฒ** (ะดะฒะพััะพะดะฝัะน ะฑัะฐั).

> **ะะปะตะบั:**
> *"ะะฐะบั. ะฃ ะฝะฐั ะฟัะพะฑะปะตะผะฐ. ะััะปะพะฒ ะทะฝะฐะตั ะพ ะฝะฐั. ะัะถะตะฝ ัั. ะะธัะฝะพ. ะะฐะฒััะฐ. ะะพัะบะฒะฐ."*

ะะฐะบั: *"ะะฐะบะฐั ะฟัะพะฑะปะตะผะฐ?"*

> **ะะปะตะบั:**
> *"ะะพ ัะตะปะตัะพะฝั ะฝะต ะณะพะฒะพัั. ะัะปะตัะฐะตัั ัะตะนัะพะผ S7 ะฒ 09:15. ะะธะปะตั ะพัะฟัะฐะฒะธะป ะฝะฐ email. ะัััะตัั ะฒ ะะพะผะพะดะตะดะพะฒะพ."*

ะะฐะบั: *"ะะปะตะบั, ััะพ ะฟัะพะธััะพะดะธั?"*

> **ะะปะตะบั:**
> *"ะะฐั ะฟัะพัะปััะธะฒะฐัั. ะกะตัะธ ัะบะพะผะฟัะพะผะตัะธัะพะฒะฐะฝั. ะัะธะตะทะถะฐะน."*

ะัะดะบะธ. ะะปะตะบั ะพัะบะปััะธะปัั.

ะะฐะบั ัะผะพััะธั ะฝะฐ ัะบัะฐะฝ. Email ะพั ะะปะตะบัะฐ:
```
From: a.sokolov@secured.net
Subject: ะะธะปะตั S7-1203 (NVS โ DME)
Attachment: ticket.pdf

ะะฐะฒััะฐ. 09:15. ะะต ะพะฟะฐะทะดัะฒะฐะน.
โ A.
```

ะะฐะบั: *"ะงััั. ะงัะพ-ัะพ ะฟะพัะปะพ ะฝะต ัะฐะบ."*

**ะะฐัะทะฐ.**

ะะฐะบั: *"ะะฐะดะฝะพ. ะะพัะบะฒะฐ ัะฐะบ ะะพัะบะฒะฐ."*

---

## ๐ ะะตะฝั 9 (11 ะพะบััะฑัั 2025, 12:40): ะัััะตัะฐ ั ะบะพะผะฐะฝะดะพะน

### ะััะพะฟะพัั ะะพะผะพะดะตะดะพะฒะพ โ ะฆะะ "ะะพัะบะฒะฐ-1"

**12:40 โ ะะพะผะพะดะตะดะพะฒะพ, ะทะฐะป ะฟัะธะปััะฐ**

ะะฐะบั ะฒััะพะดะธั ะธะท ัะตัะผะธะฝะฐะปะฐ. ะขะพะปะฟะฐ, ัะฐะบัะธ, ัะพะปะพะดะฝัะน ะฒะตัะตั. ะะพัะบะฒะฐ. ะะฟะตัะฒัะต ะทะฐ ะฟัะตะดะตะปะฐะผะธ ะะพะฒะพัะธะฑะธััะบะฐ ะดะปั ัะฐะฑะพัั.

ะงะตัะฝัะน BMW X5. ะขะพะฝะธัะพะฒะฐะฝะฝัะต ัััะบะปะฐ. ะะพะดะธัะตะปััะบะฐั ะดะฒะตัั ะพัะบััะฒะฐะตััั.

**ะะปะตะบั ะกะพะบะพะปะพะฒ.** 33 ะณะพะดะฐ. ะะพัะพัะบะฐั ัััะธะถะบะฐ, ัะฟะพััะธะฒะฝะฐั ะบัััะบะฐ, ะฟัะพะฝะธัะฐัะตะปัะฝัะน ะฒะทะณะปัะด. Ex-FSB. ะขะฒะพะน ะดะฒะพััะพะดะฝัะน ะฑัะฐั.

> **ะะปะตะบั:**
> *"ะะฐะบั. ะะพะฑัะพ ะฟะพะถะฐะปะพะฒะฐัั ะฒ ะะพัะบะฒั. ะกะฐะดะธัั. ะะพะตะดะตะผ ะฒ ะฆะะ."*

ะะฐะบั ัะฐะดะธััั. BMW ัะตะทะถะฐะตั ะพั ัะตัะผะธะฝะฐะปะฐ.

> **ะะปะตะบั:**
> *"ะะฐะบ ะฟัะพัะปะธ ะฟะตัะฒัะต 4 ัะฟะธะทะพะดะฐ?"*

ะะฐะบั: *"ะกะฟัะฐะฒะธะปัั. ะะธะบัะพั ะดะพะฒะพะปะตะฝ. ะะพ ัั ะถะต ะฝะต ะฟะพััะพะผั ะผะตะฝั ะฒัะทะฒะฐะป?"*

> **ะะปะตะบั:**
> *"ะะตั. ะััะปะพะฒ ะฐะบัะธะฒะธะทะธัะพะฒะฐะปัั. DDoS ะฐัะฐะบะธ. DNS spoofing. ะัะตัะฐ ะฑัะปะพ 50,000 ะฟะฐะบะตัะพะฒ ะฒ ัะตะบัะฝะดั ะฝะฐ ัะตัะฒะตัั ะะธะบัะพัะฐ."*

ะะฐะบั: *"ะััะปะพะฒ? ะัะพ ััะพ?"*

ะะฐัะทะฐ. ะะปะตะบั ัะผะพััะธั ะฒ ะทะตัะบะฐะปะพ ะทะฐะดะฝะตะณะพ ะฒะธะดะฐ. ะัะพะฒะตััะตั ัะปะตะถะบั.

> **ะะปะตะบั:**
> *"ะะพะปะบะพะฒะฝะธะบ ะะณะพัั ะััะปะพะฒ. ะคะกะ, ะฃะฟัะฐะฒะปะตะฝะธะต 'ะ'. ะะพะน ะฑัะฒัะธะน ะฝะฐัะฐะปัะฝะธะบ. ะะพะณะดะฐ ั ัััะป ะธะท ะคะกะ... ะพะฝ ะฝะต ะฟัะพััะธะป."*

ะะฐะบั: *"ะ ััะพ ะตะผั ะฝัะถะฝะพ?"*

> **ะะปะตะบั:**
> *"ะะฐั. ะะตะฝั. ะะธะบัะพัะฐ. ะะฟะตัะฐัะธั. ะฏ ะฝะต ะทะฝะฐั. ะะพ ะพะฝ ะฐัะฐะบัะตั ัะตัะธ. ะะฐะผ ะฝัะถะฝะพ ะฟะพะฝััั ะบะฐะบ. ะะปั ััะพะณะพ ัั ะดะพะปะถะตะฝ ะฟะพะฝะธะผะฐัั TCP/IP."*

**13:30 โ ะฆะะ "ะะพัะบะฒะฐ-1", ะกะตะฒะตัะพ-ะะพััะพัะฝัะน ะะ**

ะัะพะผััะปะตะฝะฝะฐั ะทะพะฝะฐ. ะะดะฐะฝะธะต ะฑะตะท ะฒัะฒะตัะพะบ. 5 ััะฐะถะตะน. ะะตัะพะฝะฝัะต ััะตะฝั. ะััะฐะฝะฐ. ะขััะฝะธะบะตัั. ะะธะพะผะตััะธั.

ะะปะตะบั ะฟัะพะฒะพะดะธั ะะฐะบัะฐ ะฒะฝัััั. ะฅะพะปะพะดะฝัะน ะฒะพะทะดัั ะบะพะฝะดะธัะธะพะฝะตัะพะฒ. ะัะดะตะฝะธะต ัะตัะฒะตัะพะฒ. ะะธะณะฐััะธะต ะทะตะปัะฝัะต ะธ ะบัะฐัะฝัะต LED.

**ะกะตัะฒะตัะฝะฐั ะบะพะผะฝะฐัะฐ A-12.**

ะขัะธ ัะตะปะพะฒะตะบะฐ ัะถะต ะทะดะตัั:

### **Viktor Petrov**
ะกะตะดัะต ะฒะพะปะพัั, ัััะฝัะน ะบะพัััะผ. ะะพะพัะดะธะฝะฐัะพั ะพะฟะตัะฐัะธะธ.

> **ะะธะบัะพั:**
> *"ะะฐะบั. ะฅะพัะพัะพ ััะพ ะฟัะธะปะตัะตะป. ะกะธััะฐัะธั ัะตัััะทะฝะฐั."*

### **Anna Kovaleva**
32 ะณะพะดะฐ, ะฑะปะพะฝะดะธะฝะบะฐ, ัััะพะณะธะน ะบะพัััะผ, laptop ั Wireshark. Ex-FSB, forensics expert.

> **ะะฝะฝะฐ:**
> *"ะะฐะบั ะกะพะบะพะปะพะฒ. ะะปะตะบั ะผะฝะพะณะพ ะพ ัะตะฑะต ัะฐััะบะฐะทัะฒะฐะป. ะฏ ะะฝะฝะฐ. Forensics. ะัะดั ัะฐะฑะพัะฐัั ั ะปะพะณะฐะผะธ ะฐัะฐะบ. ะะฐะผ ะฝัะถะตะฝ ัะฒะพะน ัะธัะฐะดะผะธะฝ ะพะฟัั ะดะปั ะทะฐัะธัั ัะตัะตะน."*

### **Dmitry Orlov**
29 ะปะตั, hoodie, ะดะถะธะฝัั, 3 ะผะพะฝะธัะพัะฐ. DevOps engineer.

> **ะะผะธััะธะน:**
> *"ะะฐะบั! ะะฐะบะพะฝะตั-ัะพ ะปะธัะฝะพ. ะขะฒะพะธ ัะบัะธะฟัั ะธะท Episode 02-04 โ ะพะณะพะฝั. ะฏ ะธั ัะถะต ะทะฐะดะตะฟะปะพะธะป ะฝะฐ 15 ัะตัะฒะตัะพะฒ. ะะพ ัะตัั โ ััะพ ะผะพั ัะปะฐะฑะฐั ััะพัะพะฝะฐ. ะขั ัะธะปัะฝะตะต."*

Max: *"ะัะธััะฝะพ ะฟะพะทะฝะฐะบะพะผะธัััั. ะงัะพ ัะปััะธะปะพัั?"*

**ะะธะบัะพั ะฟะพะบะฐะทัะฒะฐะตั ะฝะฐ ะผะพะฝะธัะพัั.**

Grafana dashboard. ะัะฐัะฝัะต ะณัะฐัะธะบะธ. Alerts.

> **ะะธะบัะพั:**
> *"50,000 ะฟะฐะบะตัะพะฒ/ัะตะบ. DDoS. DNS ะทะฐะฟัะพัั ะธะดัั ะฝะต ััะดะฐ. ะัะพ-ัะพ ะฟัะพัะปััะธะฒะฐะตั ััะฐัะธะบ. ะััะปะพะฒ?"*

> **ะะปะตะบั:**
> *"ะกะบะพัะตะต ะฒัะตะณะพ. ะะฝ ะธัะฟะพะปัะทัะตั ะผะตัะพะดั, ะบะพัะพััะต ั ะฟัะธะผะตะฝัะป ะฒ ะคะกะ."*

> **Anna:**
> *"ะะพะณะธ ะฟะพะบะฐะทัะฒะฐัั ะฟะพะดะพะทัะธัะตะปัะฝัะน ััะฐัะธะบ ั 185.220.101.47. Tor exit node. ะะปะฐััะธัะตัะบะธะน Krylov ะฟะพัะตัะบ."*

> **Viktor:**
> *"ะะฐะบั, ะฝะฐะผ ะฝัะถะฝะพ ะฟะพะฝััั ัะตัะธ. TCP/IP. ะะพะดะตะปั OSI. IP ะฐะดัะตัะฐ. ะะพััั. ะะฐะบ ัะฐะฑะพัะฐัั ะฐัะฐะบะธ. ะะฐะบ ะทะฐัะธัะฐัััั."*

> **Alex:**
> *"ะฏ ะฝะฐััั ัะตะฑั ะดัะผะฐัั ะบะฐะบ ะฐัะฐะบัััะธะน. Anna โ ะบะฐะบ ะทะฐัะธัะฝะธะบ. Dmitry ะฟะพะผะพะถะตั ั ะฐะฒัะพะผะฐัะธะทะฐัะธะตะน."*

> **Viktor:**
> *"ะะฐัะธะฝะฐะตะผ ั ะพัะฝะพะฒ. TCP/IP. ะกะตะณะพะดะฝั. ะฃ ัะตะฑั 5-6 ัะฐัะพะฒ. ะะพะณััะถะฐะนัั."*

---

## ๐ฎ ะะฐัะฐะปะพ ะผะธััะธะธ

### 14:00 โ LILITH ะฟะพัะฒะปัะตััั

Max ัะฐะดะธััั ะทะฐ ัะฒะพะฑะพะดะฝัะน ัะตัะผะธะฝะฐะป. Linux workstation. Ubuntu 24.04. ะขัะธ ะผะพะฝะธัะพัะฐ. ะะปะฐะฒะธะฐัััะฐ ะผะตัะฐะฝะธัะตัะบะฐั.

ะญะบัะฐะฝ ะผะธะณะฐะตั. LILITH ะฐะบัะธะฒะธััะตััั:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                               โ
โ   LILITH v2.0 โ Networking Module                            โ
โ                                                               โ
โ   ะัะธะฒะตั ัะฝะพะฒะฐ, ะะฐะบั.                                          โ
โ   ะะพะฒะพัะธะฑะธััะบ ะฑัะป ัะฐะทะผะธะฝะบะพะน. ะะพัะบะฒะฐ โ ะฝะฐััะพััะฐั ัะฐะฑะพัะฐ.      โ
โ                                                               โ
โ   Krylov ะฐัะฐะบัะตั ัะตัะธ. ะงัะพะฑั ะทะฐัะธัะฐัััั, ะฝัะถะฝะพ ะฟะพะฝะธะผะฐัั      โ
โ   ะบะฐะบ ัะฐะฑะพัะฐัั ัะตัะธ. TCP/IP โ ััะพ ัะทัะบ ะธะฝัะตัะฝะตัะฐ.            โ
โ                                                               โ
โ   ะะฐะถะดัะน ะฟะฐะบะตั ัะฐััะบะฐะทัะฒะฐะตั ะธััะพัะธั.                         โ
โ   ะะฐััะธัั ัะปััะฐัั.                                            โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

> **LILITH:**
> *"ะกะตะนัะฐั ัั ะฒ ะฆะะ 'ะะพัะบะฒะฐ-1'. ะะพะบััะณ ัะตะฑั 200+ ัะตัะฒะตัะพะฒ. 50 ะธะท ะฝะธั โ ะพะฟะตัะฐัะธั Viktor. ะััะฐะปัะฝัะต โ ััะถะธะต. ะะฐะถะดัะน ะธะผะตะตั IP ะฐะดัะตั. ะะฐะถะดัะน ัะปััะฐะตั ะฟะพััั. ะะตะบะพัะพััะต ะฐัะฐะบััั. ะขะฒะพั ะทะฐะดะฐัะฐ โ ะฟะพะฝััั ะบัะพ ะตััั ะบัะพ."*

Max: *"ะก ัะตะณะพ ะฝะฐัะฐัั?"*

> **LILITH:**
> *"ะก ะพัะฝะพะฒ. IP ะฐะดัะตัะฐ. TCP vs UDP. ะะพััั. ะกะพะบะตัั. ะะพะดะตะปั TCP/IP. ะะพัะพะผ โ ะฟัะฐะบัะธะบะฐ. ะะฟัะตะดะตะปะธัั IP ัะตัะฒะตัะฐ Viktor. ะัะพะฒะตัะธัั ะพัะบััััะต ะฟะพััั. ะะฐะนะดััั ะผะฐััััั ะดะพ ัะตัะฒะตัะฐ. ะะพะตัะฐะปะธ."*

---

## ๐ ะฆะะะ 1: IP ะะดัะตัะฐ โ "ะขะฒะพะน ะฐะดัะตั ะฒ ัะตัะธ" (12-15 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (2-3 ะผะธะฝ)

Alex ะฟะพะฒะพัะฐัะธะฒะฐะตััั ะบ Max:

> **ะะปะตะบั:**
> *"ะะตัะฒะพะต ะฟัะฐะฒะธะปะพ networking โ ะทะฝะฐะน ัะฒะพะน ะฐะดัะตั. ะะฐะบ ัะตะฑั ะทะพะฒัั ะฒ ัะตัะธ? ะะตะท ััะพะณะพ ัั ghost."*

ะะฝะฝะฐ ะฟะพะบะฐะทัะฒะฐะตั ะฝะฐ ัะบัะฐะฝ ั Wireshark:

> **ะะฝะฝะฐ:**
> *"ะะฐะถะดัะน ะฟะฐะบะตั ะธะผะตะตั source IP (ะพัะบัะดะฐ) ะธ destination IP (ะบัะดะฐ). ะัะปะธ ัั ะฝะต ะทะฝะฐะตัั ัะฒะพะน IP โ ัั ะฝะต ะทะฝะฐะตัั ะบัะพ ัั ะฒ ััะพะน ะธะณัะต."*

> **LILITH:**
> *"IP ะฐะดัะตั โ ัะฒะพั ัะธััะพะฒะฐั ะปะธัะฝะพััั. ะ ะธะฝัะตัะฝะตัะต ัั ะฝะต 'ะะฐะบั ะกะพะบะพะปะพะฒ'. ะขั 192.168.100.42. ะะฐะฟะพะผะฝะธ ะตะณะพ."*

---

### ๐ ะขะตะพัะธั: ะงัะพ ัะฐะบะพะต IP ะฐะดัะตั? (5-7 ะผะธะฝ)

#### **ะะฟัะตะดะตะปะตะฝะธะต:**
IP ะฐะดัะตั (Internet Protocol Address) โ ัะฝะธะบะฐะปัะฝัะน ัะธัะปะพะฒะพะน ะธะดะตะฝัะธัะธะบะฐัะพั ััััะพะนััะฒะฐ ะฒ ัะตัะธ.

#### **ะะตัะฐัะพัะฐ: IP ะฐะดัะตั = ะะพััะพะฒัะน ะฐะดัะตั** ๐ฌ

ะัะตะดััะฐะฒั:
- **IP ะฐะดัะตั** = ะฐะดัะตั ัะฒะพะตะณะพ ะดะพะผะฐ (ัะปะธัะฐ, ะดะพะผ, ะบะฒะฐััะธัะฐ)
- **ะะฐะบะตั** = ะฟะธััะผะพ ะธะปะธ ะฟะพััะปะบะฐ
- **ะะฝัะตัะฝะตั** = ะฟะพััะพะฒะฐั ัะปัะถะฑะฐ

```
ะะพััะพะฒัะน ะฐะดัะตั:                IP ะฐะดัะตั:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะพััะธั                     โ   192  (ัััะฐะฝะฐ)
ะะพะฒะพัะธะฑะธััะบ                โ   168  (ะณะพัะพะด)
ัะป. ะะตะฝะธะฝะฐ                 โ   1    (ัะปะธัะฐ)
ะดะพะผ 42, ะบะฒ. 15             โ   100  (ะดะพะผ.ะบะฒะฐััะธัะฐ)

ะะพะปะฝัะน ะฐะดัะตั: 192.168.1.100
```

**ะะตะท ะฐะดัะตัะฐ** = ะฟะธััะผะพ ะฝะต ะดะพะนะดัั. **ะะตะท IP** = ะฟะฐะบะตั ะฟะพัะตััะตััั.

> **LILITH:**
> *"IP ะฐะดัะตั โ ััะพ ะฝะต ะฟัะพััะพ ัะธัะปะพ. ะญัะพ ัะฒะพั ะฟะพะทะธัะธั ะฒ ะณะปะพะฑะฐะปัะฝะพะน ะบะฐััะต ะธะฝัะตัะฝะตัะฐ. ะัะฐะบัััะธะน ัะทะฝะฐัั ัะฒะพะน IP โ ะพะฝ ะทะฝะฐะตั ะณะดะต ัั."*

---

#### **ะคะพัะผะฐั IPv4:**

```
   192   .   168   .    1    .   100
   โโโ       โโโ        โ         โโโ
   ะกะตัั     ะะพะดัะตัั   ะะพะดัะตัั    ะฅะพัั
  (network) (subnet)  (subnet)  (host)
```

- **4 ะพะบัะตัะฐ** (ัะธัะปะฐ 0-255)
- ะะฐะทะดะตะปะตะฝั ัะพัะบะฐะผะธ
- ะัะธะผะตัั: `10.0.0.42`, `192.168.1.1`, `8.8.8.8`

---

#### **Private vs Public IP:**

**ะะฝะฐะปะพะณะธั:** Private = ะดะพะผะฐัะฝะธะน ะฐะดัะตั, Public = ะฐะดัะตั ะพัะธัะฐ

| ะขะธะฟ | ะะธะฐะฟะฐะทะพะฝ | ะะดะต ะธัะฟะพะปัะทัะตััั | ะะธะดะตะฝ ะธะท ะธะฝัะตัะฝะตัะฐ? |
|-----|----------|------------------|---------------------|
| **Private (Class A)** | 10.0.0.0 โ 10.255.255.255 | ะะฝัััะตะฝะฝะธะต ัะตัะธ | โ ะะตั |
| **Private (Class B)** | 172.16.0.0 โ 172.31.255.255 | ะะพัะฟะพัะฐัะธะฒะฝัะต ัะตัะธ | โ ะะตั |
| **Private (Class C)** | 192.168.0.0 โ 192.168.255.255 | ะะพะผะฐัะฝะธะต ัะตัะธ | โ ะะตั |
| **Public** | ะัั ะพััะฐะปัะฝะพะต | ะะฝัะตัะฝะตั | โ ะะฐ |

**ะัะธะผะตัั:**
```bash
192.168.1.100   # Private (ะดะพะผะฐัะฝัั ัะตัั)
10.50.1.100     # Private (ะฆะะ "ะะพัะบะฒะฐ-1")
8.8.8.8         # Public (Google DNS)
142.250.185.46  # Public (Google ัะตัะฒะตั)
```

> **LILITH:**
> *"Private IP = ัะฒะพั ะบะฒะฐััะธัะฐ. Public IP = ะพัะธัะฝะพะต ะทะดะฐะฝะธะต. Private โ ะฑะตะทะพะฟะฐัะฝะตะต (ัะบััั ะพั ะธะฝัะตัะฝะตัะฐ). Public โ ะฒะธะดะธะผ ะฒัะตะผ."*

---

#### **ะกะฟะตัะธะฐะปัะฝัะต ะฐะดัะตัะฐ:**

**Loopback (localhost):**
```
127.0.0.1 = "ัะฐะทะณะพะฒะพั ั ัะฐะผะธะผ ัะพะฑะพะน"
```

**ะะตัะฐัะพัะฐ:** Loopback = ัะผะพััะตัั ะฒ ะทะตัะบะฐะปะพ
- ะะพะผะฟัััะตั ะพะฑัะฐัะฐะตััั ะบ ัะฐะผะพะผั ัะตะฑะต
- ะัะฟะพะปัะทัะตััั ะดะปั ัะตััะธัะพะฒะฐะฝะธั
- `ping 127.0.0.1` ะฒัะตะณะดะฐ ัะฐะฑะพัะฐะตั (ะตัะปะธ ัะตัั ะถะธะฒะฐ)

**Broadcast:**
```
255.255.255.255 = "ะบัะธะบ ะฝะฐ ะฒัั ัะปะธัั"
```
- ะัะฟัะฐะฒะธัั ะฟะฐะบะตั ะะกะะ ะฒ ัะตัะธ

---

#### **IPv4 vs IPv6:**

| IPv4 | IPv6 |
|------|------|
| 32 ะฑะธัะฐ | 128 ะฑะธั |
| `192.168.1.100` | `2001:0db8:85a3::8a2e:0370:7334` |
| 4.3 ะผะปัะด ะฐะดัะตัะพะฒ | 340 ัะฝะดะตัะธะปะปะธะพะฝะพะฒ ะฐะดัะตัะพะฒ |
| ะะพััะธ ะทะฐะบะพะฝัะธะปะธัั | ะัะดััะตะต |

**ะะพัะตะผั IPv6?**
- IPv4 ะฐะดัะตัะฐ ะทะฐะบะพะฝัะธะปะธัั (~2011)
- IoT ััััะพะนััะฒ ะผะธะปะปะธะฐัะดั (ัะพะปะพะดะธะปัะฝะธะบะธ, ะปะฐะผะฟะพัะบะธ, ะผะฐัะธะฝั)
- IPv6 = ะฟะพััะธ ะฑะตัะบะพะฝะตัะฝะพะต ะบะพะปะธัะตััะฒะพ ะฐะดัะตัะพะฒ

> **LILITH:**
> *"IPv4 = ััะฐัะฐั ะบะฒะฐััะธัะฐ (ะฐะดัะตัะพะฒ ะผะฐะปะพ, ะฟัะธัะพะดะธััั ะดะตะปะธัั). IPv6 = ะฝะพะฒัะน ัะฐะนะพะฝ (ะฐะดัะตัะพะฒ ะฝะฐ ะฒัะตั ัะฒะฐัะธั)."*

---

#### **ASCII Diagram: IP Address Structure**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                   IP ADDRESS                        โ
โ                                                     โ
โ    Quad 1   .   Quad 2   .   Quad 3   .   Quad 4   โ
โ      192    .     168    .      1     .    100      โ
โ       โ            โ            โ            โ       โ
โ     Network      Subnet      Subnet       Host      โ
โ   (0-255)      (0-255)      (0-255)     (0-255)     โ
โ                                                     โ
โ  "ะัะพ ัั ะฒ ัะตัะธ?"                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะัะธะผะตั ัะฐะทะฑะพัะฐ:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
10.50.1.100

10.*.*.*     โ ะกะตัั ะบะปะฐััะฐ A (private)
10.50.*.*    โ ะะพะดัะตัั (ะฆะะ "ะะพัะบะฒะฐ-1")
10.50.1.*    โ ะะพะดัะตัั rack 1
10.50.1.100  โ ะะพะฝะบัะตัะฝัะน ัะตัะฒะตั (shadow-server-02)
```

---

### ๐ป ะัะฐะบัะธะบะฐ: ะฃะทะฝะฐะน ัะฒะพะน IP ะฐะดัะตั (3-5 ะผะธะฝ)

#### **ะะฐะดะฐัะฐ:**
ะะฟัะตะดะตะปะธัะต IP ะฐะดัะตั ัะฐะฑะพัะตะน ััะฐะฝัะธะธ Max ะฒ ะฆะะ "ะะพัะบะฒะฐ-1".

**ะะพะฟัะพะฑัะนัะต ัะฐะผะธ** (2-3 ะผะธะฝััั) ะฟะตัะตะด ะฟะพะดัะบะฐะทะบะฐะผะธ:

```bash
# ะะฐัะฐ ะบะพะผะฐะฝะดะฐ ะทะดะตัั
```

---

<details>
<summary>๐ก ะะพะดัะบะฐะทะบะฐ 1 (ะตัะปะธ ะทะฐััััะปะธ > 3 ะผะธะฝััั)</summary>

**LILITH:**
> *"ะะพะผะฐะฝะดะฐ `ip` โ ัะฒะพะน ะดััะณ. `ip address` ะธะปะธ ะบะพัะพัะต `ip a`. ะกะผะพััะธ ะฒะฝะธะผะฐัะตะปัะฝะพ โ ัะฐะผ ะผะพะถะตั ะฑััั ะฝะตัะบะพะปัะบะพ ะธะฝัะตััะตะนัะพะฒ: `lo` (loopback), `eth0` (ethernet), `wlan0` (wifi). ะขะตะฑะต ะฝัะถะตะฝ ะฐะบัะธะฒะฝัะน ะธะฝัะตััะตะนั ั ัะตะฐะปัะฝัะผ IP."*

ะะพะฟัะพะฑัะนัะต:
```bash
ip a
```

ะัะธัะต ัััะพะบั ั `inet` (ะฝะต `inet6`), ะธ ะฝะต ะฝะฐ ะธะฝัะตััะตะนัะต `lo` (localhost).

</details>

---

<details>
<summary>๐ก ะะพะดัะบะฐะทะบะฐ 2 (ะตัะปะธ ะทะฐััััะปะธ > 5 ะผะธะฝัั)</summary>

**ะะพะฝะบัะตัะฝัะต ะบะพะผะฐะฝะดั:**

```bash
# ะะฐัะธะฐะฝั 1: ะะพะบะฐะทะฐัั ะฒัะต IP ะฐะดัะตัะฐ
ip a

# ะะฐัะธะฐะฝั 2: ะขะพะปัะบะพ IPv4 ะฐะดัะตัะฐ
ip -4 a

# ะะฐัะธะฐะฝั 3: ะขะพะปัะบะพ IP ะฑะตะท ะดะตัะฐะปะตะน
hostname -I

# ะะฐัะธะฐะฝั 4: ะะพะฝะบัะตัะฝัะน ะธะฝัะตััะตะนั
ip a show eth0
```

**ะะฐะบ ะฟะฐััะธัั ะฒัะฒะพะด:**
```bash
# ะะทะฒะปะตัั ะฟะตัะฒัะน ะฐะบัะธะฒะฝัะน IP (ะฝะต localhost)
ip -4 a | grep -v "127.0.0.1" | grep "inet " | awk '{print $2}' | cut -d/ -f1 | head -n1
```

</details>

---

<details>
<summary>โ ะะตัะตะฝะธะต</summary>

**ะะพะผะฐะฝะดั ะดะปั ะพะฟัะตะดะตะปะตะฝะธั IP:**

```bash
# ะัะพััะพะน ัะฟะพัะพะฑ (ัะตะบะพะผะตะฝะดัะตััั ะดะปั ะฝะฐัะธะฝะฐััะธั)
hostname -I

# ะะตัะฐะปัะฝัะน ัะฟะพัะพะฑ
ip a

# ะขะพะปัะบะพ IPv4
ip -4 a

# ะะพะฝะบัะตัะฝัะน ะธะฝัะตััะตะนั (ะตัะปะธ ะทะฝะฐะตัะต ะฝะฐะทะฒะฐะฝะธะต)
ip a show eth0

# ะะปั ัะบัะธะฟัะฐ (ะฟะฐััะธะฝะณ)
WORKSTATION_IP=$(hostname -I | awk '{print $1}')
echo "ะะพะน IP: $WORKSTATION_IP"

# ะะปะธ ะฑะพะปะตะต ะดะตัะฐะปัะฝัะน ะฟะฐััะธะฝะณ
WORKSTATION_IP=$(ip -4 a | grep -v "127.0.0.1" | grep "inet " | awk '{print $2}' | cut -d/ -f1 | head -n1)
echo "ะะพะน IP: $WORKSTATION_IP"
```

**ะัะธะผะตั ะฒัะฒะพะดะฐ `ip a`:**
```
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500
    link/ether 00:0c:29:5a:3d:1f brd ff:ff:ff:ff:ff:ff
    inet 192.168.100.42/24 brd 192.168.100.255 scope global eth0
         ^^^^^^^^^^^^^^^^
         ะะะจ IP ะะะะะก
```

**ะะฝัะตัะฟัะตัะฐัะธั:**
- `inet 192.168.100.42/24` โ ะฒะฐั IP ั ะผะฐัะบะพะน ัะตัะธ
- `192.168.100.42` โ ัะฐะผ IP ะฐะดัะตั
- `/24` โ ะผะฐัะบะฐ ัะตัะธ (255.255.255.0)
- `eth0` โ ัะตัะตะฒะพะน ะธะฝัะตััะตะนั (Ethernet)

> **LILITH:**
> *"ะะพะทะดัะฐะฒะปัั. ะขะตะฟะตัั ัั ะทะฝะฐะตัั ัะฒะพะน ะฐะดัะตั. ะ ััะพะน ัะตัะธ ัั โ 192.168.100.42. ะะฐะฟะพะผะฝะธ ะตะณะพ. ะััะปะพะฒ ัะถะต ะทะฐะฟะพะผะฝะธะป."*

</details>

---

### ๐ค ะัะพะฒะตัะบะฐ ะฟะพะฝะธะผะฐะฝะธั (1 ะผะธะฝ)

**LILITH ัะฟัะฐัะธะฒะฐะตั:**

> *"ะขะฒะพะน IP: 192.168.1.100. IP Google: 8.8.8.8. ะงะตะผ ะพะฝะธ ะพัะปะธัะฐัััั? ะะพัะตะผั ัะฒะพะน ะฐะดัะตั ะฝะฐัะธะฝะฐะตััั ั 192.168?"*

**ะัะผะฐะน 30 ัะตะบัะฝะด ะฟะตัะตะด ะฟัะพะฒะตัะบะพะน:**

<details>
<summary>๐ก ะัะฒะตั</summary>

**ะะฐะทะฝะธัะฐ:**
- `192.168.1.100` โ **Private IP** (ะปะพะบะฐะปัะฝะฐั ัะตัั, ะฝะต ะฒะธะดะตะฝ ะธะท ะธะฝัะตัะฝะตัะฐ)
- `8.8.8.8` โ **Public IP** (Google DNS, ะดะพัััะฟะตะฝ ะณะปะพะฑะฐะปัะฝะพ)

**ะะพัะตะผั 192.168?**
- ะะธะฐะฟะฐะทะพะฝ `192.168.0.0 - 192.168.255.255` ะทะฐัะตะทะตัะฒะธัะพะฒะฐะฝ ะดะปั private ัะตัะตะน (RFC 1918)
- ะัะฟะพะปัะทัะตััั ะฒ ะดะพะผะฐัะฝะธั/ะบะพัะฟะพัะฐัะธะฒะฝัั ัะตััั
- ะะต ะผะฐัััััะธะทะธััะตััั ะฒ ะธะฝัะตัะฝะตัะต (ะฑะตะทะพะฟะฐัะฝะตะต)

**ะะตัะฐัะพัะฐ:**
- Private IP = ะดะพะผะฐัะฝะธะน ะฐะดัะตั (ัะพะปัะบะพ ัะพัะตะดะธ ะทะฝะฐัั)
- Public IP = ะฐะดัะตั ะพัะธัะฐ (ะฒัะต ะผะพะณัั ะฝะฐะนัะธ ะฝะฐ ะบะฐััะต)

> **LILITH:**
> *"Private IP = ัะบััั ะทะฐ NAT (ัะพััะตัะพะผ). Public IP = ะฒะธะดะตะฝ ะฒัะตะผ. ะััะปะพะฒ ัะบะฐะฝะธััะตั public IP. ะะฐ private โ ัะปะพะถะฝะตะต ะดะพะฑัะฐัััั. ะัะฟะพะปัะทัะน ััะพ."*

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 1:

- โ IP ะฐะดัะตั = ัะฝะธะบะฐะปัะฝัะน ะธะดะตะฝัะธัะธะบะฐัะพั ััััะพะนััะฒะฐ ะฒ ัะตัะธ
- โ Private IP (192.168.x.x) vs Public IP (8.8.8.8)
- โ Loopback (127.0.0.1) = localhost
- โ ะะพะผะฐะฝะดั: `ip a`, `hostname -I`, `ip -4 a`
- โ IPv4 (4.3 ะผะปัะด ะฐะดัะตัะพะฒ) โ IPv6 (โ ะฐะดัะตัะพะฒ)

> **LILITH:**
> *"ะฆะธะบะป 1 ะทะฐะฒะตัััะฝ. ะขั ะทะฝะฐะตัั ัะฒะพะน ะฐะดัะตั. ะขะตะฟะตัั ะฟัะพะฒะตัะธะผ โ ะถะธะฒ ะปะธ ัะตัะฒะตั Viktor. Ping. ะกะปะตะดัััะธะน ัะธะบะป."*

---

## ๐ ะฆะะะ 2: Ping & ICMP + tcpdump โ "ะญัะพ ะฒ ะฟะตัะตัะต" (18 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (2-3 ะผะธะฝ)

ะะธะบัะพั ะฟะพะบะฐะทัะฒะฐะตั ะฝะฐ ะผะพะฝะธัะพั Grafana. ะัะฐัะฝัะต ะปะธะฝะธะธ ะณัะฐัะธะบะพะฒ ะฒะทะปะตัะฐัั ะฒะฒะตัั:

> **ะะธะบัะพั:**
> *"50,000 ะฟะฐะบะตัะพะฒ ะฒ ัะตะบัะฝะดั. DDoS ะฐัะฐะบะฐ. ICMP flood. ะัะพ-ัะพ ะฟะธะฝะณัะตั ะฝะฐัะธ ัะตัะฒะตัั ะดะพ ะพัะบะฐะทะฐ."*

ะะปะตะบั ะฟะพะฒะพัะฐัะธะฒะฐะตััั ะบ ะะฐะบัั:

> **ะะปะตะบั:**
> *"Ping โ ะฟะตัะฒะพะต ััะพ ะดะตะปะฐะตั ัะฐะบะตั. ะัะพะฒะตัะธัั โ ัะตัะฒะตั ะถะธะฒ? ะัะปะธ ะดะฐ โ ะฝะฐัะธะฝะฐะตั ัะบะฐะฝะธัะพะฒะฐะฝะธะต. ะะฐะบั, ะฟัะพะฒะตัั shadow-server-02. ะะฝ ะพัะฒะตัะฐะตั?"*

ะะฝะฝะฐ ะพัะบััะฒะฐะตั Wireshark, ะฟะพะบะฐะทัะฒะฐะตั ะฟะพัะพะบ ะฟะฐะบะตัะพะฒ:

> **ะะฝะฝะฐ:**
> *"ะกะผะพััะธ. ICMP Echo Request โ ICMP Echo Reply. ะญัะพ ะฝะพัะผะฐะปัะฝัะน ping. ะะพ ะตัะปะธ ะธั 50,000/ัะตะบ โ ััะพ ะฐัะฐะบะฐ. ะัะถะฝะพ ะฟะพะฝััั ัะฐะทะฝะธัั."*

> **LILITH:**
> *"Ping โ ััะพ ััะพ ะฒ ะฟะตัะตัะต. ะัะธัะธัั 'HELLO!' โ ัะปััะธัั 'HELLO!' ะพะฑัะฐัะฝะพ. ะัะปะธ ัะธัะธะฝะฐ โ ะฟะตัะตัะฐ ะฟัััะฐั. ะะปะธ ัั ะณะปััะพะน. ะะปะธ ะบัะพ-ัะพ ะทะฐัะบะฝัะป ัะตะฑะต ัะพั."*

---

### ๐ ะขะตะพัะธั: Ping ะธ ICMP (7-9 ะผะธะฝ)

#### **ะงัะพ ัะฐะบะพะต ping?**

**ping** (Packet Internet Groper) โ ััะธะปะธัะฐ ะดะปั ะฟัะพะฒะตัะบะธ ะดะพัััะฟะฝะพััะธ ัะพััะฐ ะฒ ัะตัะธ.

#### **ะะตัะฐัะพัะฐ: Ping = ะญัะพ ะฒ ะฟะตัะตัะต** ๐

ะัะตะดััะฐะฒั:
- ะขั ััะพะธัั ะฒ **ะฟะตัะตัะต** (ัะตัั)
- ะัะธัะธัั **"HELLO!"** (ICMP Echo Request)
- ะกะปััะธัั **ััะพ "HELLO!"** (ICMP Echo Reply)
- ะกัะธัะฐะตัั **ะฒัะตะผั** ะผะตะถะดั ะบัะธะบะพะผ ะธ ััะพะผ (latency)

```
ะะตัะตัะฐ (ัะตัั):
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
      [ะขะซ]                           [ะกะขะะะ]
       โ                                 โ
       โ  "HELLO!" โโโโโโโโโโโโโโโโโโโโโ>โ
       โ  (ICMP Echo Request)             โ
       โ                                 โ
       โ <โโโโโโโโโโโโโโโโโโโโโ "HELLO!" โ
       โ  (ICMP Echo Reply)               โ
       โ                                 โ
       โโ ะัะตะผั: 15ms (ัะฐัััะพัะฝะธะต ะดะพ ััะตะฝั)

ะงัะพ ัะทะฝะฐะปะธ:
โ ะกัะตะฝะฐ ัััะตััะฒัะตั (ัะตัะฒะตั ะถะธะฒ)
โ ะะฐัััะพัะฝะธะต: 15ms (latency)
โ ะญัะพ ัััะบะพะต (ะฝะตั ะฟะพัะตัั ะฟะฐะบะตัะพะฒ)
```

**ะัะปะธ ัะธัะธะฝะฐ (no reply):**
- ะกัะตะฝะฐ ัะปะธัะบะพะผ ะดะฐะปะตะบะพ? (ัะตัะฒะตั down)
- ะะตัะตัะฐ ะทะฐะฟะพะปะฝะตะฝะฐ ะฒะพะดะพะน? (ัะตัั ัะฐะทะพัะฒะฐะฝะฐ)
- ะฃัะธ ะทะฐัะบะฝััั? (firewall ะฑะปะพะบะธััะตั ICMP)

> **LILITH:**
> *"Ping โ ัะฐะผัะน ะฟัะพััะพะน ะธ ัะฐะผัะน ะฒะฐะถะฝัะน ะธะฝััััะผะตะฝั ะดะธะฐะณะฝะพััะธะบะธ. ะัะปะธ ping ะฝะต ัะฐะฑะพัะฐะตั โ ะปะธะฑะพ ัะตัะฒะตั ะผัััะฒ, ะปะธะฑะพ ะผะตะถะดั ะฒะฐะผะธ ััะตะฝะฐ. ะััะปะพะฒ ะปัะฑะธั ััะฐะฒะธัั ััะตะฝั."*

---

#### **ICMP (Internet Control Message Protocol)**

ICMP โ ะฟัะพัะพะบะพะป ะดะปั ะดะธะฐะณะฝะพััะธะบะธ ะธ ะพัะธะฑะพะบ ัะตัะธ.

**ะขะธะฟั ICMP ัะพะพะฑัะตะฝะธะน:**

| Type | ะะฐะทะฒะฐะฝะธะต | ะงัะพ ะดะตะปะฐะตั | ะัะธะผะตั |
|------|----------|------------|--------|
| **0** | Echo Reply | ะัะฒะตั ะฝะฐ ping | `pong` |
| **3** | Destination Unreachable | ะัะฝะบั ะฝะฐะทะฝะฐัะตะฝะธั ะฝะตะดะพัััะฟะตะฝ | "Server down" |
| **8** | Echo Request | ะะฐะฟัะพั ping | `ping` |
| **11** | Time Exceeded | TTL ะธัััะบ | `traceroute` |

**ICMP = "ัะปัะถะฑะฐ ะดะพััะฐะฒะบะธ" ะธะฝัะตัะฝะตัะฐ:**
- ะะต ะดะพััะฐะฒะปัะตั ะดะฐะฝะฝัะต (ะบะฐะบ TCP/UDP)
- ะกะพะพะฑัะฐะตั ะพ ะฟัะพะฑะปะตะผะฐั ะดะพััะฐะฒะบะธ
- ะะพะผะพะณะฐะตั ะดะธะฐะณะฝะพััะธัะพะฒะฐัั ัะตัั

---

#### **ะงัะพ ะฟะพะบะฐะทัะฒะฐะตั ping:**

```bash
$ ping google.com

PING google.com (142.250.185.46) 56(84) bytes of data.
64 bytes from lga34s34-in-f14.1e100.net (142.250.185.46): icmp_seq=1 ttl=117 time=15.2 ms
64 bytes from lga34s34-in-f14.1e100.net (142.250.185.46): icmp_seq=2 ttl=117 time=14.8 ms
64 bytes from lga34s34-in-f14.1e100.net (142.250.185.46): icmp_seq=3 ttl=117 time=15.0 ms
64 bytes from lga34s34-in-f14.1e100.net (142.250.185.46): icmp_seq=4 ttl=117 time=15.1 ms

--- google.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3005ms
rtt min/avg/max/mdev = 14.8/15.0/15.2/0.2 ms
```

**ะะฐะทะฑะพั ะฒัะฒะพะดะฐ:**

| ะะฐัะฐะผะตัั | ะะฝะฐัะตะฝะธะต | ะงัะพ ะพะทะฝะฐัะฐะตั |
|----------|----------|--------------|
| `142.250.185.46` | IP Google | ะัะดะฐ ะพัะฟัะฐะฒะปัะตััั ping |
| `icmp_seq=1` | ะะพะผะตั ะฟะฐะบะตัะฐ | ะะพััะดะบะพะฒัะน ะฝะพะผะตั (ะดะปั ะพััะปะตะถะธะฒะฐะฝะธั ะฟะพัะตัั) |
| `ttl=117` | Time To Live | ะกะบะพะปัะบะพ ัะพััะตัะพะฒ ะผะพะถะตั ะฟัะพะนัะธ ะฟะฐะบะตั (ะฝะฐัะฐะป ั 128, ะฟัะพััะป 11) |
| `time=15.2 ms` | Latency | ะัะตะผั ััะดะฐ-ะพะฑัะฐัะฝะพ (round-trip time) |
| `0% packet loss` | ะะพัะตัะธ ะฟะฐะบะตัะพะฒ | ะัะต ะฟะฐะบะตัั ะดะพัะปะธ (ะพัะปะธัะฝะพ!) |

---

#### **ะะฝัะตัะฟัะตัะฐัะธั latency:**

```
< 1ms      โโโโโโโโ  Localhost (127.0.0.1)
1-10ms     โโโโโโโโ  ะะพะบะฐะปัะฝะฐั ัะตัั (ะพัะธั, ะดะพะผ)
10-50ms    โโโโโโโโ  ะะพัะพะด, ัะตะณะธะพะฝ (ะพัะปะธัะฝะพ)
50-100ms   โโโโโโโโ  ะััะณะพะน ะณะพัะพะด/ัััะฐะฝะฐ (ะฝะพัะผะฐะปัะฝะพ)
100-200ms  โโโโโโโโ  ะััะณะพะน ะบะพะฝัะธะฝะตะฝั (ะฟัะธะตะผะปะตะผะพ)
> 200ms    โโโโโโโโ  ะะตะดะปะตะฝะฝะพ (ัะฟััะฝะธะบ, ะฟะปะพัะพะน ะบะฐะฝะฐะป)
> 500ms    โโโโโโโโ  ะัะตะฝั ะผะตะดะปะตะฝะฝะพ (ะฟัะพะฑะปะตะผั)
```

> **LILITH:**
> *"Latency โ ััะพ ะฝะต ะฟัะพััะพ ัะบะพัะพััั. ะญัะพ ัะฐัััะพัะฝะธะต ะผะตะถะดั ัะพะฑะพะน ะธ ัะตะปัั. 15ms = ะฑะปะธะทะบะพ. 200ms = ะดะฐะปะตะบะพ. 500ms = ััะพ-ัะพ ัะปะพะผะฐะฝะพ."*

---

#### **"Aha!" ะะพะผะตะฝั: ะะพัะตะผั ping ะผะพะถะตั ะฝะต ัะฐะฑะพัะฐัั?** ๐ก

**ะัะพะฑะปะตะผะฐ:** `ping 10.50.1.100` โ **100% packet loss**

**ะะพะทะผะพะถะฝัะต ะฟัะธัะธะฝั:**

1. **ะกะตัะฒะตั ะฒัะบะปััะตะฝ (down)**
   ```
   ะกัะตะฝะฐ ัััะฝัะปะฐ โ ััะพ ะฝะต ะฒะตัะฝัััั
   ```

2. **Firewall ะฑะปะพะบะธััะตั ICMP**
   ```
   ะกะตัะฒะตั ะถะธะฒ, ะฝะพ ะฝะต ะพัะฒะตัะฐะตั ะฝะฐ ping (ะฟะพะปะธัะธะบะฐ ะฑะตะทะพะฟะฐัะฝะพััะธ)
   ะกัะตะฝะฐ ััะพะธั, ะฝะพ ะฟะพะบัััะฐ ะทะฒัะบะพะธะทะพะปััะธะตะน
   ```

3. **ะกะตัั ัะฐะทะพัะฒะฐะฝะฐ**
   ```
   ะะตะถะดั ะฒะฐะผะธ ะพะฑััะฒ ะบะฐะฑะตะปั/ัะพััะตัะฐ
   ะะตัะตัะฐ ะทะฐัะพะฟะปะตะฝะฐ โ ะทะฒัะบ ะฝะต ะฟัะพัะพะดะธั
   ```

4. **Rate limiting**
   ```
   ะกะตัะฒะตั ะพัะฒะตัะฐะตั ัะพะปัะบะพ ะฝะฐ ะฟะตัะฒัะต 10 ping, ะพััะฐะปัะฝัะต ะธะณะฝะพัะธััะตั
   ะะฐัะธัะฐ ะพั ICMP flood (DDoS)
   ```

**ะะปััะตะฒะพะน ะฒัะฒะพะด:**
> **"Ping ะฝะต ัะฐะฑะพัะฐะตั" โ "ะกะตัะฒะตั ะผัััะฒ"**
>
> ะะพะถะตั ะฑััั firewall. ะัะตะณะดะฐ ะฟัะพะฒะตััะน ะดััะณะธะผะธ ัะฟะพัะพะฑะฐะผะธ (TCP port, SSH).

> **LILITH:**
> *"ะััะปะพะฒ ะทะฝะฐะตั ััะพ. ะะฝ ะฑะปะพะบะธััะตั ICMP ะฝะฐ ัะฒะพะธั ัะตัะฒะตัะฐั. Ping ะฟะพะบะฐะทัะฒะฐะตั 'down', ะฝะพ ัะตัะฒะตั ะฐัะฐะบัะตั. ะะพะถะฝะฐั ัะผะตััั."*

---

#### **ASCII Diagram: ICMP Flow**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    PING FLOW (ICMP)                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

    [ะขะฒะพะน ะะ]                             [ะกะตัะฒะตั Viktor]
   192.168.100.42                          10.50.1.100
        โ                                       โ
        โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
        โโโโ ICMP Echo Request (Type 8)   โโโโ>โ
        โ  โ "ะขั ะถะธะฒ?"                     โ    โ
        โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
        โ                                       โ
        โ         โโโ 15ms latency โโโ         โ
        โ         โ   (ััะดะฐ-ะพะฑัะฐัะฝะพ)  โ         โ
        โ         โโโโโโโโโโโโโโโโโโโโโโ         โ
        โ                                       โ
        โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
        โ<โโ ICMP Echo Reply (Type 0)     โโโโโโ
        โ  โ "ะะฐ, ั ะถะธะฒ!"                 โ    โ
        โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ
        โ                                       โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะตะทัะปััะฐั:
โ ะกะตัะฒะตั ะดะพัััะฟะตะฝ
โ Latency: 15ms (ะพัะปะธัะฝะพ)
โ Packet loss: 0% (ััะฐะฑะธะปัะฝะพ)
```

---

### ๐ป ะัะฐะบัะธะบะฐ: ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ (5-7 ะผะธะฝ)

#### **ะะฐะดะฐะฝะธะต 1: Ping localhost (ะฒัะตะณะดะฐ ัะฐะฑะพัะฐะตั)**

ะัะพะฒะตัััะต ััะพ ะฒะฐัะฐ ัะตัะตะฒะฐั stack ัะฐะฑะพัะฐะตั:

```bash
ping -c 4 127.0.0.1
```

**ะคะปะฐะณ `-c 4`** = ะพัะฟัะฐะฒะธัั ัะพะปัะบะพ 4 ะฟะฐะบะตัะฐ (ะธะฝะฐัะต ะฑะตัะบะพะฝะตัะฝะพ, ะฝัะถะฝะพ Ctrl+C)

---

#### **ะะฐะดะฐะฝะธะต 2: Ping Google DNS (ะตัะปะธ ะตััั ะธะฝัะตัะฝะตั)**

```bash
ping -c 4 8.8.8.8
```

ะัะปะธ ัะฐะฑะพัะฐะตั โ ะธะฝัะตัะฝะตั ะตััั, ัะตัั ะถะธะฒะฐ.

---

#### **ะะฐะดะฐะฝะธะต 3: Ping ัะตัะฒะตัะฐ Viktor (ัะธะผัะปััะธั)**

```bash
# ะะพะฟัะพะฑัะนัะต (ัะบะพัะตะต ะฒัะตะณะพ ะฝะต ััะฐะฑะพัะฐะตั โ ัะตัะฒะตั ะฝะต ัััะตััะฒัะตั ัะตะฐะปัะฝะพ)
ping -c 4 10.50.1.100

# ะะปััะตัะฝะฐัะธะฒะฐ ะดะปั ะฟัะฐะบัะธะบะธ: ping ะดะพะผะฐัะฝะตะณะพ ัะพััะตัะฐ
ip route | grep default  # ะะฐะนัะธ gateway
ping -c 4 192.168.1.1     # ะะฐะผะตะฝะธัั ะฝะฐ ะฒะฐั gateway
```

---

<details>
<summary>โ ะะตัะตะฝะธะต: Ping ะฒ ัะบัะธะฟัะต</summary>

```bash
#!/bin/bash

server_ip="10.50.1.100"

echo "ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ ัะตัะฒะตัะฐ $server_ip..."

# ping ั timeout
if ping -c 4 -W 2 "$server_ip" &>/dev/null; then
    echo "โ ะกะตัะฒะตั ะดะพัััะฟะตะฝ (ping successful)"

    # ะะทะฒะปะตัั average latency
    latency=$(ping -c 4 -W 2 "$server_ip" 2>/dev/null | tail -1 | awk -F '/' '{print $5}')
    if [ -n "$latency" ]; then
        echo "  Average latency: ${latency}ms"
    fi
else
    echo "โ ะกะตัะฒะตั ะฝะตะดะพัััะฟะตะฝ (ping failed)"
    echo "  ะะพะทะผะพะถะฝัะต ะฟัะธัะธะฝั:"
    echo "    - ะกะตัะฒะตั ะฒัะบะปััะตะฝ"
    echo "    - Firewall ะฑะปะพะบะธััะตั ICMP"
    echo "    - ะกะตัะตะฒะฐั ะฟัะพะฑะปะตะผะฐ (ัะพััะตั, ะบะฐะฑะตะปั)"
fi
```

**ะคะปะฐะณะธ:**
- `-c 4` โ ะพัะฟัะฐะฒะธัั 4 ะฟะฐะบะตัะฐ
- `-W 2` โ timeout 2 ัะตะบัะฝะดั ะฝะฐ ะฟะฐะบะตั
- `&>/dev/null` โ ัะบัััั ะฒัะฒะพะด (ะฟัะพะฒะตััะตะผ ัะพะปัะบะพ exit code)

</details>

---

### ๐ป ะัะฐะบัะธะบะฐ: tcpdump โ "ะัะพัะปััะบะฐ ัะตัะธ" (3-5 ะผะธะฝ)

#### **ะงัะพ ัะฐะบะพะต tcpdump?**

**tcpdump** โ ััะธะปะธัะฐ ะดะปั ะทะฐัะฒะฐัะฐ ะธ ะฐะฝะฐะปะธะทะฐ ัะตัะตะฒัั ะฟะฐะบะตัะพะฒ.

**ะะตัะฐัะพัะฐ:** tcpdump = ะฟัะพัะปััะบะฐ ัะตะปะตัะพะฝะฝะพะน ะปะธะฝะธะธ
- ะะธะดะธัั ะบะฐะถะดัะน ะทะฒะพะฝะพะบ (ะฟะฐะบะตั)
- ะัะพ ะทะฒะพะฝะธั (source IP)
- ะะพะผั (destination IP)
- ะงัะพ ะณะพะฒะพััั (ะดะฐะฝะฝัะต)

> **LILITH:**
> *"tcpdump โ ะธะฝััััะผะตะฝั ะฐัะฐะบัััะตะณะพ. ะ ัะฒะพะน ะธะฝััััะผะตะฝั. ะะธะดะธัั ะะกะ ััะพ ะฟัะพัะพะดะธั ะฟะพ ะฟัะพะฒะพะดั. ะะฐัะพะปะธ, ัะตััะธะธ, ัะตะบัะตัั. ะะพั ะฟะพัะตะผั HTTPS ะบัะธัะธัะตะฝ. ะะพั ะฟะพัะตะผั ะััะปะพะฒ ะฟัะพัะปััะธะฒะฐะตั ััะฐัะธะบ."*

---

#### **ะะฐะทะพะฒัะต ะบะพะผะฐะฝะดั tcpdump:**

```bash
# ะฃััะฐะฝะพะฒะบะฐ (ะตัะปะธ ะฝะตั)
sudo apt install tcpdump

# ะะฐัะฒะฐั ICMP ะฟะฐะบะตัะพะฒ (ping)
sudo tcpdump -i any icmp -c 10

# ะก ะดะตัะฐะปัะฝัะผ ะฒัะฒะพะดะพะผ
sudo tcpdump -i any icmp -v

# ะกะพััะฐะฝะธัั ะฒ ัะฐะนะป (.pcap ะดะปั Wireshark)
sudo tcpdump -i any icmp -w ping_capture.pcap -c 10

# ะัะพัะธัะฐัั ัะฐะนะป
tcpdump -r ping_capture.pcap
```

**ะคะปะฐะณะธ:**
- `-i any` โ ัะปััะฐัั ะฒัะต ะธะฝัะตััะตะนัั
- `icmp` โ ัะธะปััั (ัะพะปัะบะพ ICMP ะฟะฐะบะตัั)
- `-c 10` โ ะทะฐัะฒะฐัะธัั 10 ะฟะฐะบะตัะพะฒ
- `-w file.pcap` โ ัะพััะฐะฝะธัั ะฒ ัะฐะนะป
- `-v` โ verbose (ะดะตัะฐะปัะฝัะน ะฒัะฒะพะด)

---

#### **ะัะฐะบัะธะบะฐ: ะะฐัะฒะฐั ping ะฟะฐะบะตัะพะฒ**

**ะจะฐะณ 1: ะะฐะฟัััะธัั tcpdump** (ะฒ ะพะดะฝะพะผ ัะตัะผะธะฝะฐะปะต):

```bash
sudo tcpdump -i any icmp
```

**ะจะฐะณ 2: ะะฐะฟัััะธัั ping** (ะฒ ะดััะณะพะผ ัะตัะผะธะฝะฐะปะต):

```bash
ping -c 4 8.8.8.8
```

**ะจะฐะณ 3: ะกะผะพััะตัั ะฒัะฒะพะด tcpdump:**

```
14:23:15.123456 IP 192.168.100.42 > 8.8.8.8: ICMP echo request, id 1234, seq 1, length 64
14:23:15.138912 IP 8.8.8.8 > 192.168.100.42: ICMP echo reply, id 1234, seq 1, length 64
14:23:16.124567 IP 192.168.100.42 > 8.8.8.8: ICMP echo request, id 1234, seq 2, length 64
14:23:16.139823 IP 8.8.8.8 > 192.168.100.42: ICMP echo reply, id 1234, seq 2, length 64
```

**ะงัะพ ะฒะธะดะธะผ:**
- `echo request` โ ัั ะพัะฟัะฐะฒะปัะตัั ping
- `echo reply` โ Google ะพัะฒะตัะฐะตั
- `id 1234, seq 1` โ ะธะดะตะฝัะธัะธะบะฐัะพั ะธ ะฝะพะผะตั ะฟะฐะบะตัะฐ
- Latency = ัะฐะทะฝะธัะฐ ะผะตะถะดั request ะธ reply (~15ms)

---

#### **โ๏ธ Security Warning:**

> **LILITH:**
> *"tcpdump ะฒะธะดะธั ะะกะ. HTTP ะฟะฐัะพะปะธ, cookies, API keys. ะัั ััะพ ะธะดัั ะฑะตะท ัะธััะพะฒะฐะฝะธั. ะะพั ะฟะพัะตะผั:*
> - *HTTPS ะพะฑัะทะฐัะตะปะตะฝ (ัะธัััะตั HTTP)*
> - *SSH ะฒะผะตััะพ telnet (ัะธัััะตั ัะตัะผะธะฝะฐะป)*
> - *VPN ะดะปั ะฒัะตะณะพ ััะฐัะธะบะฐ (Episode 08)*
>
> *ะััะปะพะฒ ะธัะฟะพะปัะทัะตั tcpdump ะดะปั ะฟะตัะตัะฒะฐัะฐ. ะะฐัะธัะฐะนัั ัะธััะพะฒะฐะฝะธะตะผ."*

---

<details>
<summary>โ ะะตัะตะฝะธะต: tcpdump ะฒ ัะบัะธะฟัะต (ะพะฟัะธะพะฝะฐะปัะฝะพ)</summary>

```bash
#!/bin/bash

# Function: Capture ICMP packets (requires sudo)
capture_ping_packets() {
    local target_ip="$1"
    local output_file="artifacts/ping_capture.pcap"

    echo "ะะฐัะฒะฐั ICMP ะฟะฐะบะตัะพะฒ (ััะตะฑัะตั sudo)..."

    if ! command -v tcpdump &>/dev/null; then
        echo "  โ tcpdump ะฝะต ัััะฐะฝะพะฒะปะตะฝ (ะพะฟัะธะพะฝะฐะปัะฝะพ)"
        echo "  ะฃััะฐะฝะพะฒะบะฐ: sudo apt install tcpdump"
        return
    fi

    # ะัะพะฒะตัะบะฐ sudo
    if ! sudo -n true 2>/dev/null; then
        echo "  โ ะะตั sudo ะดะพัััะฟะฐ (skip tcpdump)"
        return
    fi

    # ะะฐัะฒะฐั ะฒ ัะพะฝะต (10 ะฟะฐะบะตัะพะฒ ะธะปะธ 5 ัะตะบัะฝะด)
    echo "  ะะฐะฟััะบ: sudo tcpdump -i any icmp -c 10 -w $output_file"
    timeout 5 sudo tcpdump -i any icmp -c 10 -w "$output_file" 2>/dev/null &
    local tcpdump_pid=$!

    # ะัะฟัะฐะฒะธัั ping ะฒะพ ะฒัะตะผั ะทะฐัะฒะฐัะฐ
    sleep 0.5
    ping -c 4 "$target_ip" &>/dev/null || true

    # ะะพะถะดะฐัััั ะทะฐะฒะตััะตะฝะธั tcpdump
    wait $tcpdump_pid 2>/dev/null || true

    if [ -f "$output_file" ]; then
        echo "  โ ะะฐะบะตัั ัะพััะฐะฝะตะฝั: $output_file"
        echo "  ะะฝะฐะปะธะท: tcpdump -r $output_file"
    else
        echo "  โ ะะฐัะฒะฐั ะฝะต ัะดะฐะปัั (ะฝะพัะผะฐะปัะฝะพ ะตัะปะธ ะฝะตั sudo)"
    fi
}

# ะัะฟะพะปัะทะพะฒะฐะฝะธะต
capture_ping_packets "8.8.8.8"
```

**ะัะธะผะตัะฐะฝะธะต:** tcpdump ััะตะฑัะตั sudo. ะัะปะธ ะฝะตั ะดะพัััะฟะฐ โ ัะบัะธะฟั ะฟัะพะฟัััะธั ััั ัะฐััั (graceful failure).

</details>

---

### ๐ค ะัะพะฒะตัะบะฐ ะฟะพะฝะธะผะฐะฝะธั (1 ะผะธะฝ)

**LILITH ัะฟัะฐัะธะฒะฐะตั:**

> *"Ping ัะฐะฑะพัะฐะตั (latency 15ms, 0% loss), ะฝะพ ะฑัะฐัะทะตั ะฝะต ะพัะบััะฒะฐะตั ัะฐะนั. ะงัะพ ัะปะพะผะฐะฝะพ?"*

**ะัะผะฐะน 30 ัะตะบัะฝะด ะฟะตัะตะด ะฟัะพะฒะตัะบะพะน:**

<details>
<summary>๐ก ะัะฒะตั</summary>

**ะัะพะฑะปะตะผะฐ ะะ ะฒ ัะตัะธ (Layer 3), ะฐ ะฒ ะฟัะธะปะพะถะตะฝะธะธ (Layer 7):**

**ะะพะทะผะพะถะฝัะต ะฟัะธัะธะฝั:**

1. **DNS ะฝะต ัะฐะฑะพัะฐะตั**
   - Ping ะฟะพ IP ัะฐะฑะพัะฐะตั (8.8.8.8 โ)
   - ะะพ ping ะฟะพ ะธะผะตะฝะธ ะฝะต ัะฐะฑะพัะฐะตั (google.com โ)
   - ะะตัะตะฝะธะต: ะฟัะพะฒะตัั /etc/resolv.conf, ะฝะฐัััะพะน DNS

2. **Web-ัะตัะฒะตั down**
   - ะกะตัะฒะตั ะถะธะฒ (ping OK)
   - ะะพ HTTP ะฟะพัั (80/443) ะทะฐะบััั
   - ะะตัะตะฝะธะต: ะฟัะพะฒะตัั `curl -I http://site.com`, ะฟะพััั (nmap)

3. **Firewall ะฑะปะพะบะธััะตั HTTP/HTTPS**
   - ICMP ัะฐะทัะตััะฝ (ping OK)
   - ะะพ TCP ports 80/443 ะทะฐะฑะปะพะบะธัะพะฒะฐะฝั
   - ะะตัะตะฝะธะต: ะฟัะพะฒะตัั firewall rules (Episode 07)

4. **ะัะฐัะทะตั ะฟัะพะฑะปะตะผะฐ (ะปะพะบะฐะปัะฝะพ)**
   - Cache, cookies, proxy settings
   - ะะตัะตะฝะธะต: ะฟะพะฟัะพะฑัะน curl ะธะท ัะตัะผะธะฝะฐะปะฐ

**ะะปััะตะฒะพะน ะฒัะฒะพะด:**
> **"Ping ัะฐะฑะพัะฐะตั" โ "ะัั ัะฐะฑะพัะฐะตั"**
>
> Ping ะฟัะพะฒะตััะตั ัะพะปัะบะพ Layer 3 (ัะตัั). ะัะธะปะพะถะตะฝะธั ัะฐะฑะพัะฐัั ะฝะฐ Layer 7.

> **LILITH:**
> *"Ping โ ััะพ ัะพะปัะบะพ ะฟะตัะฒัะน ัะฐะณ ะดะธะฐะณะฝะพััะธะบะธ. ะกะตัั ะถะธะฒะฐ? โ ะัะปะธัะฝะพ. ะขะตะฟะตัั ะฟัะพะฒะตััะน DNS, ะฟะพััั, ัะตัะฒะธัั. ะะพัะปะพะนะฝะพ."*

**TCP/IP ะผะพะดะตะปั:**
```
Layer 7: Application  โ ะัะฐัะทะตั, HTTP    (ะฟัะพะฑะปะตะผะฐ ััั!)
Layer 4: Transport    โ TCP, UDP         (ะฒะพะทะผะพะถะฝะพ ััั)
Layer 3: Internet     โ IP, ICMP         (ping ะฟัะพะฒะตััะตั ััะพ โ)
Layer 2: Link         โ Ethernet         (ะตัะปะธ ping OK โ ััะพ OK)
```

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 2:

- โ ping = ะฟัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ ัะพััะฐ (ICMP Echo)
- โ Latency = ะฒัะตะผั ััะดะฐ-ะพะฑัะฐัะฝะพ (< 10ms ะพัะปะธัะฝะพ, > 200ms ะผะตะดะปะตะฝะฝะพ)
- โ "Ping ะฝะต ัะฐะฑะพัะฐะตั" ะผะพะถะตั ะพะทะฝะฐัะฐัั firewall, ะฝะต ะพะฑัะทะฐัะตะปัะฝะพ "ัะตัะฒะตั down"
- โ tcpdump = ะทะฐัะฒะฐั ะฒัะตั ะฟะฐะบะตัะพะฒ (ะฒะธะดะธั ะฟะฐัะพะปะธ ะฑะตะท HTTPS!)
- โ ะะพะผะฐะฝะดั: `ping -c 4`, `sudo tcpdump -i any icmp`

> **LILITH:**
> *"ะฆะธะบะป 2 ะทะฐะฒะตัััะฝ. Ping โ ัะฒะพะน ัะฐะดะฐั. ะะพะบะฐะทัะฒะฐะตั ะบัะพ ะถะธะฒ, ะบัะพ ะผัััะฒ. ะะพ ัะฐะดะฐั ะผะพะถะฝะพ ะพะฑะผะฐะฝััั. ะกะปะตะดัััะธะน ััะพะฒะตะฝั โ DNS. ะะผะตะฝะฐ ะฒะผะตััะพ ัะธัะตะป. ะขะฐะผ ะััะปะพะฒ ะฟะพะดะผะตะฝัะตั ะพัะฒะตัั. ะะพะตัะฐะปะธ."*

---

## ๐ ะฆะะะ 3: DNS & Configuration Files โ "ะขะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ ะธะฝัะตัะฝะตัะฐ" (18 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (2-3 ะผะธะฝ)

ะะธะบัะพั ัะบะฐะทัะฒะฐะตั ะฝะฐ whiteboard ั ะดะธะฐะณัะฐะผะผะพะน ะฐัะฐะบะธ:

> **ะะธะบัะพั:**
> *"shadow-server-02.ops.internal โ ะฝะฐั ะณะปะฐะฒะฝัะน ัะตัะฒะตั. ะะฐะบั, ัะทะฝะฐะน ะตะณะพ IP. ะะพ hostname."*

ะะฝะฝะฐ ะพัะบััะฒะฐะตั Wireshark, ัะธะปััััะตั DNS ะทะฐะฟัะพัั:

> **ะะฝะฝะฐ:**
> *"ะกะผะพััะธ. ะั ะทะฐะฟัะฐัะธะฒะฐะตะผ 'shadow-server-02.ops.internal' โ DNS ะพัะฒะตัะฐะตั '10.50.1.100'. ะะพ ะฒัะตัะฐ DNS ะพัะฒะตัะธะป '185.220.101.47' โ IP ะััะปะพะฒะฐ. DNS spoofing."*

ะะปะตะบั ะฟะพะดัะพะดะธั ะบ ะะฐะบัั:

> **ะะปะตะบั:**
> *"DNS โ ัะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ ะธะฝัะตัะฝะตัะฐ. ะะพ ััะพ ะตัะปะธ ะบัะพ-ัะพ ะฟะพะดะผะตะฝะธะป ะฝะพะผะตัะฐ? ะขั ะทะฒะพะฝะธัั ะฒ ะฑะฐะฝะบ, ะฐ ะฟะพะฟะฐะดะฐะตัั ะบ ะผะพัะตะฝะฝะธะบั. DNS spoofing โ ะปัะฑะธะผัะน ัััะบ ะััะปะพะฒะฐ."*

> **LILITH:**
> *"ะะผะตะฝะฐ ะปะตะณัะต ะทะฐะฟะพะผะธะฝะฐัั ัะตะผ ัะธัะปะฐ. 'google.com' vs '142.250.185.46'. ะะพ ะธะผะตะฝะฐ ะผะพะถะฝะพ ะฟะพะดะผะตะฝะธัั. ะััะปะพะฒ ััะพ ะทะฝะฐะตั. ะฃัะธัั ะทะฐัะธัะฐัััั."*

---

### ๐ ะขะตะพัะธั: ะงัะพ ัะฐะบะพะต DNS? (7-9 ะผะธะฝ)

#### **ะะฟัะตะดะตะปะตะฝะธะต:**

**DNS** (Domain Name System) โ ัะธััะตะผะฐ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธั ะดะพะผะตะฝะฝัั ะธะผัะฝ ะฒ IP ะฐะดัะตัะฐ.

#### **ะะตัะฐัะพัะฐ: DNS = ะขะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ** ๐

ะัะตะดััะฐะฒั:
- **ะะผั** (domain) = "ะะฐะบั ะกะพะบะพะปะพะฒ"
- **IP ะฐะดัะตั** = +7-913-555-1234
- **DNS ัะตัะฒะตั** = ัะตะปะตัะพะฝะฝะฐั ัะฟัะฐะฒะพัะฝะฐั ัะปัะถะฑะฐ
- **DNS ะทะฐะฟัะพั** = "ะะฐะบะพะน ะฝะพะผะตั ั ะะฐะบัะฐ ะกะพะบะพะปะพะฒะฐ?"
- **DNS ะพัะฒะตั** = "+7-913-555-1234"

```
ะขะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ:                    DNS:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
"ะะฐะบั ะกะพะบะพะปะพะฒ"        โ    "google.com"
    โ                          โ
+7-913-555-1234       โ    142.250.185.46

ะะฐัะตะผ?
โ ะะตะณัะต ะทะฐะฟะพะผะฝะธัั ะธะผั
โ ะะพะผะตั ะผะพะถะตั ะธะทะผะตะฝะธัััั, ะธะผั ะพััะฐัััั
โ ะะดะธะฝ ัะตะปะพะฒะตะบ = ะพะดะธะฝ ะฝะพะผะตั (ะพะดะธะฝ ะดะพะผะตะฝ = ะพะดะธะฝ IP)
```

> **LILITH:**
> *"DNS ัััะตััะฒัะตั ะฟะพัะพะผั ััะพ ะปัะดะธ ะฝะต ะทะฐะฟะพะผะธะฝะฐัั ัะธัะปะฐ. 142.250.185.46 ะทะฐะฑัะดะตัั. google.com โ ะฝะตั."*

---

#### **ะะฐะบ ัะฐะฑะพัะฐะตั DNS:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     DNS LOOKUP PROCESS                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1. [ะัะฐัะทะตั]  "ะะฐะบะพะน IP ั google.com?"
      โ
      โ
2. [DNS Resolver] "ะะต ะทะฝะฐั, ัะฟัะพัั ั DNS ัะตัะฒะตัะฐ..."
      โ
      โ
3. [DNS Server]  "google.com = 142.250.185.46"
      โ
      โ
4. [ะัะฐัะทะตั]  "ะกะฟะฐัะธะฑะพ!" โ ะฟะพะดะบะปััะฐะตััั ะบ 142.250.185.46

ะัะตะผั: 10-50ms (ะพะฑััะฝะพ)
```

**DNS = ะฟะพััะตะดะฝะธะบ** ะผะตะถะดั ัะตะปะพะฒะตัะตัะบะธะผะธ ะธะผะตะฝะฐะผะธ ะธ ะผะฐัะธะฝะฝัะผะธ ะฐะดัะตัะฐะผะธ.

---

#### **ะขะธะฟั DNS ะทะฐะฟะธัะตะน:**

| ะขะธะฟ | ะงัะพ ััะฐะฝะธั | ะัะธะผะตั |
|-----|------------|--------|
| **A** | ะะผั โ IPv4 | `google.com` โ `142.250.185.46` |
| **AAAA** | ะะผั โ IPv6 | `google.com` โ `2001:4860:4860::8888` |
| **CNAME** | Alias (ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธะต) | `www.google.com` โ `google.com` |
| **MX** | Mail server | `gmail.com` โ `mail.google.com` |
| **TXT** | ะขะตะบัั (SPF, DKIM) | ะะฐัะธัะฐ email ะพั ัะฟััะธะฝะณะฐ |

**ะะปั Episode 05 ัะพะบัั ะฝะฐ A ะทะฐะฟะธััั** (ะธะผั โ IP).

---

#### **"Aha!" ะะพะผะตะฝั: DNS Spoofing โ ะฟะพะดะผะตะฝะฐ ะฝะพะผะตัะฐ ะฒ ัะตะปะตัะพะฝะฝะพะน ะบะฝะธะณะต** ๐ก

**ะะพัะผะฐะปัะฝะฐั ัะธััะฐัะธั:**
```
ะขั: "ะะฐะบะพะน IP ั bank.com?"
DNS: "bank.com = 1.2.3.4"  โ ะัะฐะฒะธะปัะฝัะน IP ะฑะฐะฝะบะฐ
ะขั: (ะฟะพะดะบะปััะฐะตัััั ะบ 1.2.3.4, ะฒัั ะพะบ)
```

**DNS Spoofing (ะฐัะฐะบะฐ ะััะปะพะฒะฐ):**
```
ะขั: "ะะฐะบะพะน IP ั bank.com?"
ะััะปะพะฒ (ะฟะตัะตัะฒะฐัะธะป): "bank.com = 6.6.6.6"  โ IP ะััะปะพะฒะฐ!
ะขั: (ะฟะพะดะบะปััะฐะตัััั ะบ 6.6.6.6 โ ัะฐะนั ะััะปะพะฒะฐ, ะฒัะณะปัะดะธั ะบะฐะบ ะฑะฐะฝะบ)
ะขั: (ะฒะฒะพะดะธัั ะฟะฐัะพะปั...)
ะััะปะพะฒ: (ะฟะพะปััะฐะตั ะฟะฐัะพะปั) ๐
```

**ะะตัะฐัะพัะฐ:**
- ะขะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ ะฟะพะดะผะตะฝะตะฝะฐ
- ะขั ะทะฒะพะฝะธัั ะฒ ะฑะฐะฝะบ
- ะะพ ะฟะพะฟะฐะดะฐะตัั ะบ ะผะพัะตะฝะฝะธะบั (ะบะพัะพััะน ะฟัะธัะฒะพััะตััั ะฑะฐะฝะบะพะผ)

> **LILITH:**
> *"DNS spoofing โ ะบะฐะบ ะฟะพะดะผะตะฝะฐ ะฝะพะผะตัะฐ ะฒ ัะตะปะตัะพะฝะฝะพะน ะบะฝะธะณะต. ะขั ะดัะผะฐะตัั ะทะฒะพะฝะธัั ะฒ ะฑะฐะฝะบ, ะฐ ะฝะฐ ัะฐะผะพะผ ะดะตะปะต โ ะผะพัะตะฝะฝะธะบั. ะะฐัะธัะฐ: DNSSEC (Episode 06), HTTPS (ะฟัะพะฒะตัะบะฐ ัะตััะธัะธะบะฐัะฐ)."*

---

#### **ะคะฐะนะปั DNS ะฒ Linux:**

Linux ะธะผะตะตั **2 ะบะปััะตะฒัั ัะฐะนะปะฐ** ะดะปั DNS:

---

### **1. `/etc/hosts` โ ะะพะบะฐะปัะฝะฐั ัะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ** ๐

**ะงัะพ ััะพ:**
- ะคะฐะนะป ะฝะฐ ัะฒะพัะผ ะบะพะผะฟัััะตัะต
- ะกัะฐัะธัะตัะบะธะน ัะฟะธัะพะบ: ะธะผั โ IP
- **ะัะธะพัะธัะตั ะฝะฐะด DNS ัะตัะฒะตัะฐะผะธ!**

**ะะตัะฐัะพัะฐ:** `/etc/hosts` = ะทะฐะฟะธัะฝะฐั ะบะฝะธะถะบะฐ ะฒ ะบะฐัะผะฐะฝะต
- ะััััะพ (ะฝะต ะฝัะถะฝะพ ะทะฒะพะฝะธัั ะฒ ัะฟัะฐะฒะพัะฝัั)
- ะะพะบะฐะปัะฝะพ (ัะพะปัะบะพ ัั ะฒะธะดะธัั)
- ะะผะตะตั ะฟัะธะพัะธัะตั (ัะผะพััะธัั ัะฝะฐัะฐะปะฐ ะฒ ะบะฝะธะถะบั, ะฟะพัะพะผ ะฒ ัะฟัะฐะฒะพัะฝัั)

**ะคะพัะผะฐั:**
```bash
# /etc/hosts

127.0.0.1       localhost
192.168.1.100   mycomputer.local
10.50.1.100     shadow-server-02.ops.internal
```

**ะกัััะบัััะฐ:**
```
IP_ADDRESS    HOSTNAME    [ALIASES]
```

**ะะฐัะตะผ ะธัะฟะพะปัะทะพะฒะฐัั:**
- **Development:** ะขะตััะธัะพะฒะฐัั ะปะพะบะฐะปัะฝัะต ัะตัะฒะตัั (`192.168.1.10 dev.mysite.com`)
- **Security:** ะะปะพะบะธัะพะฒะฐัั ะฟะปะพัะธะต ะดะพะผะตะฝั (`0.0.0.0 malware.com`)
- **Fast lookup:** ะะต ะถะดะฐัั DNS ะพัะฒะตั

> **LILITH:**
> *"/etc/hosts = ัะฒะพั ะปะธัะฝะฐั ัะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ. DNS ัะตัะฒะตั ะฝะต ะบะพะฝััะพะปะธััะตั ะตั. ะััะปะพะฒ ัะพะถะต ะฝะต ะบะพะฝััะพะปะธััะตั (ะตัะปะธ ั ะฝะตะณะพ ะฝะตั ะดะพัััะฟะฐ ะบ ัะฒะพะตะผั ะบะพะผะฟัััะตัั). ะะพ ะฟะพะผะฝะธ: /etc/hosts ะธะผะตะตั ะฟัะธะพัะธัะตั. ะะพะดะผะตะฝะฐ ะทะดะตัั โ ะธ ัั ะทะฒะพะฝะธัั ะบัะดะฐ ะััะปะพะฒ ัะพัะตั."*

---

### **2. `/etc/resolv.conf` โ ะะฐะบัั ัะฟัะฐะฒะพัะฝัั ะธัะฟะพะปัะทะพะฒะฐัั** ๐ก

**ะงัะพ ััะพ:**
- ะะพะฝัะธะณััะฐัะธั DNS resolver
- ะกะฟะธัะพะบ DNS ัะตัะฒะตัะพะฒ (nameservers)

**ะะตัะฐัะพัะฐ:** `/etc/resolv.conf` = ะฝะพะผะตั ัะตะปะตัะพะฝะฝะพะน ัะฟัะฐะฒะพัะฝะพะน
- ะะพะผั ะทะฒะพะฝะธัั ะตัะปะธ ะฝะตั ะฒ `/etc/hosts`

**ะคะพัะผะฐั:**
```bash
# /etc/resolv.conf

nameserver 8.8.8.8       # Google DNS (ะฟะตัะฒัะน)
nameserver 1.1.1.1       # Cloudflare DNS (fallback)
search ops.internal      # ะะพะผะตะฝ ะฟะพ ัะผะพะปัะฐะฝะธั
```

**ะะฐัะฐะผะตััั:**
- `nameserver X.X.X.X` โ DNS ัะตัะฒะตั ะดะปั ะทะฐะฟัะพัะพะฒ
- `search domain.com` โ ะดะพะฑะฐะฒะปััั ะดะพะผะตะฝ ะบ ะบะพัะพัะบะธะผ ะธะผะตะฝะฐะผ
  - ะัะธะผะตั: `ping shadow-server-02` โ ะธัะตั `shadow-server-02.ops.internal`

**ะะพะฟัะปััะฝัะต ะฟัะฑะปะธัะฝัะต DNS:**
```
8.8.8.8, 8.8.4.4        # Google DNS
1.1.1.1, 1.0.0.1        # Cloudflare DNS
9.9.9.9                 # Quad9 (privacy-focused)
```

> **LILITH:**
> *"/etc/resolv.conf ะณะพะฒะพัะธั ะบะพะผั ะดะพะฒะตัััั. 8.8.8.8 (Google) vs 1.1.1.1 (Cloudflare) vs ัะพะฑััะฒะตะฝะฝัะน DNS. ะััะปะพะฒ ะผะพะถะตั ะฟะตัะตัะฒะฐัะธัั ััะฐัะธะบ ะบ DNS ัะตัะฒะตัั. ะะฐัะธัะฐ: DNS over TLS (Episode 06)."*

---

#### **ะัะธะพัะธัะตั DNS lookup:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         ะะะะฏะะะ ะะะะะะจะะะะฏ ะะะะ ะ LINUX                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะฐะฟัะพั: "ะะฐะบะพะน IP ั shadow-server-02.ops.internal?"

1. /etc/hosts โ ะัะพะฒะตััะตะผ ะกะะะงะะะ (ะปะพะบะฐะปัะฝะฐั ะบะฝะธะถะบะฐ)
   โโ ะะฐะนะดะตะฝะพ? โ ะัะฟะพะปัะทัะตะผ ััะพั IP โ
   โโ ะะต ะฝะฐะนะดะตะฝะพ? โ ะะดัะผ ะดะฐะปััะต โ

2. DNS Cache โ ะัะพะฒะตััะตะผ ะบัั (ะฝะตะดะฐะฒะฝะธะต ะทะฐะฟัะพัั)
   โโ ะะฐะนะดะตะฝะพ? โ ะัะฟะพะปัะทัะตะผ ะบัั โ
   โโ ะะต ะฝะฐะนะดะตะฝะพ? โ ะะดัะผ ะดะฐะปััะต โ

3. DNS Server โ ะะฐะฟัะฐัะธะฒะฐะตะผ nameserver ะธะท /etc/resolv.conf
   โโ ะัะฒะตัะธะป? โ ะัะฟะพะปัะทัะตะผ ะพัะฒะตั โ
   โโ ะะต ะพัะฒะตัะธะป? โ ERROR โ

ะัะธะพัะธัะตั:
1st: /etc/hosts       (ะปะพะบะฐะปัะฝะพ, ะฑััััะพ, ะฝะฐะดัะถะฝะพ)
2nd: DNS cache        (ะฑััััะพ, ะฝะพ ะผะพะถะตั ัััะฐัะตัั)
3rd: DNS server       (ะผะตะดะปะตะฝะฝะพ, ะฝะพ ะฐะบััะฐะปัะฝะพ)
```

> **LILITH:**
> *"ะัะธะพัะธัะตั = /etc/hosts > DNS. ะัะปะธ ะฟะพะดะผะตะฝะธัั /etc/hosts โ ะฒะตัั DNS ะพะฑัะพะดะธััั. ะะฐัะธัะฐะน /etc/hosts ะฟัะฐะฒะฐะผะธ ะดะพัััะฟะฐ (root only)."*

---

### ๐ป ะัะฐะบัะธะบะฐ: ะะฐะฑะพัะฐ ั /etc/hosts (5-7 ะผะธะฝ)

#### **ะะฐะดะฐะฝะธะต 1: ะัะพัะผะพัั /etc/hosts**

```bash
# ะัะพัะธัะฐัั ัะฐะนะป
cat /etc/hosts

# ะะปะธ
less /etc/hosts
```

**ะงัะพ ัะฒะธะดะธัะต (ะฟัะธะผะตัะฝะพ):**
```bash
127.0.0.1       localhost
127.0.1.1       mycomputer
::1             localhost ip6-localhost ip6-loopback
```

---

#### **ะะฐะดะฐะฝะธะต 2: ะะพะฑะฐะฒะธัั shadow-server-02 ะฒ /etc/hosts**

**ะะปั ัะธะผัะปััะธะธ** (ัะตัะฒะตั ะฝะต ัััะตััะฒัะตั ัะตะฐะปัะฝะพ):

```bash
# ะกะพะทะดะฐัั backup
sudo cp /etc/hosts /etc/hosts.backup

# ะะพะฑะฐะฒะธัั ะทะฐะฟะธัั
echo "10.50.1.100  shadow-server-02.ops.internal" | sudo tee -a /etc/hosts

# ะัะพะฒะตัะธัั
grep "shadow-server-02" /etc/hosts
```

**ะขะตะฟะตัั ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะธะผั:**
```bash
ping shadow-server-02.ops.internal
# ะัะดะตั ะฟะธะฝะณะพะฒะฐัั 10.50.1.100 (ะธะท /etc/hosts)
```

---

#### **ะะฐะดะฐะฝะธะต 3: ะัะพะฒะตัะธัั ะฟัะธะพัะธัะตั /etc/hosts**

**ะญะบัะฟะตัะธะผะตะฝั:**
```bash
# ะะพะฑะฐะฒั ัะตะนะบะพะฒัะน IP ะดะปั google.com
echo "127.0.0.1  google.com" | sudo tee -a /etc/hosts

# ะะธะฝะณัะน google.com
ping -c 2 google.com
# ะะตะทัะปััะฐั: ะฟะธะฝะณัะตั 127.0.0.1 (ะปะพะบะฐะปัะฝะพ!)

# /etc/hosts ะธะผะตะตั ะฟัะธะพัะธัะตั ะฝะฐะด DNS โ

# ะฃะดะฐะปะธ ัััะพะบั ะฟะพัะปะต ัะบัะฟะตัะธะผะตะฝัะฐ
sudo sed -i '/127.0.0.1.*google.com/d' /etc/hosts
```

**"Aha!" ะผะพะผะตะฝั:** `/etc/hosts` **ัะธะปัะฝะตะต** ัะตะผ DNS!

> **LILITH:**
> *"ะะธะดะธัั? /etc/hosts ะฟะตัะตะพะฟัะตะดะตะปัะตั DNS. ะััะปะพะฒ ะผะพะถะตั ะดะพะฑะฐะฒะธัั '10.50.1.100 security-update.com' โ ัั ะฟะพะดะบะปััะฐะตัััั ะบ ะตะณะพ ัะตัะฒะตัั ะฒะผะตััะพ ะฝะฐััะพััะตะณะพ update ัะตัะฒะตัะฐ. ะะฐัะธัะฐ: sudo ะฟัะฐะฒะฐ + ะฟัะพะฒะตัะบะฐ /etc/hosts ัะตะณัะปััะฝะพ."*

---

#### **ะะฐะดะฐะฝะธะต 4: ะัะพัะผะพัั /etc/resolv.conf**

```bash
cat /etc/resolv.conf
```

**ะงัะพ ัะฒะธะดะธัะต:**
```bash
nameserver 192.168.1.1    # ะะพะผะฐัะฝะธะน ัะพััะตั
# ะธะปะธ
nameserver 8.8.8.8        # Google DNS
nameserver 1.1.1.1        # Cloudflare DNS
```

**ะะปั ะบัััะฐ (ะพะฟัะธะพะฝะฐะปัะฝะพ):**
ะัะปะธ ัะพัะธัะต ะธัะฟะพะปัะทะพะฒะฐัั Google DNS:
```bash
# Backup
sudo cp /etc/resolv.conf /etc/resolv.conf.backup

# ะะทะผะตะฝะธัั (ะฒัะตะผะตะฝะฝะพ)
echo "nameserver 8.8.8.8" | sudo tee /etc/resolv.conf
echo "nameserver 1.1.1.1" | sudo tee -a /etc/resolv.conf

# ะัะพะฒะตัะธัั DNS
nslookup google.com
```

**ะะพัััะฐะฝะพะฒะธัั:**
```bash
sudo mv /etc/resolv.conf.backup /etc/resolv.conf
```

---

<details>
<summary>โ ะะตัะตะฝะธะต: Backup /etc/hosts ะฒ ัะบัะธะฟัะต</summary>

```bash
#!/bin/bash

# Function: Backup /etc/hosts before modifications
backup_hosts() {
    local backup_file="artifacts/hosts.backup"

    echo "ะกะพะทะดะฐะฝะธะต backup /etc/hosts..."

    if [ ! -f /etc/hosts ]; then
        echo "  โ /etc/hosts ะฝะต ะฝะฐะนะดะตะฝ (ัััะฐะฝะฝะพ)"
        return 1
    fi

    # ะกะพะทะดะฐัั artifacts ะดะธัะตะบัะพัะธั
    mkdir -p artifacts

    # Backup (ะผะพะถะตั ะฝะต ััะฐะฑะพัะฐัั ะฑะตะท sudo)
    if cp /etc/hosts "$backup_file" 2>/dev/null; then
        echo "  โ Backup ัะพะทะดะฐะฝ: $backup_file"
        echo "  ะะฐะทะผะตั: $(du -h "$backup_file" | awk '{print $1}')"

        # ะะพะบะฐะทะฐัั ัะพะดะตัะถะธะผะพะต
        echo ""
        echo "  ะกะพะดะตัะถะธะผะพะต /etc/hosts:"
        head -n 10 "$backup_file" | sed 's/^/    /'

        return 0
    else
        echo "  โ ะะตั ะฟัะฐะฒ ะดะปั ะบะพะฟะธัะพะฒะฐะฝะธั /etc/hosts (ะฝะพัะผะฐะปัะฝะพ)"
        echo "  ะะปั backup: sudo cp /etc/hosts artifacts/hosts.backup"
        return 1
    fi
}

# ะัะฟะพะปัะทะพะฒะฐะฝะธะต
backup_hosts
```

**ะัะธะผะตัะฐะฝะธะต:** ะะพะฟะธัะพะฒะฐะฝะธะต `/etc/hosts` ะพะฑััะฝะพ ัะฐะฑะพัะฐะตั ะฑะตะท sudo (ััะตะฝะธะต), ะฝะพ ะผะพะดะธัะธะบะฐัะธั ััะตะฑัะตั sudo.

</details>

---

### ๐ป ะัะฐะบัะธะบะฐ: DNS Lookup ะบะพะผะฐะฝะดั (3-5 ะผะธะฝ)

#### **ะะพะผะฐะฝะดั ะดะปั DNS ะทะฐะฟัะพัะพะฒ:**

```bash
# 1. host โ ะฟัะพััะพะน lookup
host google.com

# 2. nslookup โ ััะฐััะน ัะฟะพัะพะฑ (ะฝะพ ัะฐะฑะพัะฐะตั)
nslookup google.com

# 3. dig โ ะดะตัะฐะปัะฝัะน (ัะตะบะพะผะตะฝะดัะตััั)
dig google.com

# 4. dig +short โ ัะพะปัะบะพ IP (ะดะปั ัะบัะธะฟัะพะฒ)
dig google.com +short
```

**ะัะธะผะตั ะฒัะฒะพะดะฐ:**

```bash
$ host google.com
google.com has address 142.250.185.46
google.com has IPv6 address 2001:4860:4860::8888

$ dig google.com +short
142.250.185.46
```

---

#### **ะะฐะดะฐะฝะธะต: ะะฟัะตะดะตะปะธัั IP ัะตัะฒะตัะฐ Viktor**

**ะะฐัะธะฐะฝั 1: ะะท network_map.txt (ัะธะผัะปััะธั)**
```bash
grep "shadow-server-02" artifacts/network_map.txt | awk '{print $1}'
# ะะตะทัะปััะฐั: 10.50.1.100
```

**ะะฐัะธะฐะฝั 2: ะงะตัะตะท /etc/hosts (ะตัะปะธ ะดะพะฑะฐะฒะธะปะธ)**
```bash
grep "shadow-server-02" /etc/hosts | awk '{print $1}'
```

**ะะฐัะธะฐะฝั 3: DNS lookup (ะตัะปะธ ะฝะฐัััะพะตะฝ)**
```bash
host shadow-server-02.ops.internal
# ะะปะธ
dig shadow-server-02.ops.internal +short
```

---

<details>
<summary>โ ะะตัะตะฝะธะต: Get IP ะธะท ัะฐะทะฝัั ะธััะพัะฝะธะบะพะฒ</summary>

```bash
#!/bin/bash

# Function: Get Viktor server IP from multiple sources
get_viktor_server_ip() {
    local hostname="shadow-server-02.ops.internal"
    local ip=""

    echo "ะะฟัะตะดะตะปะตะฝะธะต IP ัะตัะฒะตัะฐ Viktor ($hostname)..."

    # ะะพะฟััะบะฐ 1: artifacts/network_map.txt (ะฟัะธะพัะธัะตั)
    if [ -f "artifacts/network_map.txt" ]; then
        ip=$(grep "$hostname" artifacts/network_map.txt 2>/dev/null | awk '{print $1}')
        if [ -n "$ip" ]; then
            echo "  โ ะะฐะนะดะตะฝ ะฒ network_map.txt: $ip"
            echo "$ip"
            return 0
        fi
    fi

    # ะะพะฟััะบะฐ 2: /etc/hosts
    ip=$(grep "$hostname" /etc/hosts 2>/dev/null | grep -v "^#" | awk '{print $1}' | head -n1)
    if [ -n "$ip" ]; then
        echo "  โ ะะฐะนะดะตะฝ ะฒ /etc/hosts: $ip"
        echo "$ip"
        return 0
    fi

    # ะะพะฟััะบะฐ 3: DNS lookup (host)
    if command -v host &>/dev/null; then
        ip=$(host "$hostname" 2>/dev/null | grep "has address" | awk '{print $4}' | head -n1)
        if [ -n "$ip" ]; then
            echo "  โ DNS lookup (host): $ip"
            echo "$ip"
            return 0
        fi
    fi

    # ะะพะฟััะบะฐ 4: DNS lookup (dig)
    if command -v dig &>/dev/null; then
        ip=$(dig "$hostname" +short 2>/dev/null | head -n1)
        if [ -n "$ip" ]; then
            echo "  โ DNS lookup (dig): $ip"
            echo "$ip"
            return 0
        fi
    fi

    # Fallback: ะธะทะฒะตััะฝัะน IP (ะดะปั ัะธะผัะปััะธะธ)
    echo "  โ IP ะฝะต ะฝะฐะนะดะตะฝ ะฒ network_map.txt, /etc/hosts, DNS"
    echo "  ะัะฟะพะปัะทัะตะผ fallback: 10.50.1.100"
    echo "10.50.1.100"
    return 0
}

# ะัะฟะพะปัะทะพะฒะฐะฝะธะต
VIKTOR_IP=$(get_viktor_server_ip)
echo "Viktor Server IP: $VIKTOR_IP"
```

**ะัะธะพัะธัะตั:**
1. `artifacts/network_map.txt` (ัะธะผัะปััะธั, ะดะปั ะบัััะฐ)
2. `/etc/hosts` (ะปะพะบะฐะปัะฝะฐั ะบะพะฝัะธะณััะฐัะธั)
3. DNS (`host`, `dig`)
4. Fallback (10.50.1.100)

</details>

---

### ๐ค ะัะพะฒะตัะบะฐ ะฟะพะฝะธะผะฐะฝะธั (1 ะผะธะฝ)

**LILITH ัะฟัะฐัะธะฒะฐะตั:**

> *"ะขั ะดะพะฑะฐะฒะธะป ะฒ /etc/hosts: '127.0.0.1 google.com'. ะงัะพ ะฟัะพะธะทะพะนะดัั ะบะพะณะดะฐ ัั ะทะฐะฟัััะธัั 'ping google.com'?"*

**ะัะผะฐะน 30 ัะตะบัะฝะด ะฟะตัะตะด ะฟัะพะฒะตัะบะพะน:**

<details>
<summary>๐ก ะัะฒะตั</summary>

**ะะตะทัะปััะฐั:**
```bash
$ ping google.com
PING google.com (127.0.0.1) 56(84) bytes of data.
64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.031 ms
```

**ะงัะพ ะฟัะพะธััะพะดะธั:**

1. **ping** ะทะฐะฟัะฐัะธะฒะฐะตั IP ะดะปั `google.com`
2. **Linux** ะฟัะพะฒะตััะตั `/etc/hosts` ะะะะะซะ (ะฟัะธะพัะธัะตั)
3. **ะะฐัะพะดะธั:** `127.0.0.1  google.com`
4. **ะัะฟะพะปัะทัะตั:** `127.0.0.1` (localhost)
5. **ะะธะฝะณัะตั localhost**, ะะ ะฝะฐััะพััะธะน Google!

**"Aha!" ะผะพะผะตะฝั:**
- `/etc/hosts` **ะฟะตัะตะพะฟัะตะดะตะปัะตั DNS**
- DNS ะดะฐะถะต ะฝะต ะทะฐะฟัะฐัะธะฒะฐะตััั
- ะญัะพ ะผะพัะฝัะน ะธะฝััััะผะตะฝั... ะธ ะพะฟะฐัะฝัะน

**Security implications:**

**ะัะฐะบะฐ ัะตัะตะท /etc/hosts:**
```bash
# ะััะปะพะฒ ะฟะพะปััะฐะตั root ะฝะฐ ัะฒะพะตะน ะผะฐัะธะฝะต
# ะะพะฑะฐะฒะปัะตั ะฒ /etc/hosts:
185.220.101.47  security-update.ubuntu.com
185.220.101.47  api.mybank.com
185.220.101.47  gmail.com

# ะขะตะฟะตัั:
# - ะะฑะฝะพะฒะปะตะฝะธั ะธะดัั ะฝะฐ ัะตัะฒะตั ะััะปะพะฒะฐ
# - ะะฐะฝะบะพะฒัะบะธะน API ะฟะพะดะบะปััะฐะตััั ะบ ะััะปะพะฒั
# - Gmail ะปะพะณะธะฝ ะพัะฟัะฐะฒะปัะตััั ะััะปะพะฒั
```

**ะะฐัะธัะฐ:**
```bash
# 1. ะัะฐะฒะฐ ะดะพัััะฟะฐ (ัะพะปัะบะพ root ะผะพะถะตั ัะตะดะฐะบัะธัะพะฒะฐัั)
ls -l /etc/hosts
# -rw-r--r-- root root /etc/hosts

# 2. ะะตะณัะปััะฝะฐั ะฟัะพะฒะตัะบะฐ
cat /etc/hosts | grep -v "^#" | grep -v "^$"

# 3. File integrity monitoring (advanced)
# tripwire, AIDE, etc.
```

> **LILITH:**
> *"/etc/hosts = ัะฐะผัะน ะฟัะพััะพะน ะธ ัะฐะผัะน ะพะฟะฐัะฝัะน ัะฟะพัะพะฑ ะฟะพะดะผะตะฝั DNS. ะััะปะพะฒ ะปัะฑะธั ััะพั ัะฐะนะป. ะะฐัะธัะฐะน ะตะณะพ. ะัะพะฒะตััะน ัะตะณัะปััะฝะพ. ะ ะฟะพะผะฝะธ: ะตัะปะธ ัั root โ ัั ะผะพะถะตัั ะฟะพะดะผะตะฝะธัั ะปัะฑะพะน ะดะพะผะตะฝ."*

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 3:

- โ DNS = ัะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ (ะธะผั โ IP)
- โ DNS spoofing = ะฟะพะดะผะตะฝะฐ ะฝะพะผะตัะฐ ะฒ ะบะฝะธะถะบะต (ะฐัะฐะบะฐ ะััะปะพะฒะฐ)
- โ `/etc/hosts` = ะปะพะบะฐะปัะฝะฐั ะบะฝะธะถะบะฐ (ะฟัะธะพัะธัะตั ะฝะฐะด DNS!)
- โ `/etc/resolv.conf` = ะบะฐะบะธะต DNS ัะตัะฒะตัั ะธัะฟะพะปัะทะพะฒะฐัั
- โ ะัะธะพัะธัะตั: /etc/hosts โ DNS cache โ DNS server
- โ ะะพะผะฐะฝะดั: `host`, `dig`, `nslookup`
- โ Artifacts: `hosts.backup` (ะฟะตัะตะด ะผะพะดะธัะธะบะฐัะธะตะน)

> **LILITH:**
> *"ะฆะธะบะป 3 ะทะฐะฒะตัััะฝ. DNS โ ะผะพัั ะผะตะถะดั ะธะผะตะฝะฐะผะธ ะธ ะฐะดัะตัะฐะผะธ. ะะพ ะผะพััั ะผะพะถะฝะพ ะฒะทะพัะฒะฐัั. ะะปะธ ะฟะพะดะผะตะฝะธัั. ะััะปะพะฒ ััะพ ะดะตะปะฐะตั. ะกะปะตะดัััะธะน ััะพะฒะตะฝั โ traceroute. ะฃะทะฝะฐะตะผ ัะตัะตะท ะบะฐะบะธะต ะผะพััั ะธะดัั ััะฐัะธะบ. ะะพะตัะฐะปะธ."*

---

## ๐ ะฆะะะ 4: Traceroute & Routing โ "ะะพััะพะฒัะต ััะฐะฝัะธะธ" (15 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (2 ะผะธะฝ)

ะะฝะฝะฐ ะฟะพะบะฐะทัะฒะฐะตั ะฝะฐ ะบะฐััั ั ะปะธะฝะธัะผะธ ะผะตะถะดั ะณะพัะพะดะฐะผะธ:

> **ะะฝะฝะฐ:**
> *"ะะฐะบั, ะฝัะถะตะฝ ะผะฐััััั ะดะพ shadow-server-02. ะงะตัะตะท ะบะฐะบะธะต ัะทะปั ะธะดัั ััะฐัะธะบ? ะกะบะพะปัะบะพ ัะพััะตัะพะฒ ะผะตะถะดั ะฝะฐะผะธ ะธ ะธะผ?"*

ะะปะตะบั ะฟะพะดัะพะดะธั:

> **ะะปะตะบั:**
> *"Traceroute โ ะบะฐััะฐ ะผะฐัััััะฐ ะฟะฐะบะตัะฐ. ะะฐะถะดัะน ัะพััะตั ะพััะฐะฒะปัะตั ัะปะตะด. ะะดะธะฝ ะธะท ัะพััะตัะพะฒ ะผะพะถะตั ะฑััั ัะบะพะผะฟัะพะผะตัะธัะพะฒะฐะฝ ะััะปะพะฒัะผ. Man-in-the-middle."*

> **LILITH:**
> *"Traceroute = ัะตะฟั ะฟะพััะพะฒัั ััะฐะฝัะธะน. ะะธััะผะพ ะธะดัั ะะพะฒะพัะธะฑะธััะบ โ ะะพัะบะฒะฐ โ ะกัะพะบะณะพะปัะผ. ะะฐะถะดะฐั ััะฐะฝัะธั = hop. ะััะปะพะฒ ะผะพะถะตั ัะธะดะตัั ะฝะฐ ะปัะฑะพะน ััะฐะฝัะธะธ ะธ ัะธัะฐัั ะฟะธััะผะฐ."*

---

### ๐ ะขะตะพัะธั: Traceroute & Routing (6-7 ะผะธะฝ)

#### **ะะตัะฐัะพัะฐ: Traceroute = ะะพััะพะฒัะต ััะฐะฝัะธะธ** ๐ฎ

ะัะตะดััะฐะฒั ะพัะฟัะฐะฒะบั ะฟะธััะผะฐ ัะตัะตะท ะฟะพััั:

```
ะะพะฒะพัะธะฑะธััะบ (ัั)
      โ  Station 1 (ะะพะฒะพัะธะฑะธััะบ ะะพััะฐ) โ 1ms
      โ  Station 2 (ะะพัะบะฒะฐ ะะพััะฐ) โ 50ms
      โ  Station 3 (ะกัะพะบะณะพะปัะผ ะะพััะฐ) โ 100ms
      โ  Station 4 (ะะพะปััะฐัะตะปั) โ 105ms

ะะฐะถะดะฐั ััะฐะฝัะธั = hop (ัะพััะตั ะฒ ัะตัะธ)
ะัะตะผั = latency ะดะพ ััะพะน ััะฐะฝัะธะธ
```

**traceroute ะฟะพะบะฐะทัะฒะฐะตั ะบะฐะถะดัั ััะฐะฝัะธั ะฝะฐ ะฟััะธ ะบ ัะตะปะธ.**

> **LILITH:**
> *"ะะฐะถะดัะน hop ะผะพะถะตั ัะธัะฐัั ะฟะฐะบะตัั (ะตัะปะธ ะฝะต ะทะฐัะธััะพะฒะฐะฝะพ). ะััะปะพะฒ ะผะพะถะตั ะบะพะฝััะพะปะธัะพะฒะฐัั hop #3 โ ัะธัะฐะตั ะฒะตัั ััะฐัะธะบ ัะตัะตะท ะฝะตะณะพ. HTTPS ะทะฐัะธัะฐะตั ะพั ััะพะณะพ."*

---

#### **ะะฐะบ ัะฐะฑะพัะฐะตั traceroute:**

**ะขััะบ ั TTL (Time To Live):**

1. ะัะฟัะฐะฒะธัั ะฟะฐะบะตั ั TTL=1
   - ะะตัะฒัะน ัะพััะตั: "TTL ะธัััะบ!" โ ะพัะฟัะฐะฒะปัะตั ICMP "Time Exceeded"
   - ะั ัะทะฝะฐะปะธ IP ะฟะตัะฒะพะณะพ ัะพััะตัะฐ

2. ะัะฟัะฐะฒะธัั ะฟะฐะบะตั ั TTL=2
   - ะะตัะฒัะน ัะพััะตั: ะฟัะพะฟััะบะฐะตั
   - ะัะพัะพะน ัะพััะตั: "TTL ะธัััะบ!" โ ะพัะฟัะฐะฒะปัะตั ICMP
   - ะั ัะทะฝะฐะปะธ IP ะฒัะพัะพะณะพ ัะพััะตัะฐ

3. ะะพะฒัะพัััั ะฟะพะบะฐ ะฝะต ะดะพะนะดัะผ ะดะพ ัะตะปะธ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    TRACEROUTE MECHANISM                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

[ะขั] โโ(TTL=1)โโ> [Router 1] "TTL expired!" โโICMPโโ> [ะขั]
     ะฃะทะฝะฐะปะธ IP Router 1 โ

[ะขั] โโ(TTL=2)โโ> [Router 1] โโ> [Router 2] "TTL expired!" โโ> [ะขั]
     ะฃะทะฝะฐะปะธ IP Router 2 โ

[ะขั] โโ(TTL=3)โโ> [Router 1] โโ> [Router 2] โโ> [ะฆะตะปั] "Got it!" โโ> [ะขั]
     ะะพัะปะธ ะดะพ ัะตะปะธ โ
```

---

#### **ะัะธะผะตั ะฒัะฒะพะดะฐ traceroute:**

```bash
$ traceroute google.com

traceroute to google.com (142.250.185.46), 30 hops max
 1  192.168.1.1 (192.168.1.1)  1.245 ms    # ะะพะผะฐัะฝะธะน ัะพััะตั
 2  10.0.0.1 (10.0.0.1)  5.123 ms          # ISP gateway
 3  72.14.213.1 (72.14.213.1)  12.456 ms   # ISP backbone
 4  * * *                                    # Firewall (ะฝะต ะพัะฒะตัะฐะตั)
 5  142.250.185.46 (142.250.185.46)  15.2 ms  # Google
```

**ะงัะพ ะพะทะฝะฐัะฐัั ัะธะผะฒะพะปั:**
- `*` โ ัะพััะตั ะฝะต ะพัะฒะตัะฐะตั (firewall ะธะปะธ ะฝะฐัััะพะนะบะฐ)
- `* * *` โ ััะธ ะฟะพะฟััะบะธ failed
- ะัะตะผั โ latency ะดะพ ััะพะณะพ hop'ะฐ

> **LILITH:**
> *"`* * *` = ัะปะตะฟะพะต ะฟััะฝะพ. ะะธะฑะพ firewall ะฑะปะพะบะธััะตั ICMP, ะปะธะฑะพ ัะพััะตั ะฝะฐัััะพะตะฝ ะฝะต ะพัะฒะตัะฐัั. ะััะปะพะฒ ะผะพะถะตั ัะบััะฒะฐัั ัะฒะพะธ ัะพััะตัั ัะฐะบ."*

---

#### **Routing Table โ "ะะฐััะฐ ะดะพัะพะณ"**

**Routing table** ะพะฟัะตะดะตะปัะตั ะบัะดะฐ ะพัะฟัะฐะฒะปััั ะฟะฐะบะตัั.

**ะะตัะฐัะพัะฐ:** Routing table = GPS ะฝะฐะฒะธะณะฐัะพั ั ะบะฐััะพะน ะดะพัะพะณ
- ะะฐะถะดะฐั ัััะพะบะฐ = ะผะฐััััั ะบ ะพะฟัะตะดะตะปัะฝะฝะพะน ัะตัะธ
- Default gateway = "ะตัะปะธ ะฝะต ะทะฝะฐะตัั ะบัะดะฐ โ ะธะดะธ ััะดะฐ"

**ะัะธะผะตั `/ip route show`:**
```bash
default via 192.168.1.1 dev eth0         # Default = ะดะพะผะฐัะฝะธะน ัะพััะตั
10.50.0.0/16 dev eth1                   # ะกะตัั 10.50.x.x ะฝะฐะฟััะผัั
192.168.1.0/24 dev eth0                 # ะะพะบะฐะปัะฝะฐั ัะตัั
```

**ะะฝัะตัะฟัะตัะฐัะธั:**
- ะะฐะบะตั ะดะปั `10.50.5.10` โ ะพัะฟัะฐะฒะธัั ัะตัะตะท `eth1` (ะฝะฐะฟััะผัั)
- ะะฐะบะตั ะดะปั `8.8.8.8` โ ะฝะตั ะผะฐัััััะฐ โ ะพัะฟัะฐะฒะธัั ัะตัะตะท default gateway

---

### ๐ป ะัะฐะบัะธะบะฐ: Traceroute & Routing (5-6 ะผะธะฝ)

#### **ะะฐะดะฐะฝะธะต 1: Traceroute ะดะพ Google (ะตัะปะธ ะตััั ะธะฝัะตัะฝะตั)**

```bash
# tracepath (ะฝะต ััะตะฑัะตั sudo)
tracepath google.com

# ะธะปะธ traceroute (ััะตะฑัะตั sudo)
sudo traceroute google.com
```

#### **ะะฐะดะฐะฝะธะต 2: ะัะพัะผะพัั routing table**

```bash
# ะะพะบะฐะทะฐัั ะฒัะต ะผะฐัััััั
ip route show

# ะะปะธ ะบะพัะพัะต
ip r

# ะะฐะนัะธ default gateway
ip route | grep default
```

#### **ะะฐะดะฐะฝะธะต 3: ะะฟัะตะดะตะปะธัั default gateway**

```bash
# ะะทะฒะปะตัั IP gateway
ip route | grep default | awk '{print $3}'

# ะะธะฝะณะพะฒะฐัั gateway
ping -c 2 $(ip route | grep default | awk '{print $3}')
```

<details>
<summary>โ ะะตัะตะฝะธะต: Traceroute ะฒ ัะบัะธะฟัะต</summary>

```bash
#!/bin/bash

simulate_traceroute() {
    local server_ip="$1"

    echo "ะะฐััััั ะดะพ ัะตัะฒะตัะฐ Viktor ($server_ip):"

    if command -v tracepath &>/dev/null; then
        echo "  (ะัะฟะพะปัะทัั tracepath)"
        tracepath -n "$server_ip" 2>/dev/null | head -n 10 || \
            echo "  (traceroute ะฝะต ัะดะฐะปัั โ ัะธะผัะปััะธั)"
    else
        # ะกะธะผัะปััะธั
        echo "  (ะกะธะผัะปััะธั traceroute)"
        echo "  1  192.168.100.1    1.2ms   (Gateway)"
        echo "  2  10.50.0.1        2.5ms   (ะฆะะ Switch)"
        echo "  3  $server_ip       3.1ms   (shadow-server-02)"
        echo ""
        echo "โ 3 hops, ะฟะพัะปะตะดะฝะธะน ัะทะตะป ะฒ ะฆะะะต ะะพัะบะฒะฐ-1"
    fi
}

show_routing_table() {
    echo "ะขะฐะฑะปะธัะฐ ะผะฐัััััะธะทะฐัะธะธ:"
    ip route show | sed 's/^/  /'

    echo ""
    local gateway=$(ip route | grep default | awk '{print $3}' | head -n1)
    if [ -n "$gateway" ]; then
        echo "โ Default gateway: $gateway"
    fi
}

simulate_traceroute "10.50.1.100"
show_routing_table
```

</details>

---

### ๐ค ะัะพะฒะตัะบะฐ ะฟะพะฝะธะผะฐะฝะธั

**LILITH ัะฟัะฐัะธะฒะฐะตั:**
> *"Traceroute ะฟะพะบะฐะทัะฒะฐะตั 20 hops ะดะพ ัะตัะฒะตัะฐ Viktor ะฒ ะะพัะบะฒะต. ะญัะพ ะฝะพัะผะฐะปัะฝะพ?"*

<details>
<summary>๐ก ะัะฒะตั</summary>

**ะะตั, ััะพ ะฟะพะดะพะทัะธัะตะปัะฝะพ.**

**ะะพัะผะฐะปัะฝะพ:**
- ะะพะบะฐะปัะฝะฐั ัะตัั (ะฆะะ): 1-3 hops
- ะขะพั ะถะต ะณะพัะพะด: 3-5 hops
- ะััะณะพะน ะณะพัะพะด (ะะพััะธั): 5-10 hops

**20 hops = ะฟัะพะฑะปะตะผะฐ:**
- ะะปะพัะฐั ะผะฐัััััะธะทะฐัะธั (ะฟะฐะบะตั ะธะดัั ะบััะถะฝัะผ ะฟัััะผ)
- ะะพะทะผะพะถะฝะพ Man-in-the-Middle (ะััะปะพะฒ ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตั ััะฐัะธะบ ัะตัะตะท ัะฒะพะธ ัะพััะตัั)
- VPN ะธะปะธ Tor (ะผะฝะพะณะพ ะฟัะพะผะตะถััะพัะฝัั ัะทะปะพะฒ)

**ะะตัะตะฝะธะต:**
- ะัะพะฒะตัะธัั ะผะฐััััั: `traceroute 10.50.1.100`
- ะกัะฐะฒะฝะธัั ั ะพะถะธะดะฐะตะผัะผ ะผะฐัััััะพะผ
- ะัะปะธ ะฟะพะดะพะทัะธัะตะปัะฝะพ โ ะธัะฟะพะปัะทะพะฒะฐัั VPN (Episode 08)

> **LILITH:**
> *"20 hops ะฒะฝัััะธ ะพะดะฝะพะณะพ ะฆะะ? ะััะปะพะฒ ะฟะตัะตะฝะฐะฟัะฐะฒะธะป ััะฐัะธะบ ัะตัะตะท ัะฒะพะธ ัะตัะฒะตัั. Man-in-the-middle. ะััะผะพะน ะผะฐััััั = 2-3 hops. 20 hops = ะบัะพ-ัะพ ะฒะผะตัะฐะปัั."*

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 4:

- โ traceroute = ะฟะพะบะฐะทัะฒะฐะตั ะบะฐะถะดัะน ัะพััะตั ะฝะฐ ะฟััะธ
- โ TTL trick = ะบะฐะบ traceroute ัะฐะฑะพัะฐะตั
- โ Default gateway = ะบัะดะฐ ะธะดัะธ ะตัะปะธ ะผะฐััััั ะฝะตะธะทะฒะตััะตะฝ
- โ Routing table = ะบะฐััะฐ ะดะพัะพะณ ะดะปั ะฟะฐะบะตัะพะฒ
- โ ะะพะผะฐะฝะดั: `tracepath`, `traceroute`, `ip route`

> **LILITH:**
> *"ะฆะธะบะป 4 ะทะฐะฒะตัััะฝ. ะขั ะทะฝะฐะตัั ะผะฐััััั. ะะฐะถะดัะน hop โ ะฟะพัะตะฝัะธะฐะปัะฝะฐั ัะพัะบะฐ ะบะพะฝััะพะปั ะััะปะพะฒะฐ. ะกะปะตะดัััะธะน ััะพะฒะตะฝั โ ะฟะพััั. ะะฒะตัะธ ะฒ ะทะดะฐะฝะธะธ. ะะฐะบะธะต ะพัะบัััั? ะะฐะบะธะต ะทะฐะบัััั? ะะพะตัะฐะปะธ."*

---

## ๐ ะฆะะะ 5: ะะพััั & ะกะพะบะตัั โ "ะะฒะฐััะธัั ะฒ ะทะดะฐะฝะธะธ" (15 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (2 ะผะธะฝ)

ะะผะธััะธะน ะฟะพะบะฐะทัะฒะฐะตั ะฝะฐ ะผะพะฝะธัะพั ั ะฒัะฒะพะดะพะผ `ss -tuln`:

> **ะะผะธััะธะน:**
> *"ะะฐะบั, ะบะฐะบะธะต ะฟะพััั ะพัะบัััั ะฝะฐ shadow-server-02? SSH? HTTP? ะะฐะทะฐ ะดะฐะฝะฝัั? ะะฐะถะดัะน ะฟะพัั = ะฟะพัะตะฝัะธะฐะปัะฝะฐั ััะทะฒะธะผะพััั."*

ะะปะตะบั:

> **ะะปะตะบั:**
> *"ะัะบััััะน ะฟะพัั = ะพัะบัััะฐั ะดะฒะตัั. ะัะปะธ ะฟะพัั ะฝะต ะฝัะถะตะฝ โ ะทะฐะบัะพะน ะตะณะพ. Firewall (Episode 07). ะััะปะพะฒ ัะบะฐะฝะธััะตั ะพัะบััััะต ะฟะพััั ะธ ะฐัะฐะบัะตั ััะทะฒะธะผัะต ัะตัะฒะธัั."*

> **LILITH:**
> *"IP ะฐะดัะตั = ะทะดะฐะฝะธะต. ะะพัั = ะบะฒะฐััะธัะฐ ะฒ ะทะดะฐะฝะธะธ. 192.168.1.100:22 = ะดะพะผ 192.168.1.100, ะบะฒะฐััะธัะฐ 22 (SSH). ะััะปะพะฒ ััััะธััั ะฒ ะบะฐะถะดัั ะดะฒะตัั. ะัะบัะพะน ัะพะปัะบะพ ะฝัะถะฝัะต."*

---

### ๐ ะขะตะพัะธั: ะะพััั ะธ ะกะพะบะตัั (6-7 ะผะธะฝ)

#### **ะะตัะฐัะพัะฐ: ะะพัั = ะะฒะฐััะธัะฐ ะฒ ะทะดะฐะฝะธะธ** ๐ข

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ะะะะะะ 192.168.1.100           โ
โ                                  โ
โ   ะะฒะฐััะธัะฐ 22   โ SSH           โ
โ   ะะฒะฐััะธัะฐ 80   โ HTTP          โ
โ   ะะฒะฐััะธัะฐ 443  โ HTTPS         โ
โ   ะะฒะฐััะธัะฐ 3306 โ MySQL         โ
โ   ะะฒะฐััะธัะฐ 8080 โ Debug App     โ
โ                                  โ
โ   ะััะฐะปัะฝัะต ะบะฒะฐััะธัั: ะฟััััะต    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะคะพัะผะฐั: IP:PORT
ะัะธะผะตั: 192.168.1.100:22 (SSH ัะตัะฒะตั)
```

**ะะฐัะตะผ ะฟะพััั?**
- ะะดะธะฝ IP ะฐะดัะตั = ะพะดะธะฝ ัะตัะฒะตั
- ะะพ ะฝะฐ ัะตัะฒะตัะต ะผะฝะพะณะพ ัะตัะฒะธัะพะฒ (web, ssh, database, mail...)
- ะะพััั ัะฐะทะดะตะปััั ัะตัะฒะธัั

> **LILITH:**
> *"ะะพัั = ัะฟะพัะพะฑ ัะฐะทะปะธัะธัั ัะตัะฒะธัั ะฝะฐ ะพะดะฝะพะผ IP. ะะตะท ะฟะพััะพะฒ ัะตัะฒะตั ะผะพะณ ะฑั ะดะตะปะฐัั ัะพะปัะบะพ ะพะดะฝั ะฒะตัั. ะก ะฟะพััะฐะผะธ โ 65,535 ะฒะตัะตะน ะพะดะฝะพะฒัะตะผะตะฝะฝะพ."*

---

#### **ะะธะฐะฟะฐะทะพะฝั ะฟะพััะพะฒ:**

| ะะธะฐะฟะฐะทะพะฝ | ะะฐะทะฒะฐะฝะธะต | ะัะฟะพะปัะทะพะฒะฐะฝะธะต |
|----------|----------|---------------|
| 0-1023 | Well-known | ะกะธััะตะผะฝัะต ัะตัะฒะธัั (ััะตะฑััั root) |
| 1024-49151 | Registered | ะัะธะปะพะถะตะฝะธั |
| 49152-65535 | Dynamic | ะัะตะผะตะฝะฝัะต (ะบะปะธะตะฝััะบะธะต ัะพะตะดะธะฝะตะฝะธั) |

**ะะพะฟัะปััะฝัะต ะฟะพััั:**
```
22   โ SSH (ัะดะฐะปัะฝะฝัะน ัะตัะผะธะฝะฐะป)
80   โ HTTP (ะฒะตะฑ ะฑะตะท ัะธััะพะฒะฐะฝะธั)
443  โ HTTPS (ะฒะตะฑ ั SSL/TLS)
25   โ SMTP (ะพัะฟัะฐะฒะบะฐ email)
110  โ POP3 (ะฟะพะปััะตะฝะธะต email)
143  โ IMAP (email)
3306 โ MySQL
5432 โ PostgreSQL
6379 โ Redis
```

---

#### **ะกะพััะพัะฝะธั ะฟะพััะพะฒ:**

```bash
$ ss -tuln
State    Local Address:Port
LISTEN   0.0.0.0:22         # SSH ัะปััะฐะตั ะฝะฐ ะฒัะตั ะธะฝัะตััะตะนัะฐั
LISTEN   127.0.0.1:3306     # MySQL ัะพะปัะบะพ ะฝะฐ localhost
ESTAB    192.168.1.100:45678 โ 142.250.185.46:443  # ะะบัะธะฒะฝะพะต HTTPS ัะพะตะดะธะฝะตะฝะธะต
```

**ะกะพััะพัะฝะธั:**
- **LISTEN** โ ะฟะพัั ะพัะบััั, ะถะดัั ะฟะพะดะบะปััะตะฝะธะน
- **ESTABLISHED** โ ะฐะบัะธะฒะฝะพะต ัะพะตะดะธะฝะตะฝะธะต
- **TIME_WAIT** โ ัะพะตะดะธะฝะตะฝะธะต ะทะฐะบััะฒะฐะตััั

**Security:**
- `0.0.0.0:22` = SSH ะดะพัััะฟะตะฝ **ะธะทะฒะฝะต** (ะพะฟะฐัะฝะพ!)
- `127.0.0.1:3306` = MySQL ัะพะปัะบะพ **localhost** (ะฑะตะทะพะฟะฐัะฝะตะต)

> **LILITH:**
> *"0.0.0.0 = ะดะฒะตัั ะพัะบัััะฐ ะดะปั ะฒัะตั. 127.0.0.1 = ะดะฒะตัั ะพัะบัััะฐ ัะพะปัะบะพ ะธะทะฝัััะธ. ะะฐะทั ะดะฐะฝะฝัั ะฝะฐ 0.0.0.0? ะััะปะพะฒ ะณะพะฒะพัะธั ัะฟะฐัะธะฑะพ."*

---

### ๐ป ะัะฐะบัะธะบะฐ: ะัะพะฒะตัะบะฐ ะฟะพััะพะฒ (5-6 ะผะธะฝ)

#### **ะะฐะดะฐะฝะธะต 1: ะัะบััััะต ะฟะพััั ะฝะฐ ะปะพะบะฐะปัะฝะพะน ะผะฐัะธะฝะต**

```bash
# ss (ัะพะฒัะตะผะตะฝะฝัะน)
ss -tuln

# netstat (ััะฐััะน, ะฝะพ ัะฐะฑะพัะฐะตั)
netstat -tuln

# ะก ะฟัะพัะตััะฐะผะธ (ััะตะฑัะตั sudo)
sudo ss -tulnp
```

#### **ะะฐะดะฐะฝะธะต 2: ะัะพะฒะตัะธัั ะบะพะฝะบัะตัะฝัะน ะฟะพัั**

```bash
# ะกะปััะฐะตั ะปะธ ะฟะพัั 22 (SSH)?
ss -tuln | grep :22

# ะัะพ ัะปััะฐะตั ะฟะพัั 80?
sudo ss -tulnp | grep :80
```

<details>
<summary>โ ะะตัะตะฝะธะต: ะัะพะฒะตัะบะฐ ะฟะพััะพะฒ ะฒ ัะบัะธะฟัะต</summary>

```bash
#!/bin/bash

check_local_ports() {
    echo "ะัะบััััะต ะฟะพััั ะฝะฐ ัะฐะฑะพัะตะน ััะฐะฝัะธะธ Max:"

    if command -v ss &>/dev/null; then
        echo "  (ะัะฟะพะปัะทัั ss -tuln)"
        ss -tuln | grep LISTEN | awk '{print "  " $1 "\t" $5}' | head -n 10
    elif command -v netstat &>/dev/null; then
        echo "  (ะัะฟะพะปัะทัั netstat -tuln)"
        netstat -tuln | grep LISTEN | awk '{print "  " $1 "\t" $4}' | head -n 10
    fi

    echo ""
    echo "โ ะัะพะฒะตัััะต: ะฝัะถะฝั ะปะธ ะฒัะต ััะธ ะฟะพััั?"
    echo "  ะะฐะถะดัะน ะพัะบััััะน ะฟะพัั = ะฟะพัะตะฝัะธะฐะปัะฝะฐั ััะทะฒะธะผะพััั"
}

check_local_ports
```

</details>

---

### ๐ค ะัะพะฒะตัะบะฐ ะฟะพะฝะธะผะฐะฝะธั

**LILITH ัะฟัะฐัะธะฒะฐะตั:**
> *"ะะพัั 22 ะพัะบััั ะฝะฐ 0.0.0.0:22. ะะพัั 3306 ะพัะบััั ะฝะฐ 127.0.0.1:3306. ะะฐะบะพะน ะฑะตะทะพะฟะฐัะฝะตะต?"*

<details>
<summary>๐ก ะัะฒะตั</summary>

**127.0.0.1:3306 (MySQL) ะฑะตะทะพะฟะฐัะฝะตะต!**

**ะะฐะทะฝะธัะฐ:**
```
0.0.0.0:22 (SSH)
  โ ะกะปััะฐะตั ะฝะฐ ะะกะะฅ ะธะฝัะตััะตะนัะฐั
  โ ะะพัััะฟะตะฝ ะธะทะฒะฝะต (ะธะท ะธะฝัะตัะฝะตัะฐ ะตัะปะธ ะฝะตั firewall)
  โ ะััะปะพะฒ ะผะพะถะตั ะฐัะฐะบะพะฒะฐัั SSH

127.0.0.1:3306 (MySQL)
  โ ะกะปััะฐะตั ัะพะปัะบะพ ะฝะฐ localhost
  โ ะะพัััะฟะตะฝ ัะพะปัะบะพ ะปะพะบะฐะปัะฝะพ (ั ัะฐะผะพะณะพ ัะตัะฒะตัะฐ)
  โ ะััะปะพะฒ ะะ ะผะพะถะตั ะฟะพะดะบะปััะธัััั ะธะทะฒะฝะต
```

**Best practice:**
- SSH (22): ะตัะปะธ ะฝัะถะตะฝ ัะดะฐะปัะฝะฝะพ โ ะธัะฟะพะปัะทัะน, ะฝะพ ั firewall + ะบะปััะฐะผะธ
- MySQL (3306): **ะฝะธะบะพะณะดะฐ** 0.0.0.0 โ ัะพะปัะบะพ 127.0.0.1
- HTTP/HTTPS (80/443): 0.0.0.0 OK (ะดะปั ะฒะตะฑ-ัะตัะฒะตัะฐ)

> **LILITH:**
> *"ะะฐะทะฐ ะดะฐะฝะฝัั ะฝะฐ 0.0.0.0 = ะฟัะธะณะปะฐัะตะฝะธะต ะััะปะพะฒั. SSH ะฝะฐ 0.0.0.0 = ัะธัะบะพะฒะฐะฝะฝะพ (firewall ะพะฑัะทะฐัะตะปะตะฝ). ะัะฐะฒะธะปะพ: ะพัะบััะฒะฐะน ะผะธะฝะธะผัะผ, ะทะฐัะธัะฐะน ะผะฐะบัะธะผัะผ."*

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 5:

- โ ะะพัั = ะบะฒะฐััะธัะฐ ะฒ ะทะดะฐะฝะธะธ (IP = ะทะดะฐะฝะธะต)
- โ Well-known ports: 0-1023 (SSH=22, HTTP=80, HTTPS=443)
- โ 0.0.0.0 = ะดะพัััะฟะตะฝ ะธะทะฒะฝะต, 127.0.0.1 = ัะพะปัะบะพ localhost
- โ LISTEN = ะฟะพัั ะพัะบััั ะธ ะถะดัั ัะพะตะดะธะฝะตะฝะธะน
- โ ะะพะผะฐะฝะดั: `ss -tuln`, `netstat -tuln`

> **LILITH:**
> *"ะฆะธะบะป 5 ะทะฐะฒะตัััะฝ. ะขั ะทะฝะฐะตัั ะบะฐะบะธะต ะดะฒะตัะธ ะพัะบัััั. ะกะปะตะดัััะธะน ััะพะฒะตะฝั โ ัะบะฐะฝะธัะพะฒะฐะฝะธะต. ะฃะทะฝะฐะตะผ ะบะฐะบะธะต ะดะฒะตัะธ ะพัะบัััั ั shadow-server-02. nmap โ ัะฒะตะนัะฐััะบะธะน ะฝะพะถ ัะฐะบะตัะฐ. ะะพะตัะฐะปะธ."*

---

## ๐ ะฆะะะ 6: ะกะบะฐะฝะธัะพะฒะฐะฝะธะต ะฟะพััะพะฒ (nmap) โ "ะะตัะตะบัะธะฒ ั ะปัะฟะพะน" (15 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (2 ะผะธะฝ)

ะะปะตะบั ะฟะพะฒะพัะฐัะธะฒะฐะตััั ะบ ะะฐะบัั:

> **ะะปะตะบั:**
> *"ะะฐะบั, ัะตะฟะตัั ะดัะผะฐะน ะบะฐะบ ะฐัะฐะบัััะธะน. ะัะพัะบะฐะฝะธััะน shadow-server-02. ะฃะทะฝะฐะน ะบะฐะบะธะต ะฟะพััั ะพัะบัััั. ะญัะพ ัะพ, ััะพ ะฒะธะดะธั ะััะปะพะฒ ะฟะตัะตะด ะฐัะฐะบะพะน."*

> **โ๏ธ ะะะะะ ะพั ะะธะบัะพัะฐ:**
> *"ะกะบะฐะฝะธัะพะฒะฐะฝะธะต ััะถะธั ัะตัะฒะตัะพะฒ ะฑะตะท ัะฐะทัะตัะตะฝะธั โ ะฝะตะทะฐะบะพะฝะฝะพ (ััะฐััั ะฃะ ะะค). ะั ัะบะฐะฝะธััะตะผ ะขะะะฌะะ ะฝะฐัะธ ัะตัะฒะตัั ะพะฟะตัะฐัะธะธ Viktor."*

> **LILITH:**
> *"nmap โ ะธะฝััััะผะตะฝั ะฐัะฐะบัััะตะณะพ. ะ ัะฒะพะน ะธะฝััััะผะตะฝั. ะะฐะทะฝะธัะฐ โ ัั ั ัะฐะทัะตัะตะฝะธะตะผ. ะััะปะพะฒ ะธัะฟะพะปัะทัะตั nmap ััะพะฑั ะฝะฐะนัะธ ััะทะฒะธะผะพััะธ. ะขั โ ััะพะฑั ะธั ะทะฐะบัััั."*

---

### ๐ ะขะตะพัะธั: nmap (Network Mapper) (6-7 ะผะธะฝ)

**nmap** โ ััะธะปะธัะฐ ะดะปั ัะบะฐะฝะธัะพะฒะฐะฝะธั ัะตัะตะน ะธ ะฟะพััะพะฒ.

#### **ะะตัะฐัะพัะฐ: nmap = ะะตัะตะบัะธะฒ ั ะปัะฟะพะน** ๐

ะะตัะตะบัะธะฒ ัะพะดะธั ะฟะพ ะทะดะฐะฝะธั (ัะตัะฒะตั):
- ะกัััะธััั ะฒ ะบะฐะถะดัั ะดะฒะตัั (ะฟะพัั)
- ะะฐะฟะธััะฒะฐะตั: ะพัะบัััะฐ, ะทะฐะบัััะฐ, ะทะฐะบะพะปะพัะตะฝะฐ
- ะกะฟัะฐัะธะฒะฐะตั ะบัะพ ะถะธะฒัั (ะฒะตััะธั ัะตัะฒะธัะฐ)
- ะะตะปะฐะตั ะทะฐะบะปััะตะฝะธะต (OS fingerprinting)

```
Detective nmap:
  ๐ช Port 22?   โ Open (SSH, OpenSSH 8.2)
  ๐ช Port 80?   โ Open (Apache 2.4.41)
  ๐ช Port 443?  โ Open (nginx 1.18)
  ๐ช Port 3306? โ Closed (ะฝะธะบัะพ ะฝะต ะพัะฒะตัะฐะตั)

Report: 3 open ports, Apache+nginx, likely Ubuntu 20.04
```

---

#### **ะขะธะฟั ัะบะฐะฝะธัะพะฒะฐะฝะธั:**

```bash
# 1. ะัะพััะพะต ัะบะฐะฝะธัะพะฒะฐะฝะธะต (TCP Connect)
nmap 10.50.1.100

# 2. TOP-100 ะฟะพััะพะฒ (ะฑััััะตะต)
nmap --top-ports 100 10.50.1.100

# 3. ะะตััะธะธ ัะตัะฒะธัะพะฒ
nmap -sV 10.50.1.100

# 4. ะะณัะตััะธะฒะฝะพะต (OS + ะฒะตััะธะธ + ัะบัะธะฟัั)
sudo nmap -A 10.50.1.100

# 5. ะะตะท ping (ะตัะปะธ firewall ะฑะปะพะบะธััะตั ICMP)
nmap -Pn 10.50.1.100
```

**ะัะฒะพะด:**
```
PORT     STATE  SERVICE  VERSION
22/tcp   open   ssh      OpenSSH 8.2
80/tcp   open   http     Apache 2.4.41
443/tcp  open   https    nginx 1.18
3306/tcp closed mysql
```

> **LILITH:**
> *"nmap ะฟะพะบะฐะทัะฒะฐะตั ััะพ ะฒะธะดะธั ะััะปะพะฒ ะฟะตัะตะด ะฐัะฐะบะพะน. ะัะบััััะต ะฟะพััั = attack surface. ะงะตะผ ะผะตะฝััะต ะพัะบัััะพ โ ัะตะผ ะฑะตะทะพะฟะฐัะฝะตะต."*

---

### ๐ป ะัะฐะบัะธะบะฐ: nmap ัะบะฐะฝะธัะพะฒะฐะฝะธะต (5-6 ะผะธะฝ)

#### **ะะฐะดะฐะฝะธะต 1: ะฃััะฐะฝะพะฒะธัั nmap (ะตัะปะธ ะฝะตั)**

```bash
sudo apt install nmap
```

#### **ะะฐะดะฐะฝะธะต 2: ะกะบะฐะฝะธัะพะฒะฐะฝะธะต localhost (ะฑะตะทะพะฟะฐัะฝะพ)**

```bash
# ะกะบะฐะฝะธัะพะฒะฐัั ัะตะฑั
nmap 127.0.0.1

# TOP-100 ะฟะพััะพะฒ
nmap --top-ports 100 127.0.0.1
```

#### **ะะฐะดะฐะฝะธะต 3: ะกะบะฐะฝะธัะพะฒะฐะฝะธะต shadow-server-02 (ัะธะผัะปััะธั)**

```bash
# ะัะปะธ ัะตัะฒะตั ัััะตััะฒัะตั
nmap --top-ports 100 10.50.1.100

# ะะฝะฐัะต โ ัะธะผัะปััะธั ะฒ ัะบัะธะฟัะต
```

<details>
<summary>โ ะะตัะตะฝะธะต: nmap ะฒ ัะบัะธะฟัะต</summary>

```bash
#!/bin/bash

scan_viktor_server() {
    local server_ip="$1"

    echo "ะกะบะฐะฝะธัะพะฒะฐะฝะธะต ะฟะพััะพะฒ shadow-server-02 ($server_ip):"

    if command -v nmap &>/dev/null; then
        echo "  (ะัะฟะพะปัะทัั nmap --top-ports 100)"
        timeout 30 nmap --top-ports 100 -T4 "$server_ip" 2>/dev/null | grep -E "^[0-9]+" || \
            echo "  (nmap ะฝะต ัะดะฐะปะพัั โ ัะธะผัะปััะธั)"
    else
        # ะกะธะผัะปััะธั
        echo "  (ะกะธะผัะปััะธั nmap)"
        echo ""
        echo "  PORT     STATE  SERVICE"
        echo "  22/tcp   open   ssh"
        echo "  80/tcp   open   http"
        echo "  443/tcp  open   https"
        echo ""
        echo "โ ะะฑะฝะฐััะถะตะฝะพ 3 ะพัะบััััั ะฟะพััะฐ"
    fi

    echo ""
    echo "Analysis:"
    echo "  โ SSH (22) โ OK (ะฝัะถะตะฝ ะดะปั ัะฟัะฐะฒะปะตะฝะธั)"
    echo "  โ HTTP (80) โ ะทะฐัะตะผ? ะะพะปะถะตะฝ ะฑััั ัะพะปัะบะพ HTTPS"
    echo "  โ HTTPS (443) โ OK (ะฒะตะฑ-ะธะฝัะตััะตะนั)"
}

scan_viktor_server "10.50.1.100"
```

</details>

---

### ๐ค ะัะพะฒะตัะบะฐ ะฟะพะฝะธะผะฐะฝะธั

**LILITH ัะฟัะฐัะธะฒะฐะตั:**
> *"nmap ะฟะพะบะฐะทะฐะป ะฟะพัั 8080 open (debug interface). ะญัะพ ะฟัะพะฑะปะตะผะฐ?"*

<details>
<summary>๐ก ะัะฒะตั</summary>

**ะะฐ, ัะตัััะทะฝะฐั ะฟัะพะฑะปะตะผะฐ!**

**ะะพัะตะผั ะพะฟะฐัะฝะพ:**
- ะะพัั 8080 ัะฐััะพ = debug/admin interface
- ะะพะถะตั ัะพะดะตัะถะฐัั:
  - ะะพะณะธ ั ะฟะฐัะพะปัะผะธ
  - ะะพะฝัะธะณััะฐัะธั
  - API ะฑะตะท ะฐััะตะฝัะธัะธะบะฐัะธะธ
  - ะะพะทะผะพะถะฝะพััั ะฒัะฟะพะปะฝะธัั ะบะพะด

**ะัะปะธ 8080 ะพัะบััั:**
```bash
# ะััะปะพะฒ:
curl http://10.50.1.100:8080/admin
# ะะธะดะธั admin ะฟะฐะฝะตะปั ะฑะตะท ะฟะฐัะพะปั
# ะะพะปััะฐะตั root ะดะพัััะฟ
```

**ะะตัะตะฝะธะต:**
1. **ะะฐะบัััั ะฟะพัั** (ะตัะปะธ ะฝะต ะฝัะถะตะฝ)
2. **Firewall:** ะะฐะทัะตัะธัั ัะพะปัะบะพ ั ะดะพะฒะตัะตะฝะฝัั IP
3. **ะััะตะฝัะธัะธะบะฐัะธั:** ะะพะฑะฐะฒะธัั ะฟะฐัะพะปั
4. **ะะตัะตะผะตััะธัั:** ะขะพะปัะบะพ 127.0.0.1:8080 (localhost)

> **LILITH:**
> *"ะะพัั 8080 = ะฟะพะดะฐัะพะบ ะััะปะพะฒั. Debug interfaces ะฝะธะบะพะณะดะฐ ะฝะต ะดะพะปะถะฝั ะฑััั ะดะพัััะฟะฝั ะธะทะฒะฝะต. Firewall ะธั. ะะปะธ ัะดะฐะปะธ. Episode 07 ะฟะพะบะฐะถะตั ะบะฐะบ."*

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 6:

- โ nmap = ัะบะฐะฝะธัะพะฒะฐะฝะธะต ะฟะพััะพะฒ ะธ ัะตัะฒะธัะพะฒ
- โ ะะพะบะฐะทัะฒะฐะตั "ะณะปะฐะทะฐะผะธ ะฐัะฐะบัััะตะณะพ"
- โ ะะพะผะฐะฝะดั: `nmap IP`, `nmap --top-ports 100 IP`
- โ โ๏ธ ะะต ัะบะฐะฝะธััะน ััะถะธะต ัะตัะฒะตัั ะฑะตะท ัะฐะทัะตัะตะฝะธั!
- โ ะัะบััััะต ะฟะพััั = attack surface (ะผะธะฝะธะผะธะทะธััะน!)

> **LILITH:**
> *"ะฆะธะบะป 6 ะทะฐะฒะตัััะฝ. ะขั ะฒะธะดะธัั ััะพ ะฒะธะดะธั ะััะปะพะฒ. ะกะปะตะดัััะธะน ััะพะฒะตะฝั โ ัะตะพัะธั. TCP/IP ะผะพะดะตะปั. 4 ัะปะพั ะธะฝัะตัะฝะตัะฐ. ะะพะฝะธะผะฐะฝะธะต ะผะพะดะตะปะธ = ะฟะพะฝะธะผะฐะฝะธะต ะฐัะฐะบ. ะะพะตัะฐะปะธ."*

---

## ๐ ะฆะะะ 7: TCP/IP Model โ "ะะพััะพะฒัะน ะบะพะฝะฒะตัั ะฒ ะบะพะฝะฒะตััะต" (15 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (2 ะผะธะฝ)

ะะธะบัะพั ัะธััะตั ะฝะฐ whiteboard 4 ัะปะพั:

> **ะะธะบัะพั:**
> *"ะะฐะบั, ััะฝะดะฐะผะตะฝัะฐะปัะฝะฐั ัะตะพัะธั. TCP/IP โ ะพัะฝะพะฒะฐ ะธะฝัะตัะฝะตัะฐ. 4 ัะปะพั. ะะฐะถะดัะน ัะปะพะน ัะตัะฐะตั ัะฒะพั ะทะฐะดะฐัั."*

ะะฝะฝะฐ:

> **ะะฝะฝะฐ:**
> *"ะะพะฝะธะผะฐะฝะธะต ะผะพะดะตะปะธ ะบัะธัะธัะฝะพ ะดะปั forensics. ะััะปะพะฒ ะฐัะฐะบัะตั ะฝะฐ ัะฐะทะฝัั ัะปะพัั. DDoS (Layer 3). DNS spoofing (Layer 7). ะัะถะฝะพ ะทะฝะฐัั ะณะดะต ะธัะบะฐัั."*

> **LILITH:**
> *"TCP/IP = ะฟะพััะพะฒัะน ะบะพะฝะฒะตัั ะฒ ะบะพะฝะฒะตััะต. ะะธััะผะพ โ ะบะพะฝะฒะตัั โ ะฝะฐ ะบะพะฝะฒะตััะต ะฐะดัะตั โ ะฟะพััะฐะปัะพะฝ ะฝะตััั. 4 ัะปะพั. ะะฐะถะดัะน ะดะพะฑะฐะฒะปัะตั ะธะฝัะพัะผะฐัะธั. ะญัะพ ัะธะปะพัะพัะธั ะธะฝัะตัะฝะตัะฐ."*

---

### ๐ ะขะตะพัะธั: TCP/IP 4 ะกะปะพั (7-9 ะผะธะฝ)

#### **ะะตัะฐัะพัะฐ: TCP/IP = ะะพััะพะฒัะน ะบะพะฝะฒะตัั** โ๏ธ

```
4. Application Layer
   โโโโโโโโโโโโโโโโโโโโโโโโ
   โ  [ะะธััะผะพ]            โ  โ HTTP data, ัะฒะพั ัะพะพะฑัะตะฝะธะต
   โโโโโโโโโโโโโโโโโโโโโโโโ

3. Transport Layer
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  [ะะธััะผะพ ะฒ ะบะพะฝะฒะตััะต]       โ  โ TCP header (ะบะฐะบ ะดะพััะฐะฒะธัั)
   โ  TCP: ะฝะฐะดัะถะฝะพ, ั ะฟะพะดัะฒะตัะถะดะตะฝะธะตะผ
   โ  UDP: ะฑััััะพ, ะฑะตะท ะณะฐัะฐะฝัะธะน
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

2. Internet Layer
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  [ะะฐ ะบะพะฝะฒะตััะต ะฐะดัะตั]                โ  โ IP header (ะบัะดะฐ)
   โ  From: 192.168.1.100                โ
   โ  To:   142.250.185.46               โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1. Link Layer
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  [ะะพััะฐะปัะพะฝ ะฝะตััั ัะธะทะธัะตัะบะธ]         โ  โ Ethernet, Wi-Fi
   โ  MAC ะฐะดัะตัะฐ, ะบะฐะฑะตะปะธ, ัะฐะดะธะพ ะฒะพะปะฝั     โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะะฐะถะดัะน ัะปะพะน ะดะพะฑะฐะฒะปัะตั header = ะบะพะฝะฒะตัั ะฒ ะบะพะฝะฒะตััะต!**

---

#### **ASCII Diagram: 4 Layers**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    TCP/IP MODEL (4 LAYERS)                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

LAYER 4: APPLICATION        ะงะขะ?
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
HTTP, HTTPS, SSH, FTP, DNS, SMTP
ะขะฒะพะธ ะดะฐะฝะฝัะต, ัะพะพะฑัะตะฝะธั, ัะฐะนะปั
ะัะธะผะตั: GET /index.html HTTP/1.1

                โ ะะพะฑะฐะฒะปัะตั TCP header โ

LAYER 3: TRANSPORT          ะะะ?
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
TCP (ะฝะฐะดัะถะฝัะน), UDP (ะฑัััััะน)
ะะพััั (22, 80, 443)
ะะพะฝััะพะปั ะพัะธะฑะพะบ, ะฟะพััะดะพะบ ะฟะฐะบะตัะพะฒ

                โ ะะพะฑะฐะฒะปัะตั IP header โ

LAYER 2: INTERNET           ะะฃะะ?
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
IP (ะฐะดัะตัะฐัะธั), ICMP (ะดะธะฐะณะฝะพััะธะบะฐ)
Source IP โ Destination IP
ะะฐัััััะธะทะฐัะธั ัะตัะตะท ัะพััะตัั

                โ ะะพะฑะฐะฒะปัะตั Ethernet header โ

LAYER 1: LINK               ะะะ?
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Ethernet, Wi-Fi, ะบะฐะฑะตะปะธ
MAC ะฐะดัะตัะฐ (ัะธะทะธัะตัะบะธะต)
ะะตัะตะดะฐัะฐ ะฑะธัะพะฒ ะฟะพ ะฟัะพะฒะพะดั/ัะฐะดะธะพ
```

> **LILITH:**
> *"4 ัะปะพั = separation of concerns. ะะฐะถะดัะน ัะปะพะน ะดะตะปะฐะตั ัะฒะพั ะดะตะปะพ. Application ะฝะต ะทะฝะฐะตั ะฟัะพ Ethernet. Ethernet ะฝะต ะทะฝะฐะตั ะฟัะพ HTTP. ะะพะดัะปัะฝะพััั = ะณะธะฑะบะพััั."*

---

#### **TCP vs UDP:**

| | TCP | UDP |
|---|-----|-----|
| **ะะฐะดัะถะฝะพััั** | ะะฐัะฐะฝัะธััะตั ะดะพััะฐะฒะบั | ะะพะถะตั ะฟะพัะตัััั ะฟะฐะบะตัั |
| **ะกะบะพัะพััั** | ะะตะดะปะตะฝะฝะตะต | ะััััะตะต |
| **Handshake** | 3-way (SYNโSYN-ACKโACK) | ะะตั |
| **ะัะฟะพะปัะทัะตััั** | HTTP, SSH, FTP | DNS, ะฒะธะดะตะพ, ะธะณัั |
| **ะะตัะฐัะพัะฐ** | ะะฐะบะฐะทะฝะพะต ะฟะธััะผะพ (ั ะฟะพะดัะฒะตัะถะดะตะฝะธะตะผ) | ะัะบัััะบะฐ (ะฑะตะท ะณะฐัะฐะฝัะธะน) |

**ะะพะณะดะฐ ััะพ:**
- **TCP:** ะะพะณะดะฐ ะฒะฐะถะฝะฐ ะฝะฐะดัะถะฝะพััั (ัะฐะนะปั, email, SSH)
- **UDP:** ะะพะณะดะฐ ะฒะฐะถะฝะฐ ัะบะพัะพััั (ะฒะธะดะตะพ ัััะธะผ, ะพะฝะปะฐะนะฝ ะธะณัั, DNS)

> **LILITH:**
> *"TCP = ะผะตะดะปะตะฝะฝะพ, ะฝะพ ะดะพััะฐะฒะธั. UDP = ะฑััััะพ, ะฝะพ ะผะพะถะตั ะฟะพัะตัััั. DNS ะธัะฟะพะปัะทัะตั UDP (ะฟะพัะตััะป ะพัะฒะตั? ะทะฐะฟัะพัะธ ัะฝะพะฒะฐ โ ะฑััััะพ). SSH ะธัะฟะพะปัะทัะตั TCP (ะฟะพัะตััะป ะฟะฐะบะตั? ะฒัั ัะตััะธั ัะปะพะผะฐะตััั)."*

---

### ๐ป ะัะฐะบัะธะบะฐ: ะะฟัะตะดะตะปะตะฝะธะต ัะปะพั (3-4 ะผะธะฝ)

#### **ะะฐะดะฐะฝะธะต: ะะฐะบะพะน ัะปะพะน?**

ะะฟัะตะดะตะปะธัะต ะฝะฐ ะบะฐะบะพะผ ัะปะพะต ัะฐะฑะพัะฐะตั ะบะฐะถะดัะน ะธะฝััััะผะตะฝั:

```
ping      โ Layer ?
ssh       โ Layer ?
ip a      โ Layer ?
nmap      โ Layer ?
traceroute โ Layer ?
```

<details>
<summary>๐ก ะัะฒะตั</summary>

```
ping       โ Layer 3 (ICMP = Internet Layer)
ssh        โ Layer 4 (SSH = Application Layer)
ip a       โ Layer 2 (IP addresses = Internet Layer)
nmap       โ Layers 3-4 (ัะบะฐะฝะธััะตั ะฟะพััั TCP/UDP)
traceroute โ Layer 3 (ICMP Time Exceeded)
```

**ะะปััะตะฒะพะน ะฒัะฒะพะด:**
- ะะฝััััะผะตะฝัั ัะฐะฑะพัะฐัั ะฝะฐ ัะฐะทะฝัั ัะปะพัั
- ะัะฐะบะธ ัะพะถะต ะฝะฐ ัะฐะทะฝัั ัะปะพัั:
  - DDoS โ Layer 3 (IP flood)
  - Port scan โ Layer 4 (TCP SYN flood)
  - DNS spoofing โ Layer 7 (Application)

> **LILITH:**
> *"ะะพะฝะธะผะฐะฝะธะต ัะปะพัะฒ = ะฟะพะฝะธะผะฐะฝะธะต ะณะดะต ะธัะบะฐัั ะฟัะพะฑะปะตะผั. Ping ะฝะต ัะฐะฑะพัะฐะตั? Layer 3 (ัะตัั). SSH ะฝะต ัะฐะฑะพัะฐะตั, ะฝะพ ping OK? Layer 7 (ะฟัะธะปะพะถะตะฝะธะต). ะะพัะปะพะนะฝะฐั ะดะธะฐะณะฝะพััะธะบะฐ."*

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 7:

- โ TCP/IP = 4 ัะปะพั (Application, Transport, Internet, Link)
- โ ะะฐะถะดัะน ัะปะพะน ะดะพะฑะฐะฒะปัะตั header (ะบะพะฝะฒะตัั ะฒ ะบะพะฝะฒะตััะต)
- โ TCP = ะฝะฐะดัะถะฝัะน, UDP = ะฑัััััะน
- โ ะะธะฐะณะฝะพััะธะบะฐ = ะฟะพัะปะพะนะฝะฐั (pingโLayer3, sshโLayer7)

> **LILITH:**
> *"ะฆะธะบะป 7 ะทะฐะฒะตัััะฝ. ะขะตะพัะธั ะพัะฒะพะตะฝะฐ. ะัะฐะบัะธะบะฐ ะฒะฟะตัะตะดะธ. ะกะปะตะดัััะธะน ัะธะบะป โ ัะธะฝะฐะป. ะกะพะฑะตัะธ ะฒัั ะฒ ะพะดะธะฝ bash ัะบัะธะฟั. Network Audit. ะะฒัะพะผะฐัะธะทะฐัะธั โ ัะธะปะฐ ะฐะดะผะธะฝะธัััะฐัะพัะฐ. ะะพะตัะฐะปะธ."*

---

## ๐ ะฆะะะ 8: Network Audit Script โ "ะะฒัะพะผะฐัะธะทะฐัะธั workflow" (30-40 ะผะธะฝัั)

### ๐ฌ ะกัะถะตั (3 ะผะธะฝ)

ะะธะบัะพั ัะผะพััะธั ะฝะฐ ัะฐัั โ 17:00. ะัะพัะปะพ 3 ัะฐัะฐ ั ะฝะฐัะฐะปะฐ ะผะธััะธะธ.

> **ะะธะบัะพั:**
> *"ะะฐะบั, ัะพะฑะตัะธ ะฒัั ะฒ ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝัะน ะพัััั. Network audit ัะบัะธะฟั. IP, ping, DNS, traceroute, ะฟะพััั, nmap, routing. ะัั ะฒ ะพะดะฝะพะผ ะผะตััะต."*

ะะปะตะบั:

> **ะะปะตะบั:**
> *"ะญัะพั ัะบัะธะฟั ะฑัะดะตัั ะทะฐะฟััะบะฐัั ะฝะฐ ะฒัะตั 50 ัะตัะฒะตัะฐั. ะะฒัะพะผะฐัะธะทะฐัะธั = ะผะฐัััะฐะฑะธััะตะผะพััั. ะัััะฝัั 50 ัะฐะท โ ะฝะตัะตะฐะปัะฝะพ."*

ะะฝะฝะฐ:

> **ะะฝะฝะฐ:**
> *"ะ ะปะพะณะธััะน ะฒัั. ะัะปะธ ะััะปะพะฒ ะฐัะฐะบัะตั ะทะฐะฒััะฐ โ ั ะฝะฐั ะฑัะดะตั baseline ะดะปั ััะฐะฒะฝะตะฝะธั. Forensics 101."*

> **LILITH:**
> *"Bash ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ, ะะ ะทะฐะผะตะฝั ะธะฝััััะผะตะฝัะพะฒ. ะะพะผะฝะธัั Episode 04? apt exists โ use it. ะะดะตัั ัะพ ะถะต: ะธัะฟะพะปัะทัะน ip, ping, nmap. Bash ะธั ะบะพะผะฑะธะฝะธััะตั. ะญัะพ Type A ะฟะพะดัะพะด โ ะฟัะฐะฒะธะปัะฝัะน ะดะปั network audit."*

---

### ๐ ะขะตะพัะธั: Bash Automation Philosophy (5 ะผะธะฝ)

#### **Type A vs Type B โ Why Episode 05 is Type A**

**ะะพะฟัะพั:** ะะพัะตะผั Episode 04 = Type B (no bash wrapper), ะฝะพ Episode 05 = Type A (bash script OK)?

**ะัะฒะตั:**

| Episode | ะขะธะฟ | ะะพัะตะผั |
|---------|-----|--------|
| **Episode 04** | Type B | apt ัะถะต ะฐะฒัะพะผะฐัะธะทะธััะตั ัััะฐะฝะพะฒะบั ะฟะฐะบะตัะพะฒ. Bash wrapper = ะฟะตัะตะฟะธััะฒะฐะฝะธะต apt (ะฟะปะพัะพ) |
| **Episode 05** | Type A | Network audit ััะตะฑัะตั ะบะพะผะฑะธะฝะธัะพะฒะฐะฝะธั ัะฐะทะฝัั ะบะพะผะฐะฝะด (ip, ping, ss, nmap). Bash ัะบัะธะฟั = workflow automation (ัะพัะพัะพ) |

> **LILITH:**
> *"Bash = ะบะปะตะน ะผะตะถะดั ะธะฝััััะผะตะฝัะฐะผะธ. ะะ ะทะฐะผะตะฝัะตั ะธะฝััััะผะตะฝัั. Episode 05: bash ะบะพะผะฑะธะฝะธััะตั ip, ping, nmap โ audit report. Episode 04: apt ัะถะต ะดะตะปะฐะตั ะฒัั โ bash wrapper ะฝะต ะฝัะถะตะฝ. ะะฐะทะฝะธัะฐ."*

---

#### **ะงัะพ ะฐะฒัะพะผะฐัะธะทะธััะตั ะฝะฐั ัะบัะธะฟั:**

```bash
#!/bin/bash
# network_audit.sh

# 1. get_workstation_ip()      โ ะธะท ะฆะธะบะปะฐ 1
# 2. get_viktor_server_ip()    โ ะธะท ะฆะธะบะปะฐ 3
# 3. backup_hosts()            โ ะธะท ะฆะธะบะปะฐ 3 (NEW!)
# 4. check_availability()      โ ะธะท ะฆะธะบะปะฐ 2
# 5. capture_ping_packets()    โ ะธะท ะฆะธะบะปะฐ 2 (tcpdump, NEW!)
# 6. simulate_traceroute()     โ ะธะท ะฆะธะบะปะฐ 4
# 7. check_local_ports()       โ ะธะท ะฆะธะบะปะฐ 5
# 8. scan_viktor_server()      โ ะธะท ะฆะธะบะปะฐ 6
# 9. show_routing_table()      โ ะธะท ะฆะธะบะปะฐ 4
# 10. generate_report()        โ ัะธะฝะฐะป, ะธะฝัะตะณัะธััะตั ะฒัั
```

**10 ััะฝะบัะธะน** = ะธะฝัะตะณัะฐัะธั 7 ัะธะบะปะพะฒ ะพะฑััะตะฝะธั.

---

### ๐ป ะัะฐะบัะธะบะฐ: ะกะพะทะดะฐะฝะธะต network_audit.sh (25-35 ะผะธะฝ)

#### **ะจะฐะณ 1: ะะฐัะฐัั ั starter.sh**

```bash
cd ~/kernel-shadows/season-2-networking/episode-05-tcp-ip-fundamentals

# ะกะบะพะฟะธัะพะฒะฐัั ัะฐะฑะปะพะฝ
cp starter.sh network_audit.sh
chmod +x network_audit.sh

# ะะตะดะฐะบัะธัะพะฒะฐัั
nano network_audit.sh
```

#### **ะจะฐะณ 2: ะกัััะบัััะฐ ัะบัะธะฟัะฐ**

```bash
#!/bin/bash
set -e  # Exit on error

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

###############################################################################
# 10 ะคะฃะะะฆะะ (ะธะท 7 ัะธะบะปะพะฒ)
###############################################################################

# ... (ะฒะฐัะธ ััะฝะบัะธะธ ะทะดะตัั)

###############################################################################
# MAIN FUNCTION
###############################################################################

main() {
    echo "Network Audit ะฝะฐัะฐั..."

    # 1. Workstation IP
    WORKSTATION_IP=$(get_workstation_ip)

    # 2. Viktor Server IP
    VIKTOR_IP=$(get_viktor_server_ip)

    # 3. Backup /etc/hosts
    backup_hosts

    # 4-9. ะััะฐะปัะฝัะต ััะฝะบัะธะธ
    # ...

    # 10. Generate report
    generate_report "$WORKSTATION_IP" "$VIKTOR_IP"

    echo "โ ะัะดะธั ะทะฐะฒะตัััะฝ!"
}

main "$@"
```

---

#### **ะจะฐะณ 3: ะะฝัะตะณัะฐัะธั ััะฝะบัะธะน**

**ะะพะทัะผะธัะต ะบะพะด ะธะท ัะตัะตะฝะธะน ะฆะธะบะปะพะฒ 1-7 ะธ ัะพะตะดะธะฝะธัะต ะฒ ะพะดะธะฝ ัะบัะธะฟั.**

<details>
<summary>๐ก ะะพะดัะบะฐะทะบะฐ: ะะตัะตัะตะฝัะฝะพะต ัะตัะตะฝะธะต</summary>

**ะกะผะพััะธัะต:**
```bash
cat solution/network_audit.sh
```

**ะะปะธ ะทะฐะฟัััะธัะต:**
```bash
./solution/network_audit.sh
```

**ะะปััะตะฒัะต ะผะพะผะตะฝัั:**
- 10 ััะฝะบัะธะน (ะบะฐะถะดะฐั ะธะท ัะฒะพะตะณะพ ัะธะบะปะฐ)
- Graceful failure (ะตัะปะธ ะบะพะผะฐะฝะดะฐ ะฝะต ะฝะฐะนะดะตะฝะฐ โ fallback)
- ะัะฐัะธะฒัะน ะฒัะฒะพะด (ัะฒะตัะฐ, ัะพัะผะฐัะธัะพะฒะฐะฝะธะต)
- ะะตัะฐะปัะฝัะน ะพัััั (`artifacts/network_report.txt`)

</details>

---

### ๐ฏ ะขัะตะฑะพะฒะฐะฝะธั ะบ ัะบัะธะฟัั:

- โ **Shebang:** `#!/bin/bash`
- โ **Error handling:** ะัะพะฒะตัะบะฐ ะบะพะผะฐะฝะด, fallback'ั
- โ **ะคัะฝะบัะธะธ:** 10 ััะฝะบัะธะน (ะผะพะดัะปัะฝะพััั)
- โ **ะะฐะฒััะบะธ:** `"$variable"` ะฒัะตะณะดะฐ
- โ **ะะพะผะผะตะฝัะฐัะธะธ:** ะะฑัััะฝััั ะปะพะณะธะบั
- โ **ะััะตัะฐะบัั:** `hosts.backup`, `ping_capture.pcap`, `network_report.txt`
- โ **Permissions:** `chmod +x network_audit.sh`

---

### ๐ค ะคะธะฝะฐะปัะฝัะน ะฒะพะฟัะพั (ะฟัะพะฒะตัะบะฐ Type A ะฟะพะฝะธะผะฐะฝะธั)

**LILITH ัะฟัะฐัะธะฒะฐะตั:**

> *"ะะพัะตะผั Episode 05 = Type A (bash script OK), ะฐ Episode 04 = Type B (no bash wrapper)? ะ ััะผ ัะฐะทะฝะธัะฐ ัะธะปะพัะพัะธะธ?"*

<details>
<summary>๐ก ะัะฒะตั</summary>

**ะะปััะตะฒะฐั ัะฐะทะฝะธัะฐ: ะฟะตัะตะฟะธััะฒะฐะฝะธะต vs ะบะพะผะฑะธะฝะธัะพะฒะฐะฝะธะต**

**Episode 04 (Type B):**
```bash
# โ ะะปะพัะพ (ะฑัะปะพ "ะดะพ ัะตัะฐะบัะพัะธะฝะณะฐ"):
# Bash wrapper ะฟะตัะตะฟะธััะฒะฐะตั apt:
./install_toolkit.sh
  โโ check_dependencies() # apt ัะถะต ะดะตะปะฐะตั ััะพ!
  โโ install_package()    # apt install ัะถะต ะตััั!
  โโ verify_install()     # dpkg -l ัะถะต ะดะตะปะฐะตั ััะพ!

# โ ะฅะพัะพัะพ (ะฟะพัะปะต ัะตัะฐะบัะพัะธะฝะณะฐ):
# ะัะฟะพะปัะทัะน apt ะฝะฐะฟััะผัั:
apt install nmap tcpdump wireshark
```

**Episode 05 (Type A):**
```bash
# โ ะฅะพัะพัะพ:
# Bash ะบะพะผะฑะธะฝะธััะตั ัะฐะทะฝัะต ะธะฝััััะผะตะฝัั:
./network_audit.sh
  โโ ip a              # ะะตั ะพะดะฝะพะณะพ ะธะฝััััะผะตะฝัะฐ ะดะปั network audit
  โโ ping              # ะัะถะฝะพ ะบะพะผะฑะธะฝะธัะพะฒะฐัั ะบะพะผะฐะฝะดั
  โโ ss -tuln          # Bash = ะบะปะตะน ะผะตะถะดั ะฝะธะผะธ
  โโ nmap              # ะะตะฝะตัะธััะตั unified ะพัััั
  โโ generate_report   # Bash automation appropriate
```

**ะคะธะปะพัะพัะธั:**

| ะกะธััะฐัะธั | ะะพะดัะพะด | ะัะธะผะตั |
|----------|--------|--------|
| **ะะฝััััะผะตะฝั ัััะตััะฒัะตั** | Type B: ะธัะฟะพะปัะทัะน ะตะณะพ | apt, systemd, cron |
| **ะัะถะฝะฐ ะบะพะผะฑะธะฝะฐัะธั** | Type A: bash automation | network audit, log parsing, monitoring |

**ะัะฐะฒะธะปะพ:**
> **"ะะฒัะพะผะฐัะธะทะธััะน workflow, ะฝะต ะฟะตัะตะฟะธััะฒะฐะน ะธะฝััััะผะตะฝัั"**

> **LILITH:**
> *"Episode 04: apt exists ะดะปั package management โ bash wrapper = ะฟะปะพัะพ. Episode 05: ะฝะตั ะพะดะฝะพะณะพ ะธะฝััััะผะตะฝัะฐ ะดะปั network audit โ bash ะบะพะผะฑะธะฝะธััะตั tools = ัะพัะพัะพ. Type A vs Type B = ะบะพะฝัะตะบัั, ะฝะต ะดะพะณะผะฐ."*

</details>

---

### ๐ฏ ะงัะพ ัะทะฝะฐะปะธ ะฒ ะฆะธะบะปะต 8:

- โ Bash automation ะฟะพะดัะพะดะธั ะบะพะณะดะฐ ะฝัะถะฝะฐ ะบะพะผะฑะธะฝะฐัะธั ะธะฝััััะผะตะฝัะพะฒ
- โ Type A (automation) vs Type B (use tools) = ะบะพะฝัะตะบัั
- โ 10 ััะฝะบัะธะน ะธะท 7 ัะธะบะปะพะฒ โ unified script
- โ Artifacts: hosts.backup, ping_capture.pcap, network_report.txt
- โ Graceful failure, error handling, ะผะพะดัะปัะฝะพััั

---

## ๐ ะะตะฝั 9 (18:00): ะะตะทัะปััะฐัั ะผะธััะธะธ

### ะฆะะ "ะะพัะบะฒะฐ-1" โ ะะฐะฒะตััะตะฝะธะต

ะะฐะบั ะทะฐะฒะตััะฐะตั ัะบัะธะฟั. ะะพัะปะตะดะฝัั ัััะพะบะฐ ะบะพะดะฐ. `./network_audit.sh` โ Enter.

ะญะบัะฐะฝ ะฒัะฒะพะดะธั ะพัััั. ะะพะผะฐะฝะดะฐ ัะพะฑะธัะฐะตััั ะฒะพะบััะณ ะผะพะฝะธัะพัะพะฒ.

> **ะะธะบัะพั:**
> *"ะัะปะธัะฝะพ, ะะฐะบั. ะขั ะฟะพะฝัะป ะพัะฝะพะฒั. ะขะตะฟะตัั ะผั ะทะฝะฐะตะผ ะฝะฐัั ัะตัั."*

> **ะะฝะฝะฐ:**
> *"Baseline ัะพะทะดะฐะฝ. ะัะปะธ ะััะปะพะฒ ะฐัะฐะบัะตั ะทะฐะฒััะฐ โ ัะฒะธะดะธะผ ะธะทะผะตะฝะตะฝะธั. Forensics ะณะพัะพะฒะฐ."*

> **ะะผะธััะธะน:**
> *"ะกะบัะธะฟั ัะถะต ะทะฐะดะตะฟะปะพะธะป ะฝะฐ 15 ัะตัะฒะตัะพะฒ. ะะฒัะพะผะฐัะธัะตัะบะธะน audit ะบะฐะถะดัะน ัะฐั. ะัะฐัะพัะฐ!"*

ะะปะตะบั ะฟะพะดัะพะดะธั ะบ ะะฐะบัั:

> **ะะปะตะบั:**
> *"ะะตะฟะปะพัะพ, ะะฐะบั. TCP/IP ะพัะฒะพะธะป. ะะพ ััะพ ัะพะปัะบะพ ะฝะฐัะฐะปะพ. ะััะปะพะฒ ะฐัะฐะบัะตั ัะตัะตะท DNS. ะกะปะตะดัััะธะน ัะฟะธะทะพะด โ DNS & Name Resolution. ะัะถะฝะพ ะฟะพะฝััั ะบะฐะบ ะพะฝ ะฟะพะดะผะตะฝัะตั ะพัะฒะตัั."*

Max: *"DNS spoofing... Cycle 3 ัะฟะพะผะธะฝะฐะป. ะะพัะพะฒ."*

> **ะะธะบัะพั:**
> *"ะะฐะฒััะฐ ะปะตัะธัั ะฒ ะกัะพะบะณะพะปัะผ. Erik Johansson ะฒัััะตัะธั. Bahnhof Pionen datacenter โ ัะดะตัะฝัะน ะฑัะฝะบะตั. ะขะฐะผ ะฑะตะทะพะฟะฐัะฝะตะต ัะตะผ ะทะดะตัั."*

Max: *"ะกัะพะบะณะพะปัะผ? ะฏ ะฝะธ ัะฐะทั ะฝะต ะฑัะป ะทะฐ ะณัะฐะฝะธัะตะน..."*

> **ะะธะบัะพั:**
> *"ะัะดะตัั. ะะธะปะตั ะฝะฐ ัััะตะฝะฝะธะน ัะตะนั. ะะฟะตัะฐัะธั global, Max. ะัะธะฒัะบะฐะน."*

> **LILITH (ัะบัะฐะฝ ะผะธะณะฐะตั):**
> ```
> โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
> โ  ะะะกะกะะฏ ะะะะะะจะะะ โ                                          โ
> โ                                                               โ
> โ  TCP/IP Fundamentals โ ะพัะฒะพะตะฝะพ                               โ
> โ  Network Audit โ ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝ                             โ
> โ                                                               โ
> โ  ะะพะฒะพัะธะฑะธััะบ ะฑัะป ัะฐะทะผะธะฝะบะพะน.                                   โ
> โ  ะะพัะบะฒะฐ โ ะฟะตัะฒัะน ะฑะพะน.                                         โ
> โ  ะกัะพะบะณะพะปัะผ โ ัะปะตะดัััะธะน ััะพะฒะตะฝั.                               โ
> โ                                                               โ
> โ  ะะฐะถะดัะน ะฟะฐะบะตั ัะฐััะบะฐะทัะฒะฐะตั ะธััะพัะธั.                          โ
> โ  ะขั ะฝะฐััะธะปัั ัะปััะฐัั.                                         โ
> โ                                                               โ
> โ  Next: Episode 06 โ DNS & Name Resolution                    โ
> โ  Location: Stockholm, Sweden ๐ธ๐ช                             โ
> โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
> ```

---

## ๐ ะงัะพ ะฒั ะธะทััะธะปะธ

### ะะพะผะฐะฝะดั (ะฟัะฐะบัะธะบะฐ):
- โ `ip a` โ IP ะฐะดัะตั
- โ `ping -c 4` โ ะฟัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ
- โ `tcpdump -i any icmp` โ ะทะฐัะฒะฐั ะฟะฐะบะตัะพะฒ
- โ `host`, `dig`, `nslookup` โ DNS lookup
- โ `tracepath`, `traceroute` โ ะผะฐััััั
- โ `ss -tuln`, `netstat -tuln` โ ะพัะบััััะต ะฟะพััั
- โ `nmap --top-ports 100` โ ัะบะฐะฝะธัะพะฒะฐะฝะธะต
- โ `ip route` โ ัะฐะฑะปะธัะฐ ะผะฐัััััะธะทะฐัะธะธ

### ะะพะฝัะธะณััะฐัะธะพะฝะฝัะต ัะฐะนะปั:
- โ `/etc/hosts` โ ะปะพะบะฐะปัะฝัะน DNS (ะฟัะธะพัะธัะตั!)
- โ `/etc/resolv.conf` โ DNS ัะตัะฒะตัั

### ะะพะฝัะตะฟัะธะธ (ัะตะพัะธั):
- โ TCP/IP ะผะพะดะตะปั (4 ัะปะพั)
- โ IP ะฐะดัะตัะฐ (IPv4, private vs public, loopback)
- โ DNS (ัะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ ะธะฝัะตัะฝะตัะฐ)
- โ DNS spoofing (ะฐัะฐะบะฐ ะััะปะพะฒะฐ)
- โ ICMP (ping, traceroute)
- โ ะะพััั (22=SSH, 80=HTTP, 443=HTTPS)
- โ TCP vs UDP (ะฝะฐะดัะถะฝัะน vs ะฑัััััะน)
- โ Routing (default gateway, routing table)
- โ nmap (ัะบะฐะฝะธัะพะฒะฐะฝะธะต ะฟะพััะพะฒ)
- โ Type A vs Type B automation philosophy

### ะะฐะฒัะบะธ (ัะผะตะฝะธั):
- โ ะะธะฐะณะฝะพััะธะบะฐ ัะตัะธ (ping, traceroute)
- โ ะัะดะธั ะฑะตะทะพะฟะฐัะฝะพััะธ (ะพัะบััััะต ะฟะพััั, nmap)
- โ DNS configuration (/etc/hosts, resolv.conf)
- โ Network mapping (IP, routes, services)
- โ Bash automation (network_audit.sh)
- โ Packet capture (tcpdump basics)

### Security (ะฒะฐะถะฝะพ):
- โ DNS spoofing ะทะฐัะธัะฐ (DNSSEC, Episode 06)
- โ HTTPS ะพะฑัะทะฐัะตะปะตะฝ (ะทะฐัะธัะฐ ะพั MITM)
- โ tcpdump ะฒะธะดะธั ะฒัั ะฝะตะทะฐัะธััะพะฒะฐะฝะฝะพะต
- โ 0.0.0.0 vs 127.0.0.1 (ะฑะตะทะพะฟะฐัะฝะพััั ะฟะพััะพะฒ)
- โ ะะธะฝะธะผะธะทะฐัะธั attack surface (ะทะฐะบัััั ะฝะตะฝัะถะฝัะต ะฟะพััั)

---

## ๐ ะกะฐะผะพะฟัะพะฒะตัะบะฐ

ะัะฒะตัั ะฝะฐ ััะธ ะฒะพะฟัะพัั ะฑะตะท ะฟะพะดะณะปัะดัะฒะฐะฝะธั:

1. **ะงัะพ ัะฐะบะพะต IP ะฐะดัะตั ะธ ะทะฐัะตะผ ะพะฝ ะฝัะถะตะฝ?**
2. **ะ ััะผ ัะฐะทะฝะธัะฐ ะผะตะถะดั TCP ะธ UDP?**
3. **ะงัะพ ะฟะพะบะฐะทัะฒะฐะตั ะบะพะผะฐะฝะดะฐ `ss -tuln`?**
4. **ะะฐัะตะผ ะฝัะถะตะฝ traceroute?**
5. **ะงัะพ ัะฐะบะพะต default gateway?**
6. **ะะฐะบะธะต ะฟะพััั ััะธัะฐัััั well-known?**
7. **ะงัะพ ะพะทะฝะฐัะฐะตั 127.0.0.1?**
8. **ะะพัะตะผั `/etc/hosts` ะธะผะตะตั ะฟัะธะพัะธัะตั ะฝะฐะด DNS?**
9. **ะ ััะผ ะพะฟะฐัะฝะพััั ะพัะบััััั ะฟะพััะพะฒ?**
10. **ะะพัะตะผั Episode 05 = Type A, ะฐ Episode 04 = Type B?**

<details>
<summary>โ ะัะฒะตัั</summary>

1. IP ะฐะดัะตั โ ัะฝะธะบะฐะปัะฝัะน ะธะดะตะฝัะธัะธะบะฐัะพั ััััะพะนััะฒะฐ ะฒ ัะตัะธ (ะบะฐะบ ะฐะดัะตั ะดะพะผะฐ)
2. TCP โ ะฝะฐะดัะถะฝัะน, connection-oriented; UDP โ ะฑัััััะน, connectionless
3. ะัะต TCP/UDP ัะปััะฐััะธะต ะฟะพััั ะฒ ัะธัะปะพะฒะพะผ ัะพัะผะฐัะต
4. ะะพะบะฐะทัะฒะฐะตั ะผะฐััััั (ัะตัะตะท ะบะฐะบะธะต ัะพััะตัั) ะดะพ ัะตะปะตะฒะพะณะพ ัะพััะฐ
5. ะะพััะตั, ัะตัะตะท ะบะพัะพััะน ะธะดัั ะฒะตัั ััะฐัะธะบ ะฟะพ ัะผะพะปัะฐะฝะธั
6. ะะพััั 0-1023 (SSH=22, HTTP=80, HTTPS=443)
7. Loopback ะฐะดัะตั (localhost) โ ะบะพะผะฟัััะตั ะพะฑัะฐัะฐะตััั ะบ ัะฐะผะพะผั ัะตะฑะต
8. Linux ะฟัะพะฒะตััะตั /etc/hosts ะะะะะซะ ะฟะตัะตะด DNS ะทะฐะฟัะพัะพะผ (ะฟัะธะพัะธัะตั ะปะพะบะฐะปัะฝะพะณะพ)
9. ะะฐะถะดัะน ะพัะบััััะน ะฟะพัั = ะฟะพัะตะฝัะธะฐะปัะฝะฐั ัะพัะบะฐ ะฒัะพะดะฐ ะดะปั ะฐัะฐะบะธ
10. Episode 04: apt exists (Type B = use tool). Episode 05: network audit ะฝัะถะฝะฐ ะบะพะผะฑะธะฝะฐัะธั ะบะพะผะฐะฝะด (Type A = bash automation OK)

</details>

---

## ๐ง ะัะพะฒะตัะบะฐ ะฒัะฟะพะปะฝะตะฝะธั

ะะฐะฟัััะธ ะฐะฒัะพัะตัั:

```bash
cd ~/kernel-shadows/season-2-networking/episode-05-tcp-ip-fundamentals
./tests/test.sh
```

ะขะตััั ะฟัะพะฒะตััั:
- โ ะกะพะทะดะฐะฝ ะปะธ ัะบัะธะฟั `network_audit.sh`
- โ ะัะฟะพะปะฝัะตะผัะน ะปะธ ะพะฝ (`chmod +x`)
- โ ะัะฟะพะปัะทัะตั ะปะธ ะบะพะผะฐะฝะดั `ip`, `ping`, `ss`/`netstat`
- โ ะะตะฝะตัะธััะตั ะปะธ ะพัััั `artifacts/network_report.txt`
- โ ะะพััะตะบัะฝะพััั ัะพัะผะฐัะฐ ะพััััะฐ

---

## ๐ฏ ะกะปะตะดัััะธะน ัะฟะธะทะพะด

**Episode 06: DNS & Name Resolution**

**ะะพะบะฐัะธั:** ๐ธ๐ช ะกัะพะบะณะพะปัะผ, ะจะฒะตัะธั (Bahnhof Pionen Datacenter โ ัะดะตัะฝัะน ะฑัะฝะบะตั 30ะผ ะฟะพะด ะทะตะผะปัะน)

**ะะตััะพะฝะฐะถะธ:** Erik Johansson (network engineer), Katarina Lindstrรถm (cryptography expert)

**ะะธััะธั:** ะะพะฝััั ะบะฐะบ ัะฐะฑะพัะฐะตั DNS. ะะฐัััะพะธัั DNS ะดะปั ัะบัััะธั ะธะฝััะฐััััะบัััั. ะะฑะฝะฐััะถะธัั ะธ ะทะฐะฑะปะพะบะธัะพะฒะฐัั DNS spoofing ะฐัะฐะบั ะพั ะััะปะพะฒะฐ.

**ะงัะพ ะธะทััะธะผ:**
- ะะตัะฐะปัะฝัะน DNS (A, AAAA, CNAME, MX, TXT ะทะฐะฟะธัะธ)
- dig, nslookup ะดะตัะฐะปัะฝะพ
- DNS cache poisoning (ะฐัะฐะบะฐ ะััะปะพะฒะฐ)
- DNSSEC (ะทะฐัะธัะฐ ะพั spoofing)
- DNS over TLS (ัะธััะพะฒะฐะฝะธะต DNS)

> **LILITH:**
> *"TCP/IP ัั ะพัะฒะพะธะป. ะะพ ะฟะฐะบะตัั ะฑะตัะฟะพะปะตะทะฝั ะตัะปะธ ัั ะฝะต ะทะฝะฐะตัั ะบัะดะฐ ะธั ะพัะฟัะฐะฒะปััั. DNS โ ัะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ ะธะฝัะตัะฝะตัะฐ. ะััะปะพะฒ ััะพ ะทะฝะฐะตั. ะ ัะบัะฟะปัะฐัะธััะตั. ะกะปะตะดัััะฐั ะพััะฐะฝะพะฒะบะฐ โ ะกัะพะบะณะพะปัะผ. ะฅะพะปะพะดะฝัะน, ัะตะฒะตัะฝัะน, ะฟะฐัะฐะฝะพะธะดะฐะปัะฝัะน. ะะฐะบ ัะฐะท ะดะปั ะฝะฐั."*

---

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะผะฐัะตัะธะฐะปั

### Man Pages
```bash
man ip
man ping
man traceroute
man netstat
man ss
man nmap
man tcpdump
```

### ะะพะปะตะทะฝัะต ัะตััััั
- [IPvFoo](https://github.com/pmarks-net/ipvfoo) โ IPv4/IPv6 ะธะฝะดะธะบะฐัะพั ะดะปั ะฑัะฐัะทะตัะฐ
- [IPInfo.io](https://ipinfo.io/) โ ะธะฝัะพัะผะฐัะธั ะพะฑ IP ะฐะดัะตัะฐั
- [Wireshark](https://www.wireshark.org/) โ ะฐะฝะฐะปะธะท ัะตัะตะฒะพะณะพ ััะฐัะธะบะฐ (GUI)
- [TCP/IP Illustrated](https://en.wikipedia.org/wiki/TCP/IP_Illustrated) โ ะบะปะฐััะธัะตัะบะฐั ะบะฝะธะณะฐ

### ะัะฐะบัะธะบะฐ
- ะัะพัะบะฐะฝะธััะน ัะฒะพั ะดะพะผะฐัะฝัั ัะตัั: `nmap 192.168.1.0/24` (ัะพะปัะบะพ ัะฒะพั!)
- ะะฐะนะดะธ ัะฒะพะน ะฟัะฑะปะธัะฝัะน IP: `curl ifconfig.me`
- ะัะพะฒะตัั traceroute ะดะพ ะปัะฑะธะผะพะณะพ ัะฐะนัะฐ
- ะะทััะธ Wireshark (GUI ะดะปั ะฐะฝะฐะปะธะทะฐ ะฟะฐะบะตัะพะฒ)
- ะัะพะฒะตัั /etc/hosts ัะตะณัะปััะฝะพ (security!)

### ะะฐัััะพะนะบะฐ lab ััะตะดั
ะะปั ะณะปัะฑะพะบะพะน ะฟัะฐะบัะธะบะธ ะผะพะถะตัั ะฝะฐัััะพะธัั ะฒะธัััะฐะปัะฝัั ัะตัั:
```bash
# VirtualBox + ะฝะตัะบะพะปัะบะพ Ubuntu VM
# ะะฐัััะพะธัั internal network
# ะัะฐะบัะธะบะพะฒะฐัััั ะฒ routing, firewall, DNS
```

---

<div align="center">

**OPERATION KERNEL SHADOWS**
*Episode 05 โ TCP/IP Fundamentals*

*"ะะฐะถะดัะน ะฟะฐะบะตั ัะฐััะบะฐะทัะฒะฐะตั ะธััะพัะธั. ะะฐััะธัั ัะปััะฐัั."* โ LILITH

**[โ Season 2](../README.md) | [Episode 06 โ](../episode-06-dns-name-resolution/README.md)**

</div>

