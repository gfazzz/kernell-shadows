# Episode 07: Firewalls & iptables

**KERNEL SHADOWS ‚Äî Season 2: Networking**

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  Episode 07: Firewalls & iptables                            ‚ïë
‚ïë                                                               ‚ïë
‚ïë  Location: Moscow, Russia üá∑üá∫                                 ‚ïë
‚ïë  Datacenter: –¶–û–î "–ú–æ—Å–∫–≤–∞-1"                                  ‚ïë
‚ïë  Day: 13-14 of 60                                             ‚ïë
‚ïë  Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ                                         ‚ïë
‚ïë  Time: 5-6 hours (8 micro-cycles)                            ‚ïë
‚ïë  Status: üî¥ INCIDENT ‚Äî DDoS ATTACK IN PROGRESS               ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## üéØ Type B Episode: "ufw exists ‚Üí use it, don't wrap it"

**–§–∏–ª–æ—Å–æ—Ñ–∏—è:**
```
Episode 04 (Package Management):  apt exists ‚Üí use it ‚úÖ
Episode 06 (DNS):                 dig exists ‚Üí use it ‚úÖ
Episode 07 (Firewall):            ufw exists ‚Üí use it ‚úÖ
```

**–í—ã –±—É–¥–µ—Ç–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UFW –∏ iptables **–Ω–∞–ø—Ä—è–º—É—é** –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å firewall –ø—Ä–∞–≤–∏–ª–∞ —Ä—É–∫–∞–º–∏
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚ùå –ù–ï –ø–∏—Å–∞—Ç—å bash wrapper –≤–æ–∫—Ä—É–≥ ufw (—ç—Ç–æ Type A ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!)

**Type B vs Type A:**

| Task | Type A ‚ùå | Type B ‚úÖ |
|------|----------|----------|
| Enable firewall | `bash function enable_ufw()` | `sudo ufw enable` –Ω–∞–ø—Ä—è–º—É—é |
| Allow port | `bash wrapper allow_web()` | `sudo ufw allow 80/tcp` –Ω–∞–ø—Ä—è–º—É—é |
| Block IPs | `bash loop –≤ —Å–∫—Ä–∏–ø—Ç–µ` | –†—É—á–Ω–æ–π loop –∏–ª–∏ `ufw deny` |
| Report | `bash –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç` | `bash –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç` (OK!) |

**Linux SysAdmin –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç firewall –Ω–∞–ø—Ä—è–º—É—é, –Ω–µ –ø–∏—à–µ—Ç bash wrappers.** üîß

---

## üíª Setup: –ö–∞–∫ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

**1. –õ–æ–∫–∞–ª—å–Ω–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê**

–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–≤–æ–µ–π Ubuntu –º–∞—à–∏–Ω–µ:
```bash
sudo ufw status
sudo iptables -L
sudo ufw allow 22/tcp
sudo ufw enable
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
- **–í–°–ï–ì–î–ê** —Ä–∞–∑—Ä–µ—à–∞–π—Ç–µ SSH (–ø–æ—Ä—Ç 22) –ü–ï–†–ï–î –≤–∫–ª—é—á–µ–Ω–∏–µ–º UFW!
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `screen` –∏–ª–∏ `tmux` –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∞–∑—Ä—ã–≤–æ–≤
- –î–µ—Ä–∂–∏—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã–º –≤—Ç–æ—Ä–æ–µ SSH –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–±:
sudo ufw allow 22/tcp   # –°–ù–ê–ß–ê–õ–ê!
sudo ufw enable         # –ü–û–¢–û–ú!
```

**2. VM (–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤) ‚≠ê‚≠ê**
- –°–æ–∑–¥–∞–π—Ç–µ snapshot –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º
- –ú–æ–∂–Ω–æ —Å–º–µ–ª–æ –ª–æ–º–∞—Ç—å –∏ –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å

**3. Docker (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è) ‚≠ê‚≠ê‚≠ê**
```bash
# Dockerfile –¥–ª—è shadow-server-02
cat > Dockerfile << 'EOF'
FROM ubuntu:22.04
RUN apt-get update && apt-get install -y \
    openssh-server ufw iptables iproute2 \
    net-tools iputils-ping sudo
RUN useradd -m -s /bin/bash max && \
    echo 'max:password' | chpasswd && \
    usermod -aG sudo max
RUN mkdir /var/run/sshd
EXPOSE 22
CMD ["/usr/sbin/sshd", "-D"]
EOF

docker build -t shadow-server .
docker run -d -p 2222:22 --cap-add=NET_ADMIN \
    --name shadow-server-02 shadow-server

ssh -p 2222 max@localhost  # password: password
```

**4. Cloud VM (—Å–∞–º–æ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ) ‚≠ê‚≠ê‚≠ê‚≠ê**
- DigitalOcean / AWS / Azure
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –∏–º–µ–π—Ç–µ web console –¥–æ—Å—Ç—É–ø –Ω–∞ —Å–ª—É—á–∞–π SSH lockout!

### Recovery –µ—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ SSH:

**–õ–æ–∫–∞–ª—å–Ω–æ/VM:** —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Å–æ–ª–∏ ‚Üí `sudo ufw disable`

**Docker:** `docker rm -f shadow-server-02 && docker run ...`

**Cloud:** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ web console –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üé¨ –°—é–∂–µ—Ç: –î–µ–Ω—å 13, 03:47 ‚Äî –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –∑–≤–æ–Ω–æ–∫

**–¢–µ–ª–µ—Ñ–æ–Ω –ú–∞–∫—Å–∞ –≤–∏–±—Ä–∏—Ä—É–µ—Ç. 3:47 —É—Ç—Ä–∞. –°—Ç–æ–∫–≥–æ–ª—å–º. –ó–≤–æ–Ω–æ–∫ –æ—Ç –ê–ª–µ–∫—Å–∞:**

**–ê–ª–µ–∫—Å** (–∫—Ä–∏—á–∏—Ç, —Ñ–æ–Ω–æ–≤—ã–π —à—É–º —Å–µ—Ä–≤–µ—Ä–Ω–æ–π):
> *"–ú–ê–ö–°! –ü–†–û–°–´–ü–ê–ô–°–Ø! –£ –Ω–∞—Å DDoS! 50 –¢–´–°–Ø–ß –ø–∞–∫–µ—Ç–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É! –°–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç! –¢—ã –≥–¥–µ?!"*

**–ú–∞–∫—Å** (—Ä–µ–∑–∫–æ –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –≤ –æ—Ç–µ–ª–µ):
> *"–Ø –≤ –°—Ç–æ–∫–≥–æ–ª—å–º–µ... –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?!"*

**–ê–ª–µ–∫—Å:**
> *"–ö—Ä—ã–ª–æ–≤ –Ω–∞—à—ë–ª –Ω–∞—Å. –ë–æ—Ç–Ω–µ—Ç –±—å—ë—Ç –ø–æ shadow-server-02. –£ –Ω–∞—Å 5 –º–∏–Ω—É—Ç –¥–æ –∫—Ä–∞—Ö–∞. –õ–ï–¢–ò–®–¨ –í –ú–û–°–ö–í–£. –°–ï–ô–ß–ê–°."*

---

**03:55 ‚Äî Arlanda Airport, Stockholm**

–ú–∞–∫—Å –≤ —Ç–∞–∫—Å–∏. –ù–æ—É—Ç–±—É–∫ –Ω–∞ –∫–æ–ª–µ–Ω—è—Ö. VPN –≤ –º–æ—Å–∫–æ–≤—Å–∫–∏–π –¶–û–î.

**Terminal output:**
```
$ ssh max@shadow-server-02.ops.internal
Connection timeout... retry...
Connected (1247ms latency ‚Äî CRITICAL!)

$ uptime
 03:55:14 up 2 days, 14:23,  load average: 47.82, 38.91, 29.44

‚ö†Ô∏è CRITICAL: Load average > 40 (normal: 1-2)
‚ö†Ô∏è WARNING: 1247ms latency (normal: 20-50ms)
```

**Grafana dashboard:**
```
‚ö†Ô∏è NETWORK TRAFFIC SPIKE
Incoming: 487 Mbps (normal: 20 Mbps)
Packets/sec: 52,341 (normal: 1,500)
CPU: 94% (CRITICAL)
```

**–ú–∞–∫—Å** (–≤ –ø–∞–Ω–∏–∫–µ):
> *"–ê–ª–µ–∫—Å, —è –Ω–µ —É—Å–ø–µ—é –¥–æ–ª–µ—Ç–µ—Ç—å! –ß–µ—Ä–µ–∑ 4 —á–∞—Å–∞ –±—É–¥—É!"*

**–ê–ª–µ–∫—Å:**
> *"–¢–æ–≥–¥–∞ –¥–µ–ª–∞–π —É–¥–∞–ª—ë–Ω–Ω–æ. –°–ï–ô–ß–ê–°. –£ —Ç–µ–±—è –µ—Å—Ç—å SSH. Firewall ‚Äî —ç—Ç–æ –≤—Å—ë —á—Ç–æ –Ω–∞—Å —Å–ø–∞—Å—ë—Ç."*

---

**04:00 ‚Äî –¶–û–î "–ú–æ—Å–∫–≤–∞-1", –°–µ—Ä–≤–µ—Ä–Ω–∞—è A-12**

**–ù–∞ –º–µ—Å—Ç–µ:**
- **–ê–ª–µ–∫—Å** ‚Äî —É –∫–æ–Ω—Å–æ–ª–∏, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞—Ç–∞–∫—É
- **–ê–Ω–Ω–∞** ‚Äî forensics, –∏—â–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫
- **–î–º–∏—Ç—Ä–∏–π** ‚Äî DevOps, –≥–æ—Ç–æ–≤–∏—Ç backup —Å–µ—Ä–≤–µ—Ä—ã
- **–í–∏–∫—Ç–æ—Ä** ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç

**–ê–Ω–Ω–∞:**
> *"–≠—Ç–æ –±–æ—Ç–Ω–µ—Ç. 847 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–æ–≤. –í—Å–µ –∏–∑ Tor exit nodes –∏ VPN –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤. SYN flood. –ö–ª–∞—Å—Å–∏–∫–∞."*

**–í–∏–∫—Ç–æ—Ä:**
> *"–ú–∞–∫—Å, —Ç—ã –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫—Ç–æ —Å–≤–æ–±–æ–¥–µ–Ω. –¢–µ–±–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å firewall. –°–º–æ–∂–µ—à—å?"*

**–ú–∞–∫—Å** (—á–µ—Ä–µ–∑ –Ω–∞—É—à–Ω–∏–∫–∏, —Å–∞–º–æ–ª—ë—Ç –Ω–∞ –≤–∑–ª—ë—Ç–µ):
> *"–Ø... —è –∏–∑—É—á–∞–ª iptables —Ç–æ–ª—å–∫–æ –≤ —Ç–µ–æ—Ä–∏–∏..."*

**–ê–ª–µ–∫—Å:**
> *"–¢–µ–æ—Ä–∏–∏ –±–æ–ª—å—à–µ –Ω–µ—Ç. –¢–æ–ª—å–∫–æ –ø—Ä–∞–∫—Ç–∏–∫–∞. –Ø –±—É–¥—É —Ä—è–¥–æ–º. –ü–æ –ø—É–Ω–∫—Ç–∞–º. –®–∞–≥ –∑–∞ —à–∞–≥–æ–º. –ü–æ–µ—Ö–∞–ª–∏."*

---

### LILITH –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è ‚Äî Emergency Mode

**LILITH v2.0 (–∫—Ä–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º):**
> *"INCIDENT DETECTED. DDoS attack: 52,341 packets/sec from 847 IPs."*
>
> *"Firewall ‚Äî –ø–æ—Å–ª–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –æ–±–æ—Ä–æ–Ω—ã. –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —É–ø–∞–¥—ë—Ç ‚Äî –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–∞–ª–µ–Ω–∞. –ö—Ä—ã–ª–æ–≤ –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º. –û–Ω —É–∑–Ω–∞–µ—Ç –≤—Å–µ –Ω–∞—à–∏ –ª–æ–∫–∞—Ü–∏–∏."*
>
> *"–ú–∞–∫—Å, —Ç—ã –Ω–µ –æ–¥–∏–Ω. –Ø –ø—Ä–æ–≤–µ–¥—É —á–µ—Ä–µ–∑ firewall setup. –ù–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ç—ã. –ë—ã—Å—Ç—Ä–æ."*
>
> *"–£ –Ω–∞—Å 5 –º–∏–Ω—É—Ç –¥–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Ä–æ–≥–∞. After that ‚Äî server crash."*

**–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è:** 04:02
**Deadline:** 04:07
**–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞:** CRITICAL

---

## üìö Micro-Cycles: 8 —Ü–∏–∫–ª–æ–≤ √ó 10-15 –º–∏–Ω—É—Ç

### –¶–∏–∫–ª 1: UFW Status Check (10 –º–∏–Ω—É—Ç) üîç

#### üé¨ –°—é–∂–µ—Ç (2 –º–∏–Ω)

**–ê–ª–µ–∫—Å:**
> *"–ú–∞–∫—Å, –ø–µ—Ä–≤–æ–µ ‚Äî —É–∑–Ω–∞–π —á—Ç–æ —É –Ω–∞—Å —Å–µ–π—á–∞—Å. Firewall –≤–∫–ª—é—á–µ–Ω? –ö–∞–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞?"*

**–ú–∞–∫—Å:**
> *"–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å?"*

**–ê–ª–µ–∫—Å:**
> *"UFW. –≠—Ç–æ wrapper –Ω–∞–¥ iptables. –ü—Ä–æ—â–µ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏. –ö–æ–º–∞–Ω–¥–∞ `sudo ufw status`."*

---

#### üìö –¢–µ–æ—Ä–∏—è: –ß—Ç–æ —Ç–∞–∫–æ–µ Firewall? (5 –º–∏–Ω)

**üé≠ –ú–ï–¢–ê–§–û–†–ê #1: Firewall = –û—Ö—Ä–∞–Ω–Ω–∏–∫ –Ω–æ—á–Ω–æ–≥–æ –∫–ª—É–±–∞**

```
          üè¢ Server (–∫–ª—É–±)
              ‚Üë
              |
         [Firewall] üëÆ –û—Ö—Ä–∞–Ω–Ω–∏–∫
              |
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚Üì         ‚Üì
    ‚úÖ VIP      ‚ùå Botnet
   (allowed)   (blocked)
```

**–û—Ö—Ä–∞–Ω–Ω–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- üÜî –ö—Ç–æ —Ç—ã? (source IP)
- üö™ –ö—É–¥–∞ –∏–¥—ë—à—å? (destination port)
- üì¶ –ß—Ç–æ –Ω–µ—Å—ë—à—å? (protocol, packet content)
- üìù –ï—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ? (whitelist / blacklist)

**–ü—Ä–∞–≤–∏–ª–∞ –∫–ª—É–±–∞ = Firewall rules:**
- VIP –≥–æ—Å—Ç–∏ ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º (ACCEPT)
- –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ ‚Üí –Ω–µ –ø—É—Å–∫–∞–µ–º (DROP)
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥—Ä—É–∑–µ–π ‚Üí –ª–∏–º–∏—Ç (rate limiting)
- –ö–∞–∂–¥—ã–π –≤—Ö–æ–¥ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º ‚Üí –ª–æ–≥ (LOG)

**LILITH:**
> *"Firewall ‚Äî –Ω–µ —Å—Ç–µ–Ω–∞. –≠—Ç–æ –≤—ã—à–∏–±–∞–ª–∞. –•–æ—Ä–æ—à–∏–π –≤—ã—à–∏–±–∞–ª–∞ –∑–Ω–∞–µ—Ç –∫–æ–≥–æ –≤–ø—É—Å—Ç–∏—Ç—å, –∫–æ–≥–æ –≤—ã–∫–∏–Ω—É—Ç—å, –∞ –Ω–∞ –∫–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ä–∞—Ç—å. –ü–ª–æ—Ö–æ–π ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ—Ö, –≤–∫–ª—é—á–∞—è —Å–µ–±—è."*

---

**Linux Firewall Stack:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Application Layer  ‚îÇ  nginx, ssh, apache
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ufw / iptables     ‚îÇ  ‚Üê Userspace tools (–∑–¥–µ—Å—å —Ä–∞–±–æ—Ç–∞–µ–º –º—ã)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Netfilter         ‚îÇ  ‚Üê Kernel module (packet filtering)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Network Stack      ‚îÇ  TCP/IP, routing
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**UFW (Uncomplicated Firewall):**
- Wrapper –Ω–∞–¥ iptables
- –ü—Ä–æ—â–µ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- Ubuntu default

**iptables:**
- –ú–æ—â–Ω—ã–π, –Ω–æ —Å–ª–æ–∂–Ω—ã–π
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ Netfilter

---

#### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ (3 –º–∏–Ω)

**–ó–∞–¥–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å firewall.

```bash
# 1. UFW status
sudo ufw status verbose

# 2. iptables rules
sudo iptables -L -n -v

# 3. SYN_RECV connections (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä SYN flood)
netstat -an | grep SYN_RECV | wc -l
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–î–û –Ω–∞—Å—Ç—Ä–æ–π–∫–∏):**
```
UFW: Status: inactive
iptables: Chain INPUT (policy ACCEPT) ‚Äî –Ω–µ—Ç –ø—Ä–∞–≤–∏–ª!
SYN_RECV: 847 (‚ö†Ô∏è CRITICAL! normal < 10)
```

**LILITH:**
> *"–í–∏–∂—É. Firewall –≤—ã–∫–ª—é—á–µ–Ω. Default policy ACCEPT ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –í–°–Å. –ë–æ—Ç–Ω–µ—Ç –≥—É–ª—è–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ. –ò—Å–ø—Ä–∞–≤–ª—è–µ–º."*

---

#### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å:** –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç `Chain INPUT (policy ACCEPT)`?

a) –í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
b) –í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è (–µ—Å–ª–∏ –Ω–µ—Ç –¥—Ä—É–≥–∏—Ö –ø—Ä–∞–≤–∏–ª)
c) Firewall –∞–∫—Ç–∏–≤–µ–Ω

<details>
<summary>üí° –î—É–º–∞–π 30 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç: b) –í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è**

`policy ACCEPT` = default policy: –µ—Å–ª–∏ –ø–∞–∫–µ—Ç –Ω–µ –ø–æ–¥–æ—à—ë–ª –Ω–∏ –ø–æ–¥ –æ–¥–Ω–æ –ø—Ä–∞–≤–∏–ª–æ ‚Äî **–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å**.

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –ø—Ä–∞–≤–∏–ª –Ω–µ—Ç (–∫–∞–∫ —Å–µ–π—á–∞—Å) ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –í–°–Å!

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ:** `policy DROP` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë —á—Ç–æ –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ —è–≤–Ω–æ.

**LILITH:**
> *"ACCEPT policy ‚Äî —ç—Ç–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–≤–µ—Ä–∏. DROP policy ‚Äî –∑–∞–∫—Ä—ã—Ç—ã–µ –¥–≤–µ—Ä–∏ —Å VIP —Å–ø–∏—Å–∫–æ–º. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π DROP."*

</details>

---

### –¶–∏–∫–ª 2: Enable UFW Safely (12 –º–∏–Ω—É—Ç) üîì

#### üé¨ –°—é–∂–µ—Ç (2 –º–∏–Ω)

**–ê–ª–µ–∫—Å:**
> *"–ú–∞–∫—Å, firewall –≤—ã–∫–ª—é—á–µ–Ω. –í–∫–ª—é—á–∞–µ–º UFW. –ù–û! –ö–†–ò–¢–ò–ß–ù–û ‚Äî —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–∑—Ä–µ—à–∏ SSH, –∏–Ω–∞—á–µ –ø–æ—Ç–µ—Ä—è–µ—à—å –¥–æ—Å—Ç—É–ø!"*

**–ú–∞–∫—Å:**
> *"–ê —á—Ç–æ –±—É–¥–µ—Ç –µ—Å–ª–∏ –Ω–µ —Ä–∞–∑—Ä–µ—à–∏—Ç—å?"*

**–ê–ª–µ–∫—Å:**
> *"–ü–æ—Ç–µ—Ä—è–µ—à—å SSH. –°–µ—Ä–≤–µ—Ä —Å—Ç–∞–Ω–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–∏–¥—ë—Ç—Å—è –ª–µ—Ç–µ—Ç—å –≤ –ú–æ—Å–∫–≤—É —Ñ–∏–∑–∏—á–µ—Å–∫–∏. 4 —á–∞—Å–∞. –°–µ—Ä–≤–µ—Ä —É–ø–∞–¥—ë—Ç —á–µ—Ä–µ–∑ 3 –º–∏–Ω—É—Ç—ã."*

**–ú–∞–∫—Å:**
> *"–ü–æ–Ω—è–ª. SSH –ø–µ—Ä–≤—ã–π. –ü–æ—Ç–æ–º UFW."*

**LILITH:**
> *"88% –Ω–æ–≤–∏—á–∫–æ–≤ –±–ª–æ–∫–∏—Ä—É—é—Ç —Å–∞–º–∏ —Å–µ–±—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∫–ª—é—á–µ–Ω–∏–∏ UFW. –¢—ã –Ω–µ –±—É–¥–µ—à—å 89-–º."*

---

#### üìö –¢–µ–æ—Ä–∏—è: UFW Basics (6 –º–∏–Ω)

**üé≠ –ú–ï–¢–ê–§–û–†–ê #2: Default Policy = –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ö—Ä–∞–Ω–Ω–∏–∫–∞**

```
Policy ACCEPT (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ):
  –û—Ö—Ä–∞–Ω–Ω–∏–∫: "–ü—É—Å–∫–∞–π –≤—Å–µ, –∫—Ä–æ–º–µ –∫–æ–≥–æ –∑–∞–ø—Ä–µ—Ç–∏–º"
  ‚Üí –ó–∞–±—ã–ª–∏ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å botnet? –ü—Ä–æ—à–ª–∏!

Policy DENY (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
  –û—Ö—Ä–∞–Ω–Ω–∏–∫: "–ë–ª–æ–∫–∏—Ä—É–π –≤—Å–µ—Ö, –∫—Ä–æ–º–µ –∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–∏–º"
  ‚Üí –ó–∞–±—ã–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å SSH? –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω! (–Ω–æ botnet —Ç–æ–∂–µ)
```

**Best practice:**
```bash
# 1. Default: –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Ö–æ–¥—è—â–∏–µ
sudo ufw default deny incoming

# 2. Default: —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–µ
sudo ufw default allow outgoing

# 3. –Ø–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –Ω—É–∂–Ω–æ–µ (SSH, HTTP, HTTPS)
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# 4. –í–∫–ª—é—á–∏—Ç—å
sudo ufw enable
```

---

**–ü–æ—Ä—è–¥–æ–∫ –∫—Ä–∏—Ç–∏—á–µ–Ω!**

```
‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
1. sudo ufw enable         # –í–∫–ª—é—á–∏–ª–∏ UFW
2. sudo ufw allow 22/tcp   # –†–∞–∑—Ä–µ—à–∏–ª–∏ SSH
‚Üí –ú–µ–∂–¥—É —à–∞–≥–æ–º 1 –∏ 2 –≤—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã!

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
1. sudo ufw allow 22/tcp   # –†–∞–∑—Ä–µ—à–∏–ª–∏ SSH
2. sudo ufw enable         # –í–∫–ª—é—á–∏–ª–∏ UFW
‚Üí SSH —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞!
```

**LILITH:**
> *"–ü–æ—Ä—è–¥–æ–∫ –∫–æ–º–∞–Ω–¥ = –∂–∏–∑–Ω—å –∏–ª–∏ —Å–º–µ—Ä—Ç—å SSH. –ó–∞–ø–æ–º–Ω–∏: allow –ü–ï–†–ï–î enable. –í—Å–µ–≥–¥–∞."*

---

**üí° AHA Moment: UFW ‚â† –∞–∫—Ç–∏–≤–µ–Ω —Å—Ä–∞–∑—É**

```bash
# –î–æ–±–∞–≤–∏–ª–∏ –ø—Ä–∞–≤–∏–ª–æ
sudo ufw allow 22/tcp
# –í—ã–≤–æ–¥: Rule added ‚úì

# –ù–û! –ü—Ä–∞–≤–∏–ª–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∫–∞ –Ω–µ –≤–∫–ª—é—á–∏–º UFW
sudo ufw status
# Status: inactive ‚ö†Ô∏è

# –í–∫–ª—é—á–∞–µ–º
sudo ufw enable
# Now: Status: active ‚úì + –ø—Ä–∞–≤–∏–ª–æ —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

**–ó–∞—á–µ–º —Ç–∞–∫?** –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å! –ú–æ–∂–µ—à—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, **–ø–æ—Ç–æ–º** –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

---

#### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –í–∫–ª—é—á–µ–Ω–∏–µ UFW (3 –º–∏–Ω)

**–ó–∞–¥–∞–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç–µ UFW –±–µ–∑–æ–ø–∞—Å–Ω–æ (–Ω–µ –ø–æ—Ç–µ—Ä—è–≤ SSH).

```bash
# –®–∞–≥ 1: Default policies
sudo ufw default deny incoming
sudo ufw default allow outgoing

# –®–∞–≥ 2: –†–∞–∑—Ä–µ—à–∏—Ç—å SSH (–ö–†–ò–¢–ò–ß–ù–û!)
sudo ufw allow 22/tcp comment 'SSH access'

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ
sudo ufw show added

# –®–∞–≥ 4: –í–∫–ª—é—á–∏—Ç—å UFW
echo "y" | sudo ufw enable  # Auto-yes

# –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo ufw status verbose
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Status: active
Logging: on (low)
Default: deny (incoming), allow (outgoing)

To                         Action      From
--                         ------      ----
22/tcp                     ALLOW IN    Anywhere    # SSH access
```

**LILITH:**
> *"–•–æ—Ä–æ—à–æ. UFW –∞–∫—Ç–∏–≤–µ–Ω. SSH —Ä–∞–±–æ—Ç–∞–µ—Ç. Default deny ‚Äî —É–º–Ω–æ. –¢–µ–ø–µ—Ä—å –±–æ—Ç–Ω–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω... –∫—Ä–æ–º–µ 80 –∏ 443. –≠—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥."*

---

#### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å:** –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `comment` –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö?

```bash
sudo ufw allow 22/tcp comment 'SSH access'
```

<details>
<summary>üí° –î—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è!

–ß–µ—Ä–µ–∑ –º–µ—Å—è—Ü —Ç—ã –∑–∞–±—É–¥–µ—à—å –∑–∞—á–µ–º —Ä–∞–∑—Ä–µ—à–∏–ª –ø–æ—Ä—Ç 8080. Comment –Ω–∞–ø–æ–º–Ω–∏—Ç:
```
8080/tcp    ALLOW    # Prometheus monitoring
```

**LILITH:**
> *"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ‚Äî –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Å–µ–±—è. –¢—ã —á–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞ ‚Äî —ç—Ç–æ –¥—Ä—É–≥–æ–π —á–µ–ª–æ–≤–µ–∫. –ü–æ–º–æ–≥–∏ –µ–º—É."*

**Best practice:** –í—Å–µ–≥–¥–∞ comment –¥–ª—è –Ω–µ-—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤!

</details>

---

### –¶–∏–∫–ª 3: Allow Web Traffic (10 –º–∏–Ω—É—Ç) üåê

#### üé¨ –°—é–∂–µ—Ç (2 –º–∏–Ω)

**–ê–ª–µ–∫—Å:**
> *"–û—Ç–ª–∏—á–Ω–æ! SSH —Ä–∞–±–æ—Ç–∞–µ—Ç. –¢–µ–ø–µ—Ä—å —Ä–∞–∑—Ä–µ—à–∏ –≤–µ–±-—Ç—Ä–∞—Ñ–∏–∫ ‚Äî –ø–æ—Ä—Ç—ã 80 –∏ 443. –ù–∞—à —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å HTTP/HTTPS –∑–∞–ø—Ä–æ—Å—ã."*

**–ú–∞–∫—Å:**
> *"–ü—Ä–æ—Å—Ç–æ allow 80 –∏ 443?"*

**–ê–ª–µ–∫—Å:**
> *"–î–∞. UFW –∑–Ω–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ä—Ç—ã. –ú–æ–∂–µ—à—å –¥–∞–∂–µ `sudo ufw allow http` ‚Äî –æ–Ω —Å–∞–º –ø–æ–π–º—ë—Ç —á—Ç–æ —ç—Ç–æ 80."*

---

#### üìö –¢–µ–æ—Ä–∏—è: Standard Ports (5 –º–∏–Ω)

**Well-known Ports (0-1023):**

| Service | Port | Protocol | Use case |
|---------|------|----------|----------|
| **SSH** | 22 | TCP | Remote access |
| **HTTP** | 80 | TCP | Web (unencrypted) |
| **HTTPS** | 443 | TCP | Web (encrypted) |
| DNS | 53 | UDP/TCP | Name resolution |
| FTP | 21 | TCP | File transfer ‚ö†Ô∏è unsecure |
| SMTP | 25 | TCP | Email sending |
| MySQL | 3306 | TCP | Database |
| PostgreSQL | 5432 | TCP | Database |

**LILITH:**
> *"22, 80, 443 ‚Äî —Å–≤—è—Ç–∞—è —Ç—Ä–æ–∏—Ü–∞ web —Å–µ—Ä–≤–µ—Ä–∞. SSH –¥–ª—è –∞–¥–º–∏–Ω–æ–≤, HTTP/HTTPS –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –∑–∞–∫—Ä—ã—Ç–æ."*

---

**üé≠ –ú–ï–¢–ê–§–û–†–ê #3: –ü–æ—Ä—Ç—ã = –î–≤–µ—Ä–∏ –≤ –∑–¥–∞–Ω–∏–∏**

```
        üè¢ Server
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ :22   SSH    ‚îÇ ‚Üê –°–ª—É–∂–µ–±–Ω—ã–π –≤—Ö–æ–¥ (—Ç–æ–ª—å–∫–æ admin)
    ‚îÇ :80   HTTP   ‚îÇ ‚Üê –ì–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥ (–ø—É–±–ª–∏—á–Ω—ã–π)
    ‚îÇ :443  HTTPS  ‚îÇ ‚Üê VIP –≤—Ö–æ–¥ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π)
    ‚îÇ :3306 MySQL  ‚îÇ ‚Üê –ó–∞–¥–Ω–∏–π –¥–≤–æ—Ä (–∑–∞–∫—Ä—ã—Ç –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö)
    ‚îÇ :8080 ???    ‚îÇ ‚Üê –ó–∞–ø–∞—Å–Ω–æ–π –≤—ã—Ö–æ–¥ (–∑–∞—á–µ–º –æ—Ç–∫—Ä—ã—Ç?)
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è attack surface:**
- –û—Ç–∫—Ä—ã—Ç–æ —Ç–æ–ª—å–∫–æ **–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ**
- –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –∑–∞–∫—Ä—ã—Ç–æ
- MySQL? –¢–æ–ª—å–∫–æ —Å localhost –∏–ª–∏ VPN
- Random –ø–æ—Ä—Ç—ã? –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å –∑–∞—á–µ–º ‚Äî –∑–∞–∫—Ä–æ–π!

---

**üí° AHA Moment: UFW –∑–Ω–∞–µ—Ç –∏–º–µ–Ω–∞ —Å–µ—Ä–≤–∏—Å–æ–≤**

```bash
# –î–≤–∞ —Å–ø–æ—Å–æ–±–∞:
sudo ufw allow 22/tcp     # –ü–æ –Ω–æ–º–µ—Ä—É
sudo ufw allow ssh        # –ü–æ –∏–º–µ–Ω–∏ (UFW –∑–Ω–∞–µ—Ç ssh = 22)

sudo ufw allow 80/tcp
sudo ufw allow http       # –¢–æ –∂–µ —Å–∞–º–æ–µ!

sudo ufw allow 443/tcp
sudo ufw allow https      # –¢–æ –∂–µ —Å–∞–º–æ–µ!

# –û—Ç–∫—É–¥–∞ UFW –∑–Ω–∞–µ—Ç?
cat /etc/services | grep -E "^ssh|^http"
```

–í—ã–≤–æ–¥: `ssh    22/tcp`, `http   80/tcp`

**LILITH:**
> *"–ò–º–µ–Ω–∞ —É–¥–æ–±–Ω–µ–µ. –ù–æ —è –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –Ω–æ–º–µ—Ä–∞ ‚Äî explicitness. –í–∏–¥–∏—à—å 22 ‚Äî —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç–Ω–æ."*

---

#### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤–µ–±-—Ç—Ä–∞—Ñ–∏–∫–∞ (2 –º–∏–Ω)

**–ó–∞–¥–∞–Ω–∏–µ:** –†–∞–∑—Ä–µ—à–∏—Ç–µ HTTP (80) –∏ HTTPS (443).

```bash
# –°–ø–æ—Å–æ–± 1: –ü–æ –Ω–æ–º–µ—Ä—É –ø–æ—Ä—Ç–∞
sudo ufw allow 80/tcp comment 'HTTP'
sudo ufw allow 443/tcp comment 'HTTPS'

# –°–ø–æ—Å–æ–± 2: –ü–æ –∏–º–µ–Ω–∏ (–∫–æ—Ä–æ—á–µ)
sudo ufw allow http
sudo ufw allow https

# –ü—Ä–æ–≤–µ—Ä–∫–∞
sudo ufw status numbered
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
To                         Action      From
--                         ------      ----
[ 1] 22/tcp                 ALLOW IN    Anywhere      # SSH access
[ 2] 80/tcp                 ALLOW IN    Anywhere      # HTTP
[ 3] 443/tcp                ALLOW IN    Anywhere      # HTTPS
```

**LILITH:**
> *"–•–æ—Ä–æ—à–æ. –¢–µ–ø–µ—Ä—å legitimate –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∑–∞–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç. –ù–æ –±–æ—Ç–Ω–µ—Ç —Ç–æ–∂–µ –º–æ–∂–µ—Ç –±–∏—Ç—å –ø–æ 80/443. Rate limiting ‚Äî –ø–æ–∑–∂–µ."*

---

#### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å:** –ù—É–∂–Ω–æ –ª–∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å port 80 –µ—Å–ª–∏ –µ—Å—Ç—å 443 (HTTPS)?

<details>
<summary>üí° –î—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:** –î–∞, –æ–±—ã—á–Ω–æ –Ω—É–∂–Ω—ã –û–ë–ê!

**–ó–∞—á–µ–º?**
- **Port 80:** HTTP ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ HTTPS (301 redirect)
- **Port 443:** HTTPS ‚Üí —Ä–µ–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫

**–ü—Ä–∏–º–µ—Ä:**
```
User ‚Üí http://example.com:80
     ‚Üí 301 redirect
     ‚Üí https://example.com:443 ‚úì
```

–ï—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç—å 80 ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç `example.com` ‚Üí –±—Ä–∞—É–∑–µ—Ä –ø—Ä–æ–±—É–µ—Ç 80 ‚Üí timeout!

**–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:** –ï—Å–ª–∏ 100% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–Ω–∞—é—Ç –∞–¥—Ä–µ—Å —Å `https://` ‚Äî –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å 80.

**LILITH:**
> *"–í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏: 80 –æ—Ç–∫—Ä—ã—Ç –≤—Å–µ–≥–¥–∞. –õ—é–¥–∏ –ª–µ–Ω–∏–≤—ã –Ω–∞–±–∏—Ä–∞—Ç—å https://."*

</details>

---

### –¶–∏–∫–ª 4: Block Botnet IPs (15 –º–∏–Ω—É—Ç) üö´

#### üé¨ –°—é–∂–µ—Ç (3 –º–∏–Ω)

**–ê–Ω–Ω–∞:**
> *"–ú–∞–∫—Å, —è –æ—Ç—Å–ª–µ–¥–∏–ª–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∞—Ç–∞–∫–∏. 847 IP –∞–¥—Ä–µ—Å–æ–≤. –°–ø–∏—Å–æ–∫ –≤ `artifacts/botnet_ips.txt`. –ó–∞–±–ª–æ–∫–∏—Ä—É–π –∏—Ö –≤—Å–µ."*

**–ú–∞–∫—Å:**
> *"–í—Å–µ? –í—Ä—É—á–Ω—É—é?!"*

**–ê–Ω–Ω–∞:**
> *"Bash loop. While read. 2 –º–∏–Ω—É—Ç—ã —Ä–∞–±–æ—Ç—ã."*

**–ú–∞–∫—Å:**
> *"–ù–æ... —ç—Ç–æ –∂–µ Type B episode! –ú—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–∏—Å–∞—Ç—å bash wrappers!"*

**–ê–Ω–Ω–∞:**
> *"Loop ‚â† wrapper. Loop ‚Äî —ç—Ç–æ automation –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã. Wrapper ‚Äî —ç—Ç–æ –∑–∞–º–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞. –†–∞–∑–Ω–∏—Ü–∞."*

**LILITH:**
> *"–ü—Ä–∞–≤–∏–ª—å–Ω–æ. Type B: –∏—Å–ø–æ–ª—å–∑—É–π ufw/iptables –Ω–∞–ø—Ä—è–º—É—é. Bash loop ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã 847 —Ä–∞–∑. –¢—ã –∂–µ –Ω–µ –±—É–¥–µ—à—å –≤–≤–æ–¥–∏—Ç—å –≤—Ä—É—á–Ω—É—é?"*

---

#### üìö –¢–µ–æ—Ä–∏—è: UFW vs iptables –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (6 –º–∏–Ω)

**–î–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:**

**1. UFW (–ø—Ä–æ—â–µ, –º–µ–¥–ª–µ–Ω–Ω–µ–µ)**
```bash
sudo ufw deny from 185.220.101.47
sudo ufw deny from 91.219.237.244
# ... 847 —Ä–∞–∑
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ = –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª (–º–µ–¥–ª–µ–Ω–Ω–æ!)

**2. iptables (—Å–ª–æ–∂–Ω–µ–µ, –±—ã—Å—Ç—Ä–µ–µ)**
```bash
sudo iptables -I INPUT -s 185.220.101.47 -j DROP
sudo iptables -I INPUT -s 91.219.237.244 -j DROP
# ... 847 —Ä–∞–∑
```

**–ë—ã—Å—Ç—Ä–µ–µ:** –ü—Ä—è–º–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ kernel (–±–µ–∑ reload)

---

**üé≠ –ú–ï–¢–ê–§–û–†–ê #4: UFW = –ú–µ–Ω–µ–¥–∂–µ—Ä, iptables = –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å**

```
           UFW
            ‚Üì
    [–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª]
            ‚Üì
        iptables
            ‚Üì
        Netfilter (kernel)
```

**UFW:** "–î–æ–±–∞–≤—å –ø—Ä–∞–≤–∏–ª–æ" ‚Üí reload –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª ‚Üí –º–µ–¥–ª–µ–Ω–Ω–æ

**iptables:** "–î–æ–±–∞–≤—å –ø—Ä–∞–≤–∏–ª–æ" ‚Üí –ø—Ä—è–º–æ –≤ kernel ‚Üí –±—ã—Å—Ç—Ä–æ

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—Ç–æ:**
- **UFW:** < 100 –ø—Ä–∞–≤–∏–ª, –ø—Ä–æ—Å—Ç–æ—Ç–∞
- **iptables:** > 100 –ø—Ä–∞–≤–∏–ª, —Å–∫–æ—Ä–æ—Å—Ç—å
- **ipset:** > 1000 IP, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ (advanced)

---

**üí° AHA Moment: -A vs -I**

```bash
# -A = Append (–≤ –∫–æ–Ω–µ—Ü chain)
sudo iptables -A INPUT -s 1.2.3.4 -j DROP

# -I = Insert (–≤ –Ω–∞—á–∞–ª–æ chain)
sudo iptables -I INPUT -s 1.2.3.4 -j DROP
```

**–†–∞–∑–Ω–∏—Ü–∞:**
```
Chain INPUT:
1. ACCEPT 10.0.0.0/8 (trusted network)
2. DROP    1.2.3.4   (botnet) ‚Üê Insert —Å—é–¥–∞ (-I)
3. ACCEPT  22/tcp    (SSH)
...
99. DROP   5.6.7.8   (botnet) ‚Üê Append —Å—é–¥–∞ (-A)
```

**–ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑** ‚Äî –ø–µ—Ä–≤–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ = action!

**–î–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** `-I` (insert) ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞–Ω—å—à–µ ‚Üí –±—ã—Å—Ç—Ä–µ–µ DROP

**LILITH:**
> *"-I –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –ß–µ–º —Ä–∞–Ω—å—à–µ DROP ‚Äî —Ç–µ–º –º–µ–Ω—å—à–µ CPU —Ç—Ä–∞—Ç–∏–º –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª."*

---

#### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ botnet IPs (5 –º–∏–Ω)

**–ó–∞–¥–∞–Ω–∏–µ:** –ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –≤—Å–µ IP –∏–∑ `artifacts/botnet_ips.txt`.

**–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:**
```
# Botnet IPs from Krylov's attack
185.220.101.52    # Tor exit node
45.142.120.10     # VPN provider
...
```

**–°–∫—Ä–∏–ø—Ç (Type B approach ‚Äî loop —Å –ø—Ä—è–º—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏):**

```bash
#!/bin/bash
# block_botnet.sh - Type B: direct iptables commands

BOTNET_FILE="artifacts/botnet_ips.txt"
count=0

echo "Blocking botnet IPs with iptables..."

while IFS= read -r line; do
    # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
    [[ -z "$line" || "$line" =~ ^# ]] && continue

    # –ò–∑–≤–ª–µ—á—å IP (–ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ)
    ip=$(echo "$line" | awk '{print $1}')

    # –í–∞–ª–∏–¥–∞—Ü–∏—è IP
    if [[ ! "$ip" =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
        echo "‚ö† Invalid IP: $ip (skipped)"
        continue
    fi

    # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ iptables (Type B: direct command!)
    sudo iptables -I INPUT -s "$ip" -j DROP
    count=$((count + 1))

    # Progress –∫–∞–∂–¥—ã–µ 50 IP
    if ((count % 50 == 0)); then
        echo "  Blocked: $count IPs..."
    fi

done < "$BOTNET_FILE"

echo "‚úì Blocked $count IPs total"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞
echo "Verification:"
echo "  iptables DROP rules: $(sudo iptables -L INPUT -n | grep -c DROP)"
echo "  SYN_RECV connections: $(netstat -an 2>/dev/null | grep -c SYN_RECV)"
```

**–ó–∞–ø—É—Å–∫:**
```bash
chmod +x block_botnet.sh
./block_botnet.sh
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Blocking botnet IPs with iptables...
  Blocked: 50 IPs...
  Blocked: 100 IPs...
  ...
  Blocked: 847 IPs...
‚úì Blocked 847 IPs total

Verification:
  iptables DROP rules: 847
  SYN_RECV connections: 23  (–±—ã–ª–æ 847!)
```

**LILITH:**
> *"–ù–µ–ø–ª–æ—Ö–æ. SYN_RECV —Å 847 —É–ø–∞–ª –¥–æ 23. –≠—Ç–æ 97% reduction. –ù–æ –ö—Ä—ã–ª–æ–≤ —É–º—ë–Ω ‚Äî –æ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è–µ—Ç IP. Rate limiting ‚Äî —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥."*

---

#### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å:** –ü–æ—á–µ–º—É –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º bash loop –∑–¥–µ—Å—å, –µ—Å–ª–∏ —ç—Ç–æ Type B episode?

<details>
<summary>üí° –î—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:** Loop ‚â† Wrapper!

**Type A (–ø–ª–æ—Ö–æ):**
```bash
# –§—É–Ω–∫—Ü–∏—è-wrapper –∑–∞–º–µ–Ω—è–µ—Ç ufw
block_ip() {
    local ip="$1"
    sudo ufw deny from "$ip"
    # + –µ—â—ë 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∏–∫–∏
}
```
‚Üí –°–∫—Ä—ã–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Å–æ–∑–¥–∞–ª–∏ —Å–≤–æ–π API

**Type B (—Ö–æ—Ä–æ—à–æ):**
```bash
# Loop –ø—Ä–æ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø—Ä—è–º—É—é –∫–æ–º–∞–Ω–¥—É
while read ip; do
    sudo iptables -I INPUT -s "$ip" -j DROP  # –ü—Ä—è–º–∞—è –∫–æ–º–∞–Ω–¥–∞!
done < file.txt
```
‚Üí –í–∏–¥–Ω–∞ –ø—Ä—è–º–∞—è –∫–æ–º–∞–Ω–¥–∞, –ø—Ä–æ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

**LILITH:**
> *"Type B = –∏—Å–ø–æ–ª—å–∑—É–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–∞–ø—Ä—è–º—É—é. Bash –¥–ª—è automation ‚Äî OK. Bash –≤–º–µ—Å—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ ‚Äî NOT OK."*

</details>

---

### –¶–∏–∫–ª 5: Rate Limiting (15 –º–∏–Ω—É—Ç) ‚ö°

#### üé¨ –°—é–∂–µ—Ç (2 –º–∏–Ω)

**–ê–ª–µ–∫—Å:**
> *"–•–æ—Ä–æ—à–æ! –ù–æ —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ö—Ä—ã–ª–æ–≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è–µ—Ç IP. –ù—É–∂–µ–Ω rate limiting ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π. –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —à–ª—ë—Ç > 20 SYN –≤ —Å–µ–∫—É–Ω–¥—É ‚Äî –±–ª–æ–∫–∏—Ä—É–µ–º."*

**–ú–∞–∫—Å:**
> *"–ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å?"*

**–ê–ª–µ–∫—Å:**
> *"iptables modules: connlimit, recent, hashlimit. –ö–∞–∂–¥—ã–π –¥–ª—è —Å–≤–æ–µ–π –∑–∞–¥–∞—á–∏."*

---

#### üìö –¢–µ–æ—Ä–∏—è: Rate Limiting Types (7 –º–∏–Ω)

**üé≠ –ú–ï–¢–ê–§–û–†–ê #5: Rate Limiting = –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –≤ –∫–ª—É–±–µ**

```
üè¢ –ö–ª—É–± (capacity: 100 —á–µ–ª–æ–≤–µ–∫)

–ë–µ–∑ rate limiting:
  1000 —á–µ–ª–æ–≤–µ–∫ –ø—ã—Ç–∞—é—Ç—Å—è –∑–∞–π—Ç–∏ —Å—Ä–∞–∑—É
  ‚Üí –î–∞–≤–∫–∞, –∫—Ç–æ-—Ç–æ —É–ø–∞–ª, –∫–ª—É–± –∑–∞–∫—Ä—ã–ª—Å—è

–° rate limiting:
  –ú–∞–∫—Å–∏–º—É–º 5 —á–µ–ª–æ–≤–µ–∫/–º–∏–Ω—É—Ç—É
  ‚Üí –û—á–µ—Ä–µ–¥—å, –Ω–æ –≤—Å–µ –∂–∏–≤—ã, –∫–ª—É–± —Ä–∞–±–æ—Ç–∞–µ—Ç
```

**SYN Flood = –§–∞–ª—å—à–∏–≤—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:**
- Attacker –±—Ä–æ–Ω–∏—Ä—É–µ—Ç 1000 —Å—Ç–æ–ª–∏–∫–æ–≤
- –ù–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç
- Real guests –Ω–µ –º–æ–≥—É—Ç –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
- –†–µ—Å—Ç–æ—Ä–∞–Ω —Ç–µ—Ä—è–µ—Ç –¥–µ–Ω—å–≥–∏

**Rate limiting = "–ú–∞–∫—Å–∏–º—É–º 3 –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –æ–¥–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞"**

---

**3 —Ç–∏–ø–∞ rate limiting –≤ iptables:**

**1. connlimit ‚Äî –ª–∏–º–∏—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π**
```bash
# –ú–∞–∫—Å–∏–º—É–º 20 TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –æ–¥–Ω–æ–≥–æ IP
sudo iptables -A INPUT -p tcp --syn -m connlimit \
    --connlimit-above 20 --connlimit-mask 32 \
    -j REJECT --reject-with tcp-reset
```

**Use case:** –ó–∞—â–∏—Ç–∞ –æ—Ç connection exhaustion

---

**2. recent ‚Äî —Ç—Ä–µ–∫–∏–Ω–≥ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏**
```bash
# –¢—Ä–µ–∫–∏–Ω–≥ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
sudo iptables -A INPUT -p tcp --dport 22 -m state --state NEW \
    -m recent --set --name SSH

# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –µ—Å–ª–∏ > 4 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 60 —Å–µ–∫—É–Ω–¥
sudo iptables -A INPUT -p tcp --dport 22 -m state --state NEW \
    -m recent --update --seconds 60 --hitcount 5 --name SSH \
    -j DROP
```

**Use case:** SSH brute-force protection

---

**3. hashlimit ‚Äî per-IP rate limiting**
```bash
# –ö–∞–∂–¥—ã–π IP: –º–∞–∫—Å–∏–º—É–º 50 HTTP requests/sec
sudo iptables -A INPUT -p tcp --dport 80 -m hashlimit \
    --hashlimit-above 50/sec \
    --hashlimit-mode srcip \
    --hashlimit-name http_limit \
    -j DROP
```

**Use case:** DDoS protection –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–∞

---

**üí° AHA Moment: Token Bucket Algorithm**

```
Rate limit = –≤–µ–¥—Ä–æ —Å —Ç–æ–∫–µ–Ω–∞–º–∏

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ü™ô ü™ô ü™ô ü™ô  ‚îÇ  ‚Üê Bucket (capacity = burst)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
–ü–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è: 10 tokens/sec (rate)
–ö–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç –∑–∞–±–∏—Ä–∞–µ—Ç 1 token
–ù–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí DROP

–ü—Ä–∏–º–µ—Ä: --limit 10/sec --limit-burst 20
  Start: 20 tokens
  Request 1-20: –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Å–µ —Ç–æ–∫–µ–Ω—ã (bucket = 0)
  Request 21: DROP (–Ω–µ—Ç tokens)
  –ß–µ—Ä–µ–∑ 1 sec: +10 tokens (bucket = 10)
  Request 22-31: –∏—Å–ø–æ–ª—å–∑—É—é—Ç 10 tokens
```

**LILITH:**
> *"Token bucket = —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ. –ú–æ–∂–µ—à—å burst (–≤—Å–ø–ª–µ—Å–∫), –Ω–æ –Ω–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ. –¢–æ–∫–µ–Ω—ã –∫–æ–Ω—á–∞—é—Ç—Å—è ‚Äî –∂–¥–∏."*

---

#### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ rate limiting (5 –º–∏–Ω)

**–ó–∞–¥–∞–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SYN flood.

```bash
#!/bin/bash
# rate_limiting.sh - Type B: direct iptables

echo "=== CONFIGURING RATE LIMITING ==="
echo ""

# 1. Limit simultaneous connections (connlimit)
echo "[1] Connection limit: 20 per IP..."
sudo iptables -A INPUT -p tcp --syn -m connlimit \
    --connlimit-above 20 --connlimit-mask 32 \
    -j REJECT --reject-with tcp-reset
echo "‚úì Max 20 simultaneous connections per IP"
echo ""

# 2. SSH brute-force protection (recent)
echo "[2] SSH brute-force protection..."
sudo iptables -A INPUT -p tcp --dport 22 -m state --state NEW \
    -m recent --set --name SSH_TRACK

sudo iptables -A INPUT -p tcp --dport 22 -m state --state NEW \
    -m recent --update --seconds 60 --hitcount 5 --name SSH_TRACK \
    -j DROP
echo "‚úì Max 4 SSH attempts per minute per IP"
echo ""

# 3. HTTP rate limiting (hashlimit)
echo "[3] HTTP/HTTPS rate limiting..."
sudo iptables -A INPUT -p tcp --dport 80 -m hashlimit \
    --hashlimit-above 50/sec --hashlimit-mode srcip \
    --hashlimit-name http_limit -j DROP

sudo iptables -A INPUT -p tcp --dport 443 -m hashlimit \
    --hashlimit-above 50/sec --hashlimit-mode srcip \
    --hashlimit-name https_limit -j DROP
echo "‚úì Max 50 HTTP/HTTPS req/sec per IP"
echo ""

# 4. ICMP flood protection
echo "[4] ICMP (ping) flood protection..."
sudo iptables -A INPUT -p icmp -m limit \
    --limit 5/sec --limit-burst 10 -j ACCEPT
sudo iptables -A INPUT -p icmp -j DROP
echo "‚úì Max 5 pings/sec"
echo ""

echo "=== RATE LIMITING CONFIGURED ==="
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Load Average (before): 47.82
Load Average (after):  2.15  (‚¨á 95% reduction!)

SYN_RECV (before): 847
SYN_RECV (after):  8    (‚¨á 99% reduction!)
```

**LILITH:**
> *"Excellent. Load —Å 47 —É–ø–∞–ª –¥–æ 2. –ê—Ç–∞–∫–∞ –æ—Ç—Ä–∞–∂–µ–Ω–∞. Rate limiting —Ä–∞–±–æ—Ç–∞–µ—Ç."*

---

#### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É connlimit –∏ hashlimit?

<details>
<summary>üí° –î—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:**

**connlimit:**
- –°—á–∏—Ç–∞–µ—Ç **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ** —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- "–°–∫–æ–ª—å–∫–æ connections –æ—Ç–∫—Ä—ã—Ç–æ –°–ï–ô–ß–ê–° —Å —ç—Ç–æ–≥–æ IP?"
- Max 20 connections ‚Üí 21-–µ REJECT

**hashlimit:**
- –°—á–∏—Ç–∞–µ—Ç **—Å–∫–æ—Ä–æ—Å—Ç—å** –Ω–æ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- "–°–∫–æ–ª—å–∫–æ NEW connections –≤ —Å–µ–∫—É–Ω–¥—É/–º–∏–Ω—É—Ç—É?"
- > 50/sec ‚Üí DROP

**–ü—Ä–∏–º–µ—Ä:**
```
–õ–µ–≥–∏—Ç–∏–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
  - 10 –æ—Ç–∫—Ä—ã—Ç—ã—Ö connections (connlimit OK)
  - 2 new connections/sec (hashlimit OK)
  ‚Üí ALLOW

Botnet:
  - 5 –æ—Ç–∫—Ä—ã—Ç—ã—Ö connections (connlimit OK)
  - 1000 new connections/sec (hashlimit DROP!)
  ‚Üí BLOCKED
```

**LILITH:**
> *"connlimit = —Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–∏–∫–æ–≤ –∑–∞–Ω—è–ª. hashlimit = –∫–∞–∫ –±—ã—Å—Ç—Ä–æ –±—Ä–æ–Ω–∏—Ä—É–µ—à—å –Ω–æ–≤—ã–µ. –û–±–∞ –Ω—É–∂–Ω—ã."*

</details>

---

### –¶–∏–∫–ª 6: Logging & Monitoring (12 –º–∏–Ω—É—Ç) üìä

#### üé¨ –°—é–∂–µ—Ç (2 –º–∏–Ω)

**–ê–Ω–Ω–∞:**
> *"–ú–∞–∫—Å, –º–Ω–µ –Ω—É–∂–Ω—ã –ª–æ–≥–∏. –ö–∞–∂–¥—ã–π DROP –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å ‚Äî IP, –ø–æ—Ä—Ç, timestamp. Forensics —Ç—Ä–µ–±—É–µ—Ç –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤."*

**–ú–∞–∫—Å:**
> *"–ö–∞–∫ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å iptables?"*

**–ê–Ω–Ω–∞:**
> *"Target LOG. –°—Ç–∞–≤–∏—à—å –ø—Ä–∞–≤–∏–ª–æ –ø–µ—Ä–µ–¥ DROP ‚Äî –æ–Ω–æ –ø–∏—à–µ—Ç –≤ `/var/log/kern.log`. –¢–æ–ª—å–∫–æ –Ω–µ –∑–∞–±—É–¥—å `-m limit`, –∏–Ω–∞—á–µ –¥–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∑–∞ –º–∏–Ω—É—Ç—É."*

---

#### üìö –¢–µ–æ—Ä–∏—è: iptables Logging (5 –º–∏–Ω)

**Log target:**
```bash
sudo iptables -A INPUT -j LOG \
    --log-prefix '[FIREWALL] ' \
    --log-level 4
```

**Parameters:**
- `--log-prefix`: –ú–µ—Ç–∫–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (max 29 —Å–∏–º–≤–æ–ª–æ–≤)
- `--log-level`: 0-7 (4 = warning, —Å—Ç–∞–Ω–¥–∞—Ä—Ç)

**–í–∞–∂–Ω–æ:** LOG ‚â† terminal action (ACCEPT/DROP/REJECT)

```bash
# –ü—Ä–∞–≤–∏–ª—å–Ω–æ: LOG + DROP
iptables -A INPUT -s 1.2.3.4 -j LOG --log-prefix '[BOTNET] '
iptables -A INPUT -s 1.2.3.4 -j DROP

# –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: —Ç–æ–ª—å–∫–æ LOG (–ø–∞–∫–µ—Ç –ø—Ä–æ–π–¥—ë—Ç!)
iptables -A INPUT -s 1.2.3.4 -j LOG
```

---

**üí° AHA Moment: –ó–∞—á–µ–º -m limit –¥–ª—è –ª–æ–≥–æ–≤?**

**–ë–µ–∑ limit:**
```bash
iptables -A INPUT -j LOG --log-prefix '[DROP] '
iptables -A INPUT -j DROP
```

**–ê—Ç–∞–∫–∞:** 50,000 packets/sec
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 50,000 –ª–æ–≥-–∑–∞–ø–∏—Å–µ–π/sec = **180 MB/sec**

–î–∏—Å–∫ 100GB –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∑–∞ 10 –º–∏–Ω—É—Ç!

**–° limit:**
```bash
iptables -A INPUT -m limit --limit 5/min \
    -j LOG --log-prefix '[DROP] '
iptables -A INPUT -j DROP
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∞–∫—Å–∏–º—É–º 5 –∑–∞–ø–∏—Å–µ–π/–º–∏–Ω—É—Ç—É = **–±–µ–∑–æ–ø–∞—Å–Ω–æ**

**LILITH:**
> *"–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ limit = DDoS —Å–∞–º–æ–≥–æ —Å–µ–±—è. –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ —á–µ–º —Å–µ—Ä–≤–µ—Ä —É–ø–∞–¥—ë—Ç."*

---

**–õ–æ–≥ —Ñ–æ—Ä–º–∞—Ç:**
```
Jan 15 04:03:42 shadow-server-02 kernel: [FIREWALL DROP] \
IN=eth0 OUT= SRC=185.220.101.47 DST=10.50.1.1 \
PROTO=TCP SPT=54321 DPT=22 WINDOW=65535 SYN
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
- `SRC=` ‚Äî IP –∞—Ç–∞–∫—É—é—â–µ–≥–æ
- `DPT=` ‚Äî destination port (–∫–∞–∫–æ–π –ø–æ—Ä—Ç –∞—Ç–∞–∫—É—é—Ç)
- `SYN` ‚Äî TCP flag (SYN flood indicator)

---

#### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (4 –º–∏–Ω)

```bash
#!/bin/bash
# logging.sh - Type B approach

echo "=== CONFIGURING ATTACK LOGGING ==="
echo ""

# 1. Log SSH brute-force attempts
echo "[1] SSH brute-force logging..."
sudo iptables -A INPUT -p tcp --dport 22 -m recent --name SSH_TRACK \
    --rcheck --seconds 60 --hitcount 5 \
    -m limit --limit 2/min \
    -j LOG --log-prefix '[SSH BRUTEFORCE] ' --log-level 4
echo "‚úì SSH attacks logged"
echo ""

# 2. Log SYN flood
echo "[2] SYN flood logging..."
sudo iptables -A INPUT -p tcp --syn -m connlimit --connlimit-above 20 \
    -m limit --limit 2/min \
    -j LOG --log-prefix '[SYN FLOOD] ' --log-level 4
echo "‚úì SYN flood logged"
echo ""

# 3. Configure rsyslog for separate firewall log
echo "[3] Configuring rsyslog..."
cat << 'EOF' | sudo tee /etc/rsyslog.d/10-firewall.conf > /dev/null
:msg, contains, "[FIREWALL" /var/log/firewall.log
:msg, contains, "[SSH BRUTEFORCE]" /var/log/firewall-attacks.log
:msg, contains, "[SYN FLOOD]" /var/log/firewall-attacks.log
& stop
EOF

sudo systemctl restart rsyslog
echo "‚úì Logs: /var/log/firewall.log"
echo "‚úì Attacks: /var/log/firewall-attacks.log"
echo ""

# 4. View recent attacks
echo "[4] Recent attacks (last 5):"
sudo tail -5 /var/log/firewall-attacks.log 2>/dev/null || echo "  (no attacks yet)"
```

**–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤:**
```bash
# Real-time monitoring
sudo tail -f /var/log/firewall-attacks.log

# Top attacking IPs
sudo awk '/FIREWALL/ {for(i=1;i<=NF;i++) if($i~/^SRC=/) print substr($i,5)}' \
    /var/log/firewall.log | sort | uniq -c | sort -rn | head -10
```

---

#### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å:** –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç `& stop` –≤ rsyslog –∫–æ–Ω—Ñ–∏–≥–µ?

```
:msg, contains, "[FIREWALL" /var/log/firewall.log
& stop
```

<details>
<summary>üí° –î—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:** "–ù–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏–µ –ª–æ–≥–∏"

**–ë–µ–∑ `& stop`:**
```
[FIREWALL] –∑–∞–ø–∏—Å—å ‚Üí /var/log/firewall.log
                   ‚Üí /var/log/syslog (–¥—É–±–ª—å!)
                   ‚Üí /var/log/kern.log (–¥—É–±–ª—å!)
```

**–° `& stop`:**
```
[FIREWALL] –∑–∞–ø–∏—Å—å ‚Üí /var/log/firewall.log
                   ‚Üí STOP (–Ω–µ –ø–∏—Å–∞—Ç—å –¥–∞–ª—å—à–µ)
```

**–ó–∞—á–µ–º?** –≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞ + –ª–µ–≥—á–µ –∏—Å–∫–∞—Ç—å (–æ–¥–∏–Ω —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ —Ç—Ä—ë—Ö).

**LILITH:**
> *"& stop = '—Ö–≤–∞—Ç–∏—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å'. –û–¥–∏–Ω –ª–æ–≥-—Ñ–∞–π–ª –Ω–∞ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è ‚Äî —á–∏—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ."*

</details>

---

### –¶–∏–∫–ª 7: Final Security Audit (12 –º–∏–Ω—É—Ç) ‚úÖ

#### üé¨ –°—é–∂–µ—Ç (3 –º–∏–Ω)

**04:07 ‚Äî –†–æ–≤–Ω–æ 5 –º–∏–Ω—É—Ç –ø—Ä–æ—à–ª–æ**

**–ê–ª–µ–∫—Å** (—Å–ø–æ–∫–æ–π–Ω–æ):
> *"–ú–∞–∫—Å. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ Load Average."*

```bash
$ uptime
 04:07:23 up 2 days, 14:35,  load average: 1.92, 3.45, 8.67
```

**–ú–∞–∫—Å** (–Ω–µ –≤–µ—Ä–∏—Ç):
> *"1.92?! –ë—ã–ª–æ 47!"*

**–ê–ª–µ–∫—Å:**
> *"–¢—ã –æ—Ç—Ä–∞–∑–∏–ª DDoS. –ü–æ–∑–¥—Ä–∞–≤–ª—è—é. –¢–µ–ø–µ—Ä—å –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –≤—Å—ë. –í–∏–∫—Ç–æ—Ä —Ç—Ä–µ–±—É–µ—Ç –æ—Ç—á—ë—Ç."*

**LILITH:**
> *"Load average: 47.82 ‚Üí 1.92. That's 96% reduction. Attack mitigated. Now prove it with data."*

---

#### üìö –¢–µ–æ—Ä–∏—è: Security Audit Components (4 –º–∏–Ω)

**–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç audit report:**

1. **Incident Summary**
   - Start/end time
   - Attack type
   - Source IPs count
   - Peak metrics

2. **Firewall Configuration**
   - UFW status
   - iptables rules count
   - Blocked IPs

3. **System Metrics**
   - Load average (before/after)
   - SYN_RECV count
   - Memory/CPU usage

4. **Effectiveness Assessment**
   - Attack reduction %
   - False positives?
   - Legitimate traffic OK?

5. **Recommendations**
   - Next steps
   - Improvements
   - Monitoring plan

---

#### üíª –ü—Ä–∞–∫—Ç–∏–∫–∞: Generate Audit Report (4 –º–∏–Ω)

**–ó–∞–¥–∞–Ω–∏–µ:** –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ final security audit report.

```bash
#!/bin/bash
# audit_report.sh - Type B: collect results YOU configured

REPORT_FILE="artifacts/firewall_audit_report.txt"
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

{
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "         FIREWALL SECURITY AUDIT REPORT"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
    echo "Date:     $TIMESTAMP"
    echo "Location: –¶–û–î '–ú–æ—Å–∫–≤–∞-1', –°–µ—Ä–≤–µ—Ä–Ω–∞—è A-12 üá∑üá∫"
    echo "Operator: Max Sokolov"
    echo "Incident: DDoS Attack Response (Day 13 of 60)"
    echo ""

    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo " [1] INCIDENT SUMMARY"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
    echo "Start Time:   03:47 (emergency call)"
    echo "End Time:     04:07 (attack mitigated)"
    echo "Duration:     20 minutes"
    echo "Attack Type:  DDoS (SYN Flood)"
    echo "Source IPs:   847 botnet nodes"
    echo "Peak Load:    47.82 (CRITICAL)"
    echo "Final Load:   $(uptime | awk -F'load average:' '{print $2}' | cut -d',' -f1)"
    echo ""
    echo "STATUS: ‚úì ATTACK MITIGATED"
    echo ""

    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo " [2] FIREWALL CONFIGURATION"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
    sudo ufw status verbose 2>/dev/null
    echo ""
    echo "iptables DROP rules: $(sudo iptables -L INPUT -n | grep -c DROP)"
    echo ""

    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo " [3] CURRENT METRICS"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
    echo "Load Average:    $(uptime | awk -F'load average:' '{print $2}')"
    echo "SYN_RECV count:  $(netstat -an 2>/dev/null | grep -c SYN_RECV)"
    echo "Memory usage:    $(free -m | awk 'NR==2{printf "%.1f%%", $3*100/$2}')"
    echo ""

    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo " [4] SECURITY MEASURES IMPLEMENTED"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
    echo "‚úì UFW enabled (default deny incoming)"
    echo "‚úì SSH (22), HTTP (80), HTTPS (443) allowed"
    echo "‚úì 847 botnet IPs blocked (iptables)"
    echo "‚úì Rate limiting:"
    echo "    - Max 20 connections per IP"
    echo "    - SSH: 4 attempts/minute"
    echo "    - HTTP/HTTPS: 50 req/sec per IP"
    echo "‚úì Attack logging enabled"
    echo "‚úì Logs: /var/log/firewall-attacks.log"
    echo ""

    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo " [5] RECOMMENDATIONS"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
    echo "1. Monitor logs daily: sudo tail -f /var/log/firewall-attacks.log"
    echo "2. Update botnet IP list weekly (IPs change)"
    echo "3. Consider fail2ban for automation"
    echo "4. Backup rules: sudo iptables-save > /etc/iptables.rules"
    echo "5. Episode 08: VPN for encrypted communications"
    echo ""

    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo " END OF REPORT"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"

} > "$REPORT_FILE"

echo "‚úì Report generated: $REPORT_FILE"
cat "$REPORT_FILE"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Comprehensive audit report —Å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

#### ü§î –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è (1 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å:** –ü–æ—á–µ–º—É audit report –≤–∞–∂–µ–Ω?

<details>
<summary>üí° –î—É–º–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π</summary>

**–û—Ç–≤–µ—Ç:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è + –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞!

**–ó–∞—á–µ–º:**
1. **Forensics:** –ê–Ω–Ω–∞ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
2. **Compliance:** –í–∏–∫—Ç–æ—Ä –æ—Ç—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –∑–∞–∫–∞–∑—á–∏–∫–æ–º
3. **Future reference:** –°–ª–µ–¥—É—é—â–∞—è –∞—Ç–∞–∫–∞ ‚Äî —Å–º–æ—Ç—Ä–∏—à—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–ª–æ
4. **Learning:** –ü–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –¥–µ–ª–∞–ª, –ø–æ–ª—É—á–∏—Ç—å feedback

**LILITH:**
> *"–ë–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äî —Ç—ã –Ω–µ —Å–¥–µ–ª–∞–ª –Ω–∏—á–µ–≥–æ. –ö–æ–¥ –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, firewall –±–µ–∑ audit report ‚Äî –æ–¥–Ω–∞ —Ö—É–π–Ω—è."*

</details>

---

### –¶–∏–∫–ª 8: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ + Advanced Topics (10 –º–∏–Ω—É—Ç) üéì

#### üé¨ –°—é–∂–µ—Ç: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —ç–ø–∏–∑–æ–¥–∞ (3 –º–∏–Ω)

**04:08 ‚Äî –¢–∏—à–∏–Ω–∞ –ø–æ—Å–ª–µ –±—É—Ä–∏**

**–ú–∞–∫—Å —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —ç–∫—Ä–∞–Ω. –ì—Ä–∞—Ñ–∏–∫–∏ Grafana –∑–µ–ª—ë–Ω—ã–µ.**

**–ê–ª–µ–∫—Å:**
> *"–ù–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å. –¢—ã –æ—Ç—Ä–∞–∑–∏–ª –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é DDoS –∞—Ç–∞–∫—É. –ó–∞ 20 –º–∏–Ω—É—Ç. –£–¥–∞–ª—ë–Ω–Ω–æ. –ò–∑ —Å–∞–º–æ–ª—ë—Ç–∞."*

**–í–∏–∫—Ç–æ—Ä:**
> *"–û—Ç—á—ë—Ç –ø–æ–ª—É—á–∏–ª. –í–ø–µ—á–∞—Ç–ª—è—é—â–µ. –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–∞–Ω–Ω—ã–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ú–∞–∫—Å, —Ç—ã —Å–ø—Ä–∞–≤–∏–ª—Å—è."*

**–ê–Ω–Ω–∞:**
> *"–Ø –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∞ IP. –í—Å–µ –∏–∑ —Å–µ—Ç–∏ –ö—Ä—ã–ª–æ–≤–∞. –û–Ω –∑–Ω–∞–ª —á—Ç–æ –º—ã –≤ –ú–æ—Å–∫–≤–µ. –≠—Ç–æ –±—ã–ª–∞ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∞—Ç–∞–∫–∞."*

---

**04:15 ‚Äî –°–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö**

```bash
$ sudo tail -1 /var/log/firewall-attacks.log

Jan 15 04:14:58 shadow-server-02 kernel: [BOTNET BLOCKED]
SRC=185.220.101.47 DST=10.50.1.1
MSG="–°–æ–∫–æ–ª–æ–≤. –ü–µ—Ä–µ–¥–∞–π –±—Ä–∞—Ç—É: —è –Ω–∞–π–¥—É –≤–∞—Å. –û–±–æ–∏—Ö. - –ö."
```

**–ú–∞–∫—Å** (—Ç–∏—Ö–æ):
> *"–≠—Ç–æ... —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö? –ö–∞–∫?!"*

**–ê–ª–µ–∫—Å** (–≥–æ–ª–æ—Å –Ω–∞–ø—Ä—è–∂—ë–Ω):
> *"TCP payload. –û–Ω –≤—Å—Ç—Ä–æ–∏–ª —Ç–µ–∫—Å—Ç –≤ –ø–∞–∫–µ—Ç—ã. –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∞—Ç–∞–∫–∞. –≠—Ç–æ... —É–≥—Ä–æ–∑–∞."*

**–í–∏–∫—Ç–æ—Ä:**
> *"–ú—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ. Episode 08 ‚Äî VPN –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ."*

**LILITH:**
```
Episode 07 Complete.
Krylov escalates. Security must escalate too.
Next: Episode 08 - VPN & SSH Tunneling.
Stay sharp. Stay hidden. Stay alive.
```

---

#### üìö Advanced Topics (5 –º–∏–Ω)

**–ß—Ç–æ –¥–∞–ª—å—à–µ –∏–∑—É—á–∞—Ç—å:**

**1. fail2ban** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –±–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
sudo apt install fail2ban
# –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –ª–æ–≥–∏ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–∞–Ω–∏—Ç IP
```

**2. ipset** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ IP
```bash
# 10,000 IP = 1 –ø—Ä–∞–≤–∏–ª–æ –≤–º–µ—Å—Ç–æ 10,000
sudo ipset create blacklist hash:ip
sudo iptables -I INPUT -m set --match-set blacklist src -j DROP
```

**3. nftables** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ iptables
- –ü—Ä–æ—â–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- IPv4 –∏ IPv6 –≤ –æ–¥–Ω–æ–º –ø—Ä–∞–≤–∏–ª–µ
- Atomic updates

**4. IDS/IPS** ‚Äî Intrusion Detection/Prevention
- Snort
- Suricata
- OSSEC

**5. WAF** ‚Äî Web Application Firewall
- ModSecurity
- Cloudflare
- AWS WAF

---

#### ü§î Final Quiz (2 –º–∏–Ω)

**–í–æ–ø—Ä–æ—Å 1:** –ß—Ç–æ –≤–∞–∂–Ω–µ–µ —Å–¥–µ–ª–∞—Ç—å –ü–ï–†–í–´–ú –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ UFW?

<details>
<summary>–û—Ç–≤–µ—Ç</summary>

**–†–∞–∑—Ä–µ—à–∏—Ç—å SSH (port 22)!**

```bash
sudo ufw allow 22/tcp  # FIRST!
sudo ufw enable        # THEN!
```

–ò–Ω–∞—á–µ ‚Äî lockout.

</details>

---

**–í–æ–ø—Ä–æ—Å 2:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É DROP –∏ REJECT?

<details>
<summary>–û—Ç–≤–µ—Ç</summary>

- **DROP:** –ú–æ–ª—á–∞ –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç (attacker –Ω–µ –∑–Ω–∞–µ—Ç —á—Ç–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
- **REJECT:** –û—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç + –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ICMP "port unreachable"

**–î–ª—è security:** DROP –ª—É—á—à–µ (–Ω–µ –¥–∞—ë—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é attackers).

</details>

---

**–í–æ–ø—Ä–æ—Å 3:** –ó–∞—á–µ–º `-m limit` –ø—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏?

<details>
<summary>–û—Ç–≤–µ—Ç</summary>

**–ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞!**

–ë–µ–∑ limit: 50,000 packets/sec ‚Üí 50,000 –ª–æ–≥-–∑–∞–ø–∏—Å–µ–π/sec ‚Üí –¥–∏—Å–∫ –ø–æ–ª–Ω—ã–π –∑–∞ –º–∏–Ω—É—Ç—ã.

–° limit: max 5 –∑–∞–ø–∏—Å–µ–π/–º–∏–Ω—É—Ç—É ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω–æ.

</details>

---

## ‚úÖ –ß—Ç–æ –≤—ã –∏–∑—É—á–∏–ª–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏:
- ‚úÖ **UFW** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, enable/disable, allow/deny
- ‚úÖ **iptables** ‚Äî chains, targets, –ø—Ä–∞–≤–∏–ª–∞
- ‚úÖ **Rate limiting** ‚Äî connlimit, recent, hashlimit
- ‚úÖ **IP blocking** ‚Äî –º–∞—Å—Å–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ loop
- ‚úÖ **Logging** ‚Äî iptables LOG, rsyslog, –∞–Ω–∞–ª–∏–∑
- ‚úÖ **Monitoring** ‚Äî load average, SYN_RECV, metrics
- ‚úÖ **Type B approach** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –Ω–∞–ø—Ä—è–º—É—é

### Soft skills:
- ‚úÖ –†–∞–±–æ—Ç–∞ –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º (5 –º–∏–Ω—É—Ç deadline)
- ‚úÖ –£–¥–∞–ª—ë–Ω–Ω–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—ã—Å–æ–∫–∞—è latency)
- ‚úÖ Incident response
- ‚úÖ Documentation (audit reports)

### –°—é–∂–µ—Ç:
- ‚úÖ –ü–µ—Ä–≤—ã–π —Å–µ—Ä—å—ë–∑–Ω—ã–π incident (DDoS)
- ‚úÖ –ú–∞–∫—Å –¥–æ–∫–∞–∑–∞–ª –Ω–∞–≤—ã–∫–∏ –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º
- ‚úÖ –ö—Ä—ã–ª–æ–≤ —ç—Å–∫–∞–ª–∏—Ä—É–µ—Ç ‚Äî —É–≥—Ä–æ–∑–∞ –ê–ª–µ–∫—Å—É –∏ –ú–∞–∫—Å—É
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ VPN (Episode 08)

---

## üìÅ Solution Files (Type B)

–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å:

```
solution/
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ ufw_rules.sh             # UFW configuration (NOT wrapper!)
‚îÇ   ‚îî‚îÄ‚îÄ iptables_backup.sh       # iptables alternative (advanced)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ generate_firewall_report.sh  # Report generator (~100 lines)
‚îî‚îÄ‚îÄ README.md                    # Type B documentation
```

**–§–∏–ª–æ—Å–æ—Ñ–∏—è:** –ü—Ä—è–º—ã–µ –∫–æ–º–∞–Ω–¥—ã UFW/iptables, –ù–ï bash wrappers!

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è:**
```bash
# 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å UFW rules
sudo ./solution/configs/ufw_rules.sh

# 2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å iptables
sudo ./solution/configs/iptables_backup.sh

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞
sudo ufw status verbose
sudo iptables -L -v -n

# 4. Generate report
./solution/scripts/generate_firewall_report.sh
```

**Type B Success Criteria:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª ufw/iptables –Ω–∞–ø—Ä—è–º—É—é (–Ω–µ wrapper!)
- ‚úÖ Bash loop –¥–ª—è bulk operations (OK!)
- ‚úÖ Production-ready –∫–æ–Ω—Ñ–∏–≥–∏
- ‚úÖ Report generator < 150 —Å—Ç—Ä–æ–∫

---

## üìñ –†–µ—Å—É—Ä—Å—ã

**Man pages:**
```bash
man ufw
man iptables
man iptables-extensions  # connlimit, recent, hashlimit
```

**–§–∞–π–ª—ã:**
```
/etc/ufw/ufw.conf          # UFW config
/var/log/ufw.log           # UFW logs
/var/log/kern.log          # iptables logs
```

**Online:**
- UFW Documentation: https://help.ubuntu.com/community/UFW
- iptables Tutorial: https://www.netfilter.org/documentation/

---

*"Firewall ‚Äî —ç—Ç–æ –Ω–µ —Å—Ç–µ–Ω–∞. –≠—Ç–æ –≤—ã—à–∏–±–∞–ª–∞. –•–æ—Ä–æ—à–∏–π –≤—ã—à–∏–±–∞–ª–∞ –∑–Ω–∞–µ—Ç –∫–æ–≥–æ –≤–ø—É—Å–∫–∞—Ç—å, –∫–æ–≥–æ –≤—ã–∫–∏–Ω—É—Ç—å, –∞ –∫–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–ª—é–¥–∞—Ç—å."* ‚Äî –ê–ª–µ–∫—Å –°–æ–∫–æ–ª–æ–≤

**Episode 07 Complete!** ‚úì

**Next:** Episode 08 ‚Äî VPN & SSH Tunneling üîí

---
