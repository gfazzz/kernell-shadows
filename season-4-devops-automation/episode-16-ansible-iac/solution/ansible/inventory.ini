# KERNEL SHADOWS: Episode 16 — Ansible & Infrastructure as Code
# Operation Shadow Infrastructure Inventory
# Amsterdam → Berlin (Day 31-32)
# Klaus Schmidt, Ansible Architect

# ============================================================================
# 50 Servers Infrastructure (Production Environment)
# ============================================================================

# Web Servers (10 servers) - Nginx/Apache
[web]
web-01.operation-shadow.net
web-02.operation-shadow.net
web-03.operation-shadow.net
web-04.operation-shadow.net
web-05.operation-shadow.net
web-06.operation-shadow.net
web-07.operation-shadow.net
web-08.operation-shadow.net
web-09.operation-shadow.net
web-10.operation-shadow.net

# Database Servers (5 servers) - PostgreSQL
[database]
db-01.operation-shadow.net
db-02.operation-shadow.net
db-03.operation-shadow.net
db-04.operation-shadow.net
db-05.operation-shadow.net

# Cache Servers (5 servers) - Redis
[cache]
cache-01.operation-shadow.net
cache-02.operation-shadow.net
cache-03.operation-shadow.net
cache-04.operation-shadow.net
cache-05.operation-shadow.net

# Monitoring Servers (2 servers) - Prometheus + Grafana
[monitoring]
monitor-01.operation-shadow.net
monitor-02.operation-shadow.net

# Application Servers (28 servers) - Docker containers
[app]
app-01.operation-shadow.net
app-02.operation-shadow.net
app-03.operation-shadow.net
app-04.operation-shadow.net
app-05.operation-shadow.net
app-06.operation-shadow.net
app-07.operation-shadow.net
app-08.operation-shadow.net
app-09.operation-shadow.net
app-10.operation-shadow.net
app-11.operation-shadow.net
app-12.operation-shadow.net
app-13.operation-shadow.net
app-14.operation-shadow.net
app-15.operation-shadow.net
app-16.operation-shadow.net
app-17.operation-shadow.net
app-18.operation-shadow.net
app-19.operation-shadow.net
app-20.operation-shadow.net
app-21.operation-shadow.net
app-22.operation-shadow.net
app-23.operation-shadow.net
app-24.operation-shadow.net
app-25.operation-shadow.net
app-26.operation-shadow.net
app-27.operation-shadow.net
app-28.operation-shadow.net

# ============================================================================
# Groups of Groups (Nested Groups)
# ============================================================================

[production:children]
web
database
cache
monitoring
app

[backend:children]
database
cache

[frontend:children]
web
app

# ============================================================================
# Group Variables
# ============================================================================

[production:vars]
ansible_user=deploy
ansible_ssh_private_key_file=~/.ssh/deploy_key
ansible_python_interpreter=/usr/bin/python3
environment=production
datacenter=tempelhof
timezone=Europe/Amsterdam

[web:vars]
nginx_version=1.24
ssl_enabled=true

[database:vars]
postgres_version=15
backup_enabled=true

[cache:vars]
redis_version=7
maxmemory=2gb

# ============================================================================
# Local Testing (для отладки playbooks без реальных серверов)
# ============================================================================

[local]
localhost ansible_connection=local ansible_python_interpreter=/usr/bin/python3

# ============================================================================
# Klaus's Notes:
#
# "50 servers. One inventory file. Ansible scales."
#
# Pattern matching examples:
#   web-[01:10]  → web-01 through web-10
#   app-*        → all app servers
#   production   → all 50 servers
#
# To target specific groups:
#   ansible-playbook -i inventory.ini playbook.yml --limit web
#   ansible-playbook -i inventory.ini playbook.yml --limit "web:database"
#
# To test without running:
#   ansible-playbook -i inventory.ini playbook.yml --check
# ============================================================================


